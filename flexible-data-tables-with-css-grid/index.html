<!DOCTYPE html>
<html data-n-head="" data-n-head-ssr>
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="#ffffff" theme-color="theme-color"><meta data-n-head="true" content="Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &amp;quot;list view&amp;quot;.
It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.
" name="description" data-hid="description"><meta data-n-head="true" content="css grid, css, javascript, table, data, responsive design, responsive, flexbox, resize column, web app, development, crm, sales" name="keywords" data-hid="keywords"><meta data-n-head="true" content="summary" name="twitter:card" data-hid="twitter:card"><meta data-n-head="true" content="Flexible data tables with CSS Grid" name="twitter:title" data-hid="twitter:title"><meta data-n-head="true" content="Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &amp;quot;list view&amp;quot;.
It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.
" name="twitter:description" data-hid="twitter:description"><meta data-n-head="true" content="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" name="twitter:image"><meta data-n-head="true" content="/flexible-data-tables-with-css-grid" name="twitter:url" data-hid="twitter:url"><meta data-n-head="true" content="article" name="og:type" data-hid="og:type"><meta data-n-head="true" content="Flexible data tables with CSS Grid" name="og:title" data-hid="og:title"><meta data-n-head="true" content="Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &amp;quot;list view&amp;quot;.
It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.
" name="og:description" data-hid="og:description"><meta data-n-head="true" content="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" name="og:image" data-hid="og:image"><meta data-n-head="true" content="/flexible-data-tables-with-css-grid" name="og:url" data-hid="og:url"><title data-n-head="true">Flexible data tables with CSS Grid</title><link href="/apple-touch-icon.png" rel="apple-touch-icon" data-n-head="true" sizes="76x76"><link href="/favicon-32x32.png" rel="icon" data-n-head="true" sizes="32x32" type="image/x-icon"><link href="/favicon-16x16.png" rel="icon" data-n-head="true" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" data-n-head="true" color="#53687a"><link href="//unpkg.com/prismjs/themes/prism.css" rel="stylesheet" data-n-head="true"><link href="/_nuxt/manifest.8ae1f35e680abc541c20.js" rel="preload" as="script"><link href="/_nuxt/vendor.ce05078a33ab89125ee8.js" rel="preload" as="script"><link href="/_nuxt/app.3350f002994de6bb1c66.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" rel="preload" as="script"><link href="/_nuxt/1.03bda2e583db241630d8.js" rel="preload" as="script"><link href="/_nuxt/pages/index.5bad6aa85a4e69648400.js" rel="prefetch"><style data-vue-ssr-id="6dd13fd5:0">*{-webkit-box-sizing:border-box;box-sizing:border-box}body,html{margin:0;padding:0}ol,ul{list-style:none;padding-left:0;margin:0}a{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;text-decoration:none;color:inherit}body{font-family:Arial,sans-serif;line-height:1.55;letter-spacing:-.25px;-webkit-font-smoothing:antialiased}.wf-active body{font-family:Lato,Arial,sans-serif}html{font-size:14px}@media (min-width:470px){html{font-size:16px}}body{background:#ececec;color:#333;padding-top:28px;padding-top:2rem;overflow-x:hidden}.wrapper{max-width:840px;max-width:60rem;margin:0 auto}.header{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0 14px;padding:0 1rem;background:#ececec}@media (min-width:59rem){.header{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}@media (min-width:470px){.header{padding-left:2rem;padding-right:2rem}}.site-title{margin:0;text-align:center;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;min-width:100%;max-width:84px;max-width:6rem}@media (min-width:42rem){.site-title{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.site-title{-webkit-box-flex:initial;-ms-flex:initial;flex:initial}}.site-title:hover{opacity:.9}.site-link{display:inline-block;background:url(/_nuxt/img/Logo.542e06c.png) 0 no-repeat;background-size:6.09rem;height:126px;height:9rem;width:84px;width:6rem;margin:0 auto;text-indent:-9999px}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.site-link{background-image:url(/_nuxt/img/Logo@2x.b121531.png)}}.site-happy-text-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0 auto;padding:0;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:18.2px;font-size:1.3rem}@media (min-width:42rem){.site-happy-text-wrapper{-webkit-box-flex:2;-ms-flex:2;flex:2;padding:0 0 0 2rem}}@media (min-width:59rem){.site-happy-text-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;font-size:1.2rem}}@media (min-width:61rem){.site-happy-text-wrapper{font-size:1.3rem}}.site-happy-text{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;text-align:center}@media (min-width:42rem){.site-happy-text{text-align:left}}.site-happy-text-headline{display:block}.site-happy-text-headline,.wf-active .site-happy-text-headline{font-size:26.599px;font-size:1.9rem;font-weight:700}@media (min-width:25rem){.site-happy-text-headline{font-size:2.3rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:2.5rem}}@media (min-width:59rem){.site-happy-text-headline{font-size:2.9rem}.wf-active .site-happy-text-headline{font-size:3.1rem}}@media (min-width:61rem){.site-happy-text-headline{font-size:2.92rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:3.2rem}}.site-happy-text-tagline{display:inline}@media (min-width:42rem){.site-happy-text-tagline{display:block}}.navigation-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;padding:28px 0 0;padding:2rem 0 0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}@media (min-width:59rem){.navigation-wrapper{max-width:23rem;padding:0 0 0 2rem}}.navigation{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-width:100%;width:100%;border-radius:5px;overflow:hidden}@media (min-width:59rem){.navigation{-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-width:0}}.navigation-item{-webkit-box-flex:1;-ms-flex:1 1 33%;flex:1 1 33%;min-width:33%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;cursor:pointer;font-size:11.9px;font-size:.85rem;font-weight:200;-webkit-transition:background-color .25s;transition:background-color .25s}@media (min-width:25rem){.navigation-item{font-size:.9rem}}@media (min-width:45rem){.navigation-item{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.navigation-item{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:33%}}.navigation-item:first-child{background:#e2e2e2}.navigation-item:first-child:hover{background:#ddd}.navigation-item:nth-child(2){background:#e8e8e8}.navigation-item:nth-child(2):hover{background:#e3e3e3}.navigation-item:nth-child(3){background:#efefef}.navigation-item:nth-child(3):hover{background:#eaeaea}.navigation-item:nth-child(4){background:#ddd}.navigation-item:nth-child(4):hover{background:#d8d8d8}.navigation-item:nth-child(5){background:#e3e3e3}.navigation-item:nth-child(5):hover{background:#dedede}.navigation-item:nth-child(6){background:#eaeaea}.navigation-item:nth-child(6):hover{background:#e4e4e4}.navigation-link{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:14px;padding:1rem;text-decoration:none;font-size:12.6px;font-size:.9rem;color:#000;-webkit-transition:color .25s;transition:color .25s}@media (min-width:25rem){.navigation-link{padding:1.4rem}}.navigation-link:after{content:"";position:absolute;top:100%;left:0;bottom:0;right:0;height:0;width:100%;background:#fff;opacity:.1;cursor:pointer;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}.navigation-link:hover:after{top:50%;height:50%}.navigation-item-text{-webkit-box-flex:1;-ms-flex:1;flex:1}.posts{padding:28px 14px;padding:2rem 1rem}@media (min-width:470px){.posts{padding:2rem}}.post-wrapper{padding-bottom:28px;padding-bottom:2rem}.post-wrapper:last-child{padding-bottom:0}.post{padding:28px 14px;padding:2rem 1rem;margin:28px 0;margin:2rem 0;background:#fff;max-width:840px;max-width:60rem;position:relative}@media (min-width:470px){.post{padding:2rem}}.post:before{background:linear-gradient(180deg,hsla(0,0%,100%,0) 0,#fff 1500px);-webkit-animation:fadein 1s ease-in;animation:fadein 1s ease-in}.post:after,.post:before{content:" ";position:absolute;top:0;left:50%;bottom:0;width:100vw;-webkit-transform:translateX(-50%);transform:translateX(-50%);z-index:-1}.post:after{background:linear-gradient(0deg,#ececec 0,hsla(0,0%,100%,0) 1000px)}.posts .post{margin:0 auto;border-radius:5px}.posts .post:after,.posts .post:before{content:none}.posts .post:before{-webkit-animation:none;animation:none}@media (min-width:62rem){.post-page-post-wrapper .post{border-radius:5px}}.post>:first-child{margin-top:0}@media (min-width:62rem){.post-page-post-wrapper{margin-left:2rem;margin-right:2rem}}.post-content{font-size:15.4px;font-size:1.1rem;line-height:1.55}.post-content>*{margin:21px 0 0;margin:1.5rem 0 0}.post-content :not(figure)>a{color:#4580a7;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(104,130,197,.4)),to(rgba(104,130,197,.4)));background-image:linear-gradient(rgba(104,130,197,.4),rgba(104,130,197,.4));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-content :not(figure)>a:hover{color:#6882c5}.post-content blockquote{position:relative;font-size:18.2px;font-size:1.3rem;font-size:21.98px;font-size:1.57rem;font-style:italic;font-weight:100;padding-left:28px;padding-left:2rem;line-height:1.48;margin-top:28px;margin-top:2rem}.post-content blockquote:before{content:"\201C";position:absolute;top:-21px;top:-1.5rem;left:-7px;left:-.5rem;height:42px;height:3rem;width:25px;color:#f5f5f5;font-size:84px;font-size:6rem;font-style:normal;line-height:1}.post-content blockquote footer{margin-top:14px;margin-top:1rem;font-size:12.6px;font-size:.9rem;text-align:right}.post-content blockquote cite{display:inline-block;margin-left:7px;margin-left:.5rem}.post-content figure{text-align:center}.post-content figcaption{color:#666;font-size:12.6px;font-size:.9rem;font-style:italic}.post-content img{display:block;max-width:100%;height:auto;margin:0 auto;min-height:50px;min-width:150px;position:relative;color:#b6b6b6;font-size:12.6px;font-size:.9rem;text-align:center}.post-content img:before{content:"Image failed to load :/";display:block;font-size:13.299px;font-size:.95rem}.post-content code,.post-content pre{font-family:Consolas,Monaco,Andale Mono,monospace;text-shadow:0 1px #fff;white-space:pre;word-spacing:normal;word-break:normal;-webkit-font-feature-settings:none;font-feature-settings:none;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;word-wrap:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.post-content :not(h3):not(h4):not(h5):not(h6)>code,.post-content pre{font-size:11.9px;font-size:.85rem}.post-content :not(pre)>code,.post-content pre{background:#f5f5f5}.post-content pre{padding:14px;padding:1rem;overflow:auto;color:#000}.post-content :not(pre)>code{display:inline-block;padding:0 3.815px;padding:0 .2725rem;white-space:normal}.post-content a code{background:transparent none repeat 0 0/auto auto padding-box border-box scroll;background:initial;font-size:13.719px;font-size:.98rem;padding:0;padding:initial}.post-content p:first-child{margin-top:0}.post-content h2,.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3{font-size:22.75px;font-size:1.625rem}.post-content h4{font-size:19.446px;font-size:1.389rem}.post-content h5{font-size:16.142px;font-size:1.153rem}.post-content h6{font-size:13.034px;font-size:.931rem}.post-content .post-header-anchor{position:absolute;left:-14px;left:-1rem;top:20px;width:14px;width:1rem;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:0 0;text-align:center;line-height:1;text-shadow:none;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}@media (min-width:470px){.post-content .post-header-anchor{left:-2rem;top:20px;width:2rem}}.post-content .post-header-anchor:focus{outline:0}.post-content .post-header-anchor:hover svg{opacity:1}.post-content .post-header-anchor:after{content:" copied";position:absolute;bottom:-14px;left:0;right:0;font-size:.6em;color:gray;opacity:0;visibility:none;-webkit-transition:opacity 2s;transition:opacity 2s}.post-content .post-header-anchor svg{opacity:.2}.post-content h4 .post-header-anchor{top:18px}.post-content h5 .post-header-anchor{top:16px}.post-content h6 .post-header-anchor{top:14px}.post-content .post-header-anchor--copied:after{opacity:1}.post-content p:last-of-type{margin-bottom:0}.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3+p,.post-content h4+p,.post-content h5+p,.post-content h6+p{margin-top:7px;margin-top:.5rem}.post-content p+h3,.post-content p+h4,.post-content p+h5,.post-content p+h6{margin-top:28px;margin-top:2rem}.post-content ol,.post-content ul{padding-left:1.25em;list-style:disc outside none;list-style:initial}.post-content ol{list-style-type:decimal}.post-content li{margin-bottom:7px;margin-bottom:.5rem}.post-summary .post-content,.post-summary .post-content>*{display:inline}.post-content table{border-spacing:0;border-collapse:collapse}.post-content td,.post-content th{padding:0;padding:6px 13px;border:1px solid #dfe2e5}.post-content th{font-weight:600;text-align:left}.post-title-wrapper{margin:0}.post-title{line-height:1.4;font-size:19.599px;font-size:1.4rem;font-weight:700}.wf-active .post-title{font-size:21px;font-size:1.5rem;line-height:1.2}@media (min-width:30rem){.post-title{line-height:1.6;font-size:1.85rem}.wf-active .post-title{line-height:1.5;font-size:2rem}}.post-title-label{display:inline-block;position:relative;bottom:.3em;padding:.2em .4em;margin-left:.3em;font-size:.5em;background:#e3e3e3;color:#9e9e9e;border-radius:5%;font-weight:400;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in}.post-title:hover .post-title-label{opacity:.9}.post-title-label-parenthesis{display:none}.post-meta{font-size:12.6px;font-size:.9rem;margin:14px 0;margin:1rem 0;color:#a2a2a2}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.post-meta{color:#000;font-weight:300}}.post-blog-date{display:block;margin-top:7px;margin-top:.5rem}@media (min-width:30rem){.post-blog-date{display:inline;margin-top:0}.post-blog-date+.post-blog-title:before{display:inline-block;content:" \2014   ";margin:0 .25rem 0 .5rem}}.post-blog-link{font-weight:400;font-style:italic}.footer-link,.post-blog-link,.post-read-more-link,.post-title,.site-happy-text-headline-link,.site-happy-text-tagline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link:hover,.post-blog-link:hover,.post-read-more-link:hover,.post-title:hover,.site-happy-text-headline-link:hover,.site-happy-text-tagline-link:hover{color:#6882c5;background:-webkit-gradient(linear,left top,right top,from(#5c7b8f),to(#6882c5));background:linear-gradient(90deg,#5c7b8f,#6882c5);background-clip:border-box;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-box-decoration-break:clone;box-decoration-break:clone}.footer-link,.post-read-more-link,.post-title,.site-happy-text-tagline-link{color:#5c7b8f}.post-read-more-link{display:inline-block;font-weight:700;margin:0}.post-comments{margin:28px 28px 0;margin:2rem 2rem 0;padding:28px;padding:2rem;background:#fff;border-radius:5px}@media (min-width:62rem){.post-comments{margin-left:0;margin-right:0}}.post-comments a{color:#5c7b8f;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(rgba(0,0,0,.2)));background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-comments a:hover{color:#6882c5}@media (min-width:62rem){.more-articles{padding-left:0;padding-right:0}}.footer{text-align:center;font-size:11.2px;font-size:.8rem;margin-bottom:28px;margin-bottom:2rem}.footer-text{margin:0}.footer-link{font-weight:700}.copyright{display:block;color:gray}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.copyright{font-weight:100}}.fix-bug-ignore{color:red}.posts{position:relative}.post-wrapper{-webkit-transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out}.post{-webkit-transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out,-webkit-transform .1s ease-in-out}.posts--entering-post .post-wrapper:not(.post-wrapper--entering-from-posts) .post{opacity:.2;-webkit-transform:scale(.8);transform:scale(.8)}.posts--entering-post .post-wrapper--entering-from-posts{left:0;right:0}@media (min-width:62rem){.posts--entering-post .post-wrapper--entering-from-posts{margin-left:2rem;margin-right:2rem}}.post-skeleton{line-height:1.55;position:relative;opacity:0;max-height:0;overflow:hidden}.post-skeleton.post-skeleton--visible,.post-wrapper--entering-from-posts .post-skeleton{opacity:1;margin-top:28px;margin-top:2rem;max-height:none}.post-skeleton:after{content:" ";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;opacity:.2;-webkit-animation:1s skeleton infinite ease-in-out;animation:1s skeleton infinite ease-in-out}.post-skeleton-word{height:15.4px;height:1.1rem;background:#f7f7f7;width:46px;display:inline-block;margin:4px 6px 0 0}.post-skeleton-word:nth-child(2n){width:36px}.post-skeleton-word:nth-child(3n){width:76px}.post-skeleton+.post-skeleton .post-skeleton-word:nth-child(3n){width:71px}.post-skeleton-word:nth-child(5n){width:96px}.post-skeleton-word:nth-child(6n){width:63px}.post-skeleton-word:nth-child(7n){width:26px}@-webkit-keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}</style><style data-vue-ssr-id="1629eadd:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style>
    <script src="https://unpkg.com/scrollto-with-animation/dist/scrollto-with-animation.min.js"></script>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#869bad;opacity:0"></div><div id="__layout"><div class="wrapper"><main class="content"><header class="header"><h1 class="site-title"><a href="/" class="site-link nuxt-link-active">Adam Lynch</a></h1><div class="site-happy-text-wrapper"><p class="site-happy-text"><span class="site-happy-text-headline">
                I'm <a href="/" class="site-happy-text-headline-link nuxt-link-active">Adam Lynch</a>.
            </span><span class="site-happy-text-tagline">
                I like to
                <a href="https://github.com/adam-lynch" class="site-happy-text-tagline-link">code</a>,
                <a href="/" class="site-happy-text-tagline-link nuxt-link-active">write</a>, and dabble in design.
            </span><span class="site-happy-text-tagline">
                I lead <a href="https://www.teamwork.com" class="site-happy-text-tagline-link">Teamwork.com</a>'s next product.
            </span></div><nav class="navigation-wrapper" role="navigation"><ul class="navigation"><li class="navigation-item writing-navigation-item"><a href="/" class="navigation-link nuxt-link-active"><span class="navigation-item-text">Writing</span></a><li class="navigation-item code-navigation-item"><a href="https://github.com/adam-lynch" class="navigation-link" rel="noopener"><span class="navigation-item-text">Code</span></a><li class="navigation-item edit-navigation-item"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="navigation-link" rel="noopener"><span class="navigation-item-text">Edit page</span></a><li class="navigation-item twitter-navigation-item"><a href="https://twitter.com/lynchy010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">Twitter</span></a><li class="navigation-item email-navigation-item"><a href="mailto:contact@adamlynch.com" class="navigation-link" rel="noopener"><span class="navigation-item-text">Email</span></a><li class="navigation-item linkedin-navigation-item"><a href="https://www.linkedin.com/in/adamlynch010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">LinkedIn</span></a></ul></nav></header><div class="post-page-post-wrapper"><article class="post"><h2 class="post-title-wrapper"><a href="/flexible-data-tables-with-css-grid" class="post-title nuxt-link-exact-active nuxt-link-active">Flexible data tables with CSS Grid</a></h2><div class="post-meta"><time class="post-blog-date">May 12th</time><div class="no-ssr-placeholder"></div></div><div class="post-content">
<p>Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the "list view".</p>
<p>It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>
<p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>
<figure>
          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""></a>
          <figcaption><p>The leads list view.</p>
</figcaption>
        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It's not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.</p>
<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don't have device-orientated breakpoints).</p>
<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>
<figure>
          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""></a>
          <figcaption><p>What a list view looks like on a narrow screen.</p>
</figcaption>
        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>
<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>
<p>Assume there are a lot of columns (we'll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>
<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>
<figure>
          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""></a>
          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>
</figcaption>
        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I'll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>
<h2><a href="#just-get-to-css-grid-already" class="post-header-anchor" id="just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>
<p>I'm no CSS Grid expert but I love it. It's extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I'll skip giving an introduction to Grid in this article. Go read Rachel Andrew's <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you're done wondering where Grid was all your life, come back to me.</p>
<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table></code> to make it a grid. This won't break anything if the browser doesn't support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead></code> and <code>&lt;tbody></code>. It's not the <code>&lt;thead></code>, <code>&lt;tbody></code>, or even the <code>&lt;tr></code>s we're concerned with though. What we want to do is lay out our <code>&lt;th></code>s and <code>&lt;td></code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that's not ideal. Each <code>&lt;tr></code> grid would be independent of others and that's not good (you'll see later that I had the same problem with Flexbox).</p>
<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead></code>, <code>&lt;tbody></code>, and <code>&lt;tr></code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th></code>s and <code>&lt;td></code>s) to participate in the the <code>&lt;table></code> grid instead.</p>
<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>
<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid's<code>auto</code> and <code>max-content</code> too but what we've ended up with seems to produce the best result.</p>
<p>Here is a simplified example:</p>
<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="Flexible data table with CSS Grid">
  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">
  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script src="https://static.codepen.io/assets/embed/ei.js" async></script>
<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it's a bit constrained embedded here like this. Then try resizing the window.</p>
<h2><a href="#resizing-columns-with-grid" class="post-header-anchor" id="resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>
<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>
<p>For example, a user could create a (date) custom field for contacts called "Date of birth" so that can be tracked in the system for each contact.</p>
<p>Since a type like "Date" is selected when creating a custom field, our system already handles custom fields. There's more to think about when columns are toggled, but first I need to explain how resizing works.</p>
<ol>
<li>The user hovers over a column header, a resize handle is shown on the right hand side. We're listening for <code>mousedown</code> on the resize handle.</li>
<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>
<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table's scroll position, and our minimum into account. Then we re-set the <code>&lt;table></code>'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>
<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>
</ol>
<p>Edit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using <code>table.scrollLeft</code> instead of <code>document.documentElement.scrollLeft</code> to get the horizontal scroll position of the <em>page</em>.</p>
<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>
<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">
  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">
  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script src="https://static.codepen.io/assets/embed/ei.js" async></script>
<p>What's great here is that we only need to update one element in the DOM, not each cell.</p>
<p>We always build with touch users in mind, but it's OK not to support this via touch. It's a very precise action. Even if I wanted to resize a column using touch, I'd probably expect a different interaction, like a multi-touch spread gesture.</p>
<h2><a href="#fixed-column-widths" class="post-header-anchor" id="fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>
<p>You might have noticed I didn't tell the whole truth. Not only do we "fix" the width of the column you're resizing, we make all column widths fixed. Maybe you didn't even notice, because that's exactly how it should work.</p>
<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>
<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">
  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">
  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p> 
<script src="https://static.codepen.io/assets/embed/ei.js" async></script>
<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>
<p>We shouldn't make assumptions based on which column was or wasn't interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>
<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>
<figure>
          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""></a>
          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>
</figcaption>
        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>
<p>I can't remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it's because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren't supported. You don't have to do this, it would have been too important to leave out for our users.</p>
<p>Using something fluid probably wouldn't align with the user's intentions anyway. We can't assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it's to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we'd be disregarding the choice they made. They'd have to resize the column again to see the same content. Users are unlikely to be thinking "Hmm, I want this column to take up 20% of the window even if I resize it". Anyway, users rarely resize windows; I'm going into too much detail on an edge case here.</p>
<h2><a href="#toggling-columns" class="post-header-anchor" id="toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>
<figure>
          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""></a>
          <figcaption><p>Our modal for customizing which columns are shown.</p>
</figcaption>
        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>
<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>
<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>
<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>
<h2><a href="#why-didnt-you-just-use--libraryname-" class="post-header-anchor" id="why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>"Why didn't you just use {{ libraryName }}?"</h2>
<p>I didn't want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn't be responsive, and might not even use <code>&lt;table></code> at all. I also didn't want to write something like that myself. There must be a better way, I thought.</p>
<h2><a href="#why-didnt-you-just-use-flexbox" class="post-header-anchor" id="why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>"Why didn't you just use Flexbox?"</h2>
<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>
<p>I could have switched to <code>&lt;div></code>s representing the column containing the vertically stacked cells within. I didn't want to have to do this though. I wanted to use a <code>&lt;table></code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>
<h2><a href="#why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" id="why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>"Why didn't you just use a <code>&lt;colgroup></code>?"</h2>
<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup></code></a>, it's a handy old element. Once you define your columns using <code>&lt;col></code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>
<p>In the end though, it was simply too limited for what I needed to do. It didn't take long to realise it was a no-go. So much so, that I can't remember exactly what the problems were. I'm pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn't work well with Flexbox or Grid.</p>
<h2><a href="#why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" id="why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>"Why didn't you just use table-layout: fixed?"</h2>
<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table></code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>
<h2><a href="#but-you-could-still-have-used-a-table" class="post-header-anchor" id="but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>"But you could still have used a table!"</h2>
<p>Yes, tables can do a lot of smart things out of the box, but they can't efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>
<h2><a href="#dont-go-overboard-with-display-contents" class="post-header-anchor" id="dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don't go overboard with display: contents</h2>
<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>
<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag & drop in Firefox.</p>
<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>
<h2><a href="#im-probably-forgetting-something" class="post-header-anchor" id="im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I'm probably forgetting something</h2>
<p>There's a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can't remember anymore.</p>
<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It's a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn't recommend doing that. It's tricky to achieve with horizontally scrollable tables.</p>
<p>I didn't even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>
<p>We'll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>
<p>Anyway, thanks for reading.</p>
</div></article><aside><div class="post-comments"><p>Feedback is more than welcome via <a href="https://twitter.com/lynchy010">@lynchy010</a> or <a href="mailto:contact@adamlynch.com">contact@adamlynch.com</a></div><div class="no-ssr-placeholder"></div></aside></div><footer class="footer"><p class="footer-text"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="footer-link">This site is open source</a><span class="copyright">© 2019 Adam Lynch</span></footer></main></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{article:{id:"flexible-data-tables-with-css-grid",slug:"flexible-data-tables-with-css-grid",highlightedLanguages:["css"],source:'---\ndate: 2019-05-12\ntags:\n  - css grid\n  - css\n  - javascript\n  - table\n  - data\n  - responsive design\n  - responsive\n  - flexbox\n  - resize column\n  - web app\n  - development\n  - crm\n  - sales\n---\n\n## Flexible data tables with CSS Grid\n\n::: summary\n\nNow that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the [Teamwork CRM](https://www.teamwork.com/crm) puzzle was the "list view". \n\nIt\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n\n:::\n\n\nFirst, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to [skip to the CSS Grid bit](#just-get-to-css-grid-already).\n\n:::figure flexible-data-tables-with-css-grid/wide3.png The leads list view.\n:::\n\nPrimarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.\n\nEverything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints). \n\nAt its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen. \n\n:::figure flexible-data-tables-with-css-grid/narrow.png What a list view looks like on a narrow screen.\n:::\n\nResponsive tables are tricky. There are [several existing patterns](https://bradfrost.github.io/this-is-responsive/patterns.html) you could pick from. Consider what your users are trying to achieve and choose wisely. \n\nOnce we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.\n\nAssume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns. \n\nColumns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.\n\n:::figure flexible-data-tables-with-css-grid/resizing-window.gif How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.\n:::\n\nTo begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.\n\n## Just get to CSS Grid already\n\nI\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s [The New CSS Layout](https://abookapart.com/products/the-new-css-layout) or [A Complete Guide to Grid](https://css-tricks.com/snippets/css/complete-guide-grid/) and when you\'re done wondering where Grid was all your life, come back to me.\n\nThe first thing we do is apply `display: grid` to the `<table>` to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using `display:table`). Its children become grid items; the `<thead>` and `<tbody>`. It\'s not the `<thead>`, `<tbody>`, or even the `<tr>`s we\'re concerned with though. What we want to do is lay out our `<th>`s and `<td>`s on this grid. We could apply `display: grid` to each of these too (i.e. grids within grids), but that\'s not ideal. Each `<tr>` grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).\n\nA workaround is to use `display: contents` on the `<thead>`, `<tbody>`, and `<tr>`s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the `<th>`s and `<td>`s) to participate in the the `<table>` grid instead. \n\nThen we use the magic `grid-template-columns` to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:\n\n```css\ngrid-template-columns: minmax(150px, 1.33fr) minmax(150px, 2.33fr);\n```\n\nWe use the same minimum size for all columns but the max (`fr`) value is determined by the column data type. I tried using Grid\'s`auto` and `max-content` too but what we\'ve ended up with seems to produce the best result.\n\nHere is a simplified example:\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nYou should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.\n\n## Resizing columns with Grid\n\nOn top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields. \n\nFor example, a user could create a (date) custom field for contacts called "Date of birth" so that can be tracked in the system for each contact. \n\nSince a type like "Date" is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.\n\n1. The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for `mousedown` on the resize handle.\n2. When the user clicks the handle, we bind some more `mousemove` and `mousedown` event listeners (to the `window`). We also add some classes for decoration at this point.\n3. When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the `<table>`\'s `grid-template-columns`s rule (via `style` attribute), this time replacing the max (`fr`) value with a pixel value. For example, `grid-template-columns: minmax(150px, 1.33fr) 296px;`. We do this using `requestAnimationFrame` to keep it as smooth as possible.\n4. When `mouseup` is fired, we unbind event listeners and remove classes.\n\nEdit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using `table.scrollLeft` instead of `document.documentElement.scrollLeft` to get the horizontal scroll position of the *page*.\n\nTry this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nWhat\'s great here is that we only need to update one element in the DOM, not each cell.\n\nWe always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.\n\n## Fixed column widths\n\nYou might have noticed I didn\'t tell the whole truth. Not only do we "fix" the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.\n\nI originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nAfter some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions. \n\nWe shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.\n\nTherefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.\n\n:::figure flexible-data-tables-with-css-grid/resizing-columns.gif Before, during, and after resizing a column. Sorry the GIF is a bit janky.\n:::\n\nOnce someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.\n\nI can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and `display: contents` aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.\n\nUsing something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking "Hmm, I want this column to take up 20% of the window even if I resize it". Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.\n\n## Toggling columns\n\n:::figure flexible-data-tables-with-css-grid/manage-columns.png Our modal for customizing which columns are shown.\n:::\n\nImagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default `grid-template-column` values depending on their data type. For example, `minmax(150px, 3.33fr)`.\n\nIf any of the columns has a fixed width stored in localStorage, we make *all* of the chosen columns fixed width (and store those widths in localStorage too).\n\nOver time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.\n\nWe also store an array of column identifiers in localStorage, separate to the column width entries.\n\n## "Why didn\'t you just use {{ libraryName }}?"\n\nI didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use `<table>` at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.\n\n## "Why didn\'t you just use Flexbox?"\n\nEach row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.\n\nI could have switched to `<div>`s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a `<table>`. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.\n\n## "Why didn\'t you just use a `<colgroup>`?"\n\nCheck out [`<colgroup>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup), it\'s a handy old element. Once you define your columns using `<col>`s, styles applied to one will effectively be applied to all of the cells in that column. \n\nIn the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.\n\n## "Why didn\'t you just use table-layout: fixed?"\n\nI could have use `table-layout: fixed` on the `<table>` and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.\n\n## "But you could still have used a table!"\n\nYes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.\n\n## Don\'t go overboard with display: contents\n\n`display:contents` allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content. \n\nWe discovered a [strange bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1550728) when combining it with native drag & drop in Firefox.\n\nFortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See [Why display: contents is not CSS Grid Layout subgrid](https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/).\n\n## I\'m probably forgetting something\n\nThere\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore. \n\nWe use `position: sticky` to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.\n\nI didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.\n\nWe\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.\n\nAnyway, thanks for reading.\n',unfilteredRenderedBody:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<article-summary><p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n</article-summary><p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Edit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using <code>table.scrollLeft</code> instead of <code>document.documentElement.scrollLeft</code> to get the horizontal scroll position of the <em>page</em>.</p>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',attributes:{date:"2019-05-12T00:00:00.000Z",tags:[{id:"css-grid",name:"css grid"},{id:"css",name:"css"},{id:"javascript",name:"javascript"},{id:"table",name:"table"},{id:"data",name:"data"},{id:"responsive-design",name:"responsive design"},{id:"responsive",name:"responsive"},{id:"flexbox",name:"flexbox"},{id:"resize-column",name:"resize column"},{id:"web-app",name:"web app"},{id:"development",name:"development"},{id:"crm",name:"crm"},{id:"sales",name:"sales"}],title:"Flexible data tables with CSS Grid",updated_at:"2019-05-23T16:49:56.604Z",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"},title:"Flexible data tables with CSS Grid",renderedSummary:"<p>Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the <a href=\"https://www.teamwork.com/crm\" rel=\"noopener\">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n",rendered:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n<p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Edit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using <code>table.scrollLeft</code> instead of <code>document.documentElement.scrollLeft</code> to get the horizontal scroll position of the <em>page</em>.</p>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',summary:"Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &quot;list view&quot;.\nIt's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png",keywords:["css grid","css","javascript","table","data","responsive design","responsive","flexbox","resize column","web app","development","crm","sales"],published_at:"2019-05-12T00:00:00.000Z",updated_at:"2019-05-23T16:49:56.604Z",year:2019,month:5,day:13,relevanceScore:2,moreArticles:[{id:"improve-permissions-ux",slug:"improve-permissions-ux",highlightedLanguages:["javascript"],source:"---\ndate: 2018-03-03\ntags:\n  - ux\n  - permissions\n  - pwa\n  - web\n  - javascript\n  - notifications\n  - geolocation\n  - extension\n  - browsers\n  - development\n---\n\n## How to improve your permissions UX\n\n:::summary\n\n\"Welcome to Costco, can I have your phone number?\" Most people would refuse, right? Well I suppose *some* might oblige, but that depends on a host of factors. This is what permissions requests are like on the web. Let's take a look at how we can do better, before it's too late. Side note: a phone number is like a SnapChat username to your parents.\n\n:::\n\nWe sure can build amazing experiences these days. We can leverage powerful browser APIs to access  users' location, send them notifications (whether your site is open or not), interact with MIDI devices, and a lot more. We didn't get here on our own though. A lot of these capabilities came to other platforms first. We are in our own league when it comes to UX and engagement however. Most users see permissions requests (and these capabilities) as a nuisance.\n\n:::figure improve-permissions-ux/chris-wilson.png Chris Wilson, [The New Bar for Web Experiences](https://www.youtube.com/watch?v=PsgW-0M67TQ) (Chrome Dev Summit 2017)\n:::\n\nAt the last Chrome Dev Summit, Chris Wilson revealed that over 90% of permissions requests in Chrome for Android were unsuccessful. It's understandable. If there were an annoyance scale, I'd position it somewhere between auto-playing media and when native mobile apps open a page from their own website in a WebView, which has a banner that tells you to install their mobile app.\n\nExamples aren't needed because we've all experienced it. It's not so bad if it's obvious why the permission is needed, but in general, we need to try harder. [Peter-Paul Koch argued](https://www.quirksmode.org/blog/archives/2015/05/web_vs_native_l.html) that the web shouldn't emulate native (apps) because it will lead to bad UX. Was he right? These APIs aren't at fault but our implementations are sloppy. As web developers and designers we should lift our heads up and look around a bit more; we can learn a lot from mobile (and other platforms).\n\n\n### Why should I care?\n\nWell, the user's experience should be of utmost importance in general, but in particular, it's a bad first impression to immediately ask someone for their location. A permissions request is an easy way to disrupt the user and it instantly makes your site less trustworthy. From content credibility to conversions, trust plays a key role on the web. Simplest of all, you aren't achieving what you set out to; users aren't accepting permissions requests. In fact, it could be hurting you more than it helps. For example, you might want to send people notifications to reduce churn and keep them coming back to your content. However, it could be driving people away before they even read a single article.\n\n:::figure improve-permissions-ux/balls.jpg What the permissions prompt looks like in Chrome 63.\n:::\n\nChrome 63 (mobile) [adds fuel to the fire](https://cloudfour.com/thinks/time-to-update-your-permissions-ux/). Requests appear like modals in front of the content and users no longer have the option to dismiss the request without making a decision. This will also reduce the amount of repeat requests as users can no longer dismiss. This will surely spur sites to improve their UX. Users will not put up with sites triggering a modal like that on top of HTML modals, banners and annoying ads covering the page on load.\n\nWhat will browsers do if we don't improve? They might disable access to these APIs by default. Users would then have to grant the permission from their browser settings. If browsers feel like being nice they might show a little icon somewhere (e.g. in the address bar) which would show the prompt on click. Disabling by default would be extreme but Google already [removed the notification centre](https://venturebeat.com/2018/03/01/microsoft-improves-its-ai-face-and-image-recognition-tools/) citing lack of usage and it would certainly make a lot of users happy.\n\n\n### When should I request access to these APIs?\n\nDon't. Just don't. Only ask for access if you really need it. If you're playing around on your personal site or making an API demo, fine, but if you have users, have empathy. You are not your users. If you're asking right away because it's critical to your app, I'd re-think that. Will your site or app really not function without it? I doubt it. Otherwise, you'd have to block people from using your app who respond negatively to the permissions request then? Even https://webcamtests.com/ doesn't immediately ask for access to your webcam.\n\nIf you actually need access, context is key. It starts at the door. Make sure the user understands what your site or app is about. How can they if they're immediately presented with a request to track their location? Provide some value to the user first if you can, build some trust. Only ask *when* you really need to. Wait until they get to your store locator before you even begin to think about asking for their location. Ask the user if they'd like to receive notifications of new articles after they'd read a couple. People often think of progressive enhancement as a stack. Just because the user's browsers supports a feature, doesn't mean you should use it right away. There is something to be said for nailing the core experience and enhancing it over time, you know, progressively.\n\n\n### The double request pattern\n\nIf you are going to interrupt the user (and that's what it is, an interruption), then at least do your best to increase the chances of acceptance. You may only get one attempt. Clicking \"Block\" in Google Chrome is permanent, unless the user goes and manually overrides it for your site in Chrome's settings. Other browsers have a \"Remember this choice\" checkbox which results in the same thing.  \n\n:::figure improve-permissions-ux/google-calendar.png Google Calendar's fake UI prompt for notifications\n:::\n\nThis is where the double request pattern from mobile-land comes in. Show some fake UI first, i.e. HTML. If the user responds positively, then trigger the native permissions request. If it's rejected or ignored, then fine. You're not limited to one attempt and can ask them again whenever you want. Be smart here though, don't bombard the user. Ask again after a few more visits or come up with a clever algorithm.\n\nRequests without context are granted 40% less (another fact Chris Wilson shared in his talk). When showing this fake prompt, explain why the permission is needed, how the user will benefit, what will happen once they accept (the native request prompt will appear), etc. If you want to send notifications, what will the notifications be about? How often will the user receive them? The new Google Calendar's fake notification prompt is a good example.\n\nYou were probably imagining a popup (like Google Calendar's one) so far, but hiding the option away in your app's settings would be even better (although they're not mutually exclusively). Allowing the user to opt-in like that is surely the pattern with the highest success rate.\n\n\n#### The permissions API\n\nOne problem with using fake UI is knowing whether or not the user has already granted the permission. You don't want to show the popup again on every visit and if it's an app setting, it should look enabled. Some of the APIs provide a way to figure this out. Notifications for example; `Notification.permission` will either be `granted`, `denied`, or `prompt`. This varies from API to API and some APIs haven't got an option like that at all. For example, the geolocation API; there is no way to check if the user has previously granted access to their location without requesting it again.\n \nThe [Permissions API](https://w3c.github.io/permissions/) comes in handy here. It allows us to query the status of any permission through a single (asynchronous) interface, even the geolocation API. For example:\n\n```javascript\nnavigator.permissions.query({ name: 'notifications' })\n  .then((result) -> {\n\t  if(result.status === 'granted'){\n\t    // They've granted permission previously\n\t  }\n\t  // Otherwise result.status is 'denied' or 'prompt'\n  })\n  .catch((error) -> {\n    /* \n     * The permission state cannot be checked. \n     * E.g. Firefox didn't support the persistent-storage permission name until Firefox 53\n     */\n  });\n```\n\nFor some APIs, permissions aren't as simple though so you can provide some context when querying;\n\n```javascript\nnavigator.permissions.query({ name: 'midi', sysex: true })\n  // ...\n```\n\nUnfortunately, the Permissions API is currently only supported in Chrome (43+) and Firefox (46+). When a permission is explicitly granted or denied, you can store that information in [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage) (or elsewhere) as a fallback. Then you can look up the permission's state there instead of querying it using the Permission API.\n\nThe [Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/Web/API/Permissions) also describes similar methods for requesting and revoking permissions. No browser supports the former and the latter is only supported in Firefox (47+);\n\n```javascript\nnavigator.permissions.revoke({ name: 'microphone' })\n  // ...\n```\n\n\n### Incentivize the user\n\nTo encourage the user to opt-in, you could explain that they will be rewarded in some way. It's to you what that reward could be. Alternatively, you could just use gamification. For example, you could show an on-boarding checklist somewhere in your app, containing \"Enable notifications\" and anything else you'd like. Simply showing the number of completed items or completion percentage to the user will be enough to get some to enable notifications. Don't blackmail users though; don't block them from using certain features until they've granted a permission or signed up for your newsletter or anything like that.\n\n\n### What if the native request is rejected?\n\nIt's unlikely but there is a chance the user could still reject access once the native prompt is shown (or ignore it). If this happens, you should show some feedback and explain how to manually enable the permission via their browser settings (or link to an explanation).\n\n:::figure improve-permissions-ux/whatsapp.png The overlay WhatsApp (web) shows when the native prompt is shown.\n:::\n\nWe can do more than cross our fingers though. When the user interacts with your fake UI and you're about to trigger the native prompt, you could show something to guide them. It could even be an overlay which covers the entire page. By doing this, you can draw more attention to the prompt, prevent it being ignored, and even show some text. I remember when Google Chrome first got popular, some sites would show an arrow pointing at the download bar after you downloaded something. It was crude but it worked. I'd keep this overlay simple though. You shouldn't assume where the native prompt will appear, browser-sniff, or have too much code here in general.\n\n\n### Be reasonable\n\nWhat you do once they enable the permission is another story. First of all, you should ideally give users the option to opt-out. Especially if it's notifications they're granting, [don't go overboard](https://www.youtube.com/watch?v=gkND9G_VqVo). There is no spam filter for notifications. You could provide further settings to tweak how permissions are used. For example, Slack provides granular settings around notifications. My favourite part is that it defaults to sending you a notification for every message but once you've settled into app, it recommends reducing your notification level so you'll only get notified when you're @mentioned.\n\nDon't send the user multiple notifications for the same thing. Even if I've your app is open in 20 tabs, I should only get one notification per event. The Notification API allows you to provide a \"tag\" to achieve this;\n\n```javascript\nnew Notification(\"New email from ...\", { \n  body: \"Hey, how are you? I was wondering...\",\n  tag: \"1\" \n  // ...\n});\n```\n\nIf multiple notifications are created with the same tag (e.g. an email ID), the user will only receive one.\n\n\n### Be pragmatic\n\nYou don't need to do *all* of this. It depends how important the permission in question is to your site. The web would be a better place if everyone applied even a little bit of this.\n\n::: quote Peter Drucker\nIf you can't measure it, you can't improve it.\n:::\n\nFor each permission or feature, track engagement and acceptance, how far users get before rejecting a permission, etc. This is a conversion funnel like any other. You can then tweak it and A/B test.\n\n\n### Dear browsers\n\nHelp us out. Changes could be made to improve the experience for users and prevent abuse. To be fair, browsers block requesting a permission after three dismissals (i.e. when the user ignores it). Google Chrome (at least) allows requests again after a week. This is good but more could be done. \n\nMaybe browsers could allow us to provide some text (a new API option) that will be shown within the native prompt to give more context to the user. This might make a request to access the user's microphone feel a bit less creepy. Alternatively, if we pass a callback, the prompt could have an icon, link, or button to learn why the permission is being requested.\n\nNow let's take a look at some measures that already exist to prevent abuse. As a security feature, the Bluetooth API doesn't allow you to request a device unless it was triggered by a \"user gesture\" such as a touch or click. \n\nChrome (at least) no longer allows notifications from iFrames, from insecure origins ([like other features](https://sites.google.com/a/chromium.org/dev/Home/chromium-security/deprecating-powerful-features-on-insecure-origins)), and even warns you if you request notifications and it wasn't in response to a user gesture. Can't we just enforce this for any permissions request?\n\nChrome's rules around accessing persistent-storage aren't as simple; Chrome will automatically grant the persistence permission if any of the following are true:\n\n- The site is bookmarked (and the user has 5 or less bookmarks)\n- The site has high site engagement\n- The site has been added to home screen\n- The site has push notifications enabled\n\nOtherwise, the permission is automatically denied. \n\nI'm not saying those rules are good or bad but browsers should agree on *some* rules to enforce in respect to all permissions requests. That is my plea. Of course, developers and designers need to do better regardless, but this would really help.\n\nP.S. I noticed there's now a [Dialog API](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog); it would be nice to add some rules here too before it gets too popular and people are using it to display ads the second you hit their page. \n\n\n### Introducing AskBlocker\n\nI've been thinking about writing this for a long time and it was Jason Grigsby's [Time to Update Your Permissions UX](https://cloudfour.com/thinks/time-to-update-your-permissions-ux/) post that inspired me to actually do it. Not only did it turn out to be much longer than I expected, but I brought more work on myself by deciding to create browser extensions as well. \n\n:::figure improve-permissions-ux/askblocker.png AskBlocker for Chrome (screenshot)\n:::\n\n[AskBlocker](https://adamlynch.com/askblocker/) is an extension for Chrome, Firefox, and Brave, which keeps permissions requests in check. Permissions requests are blocked until you've interacted with the page (i.e. click, tap, or key press), with the following exceptions:\n\n- If the permission has been previously requested and granted (or explicitly denied).\n- If the domain is `localhost` or `127.0.0.1`.\n- If you've navigated to the current page from another page on the same domain.\n\nThis will at least block immediate requests to enable notifications the first time you go a site. You can see the requests which were caught and whitelist them (it will ask again and reload, to be safe). It's [open-source](https://github.com/adam-lynch/askblocker).\n\nNote: There aren't any extensions for other browsers (yet) because they don't support the Permissions API. \n\n\n### Conclusion\n\n- We can learn lessons from mobile development and more.\n- Users aren't granting permissions requests.\n- It's no longer possible to dismiss requests in Google Chrome's mobile apps.\n- We looked at how to improve your permissions UX and increase acceptance rate; the keys are discipline, context, timing, measuring, and trust, among others.\n- Browsers, please help.\n- Try out [AskBlocker](https://adamlynch.com/askblocker).\n",unfilteredRenderedBody:'<h2><a id="how-to-improve-your-permissions-ux" class="post-header-anchor" href="#how-to-improve-your-permissions-ux" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How to improve your permissions UX</h2>\n<article-summary><p>&quot;Welcome to Costco, can I have your phone number?&quot; Most people would refuse, right? Well I suppose <em>some</em> might oblige, but that depends on a host of factors. This is what permissions requests are like on the web. Let\'s take a look at how we can do better, before it\'s too late. Side note: a phone number is like a SnapChat username to your parents.</p>\n</article-summary><p>We sure can build amazing experiences these days. We can leverage powerful browser APIs to access  users\' location, send them notifications (whether your site is open or not), interact with MIDI devices, and a lot more. We didn\'t get here on our own though. A lot of these capabilities came to other platforms first. We are in our own league when it comes to UX and engagement however. Most users see permissions requests (and these capabilities) as a nuisance.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/chris-wilson.png"><img src="/images/blog-content/improve-permissions-ux/chris-wilson.png" alt=""/></a>\n          <figcaption><p>Chris Wilson, <a href="https://www.youtube.com/watch?v=PsgW-0M67TQ" rel="noopener">The New Bar for Web Experiences</a> (Chrome Dev Summit 2017)</p>\n</figcaption>\n        </figure><p>At the last Chrome Dev Summit, Chris Wilson revealed that over 90% of permissions requests in Chrome for Android were unsuccessful. It\'s understandable. If there were an annoyance scale, I\'d position it somewhere between auto-playing media and when native mobile apps open a page from their own website in a WebView, which has a banner that tells you to install their mobile app.</p>\n<p>Examples aren\'t needed because we\'ve all experienced it. It\'s not so bad if it\'s obvious why the permission is needed, but in general, we need to try harder. <a href="https://www.quirksmode.org/blog/archives/2015/05/web_vs_native_l.html" rel="noopener">Peter-Paul Koch argued</a> that the web shouldn\'t emulate native (apps) because it will lead to bad UX. Was he right? These APIs aren\'t at fault but our implementations are sloppy. As web developers and designers we should lift our heads up and look around a bit more; we can learn a lot from mobile (and other platforms).</p>\n<h3><a id="why-should-i-care" class="post-header-anchor" href="#why-should-i-care" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why should I care?</h3>\n<p>Well, the user\'s experience should be of utmost importance in general, but in particular, it\'s a bad first impression to immediately ask someone for their location. A permissions request is an easy way to disrupt the user and it instantly makes your site less trustworthy. From content credibility to conversions, trust plays a key role on the web. Simplest of all, you aren\'t achieving what you set out to; users aren\'t accepting permissions requests. In fact, it could be hurting you more than it helps. For example, you might want to send people notifications to reduce churn and keep them coming back to your content. However, it could be driving people away before they even read a single article.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/balls.jpg"><img src="/images/blog-content/improve-permissions-ux/balls.jpg" alt=""/></a>\n          <figcaption><p>What the permissions prompt looks like in Chrome 63.</p>\n</figcaption>\n        </figure><p>Chrome 63 (mobile) <a href="https://cloudfour.com/thinks/time-to-update-your-permissions-ux/" rel="noopener">adds fuel to the fire</a>. Requests appear like modals in front of the content and users no longer have the option to dismiss the request without making a decision. This will also reduce the amount of repeat requests as users can no longer dismiss. This will surely spur sites to improve their UX. Users will not put up with sites triggering a modal like that on top of HTML modals, banners and annoying ads covering the page on load.</p>\n<p>What will browsers do if we don\'t improve? They might disable access to these APIs by default. Users would then have to grant the permission from their browser settings. If browsers feel like being nice they might show a little icon somewhere (e.g. in the address bar) which would show the prompt on click. Disabling by default would be extreme but Google already <a href="https://venturebeat.com/2018/03/01/microsoft-improves-its-ai-face-and-image-recognition-tools/" rel="noopener">removed the notification centre</a> citing lack of usage and it would certainly make a lot of users happy.</p>\n<h3><a id="when-should-i-request-access-to-these-apis" class="post-header-anchor" href="#when-should-i-request-access-to-these-apis" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>When should I request access to these APIs?</h3>\n<p>Don\'t. Just don\'t. Only ask for access if you really need it. If you\'re playing around on your personal site or making an API demo, fine, but if you have users, have empathy. You are not your users. If you\'re asking right away because it\'s critical to your app, I\'d re-think that. Will your site or app really not function without it? I doubt it. Otherwise, you\'d have to block people from using your app who respond negatively to the permissions request then? Even <a href="https://webcamtests.com/" rel="noopener">https://webcamtests.com/</a> doesn\'t immediately ask for access to your webcam.</p>\n<p>If you actually need access, context is key. It starts at the door. Make sure the user understands what your site or app is about. How can they if they\'re immediately presented with a request to track their location? Provide some value to the user first if you can, build some trust. Only ask <em>when</em> you really need to. Wait until they get to your store locator before you even begin to think about asking for their location. Ask the user if they\'d like to receive notifications of new articles after they\'d read a couple. People often think of progressive enhancement as a stack. Just because the user\'s browsers supports a feature, doesn\'t mean you should use it right away. There is something to be said for nailing the core experience and enhancing it over time, you know, progressively.</p>\n<h3><a id="the-double-request-pattern" class="post-header-anchor" href="#the-double-request-pattern" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The double request pattern</h3>\n<p>If you are going to interrupt the user (and that\'s what it is, an interruption), then at least do your best to increase the chances of acceptance. You may only get one attempt. Clicking &quot;Block&quot; in Google Chrome is permanent, unless the user goes and manually overrides it for your site in Chrome\'s settings. Other browsers have a &quot;Remember this choice&quot; checkbox which results in the same thing.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/google-calendar.png"><img src="/images/blog-content/improve-permissions-ux/google-calendar.png" alt=""/></a>\n          <figcaption><p>Google Calendar\'s fake UI prompt for notifications</p>\n</figcaption>\n        </figure><p>This is where the double request pattern from mobile-land comes in. Show some fake UI first, i.e. HTML. If the user responds positively, then trigger the native permissions request. If it\'s rejected or ignored, then fine. You\'re not limited to one attempt and can ask them again whenever you want. Be smart here though, don\'t bombard the user. Ask again after a few more visits or come up with a clever algorithm.</p>\n<p>Requests without context are granted 40% less (another fact Chris Wilson shared in his talk). When showing this fake prompt, explain why the permission is needed, how the user will benefit, what will happen once they accept (the native request prompt will appear), etc. If you want to send notifications, what will the notifications be about? How often will the user receive them? The new Google Calendar\'s fake notification prompt is a good example.</p>\n<p>You were probably imagining a popup (like Google Calendar\'s one) so far, but hiding the option away in your app\'s settings would be even better (although they\'re not mutually exclusively). Allowing the user to opt-in like that is surely the pattern with the highest success rate.</p>\n<h4><a id="the-permissions-api" class="post-header-anchor" href="#the-permissions-api" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The permissions API</h4>\n<p>One problem with using fake UI is knowing whether or not the user has already granted the permission. You don\'t want to show the popup again on every visit and if it\'s an app setting, it should look enabled. Some of the APIs provide a way to figure this out. Notifications for example; <code>Notification.permission</code> will either be <code>granted</code>, <code>denied</code>, or <code>prompt</code>. This varies from API to API and some APIs haven\'t got an option like that at all. For example, the geolocation API; there is no way to check if the user has previously granted access to their location without requesting it again.</p>\n<p>The <a href="https://w3c.github.io/permissions/" rel="noopener">Permissions API</a> comes in handy here. It allows us to query the status of any permission through a single (asynchronous) interface, even the geolocation API. For example:</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'notifications\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>\n\t  <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">\'granted\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n\t    <span class="token comment">// They\'ve granted permission previously</span>\n\t  <span class="token punctuation">}</span>\n\t  <span class="token comment">// Otherwise result.status is \'denied\' or \'prompt\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">/* \n     * The permission state cannot be checked. \n     * E.g. Firefox didn\'t support the persistent-storage permission name until Firefox 53\n     */</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>For some APIs, permissions aren\'t as simple though so you can provide some context when querying;</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'midi\'</span><span class="token punctuation">,</span> sysex<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token comment">// ...</span>\n</code></pre>\n<p>Unfortunately, the Permissions API is currently only supported in Chrome (43+) and Firefox (46+). When a permission is explicitly granted or denied, you can store that information in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" rel="noopener">localStorage</a> (or elsewhere) as a fallback. Then you can look up the permission\'s state there instead of querying it using the Permission API.</p>\n<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions" rel="noopener">Mozilla Developer Network</a> also describes similar methods for requesting and revoking permissions. No browser supports the former and the latter is only supported in Firefox (47+);</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'microphone\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token comment">// ...</span>\n</code></pre>\n<h3><a id="incentivize-the-user" class="post-header-anchor" href="#incentivize-the-user" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Incentivize the user</h3>\n<p>To encourage the user to opt-in, you could explain that they will be rewarded in some way. It\'s to you what that reward could be. Alternatively, you could just use gamification. For example, you could show an on-boarding checklist somewhere in your app, containing &quot;Enable notifications&quot; and anything else you\'d like. Simply showing the number of completed items or completion percentage to the user will be enough to get some to enable notifications. Don\'t blackmail users though; don\'t block them from using certain features until they\'ve granted a permission or signed up for your newsletter or anything like that.</p>\n<h3><a id="what-if-the-native-request-is-rejected" class="post-header-anchor" href="#what-if-the-native-request-is-rejected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What if the native request is rejected?</h3>\n<p>It\'s unlikely but there is a chance the user could still reject access once the native prompt is shown (or ignore it). If this happens, you should show some feedback and explain how to manually enable the permission via their browser settings (or link to an explanation).</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/whatsapp.png"><img src="/images/blog-content/improve-permissions-ux/whatsapp.png" alt=""/></a>\n          <figcaption><p>The overlay WhatsApp (web) shows when the native prompt is shown.</p>\n</figcaption>\n        </figure><p>We can do more than cross our fingers though. When the user interacts with your fake UI and you\'re about to trigger the native prompt, you could show something to guide them. It could even be an overlay which covers the entire page. By doing this, you can draw more attention to the prompt, prevent it being ignored, and even show some text. I remember when Google Chrome first got popular, some sites would show an arrow pointing at the download bar after you downloaded something. It was crude but it worked. I\'d keep this overlay simple though. You shouldn\'t assume where the native prompt will appear, browser-sniff, or have too much code here in general.</p>\n<h3><a id="be-reasonable" class="post-header-anchor" href="#be-reasonable" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Be reasonable</h3>\n<p>What you do once they enable the permission is another story. First of all, you should ideally give users the option to opt-out. Especially if it\'s notifications they\'re granting, <a href="https://www.youtube.com/watch?v=gkND9G_VqVo" rel="noopener">don\'t go overboard</a>. There is no spam filter for notifications. You could provide further settings to tweak how permissions are used. For example, Slack provides granular settings around notifications. My favourite part is that it defaults to sending you a notification for every message but once you\'ve settled into app, it recommends reducing your notification level so you\'ll only get notified when you\'re @mentioned.</p>\n<p>Don\'t send the user multiple notifications for the same thing. Even if I\'ve your app is open in 20 tabs, I should only get one notification per event. The Notification API allows you to provide a &quot;tag&quot; to achieve this;</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">"New email from ..."</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> \n  body<span class="token punctuation">:</span> <span class="token string">"Hey, how are you? I was wondering..."</span><span class="token punctuation">,</span>\n  tag<span class="token punctuation">:</span> <span class="token string">"1"</span> \n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>If multiple notifications are created with the same tag (e.g. an email ID), the user will only receive one.</p>\n<h3><a id="be-pragmatic" class="post-header-anchor" href="#be-pragmatic" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Be pragmatic</h3>\n<p>You don\'t need to do <em>all</em> of this. It depends how important the permission in question is to your site. The web would be a better place if everyone applied even a little bit of this.</p>\n<blockquote><p>If you can\'t measure it, you can\'t improve it.</p>\n<footer>&mdash;<cite><p>Peter Drucker</p>\n</cite></footer></blockquote><p>For each permission or feature, track engagement and acceptance, how far users get before rejecting a permission, etc. This is a conversion funnel like any other. You can then tweak it and A/B test.</p>\n<h3><a id="dear-browsers" class="post-header-anchor" href="#dear-browsers" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Dear browsers</h3>\n<p>Help us out. Changes could be made to improve the experience for users and prevent abuse. To be fair, browsers block requesting a permission after three dismissals (i.e. when the user ignores it). Google Chrome (at least) allows requests again after a week. This is good but more could be done.</p>\n<p>Maybe browsers could allow us to provide some text (a new API option) that will be shown within the native prompt to give more context to the user. This might make a request to access the user\'s microphone feel a bit less creepy. Alternatively, if we pass a callback, the prompt could have an icon, link, or button to learn why the permission is being requested.</p>\n<p>Now let\'s take a look at some measures that already exist to prevent abuse. As a security feature, the Bluetooth API doesn\'t allow you to request a device unless it was triggered by a &quot;user gesture&quot; such as a touch or click.</p>\n<p>Chrome (at least) no longer allows notifications from iFrames, from insecure origins (<a href="https://sites.google.com/a/chromium.org/dev/Home/chromium-security/deprecating-powerful-features-on-insecure-origins" rel="noopener">like other features</a>), and even warns you if you request notifications and it wasn\'t in response to a user gesture. Can\'t we just enforce this for any permissions request?</p>\n<p>Chrome\'s rules around accessing persistent-storage aren\'t as simple; Chrome will automatically grant the persistence permission if any of the following are true:</p>\n<ul>\n<li>The site is bookmarked (and the user has 5 or less bookmarks)</li>\n<li>The site has high site engagement</li>\n<li>The site has been added to home screen</li>\n<li>The site has push notifications enabled</li>\n</ul>\n<p>Otherwise, the permission is automatically denied.</p>\n<p>I\'m not saying those rules are good or bad but browsers should agree on <em>some</em> rules to enforce in respect to all permissions requests. That is my plea. Of course, developers and designers need to do better regardless, but this would really help.</p>\n<p>P.S. I noticed there\'s now a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog" rel="noopener">Dialog API</a>; it would be nice to add some rules here too before it gets too popular and people are using it to display ads the second you hit their page.</p>\n<h3><a id="introducing-askblocker" class="post-header-anchor" href="#introducing-askblocker" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Introducing AskBlocker</h3>\n<p>I\'ve been thinking about writing this for a long time and it was Jason Grigsby\'s <a href="https://cloudfour.com/thinks/time-to-update-your-permissions-ux/" rel="noopener">Time to Update Your Permissions UX</a> post that inspired me to actually do it. Not only did it turn out to be much longer than I expected, but I brought more work on myself by deciding to create browser extensions as well.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/askblocker.png"><img src="/images/blog-content/improve-permissions-ux/askblocker.png" alt=""/></a>\n          <figcaption><p>AskBlocker for Chrome (screenshot)</p>\n</figcaption>\n        </figure><p><a href="https://adamlynch.com/askblocker/" rel="noopener">AskBlocker</a> is an extension for Chrome, Firefox, and Brave, which keeps permissions requests in check. Permissions requests are blocked until you\'ve interacted with the page (i.e. click, tap, or key press), with the following exceptions:</p>\n<ul>\n<li>If the permission has been previously requested and granted (or explicitly denied).</li>\n<li>If the domain is <code>localhost</code> or <code>127.0.0.1</code>.</li>\n<li>If you\'ve navigated to the current page from another page on the same domain.</li>\n</ul>\n<p>This will at least block immediate requests to enable notifications the first time you go a site. You can see the requests which were caught and whitelist them (it will ask again and reload, to be safe). It\'s <a href="https://github.com/adam-lynch/askblocker" rel="noopener">open-source</a>.</p>\n<p>Note: There aren\'t any extensions for other browsers (yet) because they don\'t support the Permissions API.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<ul>\n<li>We can learn lessons from mobile development and more.</li>\n<li>Users aren\'t granting permissions requests.</li>\n<li>It\'s no longer possible to dismiss requests in Google Chrome\'s mobile apps.</li>\n<li>We looked at how to improve your permissions UX and increase acceptance rate; the keys are discipline, context, timing, measuring, and trust, among others.</li>\n<li>Browsers, please help.</li>\n<li>Try out <a href="https://adamlynch.com/askblocker" rel="noopener">AskBlocker</a>.</li>\n</ul>\n',attributes:{date:"2018-03-03T00:00:00.000Z",tags:[{id:"ux",name:"ux"},{id:"permissions",name:"permissions"},{id:"pwa",name:"pwa"},{id:"web",name:"web"},{id:"javascript",name:"javascript"},{id:"notifications",name:"notifications"},{id:"geolocation",name:"geolocation"},{id:"extension",name:"extension"},{id:"browsers",name:"browsers"},{id:"development",name:"development"}],title:"How to improve your permissions UX",updated_at:"2019-05-22T08:25:53.239Z",photo:"/images/blog-content/improve-permissions-ux/chris-wilson.png"},title:"How to improve your permissions UX",renderedSummary:"<p>&quot;Welcome to Costco, can I have your phone number?&quot; Most people would refuse, right? Well I suppose <em>some</em> might oblige, but that depends on a host of factors. This is what permissions requests are like on the web. Let's take a look at how we can do better, before it's too late. Side note: a phone number is like a SnapChat username to your parents.</p>\n",rendered:'<h2><a id="how-to-improve-your-permissions-ux" class="post-header-anchor" href="#how-to-improve-your-permissions-ux" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How to improve your permissions UX</h2>\n<p>&quot;Welcome to Costco, can I have your phone number?&quot; Most people would refuse, right? Well I suppose <em>some</em> might oblige, but that depends on a host of factors. This is what permissions requests are like on the web. Let\'s take a look at how we can do better, before it\'s too late. Side note: a phone number is like a SnapChat username to your parents.</p>\n<p>We sure can build amazing experiences these days. We can leverage powerful browser APIs to access  users\' location, send them notifications (whether your site is open or not), interact with MIDI devices, and a lot more. We didn\'t get here on our own though. A lot of these capabilities came to other platforms first. We are in our own league when it comes to UX and engagement however. Most users see permissions requests (and these capabilities) as a nuisance.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/chris-wilson.png"><img src="/images/blog-content/improve-permissions-ux/chris-wilson.png" alt=""/></a>\n          <figcaption><p>Chris Wilson, <a href="https://www.youtube.com/watch?v=PsgW-0M67TQ" rel="noopener">The New Bar for Web Experiences</a> (Chrome Dev Summit 2017)</p>\n</figcaption>\n        </figure><p>At the last Chrome Dev Summit, Chris Wilson revealed that over 90% of permissions requests in Chrome for Android were unsuccessful. It\'s understandable. If there were an annoyance scale, I\'d position it somewhere between auto-playing media and when native mobile apps open a page from their own website in a WebView, which has a banner that tells you to install their mobile app.</p>\n<p>Examples aren\'t needed because we\'ve all experienced it. It\'s not so bad if it\'s obvious why the permission is needed, but in general, we need to try harder. <a href="https://www.quirksmode.org/blog/archives/2015/05/web_vs_native_l.html" rel="noopener">Peter-Paul Koch argued</a> that the web shouldn\'t emulate native (apps) because it will lead to bad UX. Was he right? These APIs aren\'t at fault but our implementations are sloppy. As web developers and designers we should lift our heads up and look around a bit more; we can learn a lot from mobile (and other platforms).</p>\n<h3><a id="why-should-i-care" class="post-header-anchor" href="#why-should-i-care" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why should I care?</h3>\n<p>Well, the user\'s experience should be of utmost importance in general, but in particular, it\'s a bad first impression to immediately ask someone for their location. A permissions request is an easy way to disrupt the user and it instantly makes your site less trustworthy. From content credibility to conversions, trust plays a key role on the web. Simplest of all, you aren\'t achieving what you set out to; users aren\'t accepting permissions requests. In fact, it could be hurting you more than it helps. For example, you might want to send people notifications to reduce churn and keep them coming back to your content. However, it could be driving people away before they even read a single article.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/balls.jpg"><img src="/images/blog-content/improve-permissions-ux/balls.jpg" alt=""/></a>\n          <figcaption><p>What the permissions prompt looks like in Chrome 63.</p>\n</figcaption>\n        </figure><p>Chrome 63 (mobile) <a href="https://cloudfour.com/thinks/time-to-update-your-permissions-ux/" rel="noopener">adds fuel to the fire</a>. Requests appear like modals in front of the content and users no longer have the option to dismiss the request without making a decision. This will also reduce the amount of repeat requests as users can no longer dismiss. This will surely spur sites to improve their UX. Users will not put up with sites triggering a modal like that on top of HTML modals, banners and annoying ads covering the page on load.</p>\n<p>What will browsers do if we don\'t improve? They might disable access to these APIs by default. Users would then have to grant the permission from their browser settings. If browsers feel like being nice they might show a little icon somewhere (e.g. in the address bar) which would show the prompt on click. Disabling by default would be extreme but Google already <a href="https://venturebeat.com/2018/03/01/microsoft-improves-its-ai-face-and-image-recognition-tools/" rel="noopener">removed the notification centre</a> citing lack of usage and it would certainly make a lot of users happy.</p>\n<h3><a id="when-should-i-request-access-to-these-apis" class="post-header-anchor" href="#when-should-i-request-access-to-these-apis" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>When should I request access to these APIs?</h3>\n<p>Don\'t. Just don\'t. Only ask for access if you really need it. If you\'re playing around on your personal site or making an API demo, fine, but if you have users, have empathy. You are not your users. If you\'re asking right away because it\'s critical to your app, I\'d re-think that. Will your site or app really not function without it? I doubt it. Otherwise, you\'d have to block people from using your app who respond negatively to the permissions request then? Even <a href="https://webcamtests.com/" rel="noopener">https://webcamtests.com/</a> doesn\'t immediately ask for access to your webcam.</p>\n<p>If you actually need access, context is key. It starts at the door. Make sure the user understands what your site or app is about. How can they if they\'re immediately presented with a request to track their location? Provide some value to the user first if you can, build some trust. Only ask <em>when</em> you really need to. Wait until they get to your store locator before you even begin to think about asking for their location. Ask the user if they\'d like to receive notifications of new articles after they\'d read a couple. People often think of progressive enhancement as a stack. Just because the user\'s browsers supports a feature, doesn\'t mean you should use it right away. There is something to be said for nailing the core experience and enhancing it over time, you know, progressively.</p>\n<h3><a id="the-double-request-pattern" class="post-header-anchor" href="#the-double-request-pattern" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The double request pattern</h3>\n<p>If you are going to interrupt the user (and that\'s what it is, an interruption), then at least do your best to increase the chances of acceptance. You may only get one attempt. Clicking &quot;Block&quot; in Google Chrome is permanent, unless the user goes and manually overrides it for your site in Chrome\'s settings. Other browsers have a &quot;Remember this choice&quot; checkbox which results in the same thing.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/google-calendar.png"><img src="/images/blog-content/improve-permissions-ux/google-calendar.png" alt=""/></a>\n          <figcaption><p>Google Calendar\'s fake UI prompt for notifications</p>\n</figcaption>\n        </figure><p>This is where the double request pattern from mobile-land comes in. Show some fake UI first, i.e. HTML. If the user responds positively, then trigger the native permissions request. If it\'s rejected or ignored, then fine. You\'re not limited to one attempt and can ask them again whenever you want. Be smart here though, don\'t bombard the user. Ask again after a few more visits or come up with a clever algorithm.</p>\n<p>Requests without context are granted 40% less (another fact Chris Wilson shared in his talk). When showing this fake prompt, explain why the permission is needed, how the user will benefit, what will happen once they accept (the native request prompt will appear), etc. If you want to send notifications, what will the notifications be about? How often will the user receive them? The new Google Calendar\'s fake notification prompt is a good example.</p>\n<p>You were probably imagining a popup (like Google Calendar\'s one) so far, but hiding the option away in your app\'s settings would be even better (although they\'re not mutually exclusively). Allowing the user to opt-in like that is surely the pattern with the highest success rate.</p>\n<h4><a id="the-permissions-api" class="post-header-anchor" href="#the-permissions-api" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The permissions API</h4>\n<p>One problem with using fake UI is knowing whether or not the user has already granted the permission. You don\'t want to show the popup again on every visit and if it\'s an app setting, it should look enabled. Some of the APIs provide a way to figure this out. Notifications for example; <code>Notification.permission</code> will either be <code>granted</code>, <code>denied</code>, or <code>prompt</code>. This varies from API to API and some APIs haven\'t got an option like that at all. For example, the geolocation API; there is no way to check if the user has previously granted access to their location without requesting it again.</p>\n<p>The <a href="https://w3c.github.io/permissions/" rel="noopener">Permissions API</a> comes in handy here. It allows us to query the status of any permission through a single (asynchronous) interface, even the geolocation API. For example:</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'notifications\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>\n\t  <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">\'granted\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n\t    <span class="token comment">// They\'ve granted permission previously</span>\n\t  <span class="token punctuation">}</span>\n\t  <span class="token comment">// Otherwise result.status is \'denied\' or \'prompt\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">/* \n     * The permission state cannot be checked. \n     * E.g. Firefox didn\'t support the persistent-storage permission name until Firefox 53\n     */</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>For some APIs, permissions aren\'t as simple though so you can provide some context when querying;</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'midi\'</span><span class="token punctuation">,</span> sysex<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token comment">// ...</span>\n</code></pre>\n<p>Unfortunately, the Permissions API is currently only supported in Chrome (43+) and Firefox (46+). When a permission is explicitly granted or denied, you can store that information in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" rel="noopener">localStorage</a> (or elsewhere) as a fallback. Then you can look up the permission\'s state there instead of querying it using the Permission API.</p>\n<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions" rel="noopener">Mozilla Developer Network</a> also describes similar methods for requesting and revoking permissions. No browser supports the former and the latter is only supported in Firefox (47+);</p>\n<pre><code class="language-javascript">navigator<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span><span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'microphone\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token comment">// ...</span>\n</code></pre>\n<h3><a id="incentivize-the-user" class="post-header-anchor" href="#incentivize-the-user" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Incentivize the user</h3>\n<p>To encourage the user to opt-in, you could explain that they will be rewarded in some way. It\'s to you what that reward could be. Alternatively, you could just use gamification. For example, you could show an on-boarding checklist somewhere in your app, containing &quot;Enable notifications&quot; and anything else you\'d like. Simply showing the number of completed items or completion percentage to the user will be enough to get some to enable notifications. Don\'t blackmail users though; don\'t block them from using certain features until they\'ve granted a permission or signed up for your newsletter or anything like that.</p>\n<h3><a id="what-if-the-native-request-is-rejected" class="post-header-anchor" href="#what-if-the-native-request-is-rejected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What if the native request is rejected?</h3>\n<p>It\'s unlikely but there is a chance the user could still reject access once the native prompt is shown (or ignore it). If this happens, you should show some feedback and explain how to manually enable the permission via their browser settings (or link to an explanation).</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/whatsapp.png"><img src="/images/blog-content/improve-permissions-ux/whatsapp.png" alt=""/></a>\n          <figcaption><p>The overlay WhatsApp (web) shows when the native prompt is shown.</p>\n</figcaption>\n        </figure><p>We can do more than cross our fingers though. When the user interacts with your fake UI and you\'re about to trigger the native prompt, you could show something to guide them. It could even be an overlay which covers the entire page. By doing this, you can draw more attention to the prompt, prevent it being ignored, and even show some text. I remember when Google Chrome first got popular, some sites would show an arrow pointing at the download bar after you downloaded something. It was crude but it worked. I\'d keep this overlay simple though. You shouldn\'t assume where the native prompt will appear, browser-sniff, or have too much code here in general.</p>\n<h3><a id="be-reasonable" class="post-header-anchor" href="#be-reasonable" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Be reasonable</h3>\n<p>What you do once they enable the permission is another story. First of all, you should ideally give users the option to opt-out. Especially if it\'s notifications they\'re granting, <a href="https://www.youtube.com/watch?v=gkND9G_VqVo" rel="noopener">don\'t go overboard</a>. There is no spam filter for notifications. You could provide further settings to tweak how permissions are used. For example, Slack provides granular settings around notifications. My favourite part is that it defaults to sending you a notification for every message but once you\'ve settled into app, it recommends reducing your notification level so you\'ll only get notified when you\'re @mentioned.</p>\n<p>Don\'t send the user multiple notifications for the same thing. Even if I\'ve your app is open in 20 tabs, I should only get one notification per event. The Notification API allows you to provide a &quot;tag&quot; to achieve this;</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">"New email from ..."</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> \n  body<span class="token punctuation">:</span> <span class="token string">"Hey, how are you? I was wondering..."</span><span class="token punctuation">,</span>\n  tag<span class="token punctuation">:</span> <span class="token string">"1"</span> \n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>If multiple notifications are created with the same tag (e.g. an email ID), the user will only receive one.</p>\n<h3><a id="be-pragmatic" class="post-header-anchor" href="#be-pragmatic" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Be pragmatic</h3>\n<p>You don\'t need to do <em>all</em> of this. It depends how important the permission in question is to your site. The web would be a better place if everyone applied even a little bit of this.</p>\n<blockquote><p>If you can\'t measure it, you can\'t improve it.</p>\n<footer>&mdash;<cite><p>Peter Drucker</p>\n</cite></footer></blockquote><p>For each permission or feature, track engagement and acceptance, how far users get before rejecting a permission, etc. This is a conversion funnel like any other. You can then tweak it and A/B test.</p>\n<h3><a id="dear-browsers" class="post-header-anchor" href="#dear-browsers" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Dear browsers</h3>\n<p>Help us out. Changes could be made to improve the experience for users and prevent abuse. To be fair, browsers block requesting a permission after three dismissals (i.e. when the user ignores it). Google Chrome (at least) allows requests again after a week. This is good but more could be done.</p>\n<p>Maybe browsers could allow us to provide some text (a new API option) that will be shown within the native prompt to give more context to the user. This might make a request to access the user\'s microphone feel a bit less creepy. Alternatively, if we pass a callback, the prompt could have an icon, link, or button to learn why the permission is being requested.</p>\n<p>Now let\'s take a look at some measures that already exist to prevent abuse. As a security feature, the Bluetooth API doesn\'t allow you to request a device unless it was triggered by a &quot;user gesture&quot; such as a touch or click.</p>\n<p>Chrome (at least) no longer allows notifications from iFrames, from insecure origins (<a href="https://sites.google.com/a/chromium.org/dev/Home/chromium-security/deprecating-powerful-features-on-insecure-origins" rel="noopener">like other features</a>), and even warns you if you request notifications and it wasn\'t in response to a user gesture. Can\'t we just enforce this for any permissions request?</p>\n<p>Chrome\'s rules around accessing persistent-storage aren\'t as simple; Chrome will automatically grant the persistence permission if any of the following are true:</p>\n<ul>\n<li>The site is bookmarked (and the user has 5 or less bookmarks)</li>\n<li>The site has high site engagement</li>\n<li>The site has been added to home screen</li>\n<li>The site has push notifications enabled</li>\n</ul>\n<p>Otherwise, the permission is automatically denied.</p>\n<p>I\'m not saying those rules are good or bad but browsers should agree on <em>some</em> rules to enforce in respect to all permissions requests. That is my plea. Of course, developers and designers need to do better regardless, but this would really help.</p>\n<p>P.S. I noticed there\'s now a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog" rel="noopener">Dialog API</a>; it would be nice to add some rules here too before it gets too popular and people are using it to display ads the second you hit their page.</p>\n<h3><a id="introducing-askblocker" class="post-header-anchor" href="#introducing-askblocker" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Introducing AskBlocker</h3>\n<p>I\'ve been thinking about writing this for a long time and it was Jason Grigsby\'s <a href="https://cloudfour.com/thinks/time-to-update-your-permissions-ux/" rel="noopener">Time to Update Your Permissions UX</a> post that inspired me to actually do it. Not only did it turn out to be much longer than I expected, but I brought more work on myself by deciding to create browser extensions as well.</p>\n<figure>\n          <a href="/images/blog-content/improve-permissions-ux/askblocker.png"><img src="/images/blog-content/improve-permissions-ux/askblocker.png" alt=""/></a>\n          <figcaption><p>AskBlocker for Chrome (screenshot)</p>\n</figcaption>\n        </figure><p><a href="https://adamlynch.com/askblocker/" rel="noopener">AskBlocker</a> is an extension for Chrome, Firefox, and Brave, which keeps permissions requests in check. Permissions requests are blocked until you\'ve interacted with the page (i.e. click, tap, or key press), with the following exceptions:</p>\n<ul>\n<li>If the permission has been previously requested and granted (or explicitly denied).</li>\n<li>If the domain is <code>localhost</code> or <code>127.0.0.1</code>.</li>\n<li>If you\'ve navigated to the current page from another page on the same domain.</li>\n</ul>\n<p>This will at least block immediate requests to enable notifications the first time you go a site. You can see the requests which were caught and whitelist them (it will ask again and reload, to be safe). It\'s <a href="https://github.com/adam-lynch/askblocker" rel="noopener">open-source</a>.</p>\n<p>Note: There aren\'t any extensions for other browsers (yet) because they don\'t support the Permissions API.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<ul>\n<li>We can learn lessons from mobile development and more.</li>\n<li>Users aren\'t granting permissions requests.</li>\n<li>It\'s no longer possible to dismiss requests in Google Chrome\'s mobile apps.</li>\n<li>We looked at how to improve your permissions UX and increase acceptance rate; the keys are discipline, context, timing, measuring, and trust, among others.</li>\n<li>Browsers, please help.</li>\n<li>Try out <a href="https://adamlynch.com/askblocker" rel="noopener">AskBlocker</a>.</li>\n</ul>\n',summary:"&quot;Welcome to Costco, can I have your phone number?&quot; Most people would refuse, right? Well I suppose some might oblige, but that depends on a host of factors. This is what permissions requests are like on the web. Let's take a look at how we can do better, before it's too late. Side note: a phone number is like a SnapChat username to your parents.\n",photo:"/images/blog-content/improve-permissions-ux/chris-wilson.png",keywords:["ux","permissions","pwa","web","javascript","notifications","geolocation","extension","browsers","development"],published_at:"2018-03-03T00:00:00.000Z",updated_at:"2019-05-22T08:25:53.239Z",year:2018,month:3,day:4,relevanceScore:1.4166666666666665},{id:"static-site-regeneration",slug:"static-site-regeneration",highlightedLanguages:[],source:"---\ndate: 2018-02-04\ntags:\n  - writing\n  - static-site-generation\n  - headless-cms\n  - jamstack\n  - git\n  - markdown\n  - vue.js\n  - nuxt.js\n  - javascript\n  - development\n---\n\n## Static site regeneration and focusing on what's important\n\n:::summary\n\nI've had my own site for years now but I haven't used it for much. A refresh was needed. I was focusing on the wrong things, trying to do everything, and getting nowhere slowly. It hasn't changed much in appearance, but that's just the tip of the iceberg. It has been completely redone beneath the surface. \n\n:::\n\nThe catalyst was writing; I miss it. I fell out of the habit. Maybe I was pre-occupied, I could've been a bit burned out. I haven't put pen to paper much since writing [my book](https://www.amazon.co.uk/Developing-Electron-Edge-Lynch-2016-06-17/dp/B01K160MV4), as well the follow-up [Smashing Magazine post](https://adamlynch.com/beyond-the-browser-from-web-apps-to-desktop-apps/) and talks. Even worse (read: harder to admit), I might've been content. *Ugh*. Forgive me, they were bucket list items after all.\n\nI love learning. I've absorbed so much knowledge shared for knowledge sharing's sake. The altruism of the Web community in particular is truly amazing. This blog is an attempt at giving back, playing my part. \n\nIt'll benefit me as well, of course. Writing forces me to further my understanding of topics, for example. I'm not ruling out writing for other blogs again, but I also want a blog that's *mine*. I want freedom, I want control. Plus, side projects are heathy right?\n\n\n### Don't reinvent the wheel, unless you plan on learning more about wheels\n\nI find static site generators fascinating. The end user experience is optimal because it's just static HTML pages, generated in a compile step. It's also a cheaper, more security, and the developer experience is generally better. \n\nI was compelled to write my own static generator using Gulp, Nunjucks templates, Markdown for content, an RSS feed, a pattern library (which is ridiculous looking back now), and more. The output was hosted on GitHub pages (plus CloudFlare HTTPS). This was the last version of my site. \n\nI wanted to do so much and perfect it all but it never got here. Once I had a proof of concept, everything slowed down and my attention went elsewhere. I didn't even get around to properly publishing a blog on the site but I had the proof of concept running locally. Never mind the writing style analyzer, responsive screenshot testing, and other things I had planned to do. I learned that rolling your own static site generator isn't as difficult as it sounds. I might write a post on that.\n\nThe following were my (unordered) requirements this time around.\n\n\n#### Must have\n\n- Doesn't need client-side JavaScript.\n- Crawlable.\n- Isn't restrictive on where the content comes from (e.g. files, API, DB, etc).\n- Flexible (e.g. what if I want to plug sass-lint in?).\n- Can be automated (i.e. continuous integration).\n- Allows Markdown posts.\n- Code can be embedded with CodePen, JSFiddle, etc.\n- Allows for custom / non-blog pages. \n- Allows for multiple post templates / types.\n- Open-source.\n- Supports Linux, Mac, and Windows.\n\n\n#### Nice to have\n\n- Simple.\n- Gives a head start on SEO.\n- Allows you to push the data elsewhere (Medium).\n- Uses tools I'm familiar with and am liking right now.\n- Allows posts in other formats along side Markdown posts.\n- Makes the client-side experience faster / better (progressive enhancement) and if it does, it's lightweight.\n- Service worker head start.\n- Not opinionated.\n- Generates RSS feed.\n- Head start on blog stuff.\n- Content updates can be suggested by readers.\n- Good development experience.\n- Head start on comments.\n- Head start on analytics.\n- Generates sitemap.xml.\n\n\n#### Unimportant\n\n- Build speed.\n- Popularity.\n- Themes.\n\n:::figure static-site-regeneration/nuxt.png\n:::\n\n### Winner\n\nI won't bore you by going into detail on each option I considered. [Nuxt.js](https://nuxtjs.org/) won in the end. It's a minimal framework for creating \"universal Vue.js apps,\" but hmm what does that mean? \n\nWell first there's [Vue.js](https://vuejs.org/), a modern JavaScript framework with Virtual DOM diffing, first-class Flux state management, and fantastic documentation. It's our frontend framework of choice at [Teamwork](https://www.teamwork.com/). But wait, that sounds like way too much for a blog. It doesn't need to be a web app, never mind a \"universal Vue.js app.\" Trust me, it gets better. \n\nNext, there's Nuxt.js. It's a minimal (opinionated) framework which abstracts away Vue.js and Webpack for you. You don't need to set up routing or anything like that (although you can if you'd like). If you were to create a `hello` component inside the `pages` directory, you could run one command to generate a Vue.js web app in which `/hello` would resolve to that component (like [Next.js](https://github.com/zeit/next.js/)). Since it abstracts away Webpack, it has a great development mode, including hot module reloading and more, out of the box.\n\nA \"Universal Vue.js app\" just means that it does some server-side rendering and client-side hydration. So let's say you go to a URL. Typically, the server would return a pretty much empty page which loads some JavaScript, which runs your Vue.js code, which hits an API, then renders a table and adds an event listener so that clicking on a table header would sort the table. A \"universal Vue.js app\" would instead run your Vue.js code on the server-side, which would hit the API, render the result, and return the table in the initial response to the browser. So you get the content as soon as possible, whether or not you've JavaScript enabled, whether or not the JavaScript has a fatal error, and so on. Then the JavaScript is loaded and continues from where the server-side rendering left off (i.e. client-side hydration). If you were to click on a table header, it should be ready and sort the table.\n\nSince it can run and render your Vue.js code on the server-side, it supports static site generation. It's so powerful yet all I need to do is run a slightly different command and it'll spit out static assets. The Nuxt.js logo is also weirdly similar to my own.\n\n\n### Content management\n\nThis doesn't mean I'm going to write blog posts in HTML though. You might've noticed this one interesting requirement: \"Isn't restrictive on where the content comes from (e.g. files, API, DB, etc).\" I wanted to explore other sources of content. A headless CMS, for example. Instead of hosting a CMS and having every request to my blog run through, let's say, Ghost or Wordpress, I could just use them to manage the content. It would be \"headless\" in that I'd only be using the administration panel.  I'd grab the posts by querying its database (or using its API if it has one). Since the phrase has been coined, purpose-built headless CMSs have popped up which only expose APIs and no frontend UI. \n\n\"[JAMstack](https://jamstack.org/)\" has since gained momentum; a \"modern web development architecture based on client-side JavaScript, reusable APIs, and prebuilt Markup.\" Isn't that just static site generation? Well JAMstackers(?) don't like the term \"static\" because the API could return anything really and therefore the site can be pretty dynamic. I'd prefer to hit the API at compile-time, generate static files, and have less client-side JavaScript. So for my purposes, it is static site generation.\n\nI've always wanted to play around with [Contentful](https://www.contentful.com/), a cloud-based headless CMS service. It seems really good, but I ended up choosing a Git-based approach again. Contentful doesn't support Markdown for one (EDIT: it does support Markdown, since February 2014 actually. I don't know how I missed this). Even though the editor is good, I would have no choice but to use it. I can use whatever I like with Git; a text editor, IDE, [Classeur](http://classeur.io/) (my favourite Markdown editor), etc. \n\nI get versioning for free, branching, and it works offline (up until actually publishing changes).\nSince my site is hosted on GitHub (still), I can use its UI to not only edit files but add and delete blog posts too. Another thing I love is that everything is open-source so anyone could suggest improvements to a post. I even have a button at the top of the page for this. Right now it just brings you to the [source code](https://github.com/adam-lynch/adam-lynch.github.io/), but I'll make it so it brings you to the actual post's source content. It could even have quality checks via continuous integration services.\n\nContentful does have built-in responsive image support and search API endpoints though. I'm definitely going to use it somehow, I'm just looking for the right excuse.\n\n\n### Markdown, meet Nuxt.js\n\nSo how do I actually write posts then? Nuxt.js allows you to build modules that tap into the build or generation steps to do custom stuff. A [blog module](https://github.com/nuxt-community/blog-module) already existed. It wasn't flexible enough so I took it and modified it to my needs (which we've found ourselves doing with most Vue.js related things at Teamwork). It looks for markdown files in a `writing` directory, compiles the Markdown, then generates the files, routes, and anything else. The Markdown compiler I've gone with this time is [markdown-it](https://github.com/markdown-it/markdown-it), plus some (third-party and custom) plugins for some additional capabilities. I might write a post on this someday.\n\nThe only downside really was that an RSS module didn't exist so I could match the functionality of my old site. I wrote one but ended up throwing it away when I ran into a tricky last-minute issue.\n\n\n### Imperfection\n\nI'm trying to be more open to shipping less than perfect things these days, so I've definitely left room for improvement. Some of the code is the most hacked together I've ever written. Especially the CSS, which is basically all in one `shame.scss` file. Although this route transition is nice.\n\n\n:::figure static-site-regeneration/route-transition.gif The route [transition](https://nuxtjs.org/api/pages-transition/) when going from the list of posts to an individual one. It involves a bit of positioning logic, automated scrolling, animations, and [skeleton](https://www.lukew.com/ff/entry.asp?1797) text which is shown while the post's content is loading.\n:::\n\nOne thing that's a challenge when going static are comments. You don't get built-in comments like you would with a typical CMS. I've used [Disqus](https://disqus.com/) for the time being but I'm not very happy with it. It's way too heavy. Expect a post on switching to an alternative solution or rolling my own. The workflow could be improved as well. I'd like to automate the asset generation as a continuous deployment step.\n\nAs far as content goes, expect me to publish a post a month, roughly. I'll mostly cover development but I might throw in a post every now and again about other stuff as well. There'll be short posts, deep detailed dives which I've have edited forty times, as well posts I've written in one go (sometimes they're my best). I've so many things I've been meaning to play around with. Now I've an outlet where I can write about them.\n",unfilteredRenderedBody:'<h2><a id="static-site-regeneration-and-focusing-on-whats-important" class="post-header-anchor" href="#static-site-regeneration-and-focusing-on-whats-important" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Static site regeneration and focusing on what\'s important</h2>\n<article-summary><p>I\'ve had my own site for years now but I haven\'t used it for much. A refresh was needed. I was focusing on the wrong things, trying to do everything, and getting nowhere slowly. It hasn\'t changed much in appearance, but that\'s just the tip of the iceberg. It has been completely redone beneath the surface.</p>\n</article-summary><p>The catalyst was writing; I miss it. I fell out of the habit. Maybe I was pre-occupied, I could\'ve been a bit burned out. I haven\'t put pen to paper much since writing <a href="https://www.amazon.co.uk/Developing-Electron-Edge-Lynch-2016-06-17/dp/B01K160MV4" rel="noopener">my book</a>, as well the follow-up <a href="https://adamlynch.com/beyond-the-browser-from-web-apps-to-desktop-apps/" rel="noopener">Smashing Magazine post</a> and talks. Even worse (read: harder to admit), I might\'ve been content. <em>Ugh</em>. Forgive me, they were bucket list items after all.</p>\n<p>I love learning. I\'ve absorbed so much knowledge shared for knowledge sharing\'s sake. The altruism of the Web community in particular is truly amazing. This blog is an attempt at giving back, playing my part.</p>\n<p>It\'ll benefit me as well, of course. Writing forces me to further my understanding of topics, for example. I\'m not ruling out writing for other blogs again, but I also want a blog that\'s <em>mine</em>. I want freedom, I want control. Plus, side projects are heathy right?</p>\n<h3><a id="dont-reinvent-the-wheel-unless-you-plan-on-learning-more-about-wheels" class="post-header-anchor" href="#dont-reinvent-the-wheel-unless-you-plan-on-learning-more-about-wheels" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t reinvent the wheel, unless you plan on learning more about wheels</h3>\n<p>I find static site generators fascinating. The end user experience is optimal because it\'s just static HTML pages, generated in a compile step. It\'s also a cheaper, more security, and the developer experience is generally better.</p>\n<p>I was compelled to write my own static generator using Gulp, Nunjucks templates, Markdown for content, an RSS feed, a pattern library (which is ridiculous looking back now), and more. The output was hosted on GitHub pages (plus CloudFlare HTTPS). This was the last version of my site.</p>\n<p>I wanted to do so much and perfect it all but it never got here. Once I had a proof of concept, everything slowed down and my attention went elsewhere. I didn\'t even get around to properly publishing a blog on the site but I had the proof of concept running locally. Never mind the writing style analyzer, responsive screenshot testing, and other things I had planned to do. I learned that rolling your own static site generator isn\'t as difficult as it sounds. I might write a post on that.</p>\n<p>The following were my (unordered) requirements this time around.</p>\n<h4><a id="must-have" class="post-header-anchor" href="#must-have" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Must have</h4>\n<ul>\n<li>Doesn\'t need client-side JavaScript.</li>\n<li>Crawlable.</li>\n<li>Isn\'t restrictive on where the content comes from (e.g. files, API, DB, etc).</li>\n<li>Flexible (e.g. what if I want to plug sass-lint in?).</li>\n<li>Can be automated (i.e. continuous integration).</li>\n<li>Allows Markdown posts.</li>\n<li>Code can be embedded with CodePen, JSFiddle, etc.</li>\n<li>Allows for custom / non-blog pages.</li>\n<li>Allows for multiple post templates / types.</li>\n<li>Open-source.</li>\n<li>Supports Linux, Mac, and Windows.</li>\n</ul>\n<h4><a id="nice-to-have" class="post-header-anchor" href="#nice-to-have" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Nice to have</h4>\n<ul>\n<li>Simple.</li>\n<li>Gives a head start on SEO.</li>\n<li>Allows you to push the data elsewhere (Medium).</li>\n<li>Uses tools I\'m familiar with and am liking right now.</li>\n<li>Allows posts in other formats along side Markdown posts.</li>\n<li>Makes the client-side experience faster / better (progressive enhancement) and if it does, it\'s lightweight.</li>\n<li>Service worker head start.</li>\n<li>Not opinionated.</li>\n<li>Generates RSS feed.</li>\n<li>Head start on blog stuff.</li>\n<li>Content updates can be suggested by readers.</li>\n<li>Good development experience.</li>\n<li>Head start on comments.</li>\n<li>Head start on analytics.</li>\n<li>Generates sitemap.xml.</li>\n</ul>\n<h4><a id="unimportant" class="post-header-anchor" href="#unimportant" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Unimportant</h4>\n<ul>\n<li>Build speed.</li>\n<li>Popularity.</li>\n<li>Themes.</li>\n</ul>\n<figure>\n          <a href="/images/blog-content/static-site-regeneration/nuxt.png"><img src="/images/blog-content/static-site-regeneration/nuxt.png" alt=""/></a>\n          \n        </figure><h3><a id="winner" class="post-header-anchor" href="#winner" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Winner</h3>\n<p>I won\'t bore you by going into detail on each option I considered. <a href="https://nuxtjs.org/" rel="noopener">Nuxt.js</a> won in the end. It\'s a minimal framework for creating &quot;universal Vue.js apps,&quot; but hmm what does that mean?</p>\n<p>Well first there\'s <a href="https://vuejs.org/" rel="noopener">Vue.js</a>, a modern JavaScript framework with Virtual DOM diffing, first-class Flux state management, and fantastic documentation. It\'s our frontend framework of choice at <a href="https://www.teamwork.com/" rel="noopener">Teamwork</a>. But wait, that sounds like way too much for a blog. It doesn\'t need to be a web app, never mind a &quot;universal Vue.js app.&quot; Trust me, it gets better.</p>\n<p>Next, there\'s Nuxt.js. It\'s a minimal (opinionated) framework which abstracts away Vue.js and Webpack for you. You don\'t need to set up routing or anything like that (although you can if you\'d like). If you were to create a <code>hello</code> component inside the <code>pages</code> directory, you could run one command to generate a Vue.js web app in which <code>/hello</code> would resolve to that component (like <a href="https://github.com/zeit/next.js/" rel="noopener">Next.js</a>). Since it abstracts away Webpack, it has a great development mode, including hot module reloading and more, out of the box.</p>\n<p>A &quot;Universal Vue.js app&quot; just means that it does some server-side rendering and client-side hydration. So let\'s say you go to a URL. Typically, the server would return a pretty much empty page which loads some JavaScript, which runs your Vue.js code, which hits an API, then renders a table and adds an event listener so that clicking on a table header would sort the table. A &quot;universal Vue.js app&quot; would instead run your Vue.js code on the server-side, which would hit the API, render the result, and return the table in the initial response to the browser. So you get the content as soon as possible, whether or not you\'ve JavaScript enabled, whether or not the JavaScript has a fatal error, and so on. Then the JavaScript is loaded and continues from where the server-side rendering left off (i.e. client-side hydration). If you were to click on a table header, it should be ready and sort the table.</p>\n<p>Since it can run and render your Vue.js code on the server-side, it supports static site generation. It\'s so powerful yet all I need to do is run a slightly different command and it\'ll spit out static assets. The Nuxt.js logo is also weirdly similar to my own.</p>\n<h3><a id="content-management" class="post-header-anchor" href="#content-management" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Content management</h3>\n<p>This doesn\'t mean I\'m going to write blog posts in HTML though. You might\'ve noticed this one interesting requirement: &quot;Isn\'t restrictive on where the content comes from (e.g. files, API, DB, etc).&quot; I wanted to explore other sources of content. A headless CMS, for example. Instead of hosting a CMS and having every request to my blog run through, let\'s say, Ghost or Wordpress, I could just use them to manage the content. It would be &quot;headless&quot; in that I\'d only be using the administration panel.  I\'d grab the posts by querying its database (or using its API if it has one). Since the phrase has been coined, purpose-built headless CMSs have popped up which only expose APIs and no frontend UI.</p>\n<p>&quot;<a href="https://jamstack.org/" rel="noopener">JAMstack</a>&quot; has since gained momentum; a &quot;modern web development architecture based on client-side JavaScript, reusable APIs, and prebuilt Markup.&quot; Isn\'t that just static site generation? Well JAMstackers(?) don\'t like the term &quot;static&quot; because the API could return anything really and therefore the site can be pretty dynamic. I\'d prefer to hit the API at compile-time, generate static files, and have less client-side JavaScript. So for my purposes, it is static site generation.</p>\n<p>I\'ve always wanted to play around with <a href="https://www.contentful.com/" rel="noopener">Contentful</a>, a cloud-based headless CMS service. It seems really good, but I ended up choosing a Git-based approach again. Contentful doesn\'t support Markdown for one (EDIT: it does support Markdown, since February 2014 actually. I don\'t know how I missed this). Even though the editor is good, I would have no choice but to use it. I can use whatever I like with Git; a text editor, IDE, <a href="http://classeur.io/" rel="noopener">Classeur</a> (my favourite Markdown editor), etc.</p>\n<p>I get versioning for free, branching, and it works offline (up until actually publishing changes).<br>\nSince my site is hosted on GitHub (still), I can use its UI to not only edit files but add and delete blog posts too. Another thing I love is that everything is open-source so anyone could suggest improvements to a post. I even have a button at the top of the page for this. Right now it just brings you to the <a href="https://github.com/adam-lynch/adam-lynch.github.io/" rel="noopener">source code</a>, but I\'ll make it so it brings you to the actual post\'s source content. It could even have quality checks via continuous integration services.</p>\n<p>Contentful does have built-in responsive image support and search API endpoints though. I\'m definitely going to use it somehow, I\'m just looking for the right excuse.</p>\n<h3><a id="markdown-meet-nuxtjs" class="post-header-anchor" href="#markdown-meet-nuxtjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Markdown, meet Nuxt.js</h3>\n<p>So how do I actually write posts then? Nuxt.js allows you to build modules that tap into the build or generation steps to do custom stuff. A <a href="https://github.com/nuxt-community/blog-module" rel="noopener">blog module</a> already existed. It wasn\'t flexible enough so I took it and modified it to my needs (which we\'ve found ourselves doing with most Vue.js related things at Teamwork). It looks for markdown files in a <code>writing</code> directory, compiles the Markdown, then generates the files, routes, and anything else. The Markdown compiler I\'ve gone with this time is <a href="https://github.com/markdown-it/markdown-it" rel="noopener">markdown-it</a>, plus some (third-party and custom) plugins for some additional capabilities. I might write a post on this someday.</p>\n<p>The only downside really was that an RSS module didn\'t exist so I could match the functionality of my old site. I wrote one but ended up throwing it away when I ran into a tricky last-minute issue.</p>\n<h3><a id="imperfection" class="post-header-anchor" href="#imperfection" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Imperfection</h3>\n<p>I\'m trying to be more open to shipping less than perfect things these days, so I\'ve definitely left room for improvement. Some of the code is the most hacked together I\'ve ever written. Especially the CSS, which is basically all in one <code>shame.scss</code> file. Although this route transition is nice.</p>\n<figure>\n          <a href="/images/blog-content/static-site-regeneration/route-transition.gif"><img src="/images/blog-content/static-site-regeneration/route-transition.gif" alt=""/></a>\n          <figcaption><p>The route <a href="https://nuxtjs.org/api/pages-transition/" rel="noopener">transition</a> when going from the list of posts to an individual one. It involves a bit of positioning logic, automated scrolling, animations, and <a href="https://www.lukew.com/ff/entry.asp?1797" rel="noopener">skeleton</a> text which is shown while the post\'s content is loading.</p>\n</figcaption>\n        </figure><p>One thing that\'s a challenge when going static are comments. You don\'t get built-in comments like you would with a typical CMS. I\'ve used <a href="https://disqus.com/" rel="noopener">Disqus</a> for the time being but I\'m not very happy with it. It\'s way too heavy. Expect a post on switching to an alternative solution or rolling my own. The workflow could be improved as well. I\'d like to automate the asset generation as a continuous deployment step.</p>\n<p>As far as content goes, expect me to publish a post a month, roughly. I\'ll mostly cover development but I might throw in a post every now and again about other stuff as well. There\'ll be short posts, deep detailed dives which I\'ve have edited forty times, as well posts I\'ve written in one go (sometimes they\'re my best). I\'ve so many things I\'ve been meaning to play around with. Now I\'ve an outlet where I can write about them.</p>\n',attributes:{date:"2018-02-04T00:00:00.000Z",tags:[{id:"writing",name:"writing"},{id:"static-site-generation",name:"static-site-generation"},{id:"headless-cms",name:"headless-cms"},{id:"jamstack",name:"jamstack"},{id:"git",name:"git"},{id:"markdown",name:"markdown"},{id:"vuejs",name:"vue.js"},{id:"nuxtjs",name:"nuxt.js"},{id:"javascript",name:"javascript"},{id:"development",name:"development"}],title:"Static site regeneration and focusing on what's important",updated_at:"2019-05-22T08:26:34.147Z",photo:"/images/blog-content/static-site-regeneration/nuxt.png"},title:"Static site regeneration and focusing on what's important",renderedSummary:"<p>I've had my own site for years now but I haven't used it for much. A refresh was needed. I was focusing on the wrong things, trying to do everything, and getting nowhere slowly. It hasn't changed much in appearance, but that's just the tip of the iceberg. It has been completely redone beneath the surface.</p>\n",rendered:'<h2><a id="static-site-regeneration-and-focusing-on-whats-important" class="post-header-anchor" href="#static-site-regeneration-and-focusing-on-whats-important" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Static site regeneration and focusing on what\'s important</h2>\n<p>I\'ve had my own site for years now but I haven\'t used it for much. A refresh was needed. I was focusing on the wrong things, trying to do everything, and getting nowhere slowly. It hasn\'t changed much in appearance, but that\'s just the tip of the iceberg. It has been completely redone beneath the surface.</p>\n<p>The catalyst was writing; I miss it. I fell out of the habit. Maybe I was pre-occupied, I could\'ve been a bit burned out. I haven\'t put pen to paper much since writing <a href="https://www.amazon.co.uk/Developing-Electron-Edge-Lynch-2016-06-17/dp/B01K160MV4" rel="noopener">my book</a>, as well the follow-up <a href="https://adamlynch.com/beyond-the-browser-from-web-apps-to-desktop-apps/" rel="noopener">Smashing Magazine post</a> and talks. Even worse (read: harder to admit), I might\'ve been content. <em>Ugh</em>. Forgive me, they were bucket list items after all.</p>\n<p>I love learning. I\'ve absorbed so much knowledge shared for knowledge sharing\'s sake. The altruism of the Web community in particular is truly amazing. This blog is an attempt at giving back, playing my part.</p>\n<p>It\'ll benefit me as well, of course. Writing forces me to further my understanding of topics, for example. I\'m not ruling out writing for other blogs again, but I also want a blog that\'s <em>mine</em>. I want freedom, I want control. Plus, side projects are heathy right?</p>\n<h3><a id="dont-reinvent-the-wheel-unless-you-plan-on-learning-more-about-wheels" class="post-header-anchor" href="#dont-reinvent-the-wheel-unless-you-plan-on-learning-more-about-wheels" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t reinvent the wheel, unless you plan on learning more about wheels</h3>\n<p>I find static site generators fascinating. The end user experience is optimal because it\'s just static HTML pages, generated in a compile step. It\'s also a cheaper, more security, and the developer experience is generally better.</p>\n<p>I was compelled to write my own static generator using Gulp, Nunjucks templates, Markdown for content, an RSS feed, a pattern library (which is ridiculous looking back now), and more. The output was hosted on GitHub pages (plus CloudFlare HTTPS). This was the last version of my site.</p>\n<p>I wanted to do so much and perfect it all but it never got here. Once I had a proof of concept, everything slowed down and my attention went elsewhere. I didn\'t even get around to properly publishing a blog on the site but I had the proof of concept running locally. Never mind the writing style analyzer, responsive screenshot testing, and other things I had planned to do. I learned that rolling your own static site generator isn\'t as difficult as it sounds. I might write a post on that.</p>\n<p>The following were my (unordered) requirements this time around.</p>\n<h4><a id="must-have" class="post-header-anchor" href="#must-have" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Must have</h4>\n<ul>\n<li>Doesn\'t need client-side JavaScript.</li>\n<li>Crawlable.</li>\n<li>Isn\'t restrictive on where the content comes from (e.g. files, API, DB, etc).</li>\n<li>Flexible (e.g. what if I want to plug sass-lint in?).</li>\n<li>Can be automated (i.e. continuous integration).</li>\n<li>Allows Markdown posts.</li>\n<li>Code can be embedded with CodePen, JSFiddle, etc.</li>\n<li>Allows for custom / non-blog pages.</li>\n<li>Allows for multiple post templates / types.</li>\n<li>Open-source.</li>\n<li>Supports Linux, Mac, and Windows.</li>\n</ul>\n<h4><a id="nice-to-have" class="post-header-anchor" href="#nice-to-have" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Nice to have</h4>\n<ul>\n<li>Simple.</li>\n<li>Gives a head start on SEO.</li>\n<li>Allows you to push the data elsewhere (Medium).</li>\n<li>Uses tools I\'m familiar with and am liking right now.</li>\n<li>Allows posts in other formats along side Markdown posts.</li>\n<li>Makes the client-side experience faster / better (progressive enhancement) and if it does, it\'s lightweight.</li>\n<li>Service worker head start.</li>\n<li>Not opinionated.</li>\n<li>Generates RSS feed.</li>\n<li>Head start on blog stuff.</li>\n<li>Content updates can be suggested by readers.</li>\n<li>Good development experience.</li>\n<li>Head start on comments.</li>\n<li>Head start on analytics.</li>\n<li>Generates sitemap.xml.</li>\n</ul>\n<h4><a id="unimportant" class="post-header-anchor" href="#unimportant" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Unimportant</h4>\n<ul>\n<li>Build speed.</li>\n<li>Popularity.</li>\n<li>Themes.</li>\n</ul>\n<figure>\n          <a href="/images/blog-content/static-site-regeneration/nuxt.png"><img src="/images/blog-content/static-site-regeneration/nuxt.png" alt=""/></a>\n          \n        </figure><h3><a id="winner" class="post-header-anchor" href="#winner" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Winner</h3>\n<p>I won\'t bore you by going into detail on each option I considered. <a href="https://nuxtjs.org/" rel="noopener">Nuxt.js</a> won in the end. It\'s a minimal framework for creating &quot;universal Vue.js apps,&quot; but hmm what does that mean?</p>\n<p>Well first there\'s <a href="https://vuejs.org/" rel="noopener">Vue.js</a>, a modern JavaScript framework with Virtual DOM diffing, first-class Flux state management, and fantastic documentation. It\'s our frontend framework of choice at <a href="https://www.teamwork.com/" rel="noopener">Teamwork</a>. But wait, that sounds like way too much for a blog. It doesn\'t need to be a web app, never mind a &quot;universal Vue.js app.&quot; Trust me, it gets better.</p>\n<p>Next, there\'s Nuxt.js. It\'s a minimal (opinionated) framework which abstracts away Vue.js and Webpack for you. You don\'t need to set up routing or anything like that (although you can if you\'d like). If you were to create a <code>hello</code> component inside the <code>pages</code> directory, you could run one command to generate a Vue.js web app in which <code>/hello</code> would resolve to that component (like <a href="https://github.com/zeit/next.js/" rel="noopener">Next.js</a>). Since it abstracts away Webpack, it has a great development mode, including hot module reloading and more, out of the box.</p>\n<p>A &quot;Universal Vue.js app&quot; just means that it does some server-side rendering and client-side hydration. So let\'s say you go to a URL. Typically, the server would return a pretty much empty page which loads some JavaScript, which runs your Vue.js code, which hits an API, then renders a table and adds an event listener so that clicking on a table header would sort the table. A &quot;universal Vue.js app&quot; would instead run your Vue.js code on the server-side, which would hit the API, render the result, and return the table in the initial response to the browser. So you get the content as soon as possible, whether or not you\'ve JavaScript enabled, whether or not the JavaScript has a fatal error, and so on. Then the JavaScript is loaded and continues from where the server-side rendering left off (i.e. client-side hydration). If you were to click on a table header, it should be ready and sort the table.</p>\n<p>Since it can run and render your Vue.js code on the server-side, it supports static site generation. It\'s so powerful yet all I need to do is run a slightly different command and it\'ll spit out static assets. The Nuxt.js logo is also weirdly similar to my own.</p>\n<h3><a id="content-management" class="post-header-anchor" href="#content-management" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Content management</h3>\n<p>This doesn\'t mean I\'m going to write blog posts in HTML though. You might\'ve noticed this one interesting requirement: &quot;Isn\'t restrictive on where the content comes from (e.g. files, API, DB, etc).&quot; I wanted to explore other sources of content. A headless CMS, for example. Instead of hosting a CMS and having every request to my blog run through, let\'s say, Ghost or Wordpress, I could just use them to manage the content. It would be &quot;headless&quot; in that I\'d only be using the administration panel.  I\'d grab the posts by querying its database (or using its API if it has one). Since the phrase has been coined, purpose-built headless CMSs have popped up which only expose APIs and no frontend UI.</p>\n<p>&quot;<a href="https://jamstack.org/" rel="noopener">JAMstack</a>&quot; has since gained momentum; a &quot;modern web development architecture based on client-side JavaScript, reusable APIs, and prebuilt Markup.&quot; Isn\'t that just static site generation? Well JAMstackers(?) don\'t like the term &quot;static&quot; because the API could return anything really and therefore the site can be pretty dynamic. I\'d prefer to hit the API at compile-time, generate static files, and have less client-side JavaScript. So for my purposes, it is static site generation.</p>\n<p>I\'ve always wanted to play around with <a href="https://www.contentful.com/" rel="noopener">Contentful</a>, a cloud-based headless CMS service. It seems really good, but I ended up choosing a Git-based approach again. Contentful doesn\'t support Markdown for one (EDIT: it does support Markdown, since February 2014 actually. I don\'t know how I missed this). Even though the editor is good, I would have no choice but to use it. I can use whatever I like with Git; a text editor, IDE, <a href="http://classeur.io/" rel="noopener">Classeur</a> (my favourite Markdown editor), etc.</p>\n<p>I get versioning for free, branching, and it works offline (up until actually publishing changes).<br>\nSince my site is hosted on GitHub (still), I can use its UI to not only edit files but add and delete blog posts too. Another thing I love is that everything is open-source so anyone could suggest improvements to a post. I even have a button at the top of the page for this. Right now it just brings you to the <a href="https://github.com/adam-lynch/adam-lynch.github.io/" rel="noopener">source code</a>, but I\'ll make it so it brings you to the actual post\'s source content. It could even have quality checks via continuous integration services.</p>\n<p>Contentful does have built-in responsive image support and search API endpoints though. I\'m definitely going to use it somehow, I\'m just looking for the right excuse.</p>\n<h3><a id="markdown-meet-nuxtjs" class="post-header-anchor" href="#markdown-meet-nuxtjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Markdown, meet Nuxt.js</h3>\n<p>So how do I actually write posts then? Nuxt.js allows you to build modules that tap into the build or generation steps to do custom stuff. A <a href="https://github.com/nuxt-community/blog-module" rel="noopener">blog module</a> already existed. It wasn\'t flexible enough so I took it and modified it to my needs (which we\'ve found ourselves doing with most Vue.js related things at Teamwork). It looks for markdown files in a <code>writing</code> directory, compiles the Markdown, then generates the files, routes, and anything else. The Markdown compiler I\'ve gone with this time is <a href="https://github.com/markdown-it/markdown-it" rel="noopener">markdown-it</a>, plus some (third-party and custom) plugins for some additional capabilities. I might write a post on this someday.</p>\n<p>The only downside really was that an RSS module didn\'t exist so I could match the functionality of my old site. I wrote one but ended up throwing it away when I ran into a tricky last-minute issue.</p>\n<h3><a id="imperfection" class="post-header-anchor" href="#imperfection" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Imperfection</h3>\n<p>I\'m trying to be more open to shipping less than perfect things these days, so I\'ve definitely left room for improvement. Some of the code is the most hacked together I\'ve ever written. Especially the CSS, which is basically all in one <code>shame.scss</code> file. Although this route transition is nice.</p>\n<figure>\n          <a href="/images/blog-content/static-site-regeneration/route-transition.gif"><img src="/images/blog-content/static-site-regeneration/route-transition.gif" alt=""/></a>\n          <figcaption><p>The route <a href="https://nuxtjs.org/api/pages-transition/" rel="noopener">transition</a> when going from the list of posts to an individual one. It involves a bit of positioning logic, automated scrolling, animations, and <a href="https://www.lukew.com/ff/entry.asp?1797" rel="noopener">skeleton</a> text which is shown while the post\'s content is loading.</p>\n</figcaption>\n        </figure><p>One thing that\'s a challenge when going static are comments. You don\'t get built-in comments like you would with a typical CMS. I\'ve used <a href="https://disqus.com/" rel="noopener">Disqus</a> for the time being but I\'m not very happy with it. It\'s way too heavy. Expect a post on switching to an alternative solution or rolling my own. The workflow could be improved as well. I\'d like to automate the asset generation as a continuous deployment step.</p>\n<p>As far as content goes, expect me to publish a post a month, roughly. I\'ll mostly cover development but I might throw in a post every now and again about other stuff as well. There\'ll be short posts, deep detailed dives which I\'ve have edited forty times, as well posts I\'ve written in one go (sometimes they\'re my best). I\'ve so many things I\'ve been meaning to play around with. Now I\'ve an outlet where I can write about them.</p>\n',summary:"I've had my own site for years now but I haven't used it for much. A refresh was needed. I was focusing on the wrong things, trying to do everything, and getting nowhere slowly. It hasn't changed much in appearance, but that's just the tip of the iceberg. It has been completely redone beneath the surface.\n",photo:"/images/blog-content/static-site-regeneration/nuxt.png",keywords:["writing","static-site-generation","headless-cms","jamstack","git","markdown","vue.js","nuxt.js","javascript","development"],published_at:"2018-02-04T00:00:00.000Z",updated_at:"2019-05-22T08:26:34.147Z",year:2018,month:2,day:5,relevanceScore:1.375},{id:"beyond-the-browser-from-web-apps-to-desktop-apps",slug:"beyond-the-browser-from-web-apps-to-desktop-apps",highlightedLanguages:["javascript","markup"],source:'---\ndate: 2017-03-21\noriginal:\n  blogLink: https://www.smashingmagazine.com/\n  blogName: Smashing Magazine\n  url: https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/\ntags:\n  - node-webkit\n  - electron\n  - desktop\n  - javascript\n  - development\n---\n\n## Beyond The Browser: From Web Apps To Desktop Apps\n\n:::summary\n\nI started out as a web developer, and that’s now one part of what I do as a full-stack developer, but never had I imagined I’d create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least… different.\n\n:::\n\nIt’s not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?\n\nOK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.\n\nIn this article, we’ll look at the development of desktop applications using [NW.js](http://nwjs.io/) and [Electron](http://electron.atom.io/), the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.\n\n### Why?\n\nFirst of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user’s system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.\n\nMaybe you’ve an idea that would only work as a desktop app; some things simply aren’t possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you’ve an idea for the Mac App Store. Maybe it would simply be a fun side project.\n\nIt’s hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you’d like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a [chat application](https://teamwork.com/chat). On the other hand, a connection-dependent desktop app that doesn’t really have any desktop integration should be a web app and a web app alone. It wouldn’t be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn’t get any more value from it than from visiting a URL of yours in their favorite browser.\n\nInstead of describing the desktop app you personally should build and why, I’m hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.\n\n### NW.js\n\nDesktop applications have been around a long time but you don’t have all day, so let’s skip some history and begin in Shanghai, 2011. Roger Wang, of Intel’s Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within `<script>` tags.\n\nAfter some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.\n\n*Note*: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.\n\nSo, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn’t know any better. That’s pretty powerful, but how does it work? Well, first let’s take a look at Chromium.\n\n\n:::figure beyond-the-browser/chromiumDiagram.png A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)\n:::\n\nThere is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).\n\n:::figure beyond-the-browser/nwjsDiagram.png A rough diagram of an NW.js app\'s internals.\n:::\n\nThis is roughly what an NW.js app looks like. It’s basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you’ve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.\n\nCreating an app is really easy. All you need is an HTML file and a `package.json`, like you would have when working with Node.js. You can create a default one by running `npm init --yes`. Typically, a `package.json` would point a JavaScript file as the “main” file for the module (i.e. using the `main` property), but with NW.js you need to edit the `main` property to point to your HTML file.\n\n```javascript\n{\n  "name": "example-app",\n  "version": "1.0.0",\n  "description": "",\n  "main": "index.html",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC"\n}\n```\n\n```markup\n\x3c!-- index.html --\x3e\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Example app</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body>\n    <h1>Hello, world!</h1>\n  </body>\n</html>\n```\n\nOnce you install the official `nw` package from npm (by running `npm install -g nw`), you can run `nw .` within the project directory to launch your app.\n\n:::figure beyond-the-browser/nwjsHelloWorld.png A screenshot of our example NW.js app.\n:::\n\nIt’s as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn’t look like much, but it’s up to you add some markup and styles, just like you would in a web app.\n\nYou could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and [resurrected Clippy](http://adamlynch.com/resurrecting-clippy/) using NW.js. There’s something weirdly satisfying about seeing Clippy on macOS or Windows 10.\n\n:::figure beyond-the-browser/clippy.png A screenshot of clippy.desktop on macOS.\n:::\n\nSo, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.\n\n:::figure beyond-the-browser/moduleCounts.png Bar graph showing the number of modules per major package manager. (Source: [Module Counts](http://modulecounts.com))\n:::\n\nYou get access not only to Node.js’ APIs but to all of npm, which has over 350,000 modules now. For example, [auto-launch](https://github.com/Teamwork/node-auto-launch) is an open-source module we created at [Teamwork.com](https://www.teamwork.com/) to launch an NW.js or Electron app on startup.\n\nNode.js also has what’s known as “native modules,” which, if you really need to do something a bit lower level, allows you to create modules in C or C++.\n\nTo top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:\n\n```javascript\nnew Notification(\'Hello\', {\n  body: \'world\'\n});\n```\n\n### Electron\n\nYou might recognize GitHub’s text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.\n\n:::figure beyond-the-browser/atom.png A screenshot of Atom, GitHub\'s text editor.\n:::\n\n*Note*: It’s disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it’s effectively a fork for the end user because the APIs were almost identical.\n\nIn making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.\n\n:::figure beyond-the-browser/logos.png Logos of projects that use Electron.\n:::\n\nAs well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.\n\n### How Does It Differ?\n\nBut how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.\n\n:::figure beyond-the-browser/electronDiagram.png A rough diagram of an Electron app\'s internals.\n:::\n\nThe Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don’t have to do anything.\n\n_Note_: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn’t quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.\n\nBack to the main process. Your app hasn’t any window by default, but you can open as many windows as you’d like from the main process, each having its own renderer process, just like NW.js.\n\nSo, yeah, the minimum you need for an Electron app is a main JavaScript file (which we’ll leave empty for now) and a `package.json` that points to it. Then, all you need to do is `npm install --save-dev electron` and run `electron .` to launch your app.\n\n```javascript\n{\n  "name": "example-app",\n  "version": "1.0.0",\n  "description": "",\n  "main": "main.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC"\n}\n```\n\n```javascript\n// main.js, which is empty\n```\n\nNot much will happen, though, because your app hasn’t any window by default. You can open as many windows as you’d like from the main process, each having its own renderer process, just like they’d have in an NW.js app.\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet mainWindow;\n\napp.on(\'ready\', () => {\n  mainWindow = new BrowserWindow({\n    width: 500,\n    height: 400\n  });\n  mainWindow.loadURL(\'file://\' + __dirname + \'/index.html\');\n});\n```\n\n```markup\n\x3c!-- index.html --\x3e\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Example app</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body>\n    <h1>Hello, world!</h1>\n  </body>\n</html>\n```\n\nYou could load a remote URL in this window, but typically you’d create a local HTML file and load that. Ta-da!\n\n:::figure beyond-the-browser/electronHelloWorld.png A screenshot of our example Electron app.\n:::\n\nOf the built-in modules Electron provides, like the `app` or `BrowserWindow` module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you’d catch the `click` event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.\n\nOK, so Electron has distinct processes, and you have to organize your app slightly differently, but that’s not a big deal. Why are people using Electron instead of NW.js? Well, there’s mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.\n\nElectron’s documentation really is amazing, though — that’s worth emphasizing. Take the [Electron API Demos app](https://github.com/electron/electron-api-demos). It’s an Electron app that interactively demonstrates what you can do with Electron’s APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.\n\n:::figure beyond-the-browser/apiDemosApp.png A screenshot of the Electron API Demos app.\n:::\n\nIf you submit an issue via Electron’s bug tracker, you’ll get a response within a couple of days. I’ve seen three-year-old NW.js bugs, although I don’t hold it against them. It’s tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I’m extremely grateful for what NW.js has given us.\n\nElectron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn’t focused. An example API flaw I ran into was that binding to `Control + Shift + A` in an NW.js app did what you would expect on Windows, but actually bound to `Command + Shift + A` on a Mac. This was intentional but really weird. There was no way to bind to the `Control` key. Also, binding to the `Command` key did bind to the `Command` key but the `Windows` key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you’d expect. To be fair, NW.js has since fixed the former but not the latter.\n\nThere are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don’t go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you’d like. If you want to do something interesting with audio or video, use Electron, because some codecs don’t work out of the box with NW.js.\n\nElectron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I’ll cover that later.\n\n### But How Does It Feel?\n\nIt feels fine. Sure, it’s not native. Most desktop apps these days don’t look like Windows Explorer or Finder anyway, so users won’t mind or realize that HTML is behind your user interface. You can make it feel more native if you’d like, but I’m not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That’s how a native desktop app would act, but is that better? There are also projects out there like [Photon Kit](http://photonkit.com/), which is basically a CSS framework like Bootstrap, but for macOS-style components.\n\n:::figure beyond-the-browser/photon.png A screenshot of an example Electron app made with Photon.\n:::\n\n### Performance\n\nWhat about performance? Is it slow or laggy? Well, your app is essentially a web app. It’ll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that’s fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named [Devtron](http://electron.atom.io/devtron/) to monitor some Electron-specific stuff.\n\nYour desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it’s an isolated process, any computation or processing going on in that window won’t affect rendering, scrolling or anything else in your visible window(s).\n\nKeep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won’t).\n\n### Distribution\n\nBoth NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn’t support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you’ll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don’t have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).\n\nElectron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be [phasing out Chrome Packaged Apps](http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html), but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.\n\nEven though 32-bit and 64-bit builds are supported, you’ll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.\n\nSo, let’s say that Electron has won over and you want to ship an Electron app. There’s a nice Node.js module named [electron-packager](https://github.com/electron-userland/electron-packager) that helps with packing your app up into an `.app` or `.exe` file. A few similar projects exist, including interactive ones that prompt you step by step. You should use [electron-builder](https://github.com/electron-userland/electron-builder), though, which builds on top of electron-packager, plus a few other related modules. It generates `.dmg`s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.\n\nThe annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you’re serious about shipping desktop apps, then you’ll need to build on multiple machines for each release.\n\nThis can feel a bit too manual or tedious, especially if you’re used to creating for the web. Thankfully, electron-builder was created with automation in mind. I’m talking here about continuous integration tools and services such as [Jenkins](https://jenkins.io/), [CodeShip](http://codeship.com/), [Travis-CI](https://travis-ci.org/), [AppVeyor](https://www.appveyor.com/) (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.\n\n### Automatic Updates\n\nNW.js doesn’t have automatic update support, but you’ll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as [node-webkit-updater](https://github.com/edjafarov/node-webkit-updater), which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.\n\nElectron has built-in support for automatic updates, via its [autoUpdater](http://electron.atom.io/docs/api/auto-updater/) API. It doesn’t support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux — don’t worry. The `autoUpdater` API is really simple; once you give it a URL, you can call the `checkForUpdates` method. It’s event-driven, so you can subscribe to the `update-downloaded` event, for example, and once it’s fired, call the `restartAndInstall` method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.\n\n_Note_: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.\n\nIt’s not quite as simple behind the API. It’s based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the [Squirrel.Mac](https://github.com/Squirrel/Squirrel.Mac) and [Squirrel.Windows](https://github.com/Squirrel/Squirrel.Windows) projects, respectively.\n\nThe update code within your Mac Electron app is simple, but you’ll need a server (albeit a simple server). When you call the autoUpdater module’s `checkForUpdates` method, it will hit your server. What your server needs to do is return a 204 (“No Content”) if there isn’t an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a `.zip` file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It’ll go get that `.zip`, unzip it and fire the appropriate events.\n\nThere a bit more (magic) going on in your Windows app when it comes to automatic updates. You won’t need a server, but you can have one if you’d like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.\n\nSquirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call `restartAndInstall`, it’ll be a bit quicker because it’s ready and waiting. It also supports delta updates. Let’s say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you’re, say, three versions behind, but it will only do that if it’s worth it. Otherwise, if you’re, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it’s ready to go.\n\n_Note_: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.\n\nThanks to the Electron community, you don’t have to build your own server if you don’t want to. There are open-source projects you can use. Some allow you to [store updates on S3](https://github.com/ArekSredzki/electron-release-server) or use [GitHub releases](https://github.com/GitbookIO/nuts), and some even go as far as [providing administrative dashboards](https://github.com/ArekSredzki/electron-release-server) to manage the updates.\n\n### Desktop Versus Web\n\nSo, how does making a desktop app differ from making a web app? Let’s look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you’re used to using on the web, workflow pain points, maintenance woes and more.\n\nWell, the first thing that comes to mind is browser lock-in. It’s like a guilty pleasure. If you’re making a desktop app exclusively, you’ll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You’ll never have to deal with any cross-browser incompatibilities. This is on top of Node.js’ APIs and all of npm. You can do anything.\n\n_Note_: You’ll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.\n\n#### Working With file://\n\nAnother interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You’ll need to pay more attention to how your app behaves if the network connection is lost while it’s running. You may need to adjust your mindset.\n\n_Note_: You can load remote URLs if you really want, but I wouldn’t.\n\nOne tip I can give you here is not to trust [`navigator.onLine`](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine) completely. This property returns a Boolean indicating whether or not there’s a connection, but watch out for false positives. It’ll return `true` if there’s any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus’ [`is-online`](https://github.com/sindresorhus/is-online) module to double-check; it will ping the Internet’s root servers and/or the favicon of a few popular websites. For example:\n\n```javascript\nconst isOnline = require(\'is-online\');\n\nif(navigator.onLine){\n  // hmm there\'s a connection, but is the Internet accessible?\n  isOnline().then(online => {\n    console.log(online); // true or false\n  });\n}\nelse {\n  // we can trust navigator.onLine when it says there is no connection\n  console.log(false);\n}\n```\n\nSpeaking of local files, there are a few things to be aware of when using the `file://` protocol — protocol-less URLs, for one; you can’t use them anymore. I mean URLs that start with `//` instead of `http://` or `https://`. Typically, if a web app requests `//example.com/hello.json`, then your browser would expand this to `http://example.com/hello.json` or to `https://example.com/hello.json` if the current page is loaded over HTTPS. In our app, the current page would load using the `file://` protocol; so, if we requested the same URL, it would expand to `file://example.com/hello.json` and fail. The real worry here is third-party modules you might be using; authors aren’t thinking of desktop apps when they make a library.\n\nYou’d never use a CDN. Loading local files is basically instantaneous. There’s also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.\n\n#### Artifacts Galore\n\nA lot of asset generation is involved in creating a solid desktop app. You’ll need to generate executables and installers and decide on an auto-update system. Then, for each update, you’ll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.\n\nWeight is still a concern. A “Hello, World!” Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn’t much I can offer you. The “Hello, World!” app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I’m afraid). However, your users won’t be downloading your app on a 2G connection (hopefully!).\n\n#### Expect the Unexpected\n\nYou will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let’s say you’ve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (`<select/>`), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you’re in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it’s not often the user would resize the window down to a small enough size.\n\n:::figure beyond-the-browser/dropdownComparison.png Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.\n:::\n\nYou may or may not know it, but on a Mac, every window has a header and a body. When a window isn’t focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it’s being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it’s Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn’t focused, though, they won’t react if you were to hover over them. Hover styles won’t be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that’s it. A second click would be required to actually click the button and close the app.\n\nTo add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It’s a confirmed bug; applying the hover styles on a blurred window body “doesn’t meet platform expectations,” so it will be fixed. Hopefully, I’m saving you some heartbreak here. You could have a situation in which you’ve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it’s not native).\n\nSo, you must use native buttons on a Mac. There’s no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting `window` object’s `frame` property to `false` in your `package.json`).\n\nYou could do the same with an Electron app. This is controlled by setting the `frame` property when creating a window; for example, `new BrowserWindow({width: 800, height: 600, frame: true})`. As the Electron team does, they spotted this issue and added another option as a nice compromise; `titleBarStyle`. Setting this to `hidden` will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet mainWindow;\n\napp.on(\'ready\', () => {\n  mainWindow = new BrowserWindow({\n    width: 500,\n    height: 400,\n    titleBarStyle: \'hidden\'\n  });\n  mainWindow.loadURL(\'file://\' + __dirname + \'/index.html\');\n});\n```\n\nHere’s an app in which I’ve disabled the title bar and given the `html` element a background image:\n\n:::figure beyond-the-browser/hiddenTitleBar.png A screenshot of our example app without the title bar.\n:::\n\nSee “[Frameless Window](http://electron.atom.io/docs/api/frameless-window)” from Electron’s documentation for more.\n\n#### Tooling\n\nWell, you can pretty much use all of the tooling you’d use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn’t want to use electron-builder). [Electron-connect](https://github.com/Quramy/electron-connect) watches your files for changes, and when they occur, it’ll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you’d like. You could run webpack inside your app if you wanted to — I’ve no idea why you would, but the options are endless. Make sure to check out [awesome-electron](https://github.com/sindresorhus/awesome-electron) for more resources.\n\n#### Release Flow\n\nWhat’s it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you’re working on the web app and you deploy a change that breaks something, it’s not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they’re reported or noticed. You can’t do that with desktop apps. You can’t take back updates you push out there. It’s more like a mobile app flow. You build the app, put it out there, and you can’t take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.\n\n#### Quantum Mechanics\n\nBecause a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you’ll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it’s a breaking change or not. A version released a month ago could implode because it has some slightly different code.\n\n#### Fresh Problems to Solve\n\nYou might receive a few strange bug reports — ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system’s environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you’ll have to draw a line. This was something critical to our app, so we couldn’t ignore the error, and we couldn’t fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.\n\nSure, a few web-specific concerns are no longer applicable when you’re working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There’s a 256-character limit on file paths in Windows, for example.\n\nOld versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a `node_modules` directory in your project (for example, `node_modules/a`). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a `node_modules` within that directory (for example, `node_modules/a/node_modules/b`). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like `path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js`.\n\n_Note_: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.\n\nWe had a case in which our app wouldn’t launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app’s code into an [asar archive](http://electron.atom.io/docs/tutorial/application-packaging/), which protects against path length issues but has exceptions and can’t always be used.\n\nWe created a little Gulp plugin named [gulp-path-length](https://github.com/Teamwork/gulp-path-length), which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user’s machine will determine the true length of the path, though. In our case, our installer will install it to `C:\\Users\\<username>\\AppData\\Roaming`. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they’re stored there (on the user’s machine with a long username, to be safe).\n\n```javascript\nvar gulp = require(\'gulp\');\nvar pathLength = require(\'gulp-path-length\');\n\ngulp.task(\'default\', function(){\n    gulp.src(\'./example/**/*\', {read: false})\n        .pipe(pathLength({\n\t        rewrite: {\n\t\t        match: \'./example\',\n\t\t        replacement: \'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'\n\t        }\n        }));\n});\n```\n\n#### Fatal Errors Can Be Really Fatal\n\nBecause all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let’s say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and… crash. So, you’d have to reach out to all of your users and let them know they’ll need to reinstall the app. Trust me, I know. It’s horrible.\n\n#### Analytics and Bug Reports\n\nYou’ll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won’t work (out of the box, at least). You’ll have to find something that doesn’t mind an app that runs on `file://` URLs. If you’re using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you’re using [Sentry](https://sentry.io/welcome/) to track errors, make sure to [set the `release` property when setting up your client](https://docs.sentry.io/clients/javascript/config/#optional-settings), so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you’ll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.\n\nElectron has a [`crashReporter`](http://electron.atom.io/docs/api/crash-reporter/) module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.\n\n#### Security\n\nBe extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.\n\nDon’t trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they’d have the problem, too. We contacted X’s support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn’t have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).\n\nHow can you mitigate this risk? You could try to catch errors, but you’ve no idea what they company X might do in its JavaScript, so you’re better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X’s URL from your `<script>`, you could use [Google Tag Manager](https://www.google.ie/analytics/tag-manager/) or your own API to return either HTML containing the `<script>` tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.\n\nHowever, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven’t solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don’t want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You’re back to the same problem.\n\nAnother solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you’d do this via IPC now. You’d send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.\n\nThis brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We’d be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn’t run:\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet thirdPartyWindow;\n\napp.on(\'ready\', () => {\n  thirdPartyWindow = new BrowserWindow({\n    width: 500,\n    height: 400,\n    webPreferences: {\n      nodeIntegration: false\n    }\n  });\n  thirdPartyWindow.loadURL(\'file://\' + __dirname + \'/third-party-snippets.html\');\n});\n```\n\n#### Automated Testing\n\nNW.js doesn’t have any built-in support for testing. But, again, you have access to Node.js, so it’s technically possible. There is a way to test stuff such as button-clicking within the app using [Chrome Remote Interface](https://github.com/cyrus-and/chrome-remote-interface), but it’s tricky. Even then, you can’t trigger a click on a native window control and test what happens, for example.\n\nThe Electron team has created [Spectron](http://electron.atom.io/spectron/) for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.\n\n```javascript\nvar Application = require(\'spectron\').Application\nvar assert = require(\'assert\')\n\ndescribe(\'application launch\', function () {\n  this.timeout(10000)\n\n  beforeEach(function () {\n    this.app = new Application({\n      path: \'/Applications/MyApp.app/Contents/MacOS/MyApp\'\n    })\n    return this.app.start()\n  })\n\n  afterEach(function () {\n    if (this.app && this.app.isRunning()) {\n      return this.app.stop()\n    }\n  })\n\n  it(\'shows an initial window\', function () {\n    return this.app.client.getWindowCount().then(function (count) {\n      assert.equal(count, 1)\n    })\n  })\n})\n```\n\nBecause your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you’d need to make sure the app can run in a web browser without Node.js.\n\n### Desktop And Web\n\nIt’s not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it’s worth it. I’ll mention a few related topics and tools, which are complicated in their own right, so I’ll keep just touch on them.\n\nFirst of all, forget about “browser lock-in,” native WebSockets, etc. The same goes for ES6\\. You can either revert to writing plain old ES5 JavaScript or use something like [Babel](https://babeljs.io/) to transpile your ES6 into ES5, for web use.\n\nYou also have `require`s throughout your code (for importing other scripts or modules), which a browser won’t understand. Use a module bundler that supports CommonJS (i.e. Node.js-style `require`s), such as [Rollup](http://rollupjs.org), [webpack](https://webpack.github.io) or [Browserify](http://browserify.org). When making a build for the web, a module bundler will run over your code, traverse all of the `require`s and bundle them up into one script for you.\n\nAny code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether `process.version.nwjs` or `process.versions.electron` exists; if it does, then your app is currently running in the desktop environment.\n\nEven then, you’ll be loading a lot of redundant code in the web app. Let’s say you have a `require` guarded behind a check like `if(app.isInDesktop)`, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting `app.isInDesktop`, you could pass `true` or `false` into your app as a flag at buildtime (for example, using the [envify](https://github.com/hughsk/envify) transform for Browserify). This will aide your module bundler of choice when it’s doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether `app.isInDesktop` is `true`. So, if you’re running your web build, it won’t bother going inside that `if` statement or traversing the `require` in question.\n\n#### Continuous Delivery\n\nThere’s that release mindset again; it’s challenging. When you’re working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.\n\nAs we covered earlier, you can’t really do this with a desktop app. OK, I guess you technically could if you’re using Electron, because electron-builder can be automated and, so, can spectron tests. I don’t know anyone doing this, and I wouldn’t have enough faith to do it myself. Remember, broken code can’t be taken back, and you could break the update flow. Besides, you don’t want to deliver desktop updates too often anyway. Updates aren’t silent, like they are on the web, so it’s not very nice for the user. Plus, for users on macOS, delta updates aren’t supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.\n\nYou’ll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly — unless you’re releasing a feature, that is. You don’t want to punish a user because they chose to install your desktop app. Nothing’s worse than seeing a press release for a really cool feature in an app you use, only to realize that you’ll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that’s a whole separate topic. I first learned of feature flags from “[Continuous Delivery: The Dirty Details](https://www.youtube.com/watch?v=JR-ccCTmMKY),” a talk by Etsy’s VP of Engineering, Mike Brittain.\n\n### Conclusion\n\nSo, there you have it. With minimal effort, you can add “desktop app developer” to your resumé. We’ve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I’ve shared, you’ll agree that it’s not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.\n\n#### Further Reading\n\n*   “[Resurrecting Clippy](http://engineroom.teamwork.com/resurrecting-clippy/),” Adam Lynch (me)\n    How I built clippy.desktop with NW.js.\n*   “[Essential Electron](http://jlord.us/essential-electron/),” Jessica Lord\n    A plain-speak introduction to Electron and its core concepts.\n*   [Electron Documentation](http://electron.atom.io/docs/)\n    Want to dig into the details? Get it straight from the source.\n*   “[Electron Community](http://electron.atom.io/community/)”\n    A curated list of Electron-related tools, videos and more.\n*   “[Serverless Crash Reporting for Electron Apps](https://adamlynch.com/serverless-crash-reports-for-electron-apps/),” Adam Lynch (me)\n    My experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.\n*   [electron-builder](https://github.com/electron-userland/electron-builder), Stefan Judis\n    The complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.\n*   “[autoUpdater](http://electron.atom.io/docs/api/auto-updater/),” Electron Documentation\n    See just how simple Electron’s automatic-update API is.\n',unfilteredRenderedBody:'<h2><a id="beyond-the-browser-from-web-apps-to-desktop-apps" class="post-header-anchor" href="#beyond-the-browser-from-web-apps-to-desktop-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Beyond The Browser: From Web Apps To Desktop Apps</h2>\n<article-summary><p>I started out as a web developer, and that’s now one part of what I do as a full-stack developer, but never had I imagined I’d create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least… different.</p>\n</article-summary><p>It’s not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?</p>\n<p>OK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.</p>\n<p>In this article, we’ll look at the development of desktop applications using <a href="http://nwjs.io/" rel="noopener">NW.js</a> and <a href="http://electron.atom.io/" rel="noopener">Electron</a>, the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.</p>\n<h3><a id="why" class="post-header-anchor" href="#why" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why?</h3>\n<p>First of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user’s system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.</p>\n<p>Maybe you’ve an idea that would only work as a desktop app; some things simply aren’t possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you’ve an idea for the Mac App Store. Maybe it would simply be a fun side project.</p>\n<p>It’s hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you’d like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a <a href="https://teamwork.com/chat" rel="noopener">chat application</a>. On the other hand, a connection-dependent desktop app that doesn’t really have any desktop integration should be a web app and a web app alone. It wouldn’t be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn’t get any more value from it than from visiting a URL of yours in their favorite browser.</p>\n<p>Instead of describing the desktop app you personally should build and why, I’m hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.</p>\n<h3><a id="nwjs" class="post-header-anchor" href="#nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>NW.js</h3>\n<p>Desktop applications have been around a long time but you don’t have all day, so let’s skip some history and begin in Shanghai, 2011. Roger Wang, of Intel’s Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within <code>&lt;script&gt;</code> tags.</p>\n<p>After some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.</p>\n<p><em>Note</em>: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.</p>\n<p>So, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn’t know any better. That’s pretty powerful, but how does it work? Well, first let’s take a look at Chromium.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/chromiumDiagram.png"><img src="/images/blog-content/beyond-the-browser/chromiumDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)</p>\n</figcaption>\n        </figure><p>There is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsDiagram.png"><img src="/images/blog-content/beyond-the-browser/nwjsDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an NW.js app\'s internals.</p>\n</figcaption>\n        </figure><p>This is roughly what an NW.js app looks like. It’s basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you’ve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.</p>\n<p>Creating an app is really easy. All you need is an HTML file and a <code>package.json</code>, like you would have when working with Node.js. You can create a default one by running <code>npm init --yes</code>. Typically, a <code>package.json</code> would point a JavaScript file as the “main” file for the module (i.e. using the <code>main</code> property), but with NW.js you need to edit the <code>main</code> property to point to your HTML file.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>Once you install the official <code>nw</code> package from npm (by running <code>npm install -g nw</code>), you can run <code>nw .</code> within the project directory to launch your app.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example NW.js app.</p>\n</figcaption>\n        </figure><p>It’s as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn’t look like much, but it’s up to you add some markup and styles, just like you would in a web app.</p>\n<p>You could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and <a href="http://adamlynch.com/resurrecting-clippy/" rel="noopener">resurrected Clippy</a> using NW.js. There’s something weirdly satisfying about seeing Clippy on macOS or Windows 10.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/clippy.png"><img src="/images/blog-content/beyond-the-browser/clippy.png" alt=""/></a>\n          <figcaption><p>A screenshot of clippy.desktop on macOS.</p>\n</figcaption>\n        </figure><p>So, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/moduleCounts.png"><img src="/images/blog-content/beyond-the-browser/moduleCounts.png" alt=""/></a>\n          <figcaption><p>Bar graph showing the number of modules per major package manager. (Source: <a href="http://modulecounts.com" rel="noopener">Module Counts</a>)</p>\n</figcaption>\n        </figure><p>You get access not only to Node.js’ APIs but to all of npm, which has over 350,000 modules now. For example, <a href="https://github.com/Teamwork/node-auto-launch" rel="noopener">auto-launch</a> is an open-source module we created at <a href="https://www.teamwork.com/" rel="noopener">Teamwork.com</a> to launch an NW.js or Electron app on startup.</p>\n<p>Node.js also has what’s known as “native modules,” which, if you really need to do something a bit lower level, allows you to create modules in C or C++.</p>\n<p>To top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  body<span class="token punctuation">:</span> <span class="token string">\'world\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h3><a id="electron" class="post-header-anchor" href="#electron" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Electron</h3>\n<p>You might recognize GitHub’s text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/atom.png"><img src="/images/blog-content/beyond-the-browser/atom.png" alt=""/></a>\n          <figcaption><p>A screenshot of Atom, GitHub\'s text editor.</p>\n</figcaption>\n        </figure><p><em>Note</em>: It’s disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it’s effectively a fork for the end user because the APIs were almost identical.</p>\n<p>In making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/logos.png"><img src="/images/blog-content/beyond-the-browser/logos.png" alt=""/></a>\n          <figcaption><p>Logos of projects that use Electron.</p>\n</figcaption>\n        </figure><p>As well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.</p>\n<h3><a id="how-does-it-differ" class="post-header-anchor" href="#how-does-it-differ" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How Does It Differ?</h3>\n<p>But how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronDiagram.png"><img src="/images/blog-content/beyond-the-browser/electronDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an Electron app\'s internals.</p>\n</figcaption>\n        </figure><p>The Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don’t have to do anything.</p>\n<p><em>Note</em>: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn’t quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.</p>\n<p>Back to the main process. Your app hasn’t any window by default, but you can open as many windows as you’d like from the main process, each having its own renderer process, just like NW.js.</p>\n<p>So, yeah, the minimum you need for an Electron app is a main JavaScript file (which we’ll leave empty for now) and a <code>package.json</code> that points to it. Then, all you need to do is <code>npm install --save-dev electron</code> and run <code>electron .</code> to launch your app.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-javascript"><span class="token comment">// main.js, which is empty</span>\n</code></pre>\n<p>Not much will happen, though, because your app hasn’t any window by default. You can open as many windows as you’d like from the main process, each having its own renderer process, just like they’d have in an NW.js app.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>You could load a remote URL in this window, but typically you’d create a local HTML file and load that. Ta-da!</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/electronHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example Electron app.</p>\n</figcaption>\n        </figure><p>Of the built-in modules Electron provides, like the <code>app</code> or <code>BrowserWindow</code> module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you’d catch the <code>click</code> event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.</p>\n<p>OK, so Electron has distinct processes, and you have to organize your app slightly differently, but that’s not a big deal. Why are people using Electron instead of NW.js? Well, there’s mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.</p>\n<p>Electron’s documentation really is amazing, though — that’s worth emphasizing. Take the <a href="https://github.com/electron/electron-api-demos" rel="noopener">Electron API Demos app</a>. It’s an Electron app that interactively demonstrates what you can do with Electron’s APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/apiDemosApp.png"><img src="/images/blog-content/beyond-the-browser/apiDemosApp.png" alt=""/></a>\n          <figcaption><p>A screenshot of the Electron API Demos app.</p>\n</figcaption>\n        </figure><p>If you submit an issue via Electron’s bug tracker, you’ll get a response within a couple of days. I’ve seen three-year-old NW.js bugs, although I don’t hold it against them. It’s tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I’m extremely grateful for what NW.js has given us.</p>\n<p>Electron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn’t focused. An example API flaw I ran into was that binding to <code>Control + Shift + A</code> in an NW.js app did what you would expect on Windows, but actually bound to <code>Command + Shift + A</code> on a Mac. This was intentional but really weird. There was no way to bind to the <code>Control</code> key. Also, binding to the <code>Command</code> key did bind to the <code>Command</code> key but the <code>Windows</code> key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you’d expect. To be fair, NW.js has since fixed the former but not the latter.</p>\n<p>There are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don’t go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you’d like. If you want to do something interesting with audio or video, use Electron, because some codecs don’t work out of the box with NW.js.</p>\n<p>Electron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I’ll cover that later.</p>\n<h3><a id="but-how-does-it-feel" class="post-header-anchor" href="#but-how-does-it-feel" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>But How Does It Feel?</h3>\n<p>It feels fine. Sure, it’s not native. Most desktop apps these days don’t look like Windows Explorer or Finder anyway, so users won’t mind or realize that HTML is behind your user interface. You can make it feel more native if you’d like, but I’m not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That’s how a native desktop app would act, but is that better? There are also projects out there like <a href="http://photonkit.com/" rel="noopener">Photon Kit</a>, which is basically a CSS framework like Bootstrap, but for macOS-style components.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/photon.png"><img src="/images/blog-content/beyond-the-browser/photon.png" alt=""/></a>\n          <figcaption><p>A screenshot of an example Electron app made with Photon.</p>\n</figcaption>\n        </figure><h3><a id="performance" class="post-header-anchor" href="#performance" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Performance</h3>\n<p>What about performance? Is it slow or laggy? Well, your app is essentially a web app. It’ll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that’s fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named <a href="http://electron.atom.io/devtron/" rel="noopener">Devtron</a> to monitor some Electron-specific stuff.</p>\n<p>Your desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it’s an isolated process, any computation or processing going on in that window won’t affect rendering, scrolling or anything else in your visible window(s).</p>\n<p>Keep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won’t).</p>\n<h3><a id="distribution" class="post-header-anchor" href="#distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distribution</h3>\n<p>Both NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn’t support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you’ll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don’t have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).</p>\n<p>Electron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be <a href="http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html" rel="noopener">phasing out Chrome Packaged Apps</a>, but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.</p>\n<p>Even though 32-bit and 64-bit builds are supported, you’ll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.</p>\n<p>So, let’s say that Electron has won over and you want to ship an Electron app. There’s a nice Node.js module named <a href="https://github.com/electron-userland/electron-packager" rel="noopener">electron-packager</a> that helps with packing your app up into an <code>.app</code> or <code>.exe</code> file. A few similar projects exist, including interactive ones that prompt you step by step. You should use <a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, though, which builds on top of electron-packager, plus a few other related modules. It generates <code>.dmg</code>s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.</p>\n<p>The annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you’re serious about shipping desktop apps, then you’ll need to build on multiple machines for each release.</p>\n<p>This can feel a bit too manual or tedious, especially if you’re used to creating for the web. Thankfully, electron-builder was created with automation in mind. I’m talking here about continuous integration tools and services such as <a href="https://jenkins.io/" rel="noopener">Jenkins</a>, <a href="http://codeship.com/" rel="noopener">CodeShip</a>, <a href="https://travis-ci.org/" rel="noopener">Travis-CI</a>, <a href="https://www.appveyor.com/" rel="noopener">AppVeyor</a> (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.</p>\n<h3><a id="automatic-updates" class="post-header-anchor" href="#automatic-updates" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automatic Updates</h3>\n<p>NW.js doesn’t have automatic update support, but you’ll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as <a href="https://github.com/edjafarov/node-webkit-updater" rel="noopener">node-webkit-updater</a>, which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.</p>\n<p>Electron has built-in support for automatic updates, via its <a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a> API. It doesn’t support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux — don’t worry. The <code>autoUpdater</code> API is really simple; once you give it a URL, you can call the <code>checkForUpdates</code> method. It’s event-driven, so you can subscribe to the <code>update-downloaded</code> event, for example, and once it’s fired, call the <code>restartAndInstall</code> method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.</p>\n<p><em>Note</em>: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.</p>\n<p>It’s not quite as simple behind the API. It’s based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the <a href="https://github.com/Squirrel/Squirrel.Mac" rel="noopener">Squirrel.Mac</a> and <a href="https://github.com/Squirrel/Squirrel.Windows" rel="noopener">Squirrel.Windows</a> projects, respectively.</p>\n<p>The update code within your Mac Electron app is simple, but you’ll need a server (albeit a simple server). When you call the autoUpdater module’s <code>checkForUpdates</code> method, it will hit your server. What your server needs to do is return a 204 (“No Content”) if there isn’t an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a <code>.zip</code> file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It’ll go get that <code>.zip</code>, unzip it and fire the appropriate events.</p>\n<p>There a bit more (magic) going on in your Windows app when it comes to automatic updates. You won’t need a server, but you can have one if you’d like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.</p>\n<p>Squirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call <code>restartAndInstall</code>, it’ll be a bit quicker because it’s ready and waiting. It also supports delta updates. Let’s say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you’re, say, three versions behind, but it will only do that if it’s worth it. Otherwise, if you’re, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it’s ready to go.</p>\n<p><em>Note</em>: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.</p>\n<p>Thanks to the Electron community, you don’t have to build your own server if you don’t want to. There are open-source projects you can use. Some allow you to <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">store updates on S3</a> or use <a href="https://github.com/GitbookIO/nuts" rel="noopener">GitHub releases</a>, and some even go as far as <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">providing administrative dashboards</a> to manage the updates.</p>\n<h3><a id="desktop-versus-web" class="post-header-anchor" href="#desktop-versus-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop Versus Web</h3>\n<p>So, how does making a desktop app differ from making a web app? Let’s look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you’re used to using on the web, workflow pain points, maintenance woes and more.</p>\n<p>Well, the first thing that comes to mind is browser lock-in. It’s like a guilty pleasure. If you’re making a desktop app exclusively, you’ll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You’ll never have to deal with any cross-browser incompatibilities. This is on top of Node.js’ APIs and all of npm. You can do anything.</p>\n<p><em>Note</em>: You’ll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.</p>\n<h4><a id="working-with-file" class="post-header-anchor" href="#working-with-file" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Working With file://</h4>\n<p>Another interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You’ll need to pay more attention to how your app behaves if the network connection is lost while it’s running. You may need to adjust your mindset.</p>\n<p><em>Note</em>: You can load remote URLs if you really want, but I wouldn’t.</p>\n<p>One tip I can give you here is not to trust <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine" rel="noopener"><code>navigator.onLine</code></a> completely. This property returns a Boolean indicating whether or not there’s a connection, but watch out for false positives. It’ll return <code>true</code> if there’s any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus’ <a href="https://github.com/sindresorhus/is-online" rel="noopener"><code>is-online</code></a> module to double-check; it will ping the Internet’s root servers and/or the favicon of a few popular websites. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'is-online\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// hmm there\'s a connection, but is the Internet accessible?</span>\n  <span class="token function">isOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>online <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>online<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true or false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token comment">// we can trust navigator.onLine when it says there is no connection</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Speaking of local files, there are a few things to be aware of when using the <code>file://</code> protocol — protocol-less URLs, for one; you can’t use them anymore. I mean URLs that start with <code>//</code> instead of <code>http://</code> or <code>https://</code>. Typically, if a web app requests <code>//example.com/hello.json</code>, then your browser would expand this to <code>http://example.com/hello.json</code> or to <code>https://example.com/hello.json</code> if the current page is loaded over HTTPS. In our app, the current page would load using the <code>file://</code> protocol; so, if we requested the same URL, it would expand to <code>file://example.com/hello.json</code> and fail. The real worry here is third-party modules you might be using; authors aren’t thinking of desktop apps when they make a library.</p>\n<p>You’d never use a CDN. Loading local files is basically instantaneous. There’s also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.</p>\n<h4><a id="artifacts-galore" class="post-header-anchor" href="#artifacts-galore" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Artifacts Galore</h4>\n<p>A lot of asset generation is involved in creating a solid desktop app. You’ll need to generate executables and installers and decide on an auto-update system. Then, for each update, you’ll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.</p>\n<p>Weight is still a concern. A “Hello, World!” Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn’t much I can offer you. The “Hello, World!” app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I’m afraid). However, your users won’t be downloading your app on a 2G connection (hopefully!).</p>\n<h4><a id="expect-the-unexpected" class="post-header-anchor" href="#expect-the-unexpected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Expect the Unexpected</h4>\n<p>You will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let’s say you’ve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (<code>&lt;select/&gt;</code>), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you’re in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it’s not often the user would resize the window down to a small enough size.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/dropdownComparison.png"><img src="/images/blog-content/beyond-the-browser/dropdownComparison.png" alt=""/></a>\n          <figcaption><p>Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.</p>\n</figcaption>\n        </figure><p>You may or may not know it, but on a Mac, every window has a header and a body. When a window isn’t focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it’s being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it’s Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn’t focused, though, they won’t react if you were to hover over them. Hover styles won’t be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that’s it. A second click would be required to actually click the button and close the app.</p>\n<p>To add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It’s a confirmed bug; applying the hover styles on a blurred window body “doesn’t meet platform expectations,” so it will be fixed. Hopefully, I’m saving you some heartbreak here. You could have a situation in which you’ve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it’s not native).</p>\n<p>So, you must use native buttons on a Mac. There’s no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting <code>window</code> object’s <code>frame</code> property to <code>false</code> in your <code>package.json</code>).</p>\n<p>You could do the same with an Electron app. This is controlled by setting the <code>frame</code> property when creating a window; for example, <code>new BrowserWindow({width: 800, height: 600, frame: true})</code>. As the Electron team does, they spotted this issue and added another option as a nice compromise; <code>titleBarStyle</code>. Setting this to <code>hidden</code> will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    titleBarStyle<span class="token punctuation">:</span> <span class="token string">\'hidden\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Here’s an app in which I’ve disabled the title bar and given the <code>html</code> element a background image:</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/hiddenTitleBar.png"><img src="/images/blog-content/beyond-the-browser/hiddenTitleBar.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example app without the title bar.</p>\n</figcaption>\n        </figure><p>See “<a href="http://electron.atom.io/docs/api/frameless-window" rel="noopener">Frameless Window</a>” from Electron’s documentation for more.</p>\n<h4><a id="tooling" class="post-header-anchor" href="#tooling" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tooling</h4>\n<p>Well, you can pretty much use all of the tooling you’d use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn’t want to use electron-builder). <a href="https://github.com/Quramy/electron-connect" rel="noopener">Electron-connect</a> watches your files for changes, and when they occur, it’ll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you’d like. You could run webpack inside your app if you wanted to — I’ve no idea why you would, but the options are endless. Make sure to check out <a href="https://github.com/sindresorhus/awesome-electron" rel="noopener">awesome-electron</a> for more resources.</p>\n<h4><a id="release-flow" class="post-header-anchor" href="#release-flow" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Release Flow</h4>\n<p>What’s it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you’re working on the web app and you deploy a change that breaks something, it’s not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they’re reported or noticed. You can’t do that with desktop apps. You can’t take back updates you push out there. It’s more like a mobile app flow. You build the app, put it out there, and you can’t take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.</p>\n<h4><a id="quantum-mechanics" class="post-header-anchor" href="#quantum-mechanics" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Quantum Mechanics</h4>\n<p>Because a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you’ll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it’s a breaking change or not. A version released a month ago could implode because it has some slightly different code.</p>\n<h4><a id="fresh-problems-to-solve" class="post-header-anchor" href="#fresh-problems-to-solve" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fresh Problems to Solve</h4>\n<p>You might receive a few strange bug reports — ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system’s environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you’ll have to draw a line. This was something critical to our app, so we couldn’t ignore the error, and we couldn’t fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.</p>\n<p>Sure, a few web-specific concerns are no longer applicable when you’re working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There’s a 256-character limit on file paths in Windows, for example.</p>\n<p>Old versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a <code>node_modules</code> directory in your project (for example, <code>node_modules/a</code>). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a <code>node_modules</code> within that directory (for example, <code>node_modules/a/node_modules/b</code>). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like <code>path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js</code>.</p>\n<p><em>Note</em>: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.</p>\n<p>We had a case in which our app wouldn’t launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app’s code into an <a href="http://electron.atom.io/docs/tutorial/application-packaging/" rel="noopener">asar archive</a>, which protects against path length issues but has exceptions and can’t always be used.</p>\n<p>We created a little Gulp plugin named <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>, which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user’s machine will determine the true length of the path, though. In our case, our installer will install it to <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming</code>. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they’re stored there (on the user’s machine with a long username, to be safe).</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/**/*\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t        rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t        match<span class="token punctuation">:</span> <span class="token string">\'./example\'</span><span class="token punctuation">,</span>\n\t\t        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'</span>\n\t        <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="fatal-errors-can-be-really-fatal" class="post-header-anchor" href="#fatal-errors-can-be-really-fatal" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fatal Errors Can Be Really Fatal</h4>\n<p>Because all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let’s say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and… crash. So, you’d have to reach out to all of your users and let them know they’ll need to reinstall the app. Trust me, I know. It’s horrible.</p>\n<h4><a id="analytics-and-bug-reports" class="post-header-anchor" href="#analytics-and-bug-reports" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Analytics and Bug Reports</h4>\n<p>You’ll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won’t work (out of the box, at least). You’ll have to find something that doesn’t mind an app that runs on <code>file://</code> URLs. If you’re using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you’re using <a href="https://sentry.io/welcome/" rel="noopener">Sentry</a> to track errors, make sure to <a href="https://docs.sentry.io/clients/javascript/config/#optional-settings" rel="noopener">set the <code>release</code> property when setting up your client</a>, so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you’ll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.</p>\n<p>Electron has a <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crashReporter</code></a> module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.</p>\n<h4><a id="security" class="post-header-anchor" href="#security" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Security</h4>\n<p>Be extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.</p>\n<p>Don’t trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they’d have the problem, too. We contacted X’s support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn’t have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).</p>\n<p>How can you mitigate this risk? You could try to catch errors, but you’ve no idea what they company X might do in its JavaScript, so you’re better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X’s URL from your <code>&lt;script&gt;</code>, you could use <a href="https://www.google.ie/analytics/tag-manager/" rel="noopener">Google Tag Manager</a> or your own API to return either HTML containing the <code>&lt;script&gt;</code> tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.</p>\n<p>However, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven’t solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don’t want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You’re back to the same problem.</p>\n<p>Another solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you’d do this via IPC now. You’d send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.</p>\n<p>This brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We’d be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn’t run:</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> thirdPartyWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  thirdPartyWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      nodeIntegration<span class="token punctuation">:</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  thirdPartyWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/third-party-snippets.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="automated-testing" class="post-header-anchor" href="#automated-testing" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automated Testing</h4>\n<p>NW.js doesn’t have any built-in support for testing. But, again, you have access to Node.js, so it’s technically possible. There is a way to test stuff such as button-clicking within the app using <a href="https://github.com/cyrus-and/chrome-remote-interface" rel="noopener">Chrome Remote Interface</a>, but it’s tricky. Even then, you can’t trigger a click on a native window control and test what happens, for example.</p>\n<p>The Electron team has created <a href="http://electron.atom.io/spectron/" rel="noopener">Spectron</a> for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> Application <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'spectron\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Application\n<span class="token keyword">var</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'application launch\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>\n\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      path<span class="token punctuation">:</span> <span class="token string">\'/Applications/MyApp.app/Contents/MacOS/MyApp\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'shows an initial window\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getWindowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Because your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you’d need to make sure the app can run in a web browser without Node.js.</p>\n<h3><a id="desktop-and-web" class="post-header-anchor" href="#desktop-and-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop And Web</h3>\n<p>It’s not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it’s worth it. I’ll mention a few related topics and tools, which are complicated in their own right, so I’ll keep just touch on them.</p>\n<p>First of all, forget about “browser lock-in,” native WebSockets, etc. The same goes for ES6. You can either revert to writing plain old ES5 JavaScript or use something like <a href="https://babeljs.io/" rel="noopener">Babel</a> to transpile your ES6 into ES5, for web use.</p>\n<p>You also have <code>require</code>s throughout your code (for importing other scripts or modules), which a browser won’t understand. Use a module bundler that supports CommonJS (i.e. Node.js-style <code>require</code>s), such as <a href="http://rollupjs.org" rel="noopener">Rollup</a>, <a href="https://webpack.github.io" rel="noopener">webpack</a> or <a href="http://browserify.org" rel="noopener">Browserify</a>. When making a build for the web, a module bundler will run over your code, traverse all of the <code>require</code>s and bundle them up into one script for you.</p>\n<p>Any code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether <code>process.version.nwjs</code> or <code>process.versions.electron</code> exists; if it does, then your app is currently running in the desktop environment.</p>\n<p>Even then, you’ll be loading a lot of redundant code in the web app. Let’s say you have a <code>require</code> guarded behind a check like <code>if(app.isInDesktop)</code>, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting <code>app.isInDesktop</code>, you could pass <code>true</code> or <code>false</code> into your app as a flag at buildtime (for example, using the <a href="https://github.com/hughsk/envify" rel="noopener">envify</a> transform for Browserify). This will aide your module bundler of choice when it’s doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether <code>app.isInDesktop</code> is <code>true</code>. So, if you’re running your web build, it won’t bother going inside that <code>if</code> statement or traversing the <code>require</code> in question.</p>\n<h4><a id="continuous-delivery" class="post-header-anchor" href="#continuous-delivery" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Continuous Delivery</h4>\n<p>There’s that release mindset again; it’s challenging. When you’re working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.</p>\n<p>As we covered earlier, you can’t really do this with a desktop app. OK, I guess you technically could if you’re using Electron, because electron-builder can be automated and, so, can spectron tests. I don’t know anyone doing this, and I wouldn’t have enough faith to do it myself. Remember, broken code can’t be taken back, and you could break the update flow. Besides, you don’t want to deliver desktop updates too often anyway. Updates aren’t silent, like they are on the web, so it’s not very nice for the user. Plus, for users on macOS, delta updates aren’t supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.</p>\n<p>You’ll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly — unless you’re releasing a feature, that is. You don’t want to punish a user because they chose to install your desktop app. Nothing’s worse than seeing a press release for a really cool feature in an app you use, only to realize that you’ll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that’s a whole separate topic. I first learned of feature flags from “<a href="https://www.youtube.com/watch?v=JR-ccCTmMKY" rel="noopener">Continuous Delivery: The Dirty Details</a>,” a talk by Etsy’s VP of Engineering, Mike Brittain.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>So, there you have it. With minimal effort, you can add “desktop app developer” to your resumé. We’ve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I’ve shared, you’ll agree that it’s not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.</p>\n<h4><a id="further-reading" class="post-header-anchor" href="#further-reading" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Further Reading</h4>\n<ul>\n<li>“<a href="http://engineroom.teamwork.com/resurrecting-clippy/" rel="noopener">Resurrecting Clippy</a>,” Adam Lynch (me)<br>\nHow I built clippy.desktop with NW.js.</li>\n<li>“<a href="http://jlord.us/essential-electron/" rel="noopener">Essential Electron</a>,” Jessica Lord<br>\nA plain-speak introduction to Electron and its core concepts.</li>\n<li><a href="http://electron.atom.io/docs/" rel="noopener">Electron Documentation</a><br>\nWant to dig into the details? Get it straight from the source.</li>\n<li>“<a href="http://electron.atom.io/community/" rel="noopener">Electron Community</a>”<br>\nA curated list of Electron-related tools, videos and more.</li>\n<li>“<a href="https://adamlynch.com/serverless-crash-reports-for-electron-apps/" rel="noopener">Serverless Crash Reporting for Electron Apps</a>,” Adam Lynch (me)<br>\nMy experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.</li>\n<li><a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, Stefan Judis<br>\nThe complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.</li>\n<li>“<a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a>,” Electron Documentation<br>\nSee just how simple Electron’s automatic-update API is.</li>\n</ul>\n',attributes:{date:"2017-03-21T00:00:00.000Z",original:{blogLink:"https://www.smashingmagazine.com/",blogName:"Smashing Magazine",url:"https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"electron",name:"electron"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"development",name:"development"}],title:"Beyond The Browser: From Web Apps To Desktop Apps",updated_at:"2019-05-22T08:25:28.847Z",photo:"/images/blog-content/beyond-the-browser/chromiumDiagram.png"},title:"Beyond The Browser: From Web Apps To Desktop Apps",renderedSummary:"<p>I started out as a web developer, and that’s now one part of what I do as a full-stack developer, but never had I imagined I’d create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least… different.</p>\n",rendered:'<h2><a id="beyond-the-browser-from-web-apps-to-desktop-apps" class="post-header-anchor" href="#beyond-the-browser-from-web-apps-to-desktop-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Beyond The Browser: From Web Apps To Desktop Apps</h2>\n<p>I started out as a web developer, and that’s now one part of what I do as a full-stack developer, but never had I imagined I’d create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least… different.</p>\n<p>It’s not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?</p>\n<p>OK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.</p>\n<p>In this article, we’ll look at the development of desktop applications using <a href="http://nwjs.io/" rel="noopener">NW.js</a> and <a href="http://electron.atom.io/" rel="noopener">Electron</a>, the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.</p>\n<h3><a id="why" class="post-header-anchor" href="#why" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why?</h3>\n<p>First of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user’s system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.</p>\n<p>Maybe you’ve an idea that would only work as a desktop app; some things simply aren’t possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you’ve an idea for the Mac App Store. Maybe it would simply be a fun side project.</p>\n<p>It’s hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you’d like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a <a href="https://teamwork.com/chat" rel="noopener">chat application</a>. On the other hand, a connection-dependent desktop app that doesn’t really have any desktop integration should be a web app and a web app alone. It wouldn’t be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn’t get any more value from it than from visiting a URL of yours in their favorite browser.</p>\n<p>Instead of describing the desktop app you personally should build and why, I’m hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.</p>\n<h3><a id="nwjs" class="post-header-anchor" href="#nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>NW.js</h3>\n<p>Desktop applications have been around a long time but you don’t have all day, so let’s skip some history and begin in Shanghai, 2011. Roger Wang, of Intel’s Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within <code>&lt;script&gt;</code> tags.</p>\n<p>After some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.</p>\n<p><em>Note</em>: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.</p>\n<p>So, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn’t know any better. That’s pretty powerful, but how does it work? Well, first let’s take a look at Chromium.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/chromiumDiagram.png"><img src="/images/blog-content/beyond-the-browser/chromiumDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)</p>\n</figcaption>\n        </figure><p>There is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsDiagram.png"><img src="/images/blog-content/beyond-the-browser/nwjsDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an NW.js app\'s internals.</p>\n</figcaption>\n        </figure><p>This is roughly what an NW.js app looks like. It’s basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you’ve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.</p>\n<p>Creating an app is really easy. All you need is an HTML file and a <code>package.json</code>, like you would have when working with Node.js. You can create a default one by running <code>npm init --yes</code>. Typically, a <code>package.json</code> would point a JavaScript file as the “main” file for the module (i.e. using the <code>main</code> property), but with NW.js you need to edit the <code>main</code> property to point to your HTML file.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>Once you install the official <code>nw</code> package from npm (by running <code>npm install -g nw</code>), you can run <code>nw .</code> within the project directory to launch your app.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example NW.js app.</p>\n</figcaption>\n        </figure><p>It’s as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn’t look like much, but it’s up to you add some markup and styles, just like you would in a web app.</p>\n<p>You could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and <a href="http://adamlynch.com/resurrecting-clippy/" rel="noopener">resurrected Clippy</a> using NW.js. There’s something weirdly satisfying about seeing Clippy on macOS or Windows 10.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/clippy.png"><img src="/images/blog-content/beyond-the-browser/clippy.png" alt=""/></a>\n          <figcaption><p>A screenshot of clippy.desktop on macOS.</p>\n</figcaption>\n        </figure><p>So, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/moduleCounts.png"><img src="/images/blog-content/beyond-the-browser/moduleCounts.png" alt=""/></a>\n          <figcaption><p>Bar graph showing the number of modules per major package manager. (Source: <a href="http://modulecounts.com" rel="noopener">Module Counts</a>)</p>\n</figcaption>\n        </figure><p>You get access not only to Node.js’ APIs but to all of npm, which has over 350,000 modules now. For example, <a href="https://github.com/Teamwork/node-auto-launch" rel="noopener">auto-launch</a> is an open-source module we created at <a href="https://www.teamwork.com/" rel="noopener">Teamwork.com</a> to launch an NW.js or Electron app on startup.</p>\n<p>Node.js also has what’s known as “native modules,” which, if you really need to do something a bit lower level, allows you to create modules in C or C++.</p>\n<p>To top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  body<span class="token punctuation">:</span> <span class="token string">\'world\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h3><a id="electron" class="post-header-anchor" href="#electron" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Electron</h3>\n<p>You might recognize GitHub’s text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/atom.png"><img src="/images/blog-content/beyond-the-browser/atom.png" alt=""/></a>\n          <figcaption><p>A screenshot of Atom, GitHub\'s text editor.</p>\n</figcaption>\n        </figure><p><em>Note</em>: It’s disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it’s effectively a fork for the end user because the APIs were almost identical.</p>\n<p>In making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/logos.png"><img src="/images/blog-content/beyond-the-browser/logos.png" alt=""/></a>\n          <figcaption><p>Logos of projects that use Electron.</p>\n</figcaption>\n        </figure><p>As well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.</p>\n<h3><a id="how-does-it-differ" class="post-header-anchor" href="#how-does-it-differ" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How Does It Differ?</h3>\n<p>But how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronDiagram.png"><img src="/images/blog-content/beyond-the-browser/electronDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an Electron app\'s internals.</p>\n</figcaption>\n        </figure><p>The Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don’t have to do anything.</p>\n<p><em>Note</em>: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn’t quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.</p>\n<p>Back to the main process. Your app hasn’t any window by default, but you can open as many windows as you’d like from the main process, each having its own renderer process, just like NW.js.</p>\n<p>So, yeah, the minimum you need for an Electron app is a main JavaScript file (which we’ll leave empty for now) and a <code>package.json</code> that points to it. Then, all you need to do is <code>npm install --save-dev electron</code> and run <code>electron .</code> to launch your app.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-javascript"><span class="token comment">// main.js, which is empty</span>\n</code></pre>\n<p>Not much will happen, though, because your app hasn’t any window by default. You can open as many windows as you’d like from the main process, each having its own renderer process, just like they’d have in an NW.js app.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>You could load a remote URL in this window, but typically you’d create a local HTML file and load that. Ta-da!</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/electronHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example Electron app.</p>\n</figcaption>\n        </figure><p>Of the built-in modules Electron provides, like the <code>app</code> or <code>BrowserWindow</code> module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you’d catch the <code>click</code> event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.</p>\n<p>OK, so Electron has distinct processes, and you have to organize your app slightly differently, but that’s not a big deal. Why are people using Electron instead of NW.js? Well, there’s mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.</p>\n<p>Electron’s documentation really is amazing, though — that’s worth emphasizing. Take the <a href="https://github.com/electron/electron-api-demos" rel="noopener">Electron API Demos app</a>. It’s an Electron app that interactively demonstrates what you can do with Electron’s APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/apiDemosApp.png"><img src="/images/blog-content/beyond-the-browser/apiDemosApp.png" alt=""/></a>\n          <figcaption><p>A screenshot of the Electron API Demos app.</p>\n</figcaption>\n        </figure><p>If you submit an issue via Electron’s bug tracker, you’ll get a response within a couple of days. I’ve seen three-year-old NW.js bugs, although I don’t hold it against them. It’s tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I’m extremely grateful for what NW.js has given us.</p>\n<p>Electron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn’t focused. An example API flaw I ran into was that binding to <code>Control + Shift + A</code> in an NW.js app did what you would expect on Windows, but actually bound to <code>Command + Shift + A</code> on a Mac. This was intentional but really weird. There was no way to bind to the <code>Control</code> key. Also, binding to the <code>Command</code> key did bind to the <code>Command</code> key but the <code>Windows</code> key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you’d expect. To be fair, NW.js has since fixed the former but not the latter.</p>\n<p>There are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don’t go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you’d like. If you want to do something interesting with audio or video, use Electron, because some codecs don’t work out of the box with NW.js.</p>\n<p>Electron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I’ll cover that later.</p>\n<h3><a id="but-how-does-it-feel" class="post-header-anchor" href="#but-how-does-it-feel" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>But How Does It Feel?</h3>\n<p>It feels fine. Sure, it’s not native. Most desktop apps these days don’t look like Windows Explorer or Finder anyway, so users won’t mind or realize that HTML is behind your user interface. You can make it feel more native if you’d like, but I’m not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That’s how a native desktop app would act, but is that better? There are also projects out there like <a href="http://photonkit.com/" rel="noopener">Photon Kit</a>, which is basically a CSS framework like Bootstrap, but for macOS-style components.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/photon.png"><img src="/images/blog-content/beyond-the-browser/photon.png" alt=""/></a>\n          <figcaption><p>A screenshot of an example Electron app made with Photon.</p>\n</figcaption>\n        </figure><h3><a id="performance" class="post-header-anchor" href="#performance" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Performance</h3>\n<p>What about performance? Is it slow or laggy? Well, your app is essentially a web app. It’ll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that’s fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named <a href="http://electron.atom.io/devtron/" rel="noopener">Devtron</a> to monitor some Electron-specific stuff.</p>\n<p>Your desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it’s an isolated process, any computation or processing going on in that window won’t affect rendering, scrolling or anything else in your visible window(s).</p>\n<p>Keep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won’t).</p>\n<h3><a id="distribution" class="post-header-anchor" href="#distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distribution</h3>\n<p>Both NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn’t support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you’ll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don’t have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).</p>\n<p>Electron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be <a href="http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html" rel="noopener">phasing out Chrome Packaged Apps</a>, but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.</p>\n<p>Even though 32-bit and 64-bit builds are supported, you’ll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.</p>\n<p>So, let’s say that Electron has won over and you want to ship an Electron app. There’s a nice Node.js module named <a href="https://github.com/electron-userland/electron-packager" rel="noopener">electron-packager</a> that helps with packing your app up into an <code>.app</code> or <code>.exe</code> file. A few similar projects exist, including interactive ones that prompt you step by step. You should use <a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, though, which builds on top of electron-packager, plus a few other related modules. It generates <code>.dmg</code>s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.</p>\n<p>The annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you’re serious about shipping desktop apps, then you’ll need to build on multiple machines for each release.</p>\n<p>This can feel a bit too manual or tedious, especially if you’re used to creating for the web. Thankfully, electron-builder was created with automation in mind. I’m talking here about continuous integration tools and services such as <a href="https://jenkins.io/" rel="noopener">Jenkins</a>, <a href="http://codeship.com/" rel="noopener">CodeShip</a>, <a href="https://travis-ci.org/" rel="noopener">Travis-CI</a>, <a href="https://www.appveyor.com/" rel="noopener">AppVeyor</a> (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.</p>\n<h3><a id="automatic-updates" class="post-header-anchor" href="#automatic-updates" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automatic Updates</h3>\n<p>NW.js doesn’t have automatic update support, but you’ll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as <a href="https://github.com/edjafarov/node-webkit-updater" rel="noopener">node-webkit-updater</a>, which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.</p>\n<p>Electron has built-in support for automatic updates, via its <a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a> API. It doesn’t support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux — don’t worry. The <code>autoUpdater</code> API is really simple; once you give it a URL, you can call the <code>checkForUpdates</code> method. It’s event-driven, so you can subscribe to the <code>update-downloaded</code> event, for example, and once it’s fired, call the <code>restartAndInstall</code> method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.</p>\n<p><em>Note</em>: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.</p>\n<p>It’s not quite as simple behind the API. It’s based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the <a href="https://github.com/Squirrel/Squirrel.Mac" rel="noopener">Squirrel.Mac</a> and <a href="https://github.com/Squirrel/Squirrel.Windows" rel="noopener">Squirrel.Windows</a> projects, respectively.</p>\n<p>The update code within your Mac Electron app is simple, but you’ll need a server (albeit a simple server). When you call the autoUpdater module’s <code>checkForUpdates</code> method, it will hit your server. What your server needs to do is return a 204 (“No Content”) if there isn’t an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a <code>.zip</code> file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It’ll go get that <code>.zip</code>, unzip it and fire the appropriate events.</p>\n<p>There a bit more (magic) going on in your Windows app when it comes to automatic updates. You won’t need a server, but you can have one if you’d like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.</p>\n<p>Squirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call <code>restartAndInstall</code>, it’ll be a bit quicker because it’s ready and waiting. It also supports delta updates. Let’s say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you’re, say, three versions behind, but it will only do that if it’s worth it. Otherwise, if you’re, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it’s ready to go.</p>\n<p><em>Note</em>: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.</p>\n<p>Thanks to the Electron community, you don’t have to build your own server if you don’t want to. There are open-source projects you can use. Some allow you to <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">store updates on S3</a> or use <a href="https://github.com/GitbookIO/nuts" rel="noopener">GitHub releases</a>, and some even go as far as <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">providing administrative dashboards</a> to manage the updates.</p>\n<h3><a id="desktop-versus-web" class="post-header-anchor" href="#desktop-versus-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop Versus Web</h3>\n<p>So, how does making a desktop app differ from making a web app? Let’s look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you’re used to using on the web, workflow pain points, maintenance woes and more.</p>\n<p>Well, the first thing that comes to mind is browser lock-in. It’s like a guilty pleasure. If you’re making a desktop app exclusively, you’ll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You’ll never have to deal with any cross-browser incompatibilities. This is on top of Node.js’ APIs and all of npm. You can do anything.</p>\n<p><em>Note</em>: You’ll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.</p>\n<h4><a id="working-with-file" class="post-header-anchor" href="#working-with-file" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Working With file://</h4>\n<p>Another interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You’ll need to pay more attention to how your app behaves if the network connection is lost while it’s running. You may need to adjust your mindset.</p>\n<p><em>Note</em>: You can load remote URLs if you really want, but I wouldn’t.</p>\n<p>One tip I can give you here is not to trust <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine" rel="noopener"><code>navigator.onLine</code></a> completely. This property returns a Boolean indicating whether or not there’s a connection, but watch out for false positives. It’ll return <code>true</code> if there’s any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus’ <a href="https://github.com/sindresorhus/is-online" rel="noopener"><code>is-online</code></a> module to double-check; it will ping the Internet’s root servers and/or the favicon of a few popular websites. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'is-online\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// hmm there\'s a connection, but is the Internet accessible?</span>\n  <span class="token function">isOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>online <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>online<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true or false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token comment">// we can trust navigator.onLine when it says there is no connection</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Speaking of local files, there are a few things to be aware of when using the <code>file://</code> protocol — protocol-less URLs, for one; you can’t use them anymore. I mean URLs that start with <code>//</code> instead of <code>http://</code> or <code>https://</code>. Typically, if a web app requests <code>//example.com/hello.json</code>, then your browser would expand this to <code>http://example.com/hello.json</code> or to <code>https://example.com/hello.json</code> if the current page is loaded over HTTPS. In our app, the current page would load using the <code>file://</code> protocol; so, if we requested the same URL, it would expand to <code>file://example.com/hello.json</code> and fail. The real worry here is third-party modules you might be using; authors aren’t thinking of desktop apps when they make a library.</p>\n<p>You’d never use a CDN. Loading local files is basically instantaneous. There’s also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.</p>\n<h4><a id="artifacts-galore" class="post-header-anchor" href="#artifacts-galore" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Artifacts Galore</h4>\n<p>A lot of asset generation is involved in creating a solid desktop app. You’ll need to generate executables and installers and decide on an auto-update system. Then, for each update, you’ll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.</p>\n<p>Weight is still a concern. A “Hello, World!” Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn’t much I can offer you. The “Hello, World!” app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I’m afraid). However, your users won’t be downloading your app on a 2G connection (hopefully!).</p>\n<h4><a id="expect-the-unexpected" class="post-header-anchor" href="#expect-the-unexpected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Expect the Unexpected</h4>\n<p>You will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let’s say you’ve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (<code>&lt;select/&gt;</code>), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you’re in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it’s not often the user would resize the window down to a small enough size.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/dropdownComparison.png"><img src="/images/blog-content/beyond-the-browser/dropdownComparison.png" alt=""/></a>\n          <figcaption><p>Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.</p>\n</figcaption>\n        </figure><p>You may or may not know it, but on a Mac, every window has a header and a body. When a window isn’t focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it’s being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it’s Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn’t focused, though, they won’t react if you were to hover over them. Hover styles won’t be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that’s it. A second click would be required to actually click the button and close the app.</p>\n<p>To add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It’s a confirmed bug; applying the hover styles on a blurred window body “doesn’t meet platform expectations,” so it will be fixed. Hopefully, I’m saving you some heartbreak here. You could have a situation in which you’ve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it’s not native).</p>\n<p>So, you must use native buttons on a Mac. There’s no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting <code>window</code> object’s <code>frame</code> property to <code>false</code> in your <code>package.json</code>).</p>\n<p>You could do the same with an Electron app. This is controlled by setting the <code>frame</code> property when creating a window; for example, <code>new BrowserWindow({width: 800, height: 600, frame: true})</code>. As the Electron team does, they spotted this issue and added another option as a nice compromise; <code>titleBarStyle</code>. Setting this to <code>hidden</code> will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    titleBarStyle<span class="token punctuation">:</span> <span class="token string">\'hidden\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Here’s an app in which I’ve disabled the title bar and given the <code>html</code> element a background image:</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/hiddenTitleBar.png"><img src="/images/blog-content/beyond-the-browser/hiddenTitleBar.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example app without the title bar.</p>\n</figcaption>\n        </figure><p>See “<a href="http://electron.atom.io/docs/api/frameless-window" rel="noopener">Frameless Window</a>” from Electron’s documentation for more.</p>\n<h4><a id="tooling" class="post-header-anchor" href="#tooling" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tooling</h4>\n<p>Well, you can pretty much use all of the tooling you’d use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn’t want to use electron-builder). <a href="https://github.com/Quramy/electron-connect" rel="noopener">Electron-connect</a> watches your files for changes, and when they occur, it’ll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you’d like. You could run webpack inside your app if you wanted to — I’ve no idea why you would, but the options are endless. Make sure to check out <a href="https://github.com/sindresorhus/awesome-electron" rel="noopener">awesome-electron</a> for more resources.</p>\n<h4><a id="release-flow" class="post-header-anchor" href="#release-flow" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Release Flow</h4>\n<p>What’s it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you’re working on the web app and you deploy a change that breaks something, it’s not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they’re reported or noticed. You can’t do that with desktop apps. You can’t take back updates you push out there. It’s more like a mobile app flow. You build the app, put it out there, and you can’t take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.</p>\n<h4><a id="quantum-mechanics" class="post-header-anchor" href="#quantum-mechanics" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Quantum Mechanics</h4>\n<p>Because a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you’ll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it’s a breaking change or not. A version released a month ago could implode because it has some slightly different code.</p>\n<h4><a id="fresh-problems-to-solve" class="post-header-anchor" href="#fresh-problems-to-solve" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fresh Problems to Solve</h4>\n<p>You might receive a few strange bug reports — ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system’s environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you’ll have to draw a line. This was something critical to our app, so we couldn’t ignore the error, and we couldn’t fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.</p>\n<p>Sure, a few web-specific concerns are no longer applicable when you’re working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There’s a 256-character limit on file paths in Windows, for example.</p>\n<p>Old versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a <code>node_modules</code> directory in your project (for example, <code>node_modules/a</code>). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a <code>node_modules</code> within that directory (for example, <code>node_modules/a/node_modules/b</code>). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like <code>path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js</code>.</p>\n<p><em>Note</em>: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.</p>\n<p>We had a case in which our app wouldn’t launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app’s code into an <a href="http://electron.atom.io/docs/tutorial/application-packaging/" rel="noopener">asar archive</a>, which protects against path length issues but has exceptions and can’t always be used.</p>\n<p>We created a little Gulp plugin named <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>, which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user’s machine will determine the true length of the path, though. In our case, our installer will install it to <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming</code>. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they’re stored there (on the user’s machine with a long username, to be safe).</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/**/*\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t        rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t        match<span class="token punctuation">:</span> <span class="token string">\'./example\'</span><span class="token punctuation">,</span>\n\t\t        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'</span>\n\t        <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="fatal-errors-can-be-really-fatal" class="post-header-anchor" href="#fatal-errors-can-be-really-fatal" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fatal Errors Can Be Really Fatal</h4>\n<p>Because all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let’s say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and… crash. So, you’d have to reach out to all of your users and let them know they’ll need to reinstall the app. Trust me, I know. It’s horrible.</p>\n<h4><a id="analytics-and-bug-reports" class="post-header-anchor" href="#analytics-and-bug-reports" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Analytics and Bug Reports</h4>\n<p>You’ll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won’t work (out of the box, at least). You’ll have to find something that doesn’t mind an app that runs on <code>file://</code> URLs. If you’re using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you’re using <a href="https://sentry.io/welcome/" rel="noopener">Sentry</a> to track errors, make sure to <a href="https://docs.sentry.io/clients/javascript/config/#optional-settings" rel="noopener">set the <code>release</code> property when setting up your client</a>, so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you’ll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.</p>\n<p>Electron has a <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crashReporter</code></a> module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.</p>\n<h4><a id="security" class="post-header-anchor" href="#security" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Security</h4>\n<p>Be extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.</p>\n<p>Don’t trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they’d have the problem, too. We contacted X’s support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn’t have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).</p>\n<p>How can you mitigate this risk? You could try to catch errors, but you’ve no idea what they company X might do in its JavaScript, so you’re better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X’s URL from your <code>&lt;script&gt;</code>, you could use <a href="https://www.google.ie/analytics/tag-manager/" rel="noopener">Google Tag Manager</a> or your own API to return either HTML containing the <code>&lt;script&gt;</code> tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.</p>\n<p>However, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven’t solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don’t want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You’re back to the same problem.</p>\n<p>Another solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you’d do this via IPC now. You’d send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.</p>\n<p>This brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We’d be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn’t run:</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> thirdPartyWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  thirdPartyWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      nodeIntegration<span class="token punctuation">:</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  thirdPartyWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/third-party-snippets.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="automated-testing" class="post-header-anchor" href="#automated-testing" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automated Testing</h4>\n<p>NW.js doesn’t have any built-in support for testing. But, again, you have access to Node.js, so it’s technically possible. There is a way to test stuff such as button-clicking within the app using <a href="https://github.com/cyrus-and/chrome-remote-interface" rel="noopener">Chrome Remote Interface</a>, but it’s tricky. Even then, you can’t trigger a click on a native window control and test what happens, for example.</p>\n<p>The Electron team has created <a href="http://electron.atom.io/spectron/" rel="noopener">Spectron</a> for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> Application <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'spectron\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Application\n<span class="token keyword">var</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'application launch\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>\n\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      path<span class="token punctuation">:</span> <span class="token string">\'/Applications/MyApp.app/Contents/MacOS/MyApp\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'shows an initial window\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getWindowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Because your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you’d need to make sure the app can run in a web browser without Node.js.</p>\n<h3><a id="desktop-and-web" class="post-header-anchor" href="#desktop-and-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop And Web</h3>\n<p>It’s not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it’s worth it. I’ll mention a few related topics and tools, which are complicated in their own right, so I’ll keep just touch on them.</p>\n<p>First of all, forget about “browser lock-in,” native WebSockets, etc. The same goes for ES6. You can either revert to writing plain old ES5 JavaScript or use something like <a href="https://babeljs.io/" rel="noopener">Babel</a> to transpile your ES6 into ES5, for web use.</p>\n<p>You also have <code>require</code>s throughout your code (for importing other scripts or modules), which a browser won’t understand. Use a module bundler that supports CommonJS (i.e. Node.js-style <code>require</code>s), such as <a href="http://rollupjs.org" rel="noopener">Rollup</a>, <a href="https://webpack.github.io" rel="noopener">webpack</a> or <a href="http://browserify.org" rel="noopener">Browserify</a>. When making a build for the web, a module bundler will run over your code, traverse all of the <code>require</code>s and bundle them up into one script for you.</p>\n<p>Any code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether <code>process.version.nwjs</code> or <code>process.versions.electron</code> exists; if it does, then your app is currently running in the desktop environment.</p>\n<p>Even then, you’ll be loading a lot of redundant code in the web app. Let’s say you have a <code>require</code> guarded behind a check like <code>if(app.isInDesktop)</code>, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting <code>app.isInDesktop</code>, you could pass <code>true</code> or <code>false</code> into your app as a flag at buildtime (for example, using the <a href="https://github.com/hughsk/envify" rel="noopener">envify</a> transform for Browserify). This will aide your module bundler of choice when it’s doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether <code>app.isInDesktop</code> is <code>true</code>. So, if you’re running your web build, it won’t bother going inside that <code>if</code> statement or traversing the <code>require</code> in question.</p>\n<h4><a id="continuous-delivery" class="post-header-anchor" href="#continuous-delivery" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Continuous Delivery</h4>\n<p>There’s that release mindset again; it’s challenging. When you’re working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.</p>\n<p>As we covered earlier, you can’t really do this with a desktop app. OK, I guess you technically could if you’re using Electron, because electron-builder can be automated and, so, can spectron tests. I don’t know anyone doing this, and I wouldn’t have enough faith to do it myself. Remember, broken code can’t be taken back, and you could break the update flow. Besides, you don’t want to deliver desktop updates too often anyway. Updates aren’t silent, like they are on the web, so it’s not very nice for the user. Plus, for users on macOS, delta updates aren’t supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.</p>\n<p>You’ll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly — unless you’re releasing a feature, that is. You don’t want to punish a user because they chose to install your desktop app. Nothing’s worse than seeing a press release for a really cool feature in an app you use, only to realize that you’ll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that’s a whole separate topic. I first learned of feature flags from “<a href="https://www.youtube.com/watch?v=JR-ccCTmMKY" rel="noopener">Continuous Delivery: The Dirty Details</a>,” a talk by Etsy’s VP of Engineering, Mike Brittain.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>So, there you have it. With minimal effort, you can add “desktop app developer” to your resumé. We’ve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I’ve shared, you’ll agree that it’s not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.</p>\n<h4><a id="further-reading" class="post-header-anchor" href="#further-reading" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Further Reading</h4>\n<ul>\n<li>“<a href="http://engineroom.teamwork.com/resurrecting-clippy/" rel="noopener">Resurrecting Clippy</a>,” Adam Lynch (me)<br>\nHow I built clippy.desktop with NW.js.</li>\n<li>“<a href="http://jlord.us/essential-electron/" rel="noopener">Essential Electron</a>,” Jessica Lord<br>\nA plain-speak introduction to Electron and its core concepts.</li>\n<li><a href="http://electron.atom.io/docs/" rel="noopener">Electron Documentation</a><br>\nWant to dig into the details? Get it straight from the source.</li>\n<li>“<a href="http://electron.atom.io/community/" rel="noopener">Electron Community</a>”<br>\nA curated list of Electron-related tools, videos and more.</li>\n<li>“<a href="https://adamlynch.com/serverless-crash-reports-for-electron-apps/" rel="noopener">Serverless Crash Reporting for Electron Apps</a>,” Adam Lynch (me)<br>\nMy experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.</li>\n<li><a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, Stefan Judis<br>\nThe complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.</li>\n<li>“<a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a>,” Electron Documentation<br>\nSee just how simple Electron’s automatic-update API is.</li>\n</ul>\n',summary:"I started out as a web developer, and that’s now one part of what I do as a full-stack developer, but never had I imagined I’d create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least… different.\n",original:{blogLink:"https://www.smashingmagazine.com/",blogName:"Smashing Magazine",url:"https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/"},photo:"/images/blog-content/beyond-the-browser/chromiumDiagram.png",keywords:["node-webkit","electron","desktop","javascript","development"],published_at:"2017-03-21T00:00:00.000Z",updated_at:"2019-05-22T08:25:28.847Z",year:2017,month:3,day:22,relevanceScore:.9166666666666667}]}}],error:null,state:{nameToShow:"Adam Lynch",githubAccountUrl:"https://github.com/adam-lynch",siteUrl:"https://adamlynch.com",siteTitle:"Adam Lynch",repositoryUrl:"https://github.com/adam-lynch/adam-lynch.github.io"},serverRendered:!0}</script><script src="/_nuxt/manifest.8ae1f35e680abc541c20.js" defer></script><script src="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" defer></script><script src="/_nuxt/1.03bda2e583db241630d8.js" defer></script><script src="/_nuxt/vendor.ce05078a33ab89125ee8.js" defer></script><script src="/_nuxt/app.3350f002994de6bb1c66.js" defer></script>

    <script src="https://use.typekit.net/tci5xbk.js"></script>
    <script>try{Typekit.load({async:!0})}catch(a){}</script>
    <script>!function(e,a,t,n,c,g,s){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,g=a.createElement("script"),s=a.getElementsByTagName("script")[0],g.async=1,g.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(g,s)}(window,document),ga("create","UA-31546953-1","auto"),ga("send","pageview")</script>
  

