<!DOCTYPE html>
<html data-n-head="" data-n-head-ssr>
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="#ffffff" theme-color="theme-color"><meta data-n-head="true" content="There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's os module, it isn't too difficult.
" name="description" data-hid="description"><meta data-n-head="true" content="node-webkit, desktop, javascript, platform, linux, mac, windows, development" name="keywords" data-hid="keywords"><meta data-n-head="true" content="summary" name="twitter:card" data-hid="twitter:card"><meta data-n-head="true" content="Platform detection in your NW.js app" name="twitter:title" data-hid="twitter:title"><meta data-n-head="true" content="There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's os module, it isn't too difficult.
" name="twitter:description" data-hid="twitter:description"><meta data-n-head="true" content name="twitter:image"><meta data-n-head="true" content="/platform-detection" name="twitter:url" data-hid="twitter:url"><meta data-n-head="true" content="article" name="og:type" data-hid="og:type"><meta data-n-head="true" content="Platform detection in your NW.js app" name="og:title" data-hid="og:title"><meta data-n-head="true" content="There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's os module, it isn't too difficult.
" name="og:description" data-hid="og:description"><meta data-n-head="true" content name="og:image" data-hid="og:image"><meta data-n-head="true" content="/platform-detection" name="og:url" data-hid="og:url"><title data-n-head="true">Platform detection in your NW.js app</title><link href="/apple-touch-icon.png" rel="apple-touch-icon" data-n-head="true" sizes="76x76"><link href="/favicon-32x32.png" rel="icon" data-n-head="true" sizes="32x32" type="image/x-icon"><link href="/favicon-16x16.png" rel="icon" data-n-head="true" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" data-n-head="true" color="#53687a"><link href="//unpkg.com/prismjs/themes/prism.css" rel="stylesheet" data-n-head="true"><link href="/_nuxt/manifest.25595636d53df74f38ab.js" rel="preload" as="script"><link href="/_nuxt/vendor.ce05078a33ab89125ee8.js" rel="preload" as="script"><link href="/_nuxt/app.7fd5760da80466c89126.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" rel="preload" as="script"><link href="/_nuxt/1.03bda2e583db241630d8.js" rel="preload" as="script"><link href="/_nuxt/pages/index.5bad6aa85a4e69648400.js" rel="prefetch"><style data-vue-ssr-id="6dd13fd5:0">*{-webkit-box-sizing:border-box;box-sizing:border-box}body,html{margin:0;padding:0}ol,ul{list-style:none;padding-left:0;margin:0}a{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;text-decoration:none;color:inherit}body{font-family:Arial,sans-serif;line-height:1.55;letter-spacing:-.25px;-webkit-font-smoothing:antialiased}.wf-active body{font-family:Lato,Arial,sans-serif}html{font-size:14px}@media (min-width:470px){html{font-size:16px}}body{background:#ececec;color:#333;padding-top:28px;padding-top:2rem;overflow-x:hidden}.wrapper{max-width:840px;max-width:60rem;margin:0 auto}.header{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0 14px;padding:0 1rem;background:#ececec}@media (min-width:59rem){.header{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}@media (min-width:470px){.header{padding-left:2rem;padding-right:2rem}}.site-title{margin:0;text-align:center;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;min-width:100%;max-width:84px;max-width:6rem}@media (min-width:42rem){.site-title{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.site-title{-webkit-box-flex:initial;-ms-flex:initial;flex:initial}}.site-title:hover{opacity:.9}.site-link{display:inline-block;background:url(/_nuxt/img/Logo.542e06c.png) 0 no-repeat;background-size:6.09rem;height:126px;height:9rem;width:84px;width:6rem;margin:0 auto;text-indent:-9999px}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.site-link{background-image:url(/_nuxt/img/Logo@2x.b121531.png)}}.site-happy-text-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0 auto;padding:0;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:18.2px;font-size:1.3rem}@media (min-width:42rem){.site-happy-text-wrapper{-webkit-box-flex:2;-ms-flex:2;flex:2;padding:0 0 0 2rem}}@media (min-width:59rem){.site-happy-text-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;font-size:1.2rem}}@media (min-width:61rem){.site-happy-text-wrapper{font-size:1.3rem}}.site-happy-text{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;text-align:center}@media (min-width:42rem){.site-happy-text{text-align:left}}.site-happy-text-headline{display:block}.site-happy-text-headline,.wf-active .site-happy-text-headline{font-size:26.599px;font-size:1.9rem;font-weight:700}@media (min-width:25rem){.site-happy-text-headline{font-size:2.3rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:2.5rem}}@media (min-width:59rem){.site-happy-text-headline{font-size:2.9rem}.wf-active .site-happy-text-headline{font-size:3.1rem}}@media (min-width:61rem){.site-happy-text-headline{font-size:2.92rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:3.2rem}}.site-happy-text-tagline{display:inline}@media (min-width:42rem){.site-happy-text-tagline{display:block}}.navigation-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;padding:28px 0 0;padding:2rem 0 0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}@media (min-width:59rem){.navigation-wrapper{max-width:23rem;padding:0 0 0 2rem}}.navigation{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-width:100%;width:100%}@media (min-width:59rem){.navigation{-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-width:0}}.navigation-item{-webkit-box-flex:1;-ms-flex:1 1 33%;flex:1 1 33%;min-width:33%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;cursor:pointer;font-size:11.9px;font-size:.85rem;font-weight:200;-webkit-transition:background-color .25s;transition:background-color .25s}@media (min-width:25rem){.navigation-item{font-size:.9rem}}@media (min-width:45rem){.navigation-item{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.navigation-item{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:33%}}.navigation-item:first-child{background:#e2e2e2}.navigation-item:first-child:hover{background:#ddd}.navigation-item:nth-child(2){background:#e8e8e8}.navigation-item:nth-child(2):hover{background:#e3e3e3}.navigation-item:nth-child(3){background:#efefef}.navigation-item:nth-child(3):hover{background:#eaeaea}.navigation-item:nth-child(4){background:#ddd}.navigation-item:nth-child(4):hover{background:#d8d8d8}.navigation-item:nth-child(5){background:#e3e3e3}.navigation-item:nth-child(5):hover{background:#dedede}.navigation-item:nth-child(6){background:#eaeaea}.navigation-item:nth-child(6):hover{background:#e4e4e4}.navigation-link{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:14px;padding:1rem;text-decoration:none;font-size:12.6px;font-size:.9rem;color:#000;-webkit-transition:color .25s;transition:color .25s}@media (min-width:25rem){.navigation-link{padding:1.4rem}}.navigation-link:after{content:"";position:absolute;top:100%;left:0;bottom:0;right:0;height:0;width:100%;background:#fff;opacity:.1;cursor:pointer;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}.navigation-link:hover:after{top:50%;height:50%}.navigation-item-text{-webkit-box-flex:1;-ms-flex:1;flex:1}.posts{padding:28px 14px;padding:2rem 1rem}@media (min-width:470px){.posts{padding:2rem}}.post-wrapper{padding-bottom:28px;padding-bottom:2rem}.post-wrapper:last-child{padding-bottom:0}.post{padding:28px 14px;padding:2rem 1rem;margin:28px 0;margin:2rem 0;background:#fff;max-width:840px;max-width:60rem;position:relative}@media (min-width:470px){.post{padding:2rem}}.post:before{background:linear-gradient(180deg,hsla(0,0%,100%,0) 0,#fff 1500px);-webkit-animation:fadein 1s ease-in;animation:fadein 1s ease-in}.post:after,.post:before{content:" ";position:absolute;top:0;left:50%;bottom:0;width:100vw;-webkit-transform:translateX(-50%);transform:translateX(-50%);z-index:-1}.post:after{background:linear-gradient(0deg,#ececec 0,hsla(0,0%,100%,0) 1000px)}.posts .post{margin:0 auto}.posts .post:after,.posts .post:before{content:none}.posts .post:before{-webkit-animation:none;animation:none}.post>:first-child{margin-top:0}@media (min-width:62rem){.post-page-post-wrapper{margin-left:2rem;margin-right:2rem}}.post-content{font-size:15.4px;font-size:1.1rem;line-height:1.55}.post-content>*{margin:21px 0 0;margin:1.5rem 0 0}.post-content :not(figure)>a{color:#4580a7;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(104,130,197,.4)),to(rgba(104,130,197,.4)));background-image:linear-gradient(rgba(104,130,197,.4),rgba(104,130,197,.4));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-content :not(figure)>a:hover{color:#6882c5}.post-content blockquote{position:relative;font-size:18.2px;font-size:1.3rem;font-size:21.98px;font-size:1.57rem;font-style:italic;font-weight:100;padding-left:28px;padding-left:2rem;line-height:1.48;margin-top:28px;margin-top:2rem}.post-content blockquote:before{content:"\201C";position:absolute;top:-21px;top:-1.5rem;left:-7px;left:-.5rem;height:42px;height:3rem;width:25px;color:#f5f5f5;font-size:84px;font-size:6rem;font-style:normal;line-height:1}.post-content blockquote footer{margin-top:14px;margin-top:1rem;font-size:12.6px;font-size:.9rem;text-align:right}.post-content blockquote cite{display:inline-block;margin-left:7px;margin-left:.5rem}.post-content figure{text-align:center}.post-content figcaption{color:#666;font-size:12.6px;font-size:.9rem;font-style:italic}.post-content img{display:block;max-width:100%;height:auto;margin:0 auto;min-height:50px;min-width:150px;position:relative;color:#b6b6b6;font-size:12.6px;font-size:.9rem;text-align:center}.post-content img:before{content:"Image failed to load :/";display:block;font-size:13.299px;font-size:.95rem}.post-content code,.post-content pre{font-family:Consolas,Monaco,Andale Mono,monospace;text-shadow:0 1px #fff;white-space:pre;word-spacing:normal;word-break:normal;-webkit-font-feature-settings:none;font-feature-settings:none;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;word-wrap:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.post-content :not(h3):not(h4):not(h5):not(h6)>code,.post-content pre{font-size:11.9px;font-size:.85rem}.post-content :not(pre)>code,.post-content pre{background:#f5f5f5}.post-content pre{padding:14px;padding:1rem;overflow:auto;color:#000}.post-content :not(pre)>code{display:inline-block;padding:0 3.815px;padding:0 .2725rem;white-space:normal}.post-content a code{background:transparent none repeat 0 0/auto auto padding-box border-box scroll;background:initial;font-size:13.719px;font-size:.98rem;padding:0;padding:initial}.post-content p:first-child{margin-top:0}.post-content h2,.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3{font-size:22.75px;font-size:1.625rem}.post-content h4{font-size:19.446px;font-size:1.389rem}.post-content h5{font-size:16.142px;font-size:1.153rem}.post-content h6{font-size:13.034px;font-size:.931rem}.post-content .post-header-anchor{position:absolute;left:-14px;left:-1rem;top:20px;width:14px;width:1rem;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:0 0;text-align:center;line-height:1;text-shadow:none;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}@media (min-width:470px){.post-content .post-header-anchor{left:-2rem;top:20px;width:2rem}}.post-content .post-header-anchor:focus{outline:0}.post-content .post-header-anchor:hover svg{opacity:1}.post-content .post-header-anchor:after{content:" copied";position:absolute;bottom:-14px;left:0;right:0;font-size:.6em;color:gray;opacity:0;visibility:none;-webkit-transition:opacity 2s;transition:opacity 2s}.post-content .post-header-anchor svg{opacity:.2}.post-content h4 .post-header-anchor{top:18px}.post-content h5 .post-header-anchor{top:16px}.post-content h6 .post-header-anchor{top:14px}.post-content .post-header-anchor--copied:after{opacity:1}.post-content p:last-of-type{margin-bottom:0}.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3+p,.post-content h4+p,.post-content h5+p,.post-content h6+p{margin-top:7px;margin-top:.5rem}.post-content p+h3,.post-content p+h4,.post-content p+h5,.post-content p+h6{margin-top:28px;margin-top:2rem}.post-content ol,.post-content ul{padding-left:1.25em;list-style:disc outside none;list-style:initial}.post-content ol{list-style-type:decimal}.post-content li{margin-bottom:7px;margin-bottom:.5rem}.post-summary .post-content,.post-summary .post-content>*{display:inline}.post-content table{border-spacing:0;border-collapse:collapse}.post-content td,.post-content th{padding:0;padding:6px 13px;border:1px solid #dfe2e5}.post-content th{font-weight:600;text-align:left}.post-title-wrapper{margin:0}.post-title{line-height:1.4;font-size:19.599px;font-size:1.4rem;font-weight:700}.wf-active .post-title{font-size:21px;font-size:1.5rem;line-height:1.2}@media (min-width:30rem){.post-title{line-height:1.6;font-size:1.85rem}.wf-active .post-title{line-height:1.5;font-size:2rem}}.post-title-label{display:inline-block;position:relative;bottom:.3em;padding:.2em .4em;margin-left:.3em;font-size:.5em;background:#e3e3e3;color:#9e9e9e;border-radius:5%;font-weight:400;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in}.post-title:hover .post-title-label{opacity:.9}.post-title-label-parenthesis{display:none}.post-meta{font-size:12.6px;font-size:.9rem;margin:14px 0;margin:1rem 0;color:#a2a2a2}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.post-meta{color:#000;font-weight:300}}.post-blog-date{display:block;margin-top:7px;margin-top:.5rem}@media (min-width:30rem){.post-blog-date{display:inline;margin-top:0}.post-blog-date+.post-blog-title:before{display:inline-block;content:" \2014   ";margin:0 .25rem 0 .5rem}}.post-blog-link{font-weight:400;font-style:italic}.footer-link,.post-blog-link,.post-read-more-link,.post-title,.site-happy-text-headline-link,.site-happy-text-tagline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link:hover,.post-blog-link:hover,.post-read-more-link:hover,.post-title:hover,.site-happy-text-headline-link:hover,.site-happy-text-tagline-link:hover{color:#6882c5;background:-webkit-gradient(linear,left top,right top,from(#5c7b8f),to(#6882c5));background:linear-gradient(90deg,#5c7b8f,#6882c5);background-clip:border-box;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-box-decoration-break:clone;box-decoration-break:clone}.footer-link,.post-read-more-link,.post-title,.site-happy-text-tagline-link{color:#5c7b8f}.post-read-more-link{display:inline-block;font-weight:700;margin:0}.post-comments{margin:28px 28px 0;margin:2rem 2rem 0;padding:28px;padding:2rem;background:#fff}@media (min-width:62rem){.post-comments{margin-left:0;margin-right:0}}.post-comments a{color:#5c7b8f;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(rgba(0,0,0,.2)));background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-comments a:hover{color:#6882c5}@media (min-width:62rem){.more-articles{padding-left:0;padding-right:0}}.footer{text-align:center;font-size:11.2px;font-size:.8rem;margin-bottom:28px;margin-bottom:2rem}.footer-text{margin:0}.footer-link{font-weight:700}.copyright{display:block;color:gray}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.copyright{font-weight:100}}.fix-bug-ignore{color:red}.posts{position:relative}.post-wrapper{-webkit-transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out}.post{-webkit-transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out,-webkit-transform .1s ease-in-out}.posts--entering-post .post-wrapper:not(.post-wrapper--entering-from-posts) .post{opacity:.2;-webkit-transform:scale(.8);transform:scale(.8)}.posts--entering-post .post-wrapper--entering-from-posts{left:0;right:0}@media (min-width:62rem){.posts--entering-post .post-wrapper--entering-from-posts{margin-left:2rem;margin-right:2rem}}.post-skeleton{line-height:1.55;position:relative;opacity:0;max-height:0;overflow:hidden}.post-skeleton.post-skeleton--visible,.post-wrapper--entering-from-posts .post-skeleton{opacity:1;margin-top:28px;margin-top:2rem;max-height:none}.post-skeleton:after{content:" ";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;opacity:.2;-webkit-animation:1s skeleton infinite ease-in-out;animation:1s skeleton infinite ease-in-out}.post-skeleton-word{height:15.4px;height:1.1rem;background:#f7f7f7;width:46px;display:inline-block;margin:4px 6px 0 0}.post-skeleton-word:nth-child(2n){width:36px}.post-skeleton-word:nth-child(3n){width:76px}.post-skeleton+.post-skeleton .post-skeleton-word:nth-child(3n){width:71px}.post-skeleton-word:nth-child(5n){width:96px}.post-skeleton-word:nth-child(6n){width:63px}.post-skeleton-word:nth-child(7n){width:26px}@-webkit-keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}</style><style data-vue-ssr-id="1629eadd:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style>
    <script src="https://unpkg.com/scrollto-with-animation/dist/scrollto-with-animation.min.js"></script>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#869bad;opacity:0"></div><div id="__layout"><div class="wrapper"><main class="content"><header class="header"><h1 class="site-title"><a href="/" class="site-link nuxt-link-active">Adam Lynch</a></h1><div class="site-happy-text-wrapper"><p class="site-happy-text"><span class="site-happy-text-headline">
                I'm <a href="/" class="site-happy-text-headline-link nuxt-link-active">Adam Lynch</a>.
            </span><span class="site-happy-text-tagline">
                I like to
                <a href="https://github.com/adam-lynch" class="site-happy-text-tagline-link">code</a>,
                <a href="/" class="site-happy-text-tagline-link nuxt-link-active">write</a>, and dabble in design.
            </span><span class="site-happy-text-tagline">
                I lead <a href="https://www.teamwork.com" class="site-happy-text-tagline-link">Teamwork.com</a>'s next product.
            </span></div><nav class="navigation-wrapper" role="navigation"><ul class="navigation"><li class="navigation-item writing-navigation-item"><a href="/" class="navigation-link nuxt-link-active"><span class="navigation-item-text">Writing</span></a><li class="navigation-item code-navigation-item"><a href="https://github.com/adam-lynch" class="navigation-link" rel="noopener"><span class="navigation-item-text">Code</span></a><li class="navigation-item edit-navigation-item"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="navigation-link" rel="noopener"><span class="navigation-item-text">Edit page</span></a><li class="navigation-item twitter-navigation-item"><a href="https://twitter.com/lynchy010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">Twitter</span></a><li class="navigation-item email-navigation-item"><a href="mailto:contact@adamlynch.com" class="navigation-link" rel="noopener"><span class="navigation-item-text">Email</span></a><li class="navigation-item linkedin-navigation-item"><a href="https://www.linkedin.com/in/adamlynch010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">LinkedIn</span></a></ul></nav></header><div class="post-page-post-wrapper"><article class="post"><h2 class="post-title-wrapper"><a href="/platform-detection" class="post-title nuxt-link-exact-active nuxt-link-active">Platform detection in your NW.js app</a></h2><div class="post-meta"><time class="post-blog-date">January 26th, 2016</time><div class="no-ssr-placeholder"></div></div><div class="post-content">
<p>There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's <a href="https://nodejs.org/api/os.html#os_os_platform" rel="noopener"><code>os</code></a> module, it isn't too difficult.</p>
<h3><a href="#which-operating-system" class="post-header-anchor" id="which-operating-system" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which operating system?</h3>
<p>On Mac, Linux and Windows, the following script would output <code>darwin</code>, <code>linux</code> and <code>win32</code> or <code>win64</code> respectively.</p>
<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The other possible return values of <code>os.platform()</code> are <code>freebsd</code> and <code>sunos</code>. Note this code can be used in either the main or renderer processes.</p>
<h3><a href="#which-linux-distribution" class="post-header-anchor" id="which-linux-distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which Linux distribution?</h3>
<p>Figuring this out is a bit more problematic. The <code>uname -v</code> command returns some information like the following if ran on Ubuntu: <code>#42~precise1-Ubuntu SMP Wed Aug 14 15:31:16 UTC 2013</code>. You could spawn this command via io.js' <a href="https://nodejs.org/api/child_process.html" rel="noopener"><code>child_process</code></a> module or any of the countless similar modules on <code>npm</code>.</p>
<p>This doesn't give you much though, it's probably safest to check for and read distrubtion-specific release information files (with the io.js' <a href="https://nodejs.org/api/fs.html" rel="noopener"><code>fs</code></a> module) which include:</p>
<table>
<thead>
<tr>
<th style="text-align:right">Distribution</th>
<th>File(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Debian</td>
<td><code>/etc/debian_release</code> and <code>/etc/debian_version</code> but be careful as these also exist on Ubuntu.</td>
</tr>
<tr>
<td style="text-align:right">Fedora</td>
<td><code>/etc/fedora-release</code></td>
</tr>
<tr>
<td style="text-align:right">Gentoo</td>
<td><code>/etc/gentoo-release</code></td>
</tr>
<tr>
<td style="text-align:right">Mandrake</td>
<td><code>/etc/mandrake-release</code></td>
</tr>
<tr>
<td style="text-align:right">Novell SUSE</td>
<td><code>/etc/SUSE-release</code></td>
</tr>
<tr>
<td style="text-align:right">Red Hat</td>
<td><code>/etc/redhat-release</code> and <code>/etc/redhat_version</code></td>
</tr>
<tr>
<td style="text-align:right">Slackware</td>
<td><code>/etc/slackware-release</code> and <code>/etc/slackware-version</code></td>
</tr>
<tr>
<td style="text-align:right">Solaris / Sparc</td>
<td><code>/etc/release</code></td>
</tr>
<tr>
<td style="text-align:right">Sun JDS</td>
<td><code>/etc/sun-release</code></td>
</tr>
<tr>
<td style="text-align:right">UnitedLinux</td>
<td><code>/etc/UnitedLinux-release</code></td>
</tr>
<tr>
<td style="text-align:right">Ubuntu</td>
<td><code>/etc/lsb-release</code> and <code>/etc/os-release</code></td>
</tr>
<tr>
<td style="text-align:right">Yellow dog</td>
<td><code>/etc/yellowdog-release</code></td>
</tr>
</tbody>
</table>
<p>Keep in mind that the format of each of these files can differ. An example <code>/etc/lsb-release</code> file:</p>
<pre><code>DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=12.04
DISTRIB_CODENAME=precise
DISTRIB_DESCRIPTION="Ubuntu 12.04.3 LTS"
</code></pre>
<p>An example <code>/etc/os-release</code> file:</p>
<pre><code>NAME="Ubuntu"
VERSION="12.04.3 LTS, Precise Pangolin"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu precise (12.04.3 LTS)"
VERSION_ID="12.04"
</code></pre>
<h3><a href="#32-bit-or-64-bit-architecture" class="post-header-anchor" id="32-bit-or-64-bit-architecture" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>32-bit or 64-bit architecture?</h3>
<p>The safest way to check this is to use <code>os.arch()</code> in combination with system environment variables; the following script will output <code>32</code> or <code>64</code> depending on the architecture:</p>
<pre><code class="language-javascript"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'x64'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'PROCESSOR_ARCHITEW6432'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>is64Bit <span class="token operator">?</span> <span class="token number">64</span> <span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a href="#version-detection" class="post-header-anchor" id="version-detection" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Version detection</h2>
<p>This is a bit trickier. <code>os.release()</code> returns the platform version but it is not what you'd expect it to be. It will return the actual internal (not sure if this is the right word?) operating system version. You might expect the return value to be <code>10.0.0</code> when called on Mac OSX Yosemite but it will in fact return <code>14.0.0</code>. To see the mappings between Darwin and Mac release versions, see the <a href="http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history" rel="noopener"><em>Darwin (operating system)</em></a> Wikipedia entry.</p>
<p>Microsoft <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx" rel="noopener">provide</a> Windows' versions but you may need to do some testing yourself to be safe as you can see both Windows 8 and Windows Server 2012 are both listed as being <code>9.2</code>. In my experience, it's safe to check against <code>6.2.9200</code> but don't take my word for it.</p>
<p><code>os.release()</code> will return whatever <code>uname -v</code> would return on Linux (e.g. <code>3.8.0-29-generic</code> on Ubuntu 12.04.3 LTS) so it's safer to read the distribution-specific release information file(s) we saw earlier.</p>
<h3><a href="#the-finished-article" class="post-header-anchor" id="the-finished-article" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The finished article</h3>
<p>The final version of our <code>platform.js</code> module looks like this:</p>
<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token punctuation">{</span>
  isLinux<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  isMac<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  isWindows<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  isWindows8<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  version<span class="token punctuation">:</span> os<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">/**
 * Checks if the current platform version is greater than or equal to the desired minimum version given
 *
 * @param minimumVersion {string} E.g. 10.0.0.
 * See [the Darwin operating system Wikipedia entry](http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history) for Mac - Darwin versions.
 * Also, Windows 8 >= 6.2.9200
 *
 * @returns {boolean}
 */</span>
<span class="token keyword">var</span> <span class="token function-variable function">isOfMinimumVersion</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>minimumVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> actualVersionPieces <span class="token operator">=</span> platform<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    pieces <span class="token operator">=</span> minimumVersion<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    numberOfPieces <span class="token operator">=</span> pieces<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numberOfPieces<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> piece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      actualPiece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>actualVersionPieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> actualPiece <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// e.g. 13.1 passed and actual is 13.1.0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">></span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// doesn't matter what the next bits are, the major version (or whatever) is larger</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">===</span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// to check next version piece</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// all was ok</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> name <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'mac'</span><span class="token punctuation">;</span>
  platform<span class="token punctuation">.</span>isMac <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">'linux'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">;</span>
  platform<span class="token punctuation">.</span>isLinux <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span>
  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'windows'</span><span class="token punctuation">;</span>
  platform<span class="token punctuation">.</span>isWindows <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">=</span> <span class="token function">isOfMinimumVersion</span><span class="token punctuation">(</span><span class="token string">'6.2.9200'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

platform<span class="token punctuation">.</span>is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'x64'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'PROCESSOR_ARCHITEW6432'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> platform<span class="token punctuation">;</span>
</code></pre>
<p>Take note of our <code>isOfMinimumVersion</code> method and <code>isWindows8</code> property.</p>
<p>So then, from anywhere in your app you could <code>require</code> this module and use it for platform-specific code where needs be. For example:</p>
<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./platform'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isMac<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// do something</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">&&</span> platform<span class="token punctuation">.</span>is64bit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something else</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a href="#platform-dependent-styles" class="post-header-anchor" id="platform-dependent-styles" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Platform-dependent styles</h3>
<p>You may have spotted that our <code>platforms.js</code> module exports a <code>name</code> property. This is really useful for applying platform-specific styles. To achieve differing styles per platform, we'll use this <code>name</code> property to add a <code>platform-</code> class to our <code>body</code> element:</p>
<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./platform'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'platform-'</span> <span class="token operator">+</span> platform<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Note that I've used <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList" rel="noopener"><code>Element.classList</code></a> here which <a href="http://caniuse.com/#feat=classlist" rel="noopener">isn't supported</a> by a lot of browsers people currently use. The great thing about Electron is we can ignore that. We know that it'll be fine for 100% of our app's users.</p>
<p>So then we can change the styling of certain elements based on the current platform. Let's say you have some nice custom button styles and you'd like them to be a bit rounder on Mac OS X. All we have to do is use this <code>platform-</code> class in our CSS:</p>
<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>
  // your custom styles
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>So any elements with the <code>button</code> class look like just like the custom buttons you designed (or grabbed from <a href="http://codepen.io/" rel="noopener">CodePen</a>) but if the <code>platform-mac</code> class exists on an ancestor, i.e. the <code>body</code> element, then the buttons' corners are a little more rounded.</p>
<p>You could easily go a little further and add certain classes depending on the given platform version. You could add a <code>platform-windows-8</code> class to the <code>body</code> if <code>platform.isWindows8</code> is <code>true</code> and then make the buttons' <a href="https://en.wikipedia.org/wiki/Metro_(design_language)" rel="noopener">square-cornered</a> if it exists;</p>
<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>
  // your custom styles
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.platform-windows-8 .button</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>That's it! Feel free to take this, use it, abuse it, build on top of it, or whatever you'd like. Go wild.</p>
</div></article><aside><div class="post-comments"><p>Feedback is more than welcome via <a href="https://twitter.com/lynchy010">@lynchy010</a> or <a href="mailto:contact@adamlynch.com">contact@adamlynch.com</a></div><div class="no-ssr-placeholder"></div></aside></div><footer class="footer"><p class="footer-text"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="footer-link">This site is open source</a><span class="copyright"> 2019 Adam Lynch</span></footer></main></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{article:{id:"platform-detection",slug:"platform-detection",highlightedLanguages:["js","","javascript","css"],source:"---\ndate: 2016-01-26\noriginal:\n  blogLink: https://www.packtpub.com/books/content/blogs\n  blogName: Packt books\n  url: https://www.packtpub.com/books/content/transparency-and-nwjs\ntags:\n  - node-webkit\n  - desktop\n  - javascript\n  - platform\n  - linux\n  - mac\n  - windows\n  - development\n---\n\n## Platform detection in your NW.js app\n\n:::summary\n\nThere are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's [`os`](https://nodejs.org/api/os.html#os_os_platform) module, it isn't too difficult.\n\n:::\n\n### Which operating system?\n\nOn Mac, Linux and Windows, the following script would output `darwin`, `linux` and `win32` or `win64` respectively.\n\n```js\nvar os = require('os');\nconsole.log(os.platform());\n```\n\nThe other possible return values of `os.platform()` are `freebsd` and `sunos`. Note this code can be used in either the main or renderer processes.\n\n### Which Linux distribution?\n\nFiguring this out is a bit more problematic. The `uname -v` command returns some information like the following if ran on Ubuntu: `#42~precise1-Ubuntu SMP Wed Aug 14 15:31:16 UTC 2013`. You could spawn this command via io.js' [`child_process`](https://nodejs.org/api/child_process.html) module or any of the countless similar modules on `npm`.\n\nThis doesn't give you much though, it's probably safest to check for and read distrubtion-specific release information files (with the io.js' [`fs`](https://nodejs.org/api/fs.html) module) which include:\n\n| Distribution | File(s) |\n|-:|-|\n| Debian | `/etc/debian_release` and `/etc/debian_version` but be careful as these also exist on Ubuntu. |\n| Fedora | `/etc/fedora-release` |\n| Gentoo | `/etc/gentoo-release` |\n| Mandrake | `/etc/mandrake-release` |\n| Novell SUSE | `/etc/SUSE-release` |\n| Red Hat | `/etc/redhat-release` and `/etc/redhat_version` |\n| Slackware | `/etc/slackware-release` and `/etc/slackware-version` |\n| Solaris / Sparc | `/etc/release` |\n| Sun JDS | `/etc/sun-release` |\n| UnitedLinux | `/etc/UnitedLinux-release` |\n| Ubuntu | `/etc/lsb-release` and `/etc/os-release` |\n| Yellow dog | `/etc/yellowdog-release` |\n\nKeep in mind that the format of each of these files can differ. An example `/etc/lsb-release` file:\n\n```\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION=\"Ubuntu 12.04.3 LTS\"\n```\n\nAn example `/etc/os-release` file:\n\n```\nNAME=\"Ubuntu\"\nVERSION=\"12.04.3 LTS, Precise Pangolin\"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME=\"Ubuntu precise (12.04.3 LTS)\"\nVERSION_ID=\"12.04\"\n```\n\n\n### 32-bit or 64-bit architecture?\n\nThe safest way to check this is to use `os.arch()` in combination with system environment variables; the following script will output `32` or `64` depending on the architecture:\n\n```javascript\nvar os = require('os');\nvar is64Bit = os.arch() === 'x64' || process.env.hasOwnProperty('PROCESSOR_ARCHITEW6432');\nconsole.log(is64Bit ? 64 : 32);\n```\n\n## Version detection\n\nThis is a bit trickier. `os.release()` returns the platform version but it is not what you'd expect it to be. It will return the actual internal (not sure if this is the right word?) operating system version. You might expect the return value to be `10.0.0` when called on Mac OSX Yosemite but it will in fact return `14.0.0`. To see the mappings between Darwin and Mac release versions, see the [*Darwin (operating system)*](http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history) Wikipedia entry. \n\nMicrosoft [provide](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx) Windows' versions but you may need to do some testing yourself to be safe as you can see both Windows 8 and Windows Server 2012 are both listed as being `9.2`. In my experience, it's safe to check against `6.2.9200` but don't take my word for it. \n\n`os.release()` will return whatever `uname -v` would return on Linux (e.g. `3.8.0-29-generic` on Ubuntu 12.04.3 LTS) so it's safer to read the distribution-specific release information file(s) we saw earlier.\n\n### The finished article\n\nThe final version of our `platform.js` module looks like this:\n\n```js\nvar os = require('os');\n\nvar platform = {\n  isLinux: false,\n  isMac: false,\n  isWindows: false,\n  isWindows8: false,\n  version: os.release()\n};\n\n\n/**\n * Checks if the current platform version is greater than or equal to the desired minimum version given\n *\n * @param minimumVersion {string} E.g. 10.0.0.\n * See [the Darwin operating system Wikipedia entry](http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history) for Mac - Darwin versions.\n * Also, Windows 8 >= 6.2.9200\n *\n * @returns {boolean}\n */\nvar isOfMinimumVersion = function(minimumVersion){\n  var actualVersionPieces = platform.version.split('.'),\n    pieces = minimumVersion.split('.'),\n    numberOfPieces = pieces.length;\n\n  for(var i = 0; i < numberOfPieces; i++){\n    var piece = parseInt(pieces[i], 10),\n      actualPiece = parseInt(actualVersionPieces[i], 10);\n\n    if (typeof actualPiece === 'undefined') {\n      break; // e.g. 13.1 passed and actual is 13.1.0\n    }\n    else if (actualPiece > piece) {\n      break; // doesn't matter what the next bits are, the major version (or whatever) is larger\n    }\n    else if (actualPiece === piece) {\n      continue; // to check next version piece\n    }\n    else {\n      return false;\n    }\n  }\n\n  return true; // all was ok\n};\n\n\nvar name = os.platform();\n\nif(name === 'darwin'){\n  platform.name = 'mac';\n  platform.isMac = true;\n}\nelse if(name === 'linux'){\n  platform.name = 'linux';\n  platform.isLinux = true;\n}\nelse {\n  platform.name = 'windows';\n  platform.isWindows = true;\n  platform.isWindows8 = isOfMinimumVersion('6.2.9200');\n}\n\nplatform.is64Bit = os.arch() === 'x64' || process.env.hasOwnProperty('PROCESSOR_ARCHITEW6432');\n\nmodule.exports = platform;\n```\n\nTake note of our `isOfMinimumVersion` method and `isWindows8` property.\n\nSo then, from anywhere in your app you could `require` this module and use it for platform-specific code where needs be. For example:\n\n```javascript\nvar platform = require('./platform');\n\nif(platform.isMac){\n  // do something\n}\nelse if(platform.isWindows8 && platform.is64bit) {\n  // do something else\n}\n```\n\n### Platform-dependent styles\n\nYou may have spotted that our `platforms.js` module exports a `name` property. This is really useful for applying platform-specific styles. To achieve differing styles per platform, we'll use this `name` property to add a `platform-` class to our `body` element:\n\n```javascript\nvar platform = require('./platform');\ndocument.body.classList.add('platform-' + platform.name);\n```\n\nNote that I've used [`Element.classList`](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList) here which [isn't supported](http://caniuse.com/#feat=classlist) by a lot of browsers people currently use. The great thing about Electron is we can ignore that. We know that it'll be fine for 100% of our app's users.\n\nSo then we can change the styling of certain elements based on the current platform. Let's say you have some nice custom button styles and you'd like them to be a bit rounder on Mac OS X. All we have to do is use this `platform-` class in our CSS:\n\n```css\n.button {\n  // your custom styles\n  border-radius: 3px;\n}\n\n.platform-mac .button {\n  border-radius: 5px;\n}\n```\n\nSo any elements with the `button` class look like just like the custom buttons you designed (or grabbed from [CodePen](http://codepen.io/)) but if the `platform-mac` class exists on an ancestor, i.e. the `body` element, then the buttons' corners are a little more rounded.\n\nYou could easily go a little further and add certain classes depending on the given platform version. You could add a `platform-windows-8` class to the `body` if `platform.isWindows8` is `true` and then make the buttons' [square-cornered](https://en.wikipedia.org/wiki/Metro_(design_language)) if it exists;\n\n```css\n.button {\n  // your custom styles\n  border-radius: 3px;\n}\n\n.platform-mac .button {\n  border-radius: 5px;\n}\n\n.platform-windows-8 .button {\n  border-radius: 0;\n}\n```\n\nThat's it! Feel free to take this, use it, abuse it, build on top of it, or whatever you'd like. Go wild.\n",unfilteredRenderedBody:'<h2><a id="platform-detection-in-your-nwjs-app" class="post-header-anchor" href="#platform-detection-in-your-nwjs-app" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Platform detection in your NW.js app</h2>\n<article-summary><p>There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node\'s <a href="https://nodejs.org/api/os.html#os_os_platform" rel="noopener"><code>os</code></a> module, it isn\'t too difficult.</p>\n</article-summary><h3><a id="which-operating-system" class="post-header-anchor" href="#which-operating-system" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which operating system?</h3>\n<p>On Mac, Linux and Windows, the following script would output <code>darwin</code>, <code>linux</code> and <code>win32</code> or <code>win64</code> respectively.</p>\n<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>The other possible return values of <code>os.platform()</code> are <code>freebsd</code> and <code>sunos</code>. Note this code can be used in either the main or renderer processes.</p>\n<h3><a id="which-linux-distribution" class="post-header-anchor" href="#which-linux-distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which Linux distribution?</h3>\n<p>Figuring this out is a bit more problematic. The <code>uname -v</code> command returns some information like the following if ran on Ubuntu: <code>#42~precise1-Ubuntu SMP Wed Aug 14 15:31:16 UTC 2013</code>. You could spawn this command via io.js\' <a href="https://nodejs.org/api/child_process.html" rel="noopener"><code>child_process</code></a> module or any of the countless similar modules on <code>npm</code>.</p>\n<p>This doesn\'t give you much though, it\'s probably safest to check for and read distrubtion-specific release information files (with the io.js\' <a href="https://nodejs.org/api/fs.html" rel="noopener"><code>fs</code></a> module) which include:</p>\n<table>\n<thead>\n<tr>\n<th style="text-align:right">Distribution</th>\n<th>File(s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style="text-align:right">Debian</td>\n<td><code>/etc/debian_release</code> and <code>/etc/debian_version</code> but be careful as these also exist on Ubuntu.</td>\n</tr>\n<tr>\n<td style="text-align:right">Fedora</td>\n<td><code>/etc/fedora-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Gentoo</td>\n<td><code>/etc/gentoo-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Mandrake</td>\n<td><code>/etc/mandrake-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Novell SUSE</td>\n<td><code>/etc/SUSE-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Red Hat</td>\n<td><code>/etc/redhat-release</code> and <code>/etc/redhat_version</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Slackware</td>\n<td><code>/etc/slackware-release</code> and <code>/etc/slackware-version</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Solaris / Sparc</td>\n<td><code>/etc/release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Sun JDS</td>\n<td><code>/etc/sun-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">UnitedLinux</td>\n<td><code>/etc/UnitedLinux-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Ubuntu</td>\n<td><code>/etc/lsb-release</code> and <code>/etc/os-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Yellow dog</td>\n<td><code>/etc/yellowdog-release</code></td>\n</tr>\n</tbody>\n</table>\n<p>Keep in mind that the format of each of these files can differ. An example <code>/etc/lsb-release</code> file:</p>\n<pre><code>DISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION="Ubuntu 12.04.3 LTS"\n</code></pre>\n<p>An example <code>/etc/os-release</code> file:</p>\n<pre><code>NAME="Ubuntu"\nVERSION="12.04.3 LTS, Precise Pangolin"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME="Ubuntu precise (12.04.3 LTS)"\nVERSION_ID="12.04"\n</code></pre>\n<h3><a id="32-bit-or-64-bit-architecture" class="post-header-anchor" href="#32-bit-or-64-bit-architecture" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>32-bit or 64-bit architecture?</h3>\n<p>The safest way to check this is to use <code>os.arch()</code> in combination with system environment variables; the following script will output <code>32</code> or <code>64</code> depending on the architecture:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">\'x64\'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">\'PROCESSOR_ARCHITEW6432\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>is64Bit <span class="token operator">?</span> <span class="token number">64</span> <span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h2><a id="version-detection" class="post-header-anchor" href="#version-detection" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Version detection</h2>\n<p>This is a bit trickier. <code>os.release()</code> returns the platform version but it is not what you\'d expect it to be. It will return the actual internal (not sure if this is the right word?) operating system version. You might expect the return value to be <code>10.0.0</code> when called on Mac OSX Yosemite but it will in fact return <code>14.0.0</code>. To see the mappings between Darwin and Mac release versions, see the <a href="http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history" rel="noopener"><em>Darwin (operating system)</em></a> Wikipedia entry.</p>\n<p>Microsoft <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx" rel="noopener">provide</a> Windows\' versions but you may need to do some testing yourself to be safe as you can see both Windows 8 and Windows Server 2012 are both listed as being <code>9.2</code>. In my experience, it\'s safe to check against <code>6.2.9200</code> but don\'t take my word for it.</p>\n<p><code>os.release()</code> will return whatever <code>uname -v</code> would return on Linux (e.g. <code>3.8.0-29-generic</code> on Ubuntu 12.04.3 LTS) so it\'s safer to read the distribution-specific release information file(s) we saw earlier.</p>\n<h3><a id="the-finished-article" class="post-header-anchor" href="#the-finished-article" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The finished article</h3>\n<p>The final version of our <code>platform.js</code> module looks like this:</p>\n<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token punctuation">{</span>\n  isLinux<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isMac<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isWindows<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isWindows8<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  version<span class="token punctuation">:</span> os<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n\n<span class="token comment">/**\n * Checks if the current platform version is greater than or equal to the desired minimum version given\n *\n * @param minimumVersion {string} E.g. 10.0.0.\n * See [the Darwin operating system Wikipedia entry](http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history) for Mac - Darwin versions.\n * Also, Windows 8 >= 6.2.9200\n *\n * @returns {boolean}\n */</span>\n<span class="token keyword">var</span> <span class="token function-variable function">isOfMinimumVersion</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>minimumVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token keyword">var</span> actualVersionPieces <span class="token operator">=</span> platform<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    pieces <span class="token operator">=</span> minimumVersion<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    numberOfPieces <span class="token operator">=</span> pieces<span class="token punctuation">.</span>length<span class="token punctuation">;</span>\n\n  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numberOfPieces<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">var</span> piece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      actualPiece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>actualVersionPieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> actualPiece <span class="token operator">===</span> <span class="token string">\'undefined\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// e.g. 13.1 passed and actual is 13.1.0</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">></span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// doesn\'t matter what the next bits are, the major version (or whatever) is larger</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">===</span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// to check next version piece</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// all was ok</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n\n<span class="token keyword">var</span> name <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">\'darwin\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'mac\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isMac <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">\'linux\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'linux\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isLinux <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'windows\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isWindows <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">=</span> <span class="token function">isOfMinimumVersion</span><span class="token punctuation">(</span><span class="token string">\'6.2.9200\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\nplatform<span class="token punctuation">.</span>is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">\'x64\'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">\'PROCESSOR_ARCHITEW6432\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> platform<span class="token punctuation">;</span>\n</code></pre>\n<p>Take note of our <code>isOfMinimumVersion</code> method and <code>isWindows8</code> property.</p>\n<p>So then, from anywhere in your app you could <code>require</code> this module and use it for platform-specific code where needs be. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./platform\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isMac<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// do something</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">&amp;&amp;</span> platform<span class="token punctuation">.</span>is64bit<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// do something else</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<h3><a id="platform-dependent-styles" class="post-header-anchor" href="#platform-dependent-styles" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Platform-dependent styles</h3>\n<p>You may have spotted that our <code>platforms.js</code> module exports a <code>name</code> property. This is really useful for applying platform-specific styles. To achieve differing styles per platform, we\'ll use this <code>name</code> property to add a <code>platform-</code> class to our <code>body</code> element:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./platform\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\ndocument<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">\'platform-\'</span> <span class="token operator">+</span> platform<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Note that I\'ve used <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList" rel="noopener"><code>Element.classList</code></a> here which <a href="http://caniuse.com/#feat=classlist" rel="noopener">isn\'t supported</a> by a lot of browsers people currently use. The great thing about Electron is we can ignore that. We know that it\'ll be fine for 100% of our app\'s users.</p>\n<p>So then we can change the styling of certain elements based on the current platform. Let\'s say you have some nice custom button styles and you\'d like them to be a bit rounder on Mac OS X. All we have to do is use this <code>platform-</code> class in our CSS:</p>\n<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>\n  // your custom styles\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>So any elements with the <code>button</code> class look like just like the custom buttons you designed (or grabbed from <a href="http://codepen.io/" rel="noopener">CodePen</a>) but if the <code>platform-mac</code> class exists on an ancestor, i.e. the <code>body</code> element, then the buttons\' corners are a little more rounded.</p>\n<p>You could easily go a little further and add certain classes depending on the given platform version. You could add a <code>platform-windows-8</code> class to the <code>body</code> if <code>platform.isWindows8</code> is <code>true</code> and then make the buttons\' <a href="https://en.wikipedia.org/wiki/Metro_(design_language)" rel="noopener">square-cornered</a> if it exists;</p>\n<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>\n  // your custom styles\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-windows-8 .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>That\'s it! Feel free to take this, use it, abuse it, build on top of it, or whatever you\'d like. Go wild.</p>\n',attributes:{date:"2016-01-26T00:00:00.000Z",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/transparency-and-nwjs"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"platform",name:"platform"},{id:"linux",name:"linux"},{id:"mac",name:"mac"},{id:"windows",name:"windows"},{id:"development",name:"development"}],title:"Platform detection in your NW.js app",updated_at:"2019-05-22T08:26:07.886Z"},title:"Platform detection in your NW.js app",renderedSummary:'<p>There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node\'s <a href="https://nodejs.org/api/os.html#os_os_platform" rel="noopener"><code>os</code></a> module, it isn\'t too difficult.</p>\n',rendered:'<h2><a id="platform-detection-in-your-nwjs-app" class="post-header-anchor" href="#platform-detection-in-your-nwjs-app" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Platform detection in your NW.js app</h2>\n<p>There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node\'s <a href="https://nodejs.org/api/os.html#os_os_platform" rel="noopener"><code>os</code></a> module, it isn\'t too difficult.</p>\n<h3><a id="which-operating-system" class="post-header-anchor" href="#which-operating-system" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which operating system?</h3>\n<p>On Mac, Linux and Windows, the following script would output <code>darwin</code>, <code>linux</code> and <code>win32</code> or <code>win64</code> respectively.</p>\n<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>The other possible return values of <code>os.platform()</code> are <code>freebsd</code> and <code>sunos</code>. Note this code can be used in either the main or renderer processes.</p>\n<h3><a id="which-linux-distribution" class="post-header-anchor" href="#which-linux-distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Which Linux distribution?</h3>\n<p>Figuring this out is a bit more problematic. The <code>uname -v</code> command returns some information like the following if ran on Ubuntu: <code>#42~precise1-Ubuntu SMP Wed Aug 14 15:31:16 UTC 2013</code>. You could spawn this command via io.js\' <a href="https://nodejs.org/api/child_process.html" rel="noopener"><code>child_process</code></a> module or any of the countless similar modules on <code>npm</code>.</p>\n<p>This doesn\'t give you much though, it\'s probably safest to check for and read distrubtion-specific release information files (with the io.js\' <a href="https://nodejs.org/api/fs.html" rel="noopener"><code>fs</code></a> module) which include:</p>\n<table>\n<thead>\n<tr>\n<th style="text-align:right">Distribution</th>\n<th>File(s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style="text-align:right">Debian</td>\n<td><code>/etc/debian_release</code> and <code>/etc/debian_version</code> but be careful as these also exist on Ubuntu.</td>\n</tr>\n<tr>\n<td style="text-align:right">Fedora</td>\n<td><code>/etc/fedora-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Gentoo</td>\n<td><code>/etc/gentoo-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Mandrake</td>\n<td><code>/etc/mandrake-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Novell SUSE</td>\n<td><code>/etc/SUSE-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Red Hat</td>\n<td><code>/etc/redhat-release</code> and <code>/etc/redhat_version</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Slackware</td>\n<td><code>/etc/slackware-release</code> and <code>/etc/slackware-version</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Solaris / Sparc</td>\n<td><code>/etc/release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Sun JDS</td>\n<td><code>/etc/sun-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">UnitedLinux</td>\n<td><code>/etc/UnitedLinux-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Ubuntu</td>\n<td><code>/etc/lsb-release</code> and <code>/etc/os-release</code></td>\n</tr>\n<tr>\n<td style="text-align:right">Yellow dog</td>\n<td><code>/etc/yellowdog-release</code></td>\n</tr>\n</tbody>\n</table>\n<p>Keep in mind that the format of each of these files can differ. An example <code>/etc/lsb-release</code> file:</p>\n<pre><code>DISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION="Ubuntu 12.04.3 LTS"\n</code></pre>\n<p>An example <code>/etc/os-release</code> file:</p>\n<pre><code>NAME="Ubuntu"\nVERSION="12.04.3 LTS, Precise Pangolin"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME="Ubuntu precise (12.04.3 LTS)"\nVERSION_ID="12.04"\n</code></pre>\n<h3><a id="32-bit-or-64-bit-architecture" class="post-header-anchor" href="#32-bit-or-64-bit-architecture" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>32-bit or 64-bit architecture?</h3>\n<p>The safest way to check this is to use <code>os.arch()</code> in combination with system environment variables; the following script will output <code>32</code> or <code>64</code> depending on the architecture:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">\'x64\'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">\'PROCESSOR_ARCHITEW6432\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>is64Bit <span class="token operator">?</span> <span class="token number">64</span> <span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h2><a id="version-detection" class="post-header-anchor" href="#version-detection" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Version detection</h2>\n<p>This is a bit trickier. <code>os.release()</code> returns the platform version but it is not what you\'d expect it to be. It will return the actual internal (not sure if this is the right word?) operating system version. You might expect the return value to be <code>10.0.0</code> when called on Mac OSX Yosemite but it will in fact return <code>14.0.0</code>. To see the mappings between Darwin and Mac release versions, see the <a href="http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history" rel="noopener"><em>Darwin (operating system)</em></a> Wikipedia entry.</p>\n<p>Microsoft <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx" rel="noopener">provide</a> Windows\' versions but you may need to do some testing yourself to be safe as you can see both Windows 8 and Windows Server 2012 are both listed as being <code>9.2</code>. In my experience, it\'s safe to check against <code>6.2.9200</code> but don\'t take my word for it.</p>\n<p><code>os.release()</code> will return whatever <code>uname -v</code> would return on Linux (e.g. <code>3.8.0-29-generic</code> on Ubuntu 12.04.3 LTS) so it\'s safer to read the distribution-specific release information file(s) we saw earlier.</p>\n<h3><a id="the-finished-article" class="post-header-anchor" href="#the-finished-article" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The finished article</h3>\n<p>The final version of our <code>platform.js</code> module looks like this:</p>\n<pre><code class="language-js"><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'os\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token punctuation">{</span>\n  isLinux<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isMac<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isWindows<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  isWindows8<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  version<span class="token punctuation">:</span> os<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n\n<span class="token comment">/**\n * Checks if the current platform version is greater than or equal to the desired minimum version given\n *\n * @param minimumVersion {string} E.g. 10.0.0.\n * See [the Darwin operating system Wikipedia entry](http://en.wikipedia.org/wiki/Darwin_%28operating_system%29#Release_history) for Mac - Darwin versions.\n * Also, Windows 8 >= 6.2.9200\n *\n * @returns {boolean}\n */</span>\n<span class="token keyword">var</span> <span class="token function-variable function">isOfMinimumVersion</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>minimumVersion<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token keyword">var</span> actualVersionPieces <span class="token operator">=</span> platform<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    pieces <span class="token operator">=</span> minimumVersion<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    numberOfPieces <span class="token operator">=</span> pieces<span class="token punctuation">.</span>length<span class="token punctuation">;</span>\n\n  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numberOfPieces<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">var</span> piece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      actualPiece <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>actualVersionPieces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> actualPiece <span class="token operator">===</span> <span class="token string">\'undefined\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// e.g. 13.1 passed and actual is 13.1.0</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">></span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// doesn\'t matter what the next bits are, the major version (or whatever) is larger</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actualPiece <span class="token operator">===</span> piece<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// to check next version piece</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// all was ok</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n\n<span class="token keyword">var</span> name <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">\'darwin\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'mac\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isMac <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">\'linux\'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'linux\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isLinux <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  platform<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">\'windows\'</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isWindows <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n  platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">=</span> <span class="token function">isOfMinimumVersion</span><span class="token punctuation">(</span><span class="token string">\'6.2.9200\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\nplatform<span class="token punctuation">.</span>is64Bit <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">\'x64\'</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">\'PROCESSOR_ARCHITEW6432\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> platform<span class="token punctuation">;</span>\n</code></pre>\n<p>Take note of our <code>isOfMinimumVersion</code> method and <code>isWindows8</code> property.</p>\n<p>So then, from anywhere in your app you could <code>require</code> this module and use it for platform-specific code where needs be. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./platform\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isMac<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// do something</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span>isWindows8 <span class="token operator">&amp;&amp;</span> platform<span class="token punctuation">.</span>is64bit<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// do something else</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<h3><a id="platform-dependent-styles" class="post-header-anchor" href="#platform-dependent-styles" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Platform-dependent styles</h3>\n<p>You may have spotted that our <code>platforms.js</code> module exports a <code>name</code> property. This is really useful for applying platform-specific styles. To achieve differing styles per platform, we\'ll use this <code>name</code> property to add a <code>platform-</code> class to our <code>body</code> element:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> platform <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./platform\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\ndocument<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">\'platform-\'</span> <span class="token operator">+</span> platform<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Note that I\'ve used <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList" rel="noopener"><code>Element.classList</code></a> here which <a href="http://caniuse.com/#feat=classlist" rel="noopener">isn\'t supported</a> by a lot of browsers people currently use. The great thing about Electron is we can ignore that. We know that it\'ll be fine for 100% of our app\'s users.</p>\n<p>So then we can change the styling of certain elements based on the current platform. Let\'s say you have some nice custom button styles and you\'d like them to be a bit rounder on Mac OS X. All we have to do is use this <code>platform-</code> class in our CSS:</p>\n<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>\n  // your custom styles\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>So any elements with the <code>button</code> class look like just like the custom buttons you designed (or grabbed from <a href="http://codepen.io/" rel="noopener">CodePen</a>) but if the <code>platform-mac</code> class exists on an ancestor, i.e. the <code>body</code> element, then the buttons\' corners are a little more rounded.</p>\n<p>You could easily go a little further and add certain classes depending on the given platform version. You could add a <code>platform-windows-8</code> class to the <code>body</code> if <code>platform.isWindows8</code> is <code>true</code> and then make the buttons\' <a href="https://en.wikipedia.org/wiki/Metro_(design_language)" rel="noopener">square-cornered</a> if it exists;</p>\n<pre><code class="language-css"><span class="token selector">.button</span> <span class="token punctuation">{</span>\n  // your custom styles\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-mac .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.platform-windows-8 .button</span> <span class="token punctuation">{</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>That\'s it! Feel free to take this, use it, abuse it, build on top of it, or whatever you\'d like. Go wild.</p>\n',summary:"There are various reasons why you might want to detect which platform or operating system your app is currently being ran on. Your keyboard shortcuts or UI may differ per platform, you might want to store files in platform-specific directories on disk, etc. Thanks to node's os module, it isn't too difficult.\n",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/transparency-and-nwjs"},keywords:["node-webkit","desktop","javascript","platform","linux","mac","windows","development"],published_at:"2016-01-26T00:00:00.000Z",updated_at:"2019-05-22T08:26:07.886Z",year:2016,month:1,day:27,relevanceScore:2.333333333333333,moreArticles:[{id:"transparency-and-nwjs",slug:"transparency-and-nwjs",highlightedLanguages:["json","css","javascript"],source:'---\ndate: 2016-01-26\nsummary: Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application\'s manifest like this...\noriginal:\n  blogLink: https://www.packtpub.com/books/content/blogs\n  blogName: Packt books\n  url: https://www.packtpub.com/books/content/transparency-and-nwjs\ntags:\n  - node-webkit\n  - desktop\n  - javascript\n  - platform\n  - linux\n  - mac\n  - windows\n  - development\n---\n\n## Transparency and NW.js\n\nYes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application\'s manifest like this:\n\n```json\n{\n  "name": "my-app",\n  "main": "index.html",\n  "description": "My app",\n  "version": "0.0.1",\n  "window": {\n    "transparent": true\n  }\n}\n```\n\nTransparency will then be enabled for the main window of your application from the start. Now, it\'s play time. Try giving a page\'s body a transparent or semi-transparent background color and any children an opaque background color in your CSS like this:\n\n```css\nbody {\n  background:transparent;//orbackground:rgba(255, 255, 255, 0.5);\n}\n\nbody > * {\n  background:#fff;\n}\n```\n\nI could spend all day doing this.\n\n### Programmatically enabling transparency\n\nThe transparent option can also be passed when creating a new window:\n\n```javascript\nvar gui = require(\'nw.gui\');\nvar newWindow = newgui.Window.open(\'other.html\', {\n  position: \'center\',\n  width: 600,\n  height: 800,\n  transparent: true\n});\nnewWindow.show();\n```\n\nWhether you\'re working with the current window or another window you\'ve just spawned, transparency can be toggled programmatically per window on the fly thanks to the Window API:\n\n```javascript\n  newWindow.setTransparent(true);\n  console.log(newWindow.isTransparent); // true\n```\n\nThe window\'s `setTransparent` method allows you to enable or disable transparency and its `isTransparent` property contains a Boolean indicating if it\'s enabled right now.\n\n### Support\n\nUnfortunately, there are always exceptions. Transparency isn\'t supported at all on Windows XP or earlier. In some cases it might not work on later Windows versions, including when accessing the machine via Microsoft Remote Desktop or with some unusual themes or configurations.\n\nOn Linux, transparency is supported if the window manager supports compositing. Aside from this, you\'ll also need to start your application with a couple of arguments. These can be set in your app\'s manifest under chromium-args:\n\n```json\n{\n  "name": "my-app",\n  "main": "index.html",\n  "description": "My app",\n  "version": "0.0.1",\n  "window": {\n    "transparent": true\n  },\n  "chromium-args": "--enable-transparent-visuals --disable-gpu"\n}\n```\n\n### Tips and noteworthy side-effects\n\nIt\'s best to make your app frameless if it will be semi-transparent. Otherwise it will look a bit strange. This would depend on your use case of course. Strangely, enabling transparency for a window on Mac OS X will make its frame and toolbar transparent:\n\n:::figure transparency-and-nwjs/transparent-window-frame.png Screenshot of a transparent window frame on Mac OS X \n\nBetween the community and developers behind NW.js, there isn\'t certainty whether or not windows with transparency enabled should have a shadow like typically windows do. At the time of writing, if transparency is enabled in your manifest for example, your window will not have a shadow, even if all its content is completely opaque.\n\n### Click-through\n\nNW.js even supports clicking through your transparent app to stuff behind it on your desktop, for example. This is enabled by adding a couple of runtime arguments to your chromium-args in your manifest. Namely --disable-gpu and --force-cpu-draw:\n\n```json\n{\n  "name": "my-app",\n  "main": "index.html",\n  "description": "My app",\n  "version": "0.0.1",\n  "window": {\n      "transparent": true\n  },\n  "chromium-args": "--disable-gpu --force-cpu-draw"\n}\n```\n\nAs of right now, this is only supported on Mac OS X and Windows. It only works with non-resizable frameless windows, although there may be exceptions depending on the operating system.\n\nOne other thing to note is that click-through will only be possible on areas of your app that are completely transparent. If the target element of the click or an ancestor has a background color, even if it\'s 1% opaque in the alpha channel, the click will not go through your application to whatever is behind it.\n',unfilteredRenderedBody:'<h2><a id="transparency-and-nwjs" class="post-header-anchor" href="#transparency-and-nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Transparency and NW.js</h2>\n<p>Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application\'s manifest like this:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Transparency will then be enabled for the main window of your application from the start. Now, it\'s play time. Try giving a page\'s body a transparent or semi-transparent background color and any children an opaque background color in your CSS like this:</p>\n<pre><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span>\n  <span class="token property">background</span><span class="token punctuation">:</span>transparent<span class="token punctuation">;</span>//<span class="token property">orbackground</span><span class="token punctuation">:</span><span class="token function">rgba</span><span class="token punctuation">(</span>255, 255, 255, 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">body > *</span> <span class="token punctuation">{</span>\n  <span class="token property">background</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>I could spend all day doing this.</p>\n<h3><a id="programmatically-enabling-transparency" class="post-header-anchor" href="#programmatically-enabling-transparency" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Programmatically enabling transparency</h3>\n<p>The transparent option can also be passed when creating a new window:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gui <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'nw.gui\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> newWindow <span class="token operator">=</span> newgui<span class="token punctuation">.</span>Window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">\'other.html\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  position<span class="token punctuation">:</span> <span class="token string">\'center\'</span><span class="token punctuation">,</span>\n  width<span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span>\n  height<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span>\n  transparent<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nnewWindow<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Whether you\'re working with the current window or another window you\'ve just spawned, transparency can be toggled programmatically per window on the fly thanks to the Window API:</p>\n<pre><code class="language-javascript">  newWindow<span class="token punctuation">.</span><span class="token function">setTransparent</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newWindow<span class="token punctuation">.</span>isTransparent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>\n</code></pre>\n<p>The window\'s <code>setTransparent</code> method allows you to enable or disable transparency and its <code>isTransparent</code> property contains a Boolean indicating if it\'s enabled right now.</p>\n<h3><a id="support" class="post-header-anchor" href="#support" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Support</h3>\n<p>Unfortunately, there are always exceptions. Transparency isn\'t supported at all on Windows XP or earlier. In some cases it might not work on later Windows versions, including when accessing the machine via Microsoft Remote Desktop or with some unusual themes or configurations.</p>\n<p>On Linux, transparency is supported if the window manager supports compositing. Aside from this, you\'ll also need to start your application with a couple of arguments. These can be set in your app\'s manifest under chromium-args:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"chromium-args"</span><span class="token operator">:</span> <span class="token string">"--enable-transparent-visuals --disable-gpu"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<h3><a id="tips-and-noteworthy-side-effects" class="post-header-anchor" href="#tips-and-noteworthy-side-effects" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tips and noteworthy side-effects</h3>\n<p>It\'s best to make your app frameless if it will be semi-transparent. Otherwise it will look a bit strange. This would depend on your use case of course. Strangely, enabling transparency for a window on Mac OS X will make its frame and toolbar transparent:</p>\n<figure>\n          <a href="/images/blog-content/transparency-and-nwjs/transparent-window-frame.png"><img src="/images/blog-content/transparency-and-nwjs/transparent-window-frame.png" alt=""/></a>\n          <figcaption><p>Screenshot of a transparent window frame on Mac OS X</p>\n</figcaption>\n        </figure><p>Between the community and developers behind NW.js, there isn\'t certainty whether or not windows with transparency enabled should have a shadow like typically windows do. At the time of writing, if transparency is enabled in your manifest for example, your window will not have a shadow, even if all its content is completely opaque.</p>\n<h3><a id="click-through" class="post-header-anchor" href="#click-through" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Click-through</h3>\n<p>NW.js even supports clicking through your transparent app to stuff behind it on your desktop, for example. This is enabled by adding a couple of runtime arguments to your chromium-args in your manifest. Namely --disable-gpu and --force-cpu-draw:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"chromium-args"</span><span class="token operator">:</span> <span class="token string">"--disable-gpu --force-cpu-draw"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>As of right now, this is only supported on Mac OS X and Windows. It only works with non-resizable frameless windows, although there may be exceptions depending on the operating system.</p>\n<p>One other thing to note is that click-through will only be possible on areas of your app that are completely transparent. If the target element of the click or an ancestor has a background color, even if it\'s 1% opaque in the alpha channel, the click will not go through your application to whatever is behind it.</p>\n',attributes:{date:"2016-01-26T00:00:00.000Z",summary:"Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application's manifest like this...",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/transparency-and-nwjs"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"platform",name:"platform"},{id:"linux",name:"linux"},{id:"mac",name:"mac"},{id:"windows",name:"windows"},{id:"development",name:"development"}],title:"Transparency and NW.js",updated_at:"2019-05-22T08:26:35.907Z",photo:"/images/blog-content/transparency-and-nwjs/transparent-window-frame.png"},title:"Transparency and NW.js",renderedSummary:"<p>Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application's manifest like this...</p>\n",rendered:'<h2><a id="transparency-and-nwjs" class="post-header-anchor" href="#transparency-and-nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Transparency and NW.js</h2>\n<p>Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application\'s manifest like this:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Transparency will then be enabled for the main window of your application from the start. Now, it\'s play time. Try giving a page\'s body a transparent or semi-transparent background color and any children an opaque background color in your CSS like this:</p>\n<pre><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span>\n  <span class="token property">background</span><span class="token punctuation">:</span>transparent<span class="token punctuation">;</span>//<span class="token property">orbackground</span><span class="token punctuation">:</span><span class="token function">rgba</span><span class="token punctuation">(</span>255, 255, 255, 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">body > *</span> <span class="token punctuation">{</span>\n  <span class="token property">background</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>I could spend all day doing this.</p>\n<h3><a id="programmatically-enabling-transparency" class="post-header-anchor" href="#programmatically-enabling-transparency" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Programmatically enabling transparency</h3>\n<p>The transparent option can also be passed when creating a new window:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gui <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'nw.gui\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> newWindow <span class="token operator">=</span> newgui<span class="token punctuation">.</span>Window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">\'other.html\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  position<span class="token punctuation">:</span> <span class="token string">\'center\'</span><span class="token punctuation">,</span>\n  width<span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span>\n  height<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span>\n  transparent<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nnewWindow<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Whether you\'re working with the current window or another window you\'ve just spawned, transparency can be toggled programmatically per window on the fly thanks to the Window API:</p>\n<pre><code class="language-javascript">  newWindow<span class="token punctuation">.</span><span class="token function">setTransparent</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newWindow<span class="token punctuation">.</span>isTransparent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>\n</code></pre>\n<p>The window\'s <code>setTransparent</code> method allows you to enable or disable transparency and its <code>isTransparent</code> property contains a Boolean indicating if it\'s enabled right now.</p>\n<h3><a id="support" class="post-header-anchor" href="#support" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Support</h3>\n<p>Unfortunately, there are always exceptions. Transparency isn\'t supported at all on Windows XP or earlier. In some cases it might not work on later Windows versions, including when accessing the machine via Microsoft Remote Desktop or with some unusual themes or configurations.</p>\n<p>On Linux, transparency is supported if the window manager supports compositing. Aside from this, you\'ll also need to start your application with a couple of arguments. These can be set in your app\'s manifest under chromium-args:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"chromium-args"</span><span class="token operator">:</span> <span class="token string">"--enable-transparent-visuals --disable-gpu"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<h3><a id="tips-and-noteworthy-side-effects" class="post-header-anchor" href="#tips-and-noteworthy-side-effects" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tips and noteworthy side-effects</h3>\n<p>It\'s best to make your app frameless if it will be semi-transparent. Otherwise it will look a bit strange. This would depend on your use case of course. Strangely, enabling transparency for a window on Mac OS X will make its frame and toolbar transparent:</p>\n<figure>\n          <a href="/images/blog-content/transparency-and-nwjs/transparent-window-frame.png"><img src="/images/blog-content/transparency-and-nwjs/transparent-window-frame.png" alt=""/></a>\n          <figcaption><p>Screenshot of a transparent window frame on Mac OS X</p>\n</figcaption>\n        </figure><p>Between the community and developers behind NW.js, there isn\'t certainty whether or not windows with transparency enabled should have a shadow like typically windows do. At the time of writing, if transparency is enabled in your manifest for example, your window will not have a shadow, even if all its content is completely opaque.</p>\n<h3><a id="click-through" class="post-header-anchor" href="#click-through" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Click-through</h3>\n<p>NW.js even supports clicking through your transparent app to stuff behind it on your desktop, for example. This is enabled by adding a couple of runtime arguments to your chromium-args in your manifest. Namely --disable-gpu and --force-cpu-draw:</p>\n<pre><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-app"</span><span class="token punctuation">,</span>\n  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"My app"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.1"</span><span class="token punctuation">,</span>\n  <span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"transparent"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"chromium-args"</span><span class="token operator">:</span> <span class="token string">"--disable-gpu --force-cpu-draw"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>As of right now, this is only supported on Mac OS X and Windows. It only works with non-resizable frameless windows, although there may be exceptions depending on the operating system.</p>\n<p>One other thing to note is that click-through will only be possible on areas of your app that are completely transparent. If the target element of the click or an ancestor has a background color, even if it\'s 1% opaque in the alpha channel, the click will not go through your application to whatever is behind it.</p>\n',summary:"Yes, NW.js does support transparency, albeit it is disabled by default. One way to enable transparency is to use the transparency property to your application's manifest like this...\n",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/transparency-and-nwjs"},photo:"/images/blog-content/transparency-and-nwjs/transparent-window-frame.png",keywords:["node-webkit","desktop","javascript","platform","linux","mac","windows","development"],published_at:"2016-01-26T00:00:00.000Z",updated_at:"2019-05-22T08:26:35.907Z",year:2016,month:1,day:27,relevanceScore:.33333333333333326},{id:"installing-your-nwjs-app-windows1",slug:"installing-your-nwjs-app-windows1",highlightedLanguages:[],source:"---\ndate: 2015-12-09\nsummary: NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.\noriginal:\n  blogLink: https://www.packtpub.com/books/content/blogs\n  blogName: Packt books\n  url: https://www.packtpub.com/books/content/installing-your-nwjs-app-windows\ntags:\n  - node-webkit\n  - desktop\n  - javascript\n  - windows\n  - install\n  - installer\n  - development\n---\n\n## Installing your NW.js app on Windows\n\n[NW.js](https://github.com/nwjs/nw.js) is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like [Creating Your First Desktop App With HTML, JS and Node-WebKit](http://tutorialzine.com/2015/01/your-first-node-webkit-app/) to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users. I've been through it myself with [Teamwork Chat](https://www.teamwork.com/chat) and there are a few things to consider. What exactly should you provide the end user with? How? Where? And why?\n\n### What to ship\n\nIf you want to keep it simple you can simply package everything up into a ZIP archive for your users to download. The ZIP should include your app, along with all of the files generated during the build; the dynamic-link libraries (`.dll`s), the nw.pak and the other PAK files in the locales directory. All of these extra files are required to be certain your app will function correctly on Windows, even if they already have some of these from a previous installation of Google Chrome, for example.\n\nWhen I say you need to include \"your app\" in this archive, I of course mean your `myApp.exe` if you've used the [nw-builder module](https://github.com/nwjs/nw-builder) to build your app (which I recommend).\n\nIf you want to use the [.nw method](https://github.com/nwjs/nw.js/wiki/How-to-run-apps) of running your app, you will have to distribute your app in separate pieces; `nw.exe`, a `.nw` archive containing your app code and `myApp.ink` a shortcut which executes `nw.exe` with your `.nw` archive. This is how the popular [Popcorn Time](https://popcorntime.io/) app works.\n\nYou could rename `nw.exe` to something nicer but it's not advised to ensure [native module compatibility](https://github.com/nwjs/nw.js/issues/199#issuecomment-91411953).\n\n### Installers\n\nGiving the user a simple ZIP isn't optimal though. It isn't the most user-friendly option and you wouldn't have much control over what the user does with your app; where they put it, how many copies of your app they have, etc. This is where installers come in. E.g. [Inno Setup](http://www.jrsoftware.org/isinfo.php), [NSIS](http://nsis.sourceforge.net/Main_Page) or [Install Shield](http://www.flexerasoftware.com/producer/products/software-installation/installshield-software-installer/). The applications provided to build these installers can be configured to grab all of your files and store them wherever you choose on the user's machine, pin your app to their start menu and a whole host of other options.\n\n### Where to store your app\n\nThe first place that springs to mind is Program Files, right? Well, if your app has to add / overwrite / remove files from the directory in which it's located then you'll run into problems with permissions. To get around this I suggest storing your app in `C:\\Users\\<username>\\AppData\\Roaming\\MyApp` like a handful of big name apps do.\n\nIf you really need to store your app in Program Files then you could theoretically use something like the node-windows node module to elevate the privileges of the current user to a local administrator and execute the problematic filesystem interactions using Windows services. This means though that Windows' UAC (User Account Control) may show for the user depending on their settings. If you were to use node-windows, this also means that you'd have to pass Windows commands as strings instead of using the fs module.\n\nAnother possible location is `C:\\Users\\Default\\AppData\\Roaming\\MyApp`. Anything stored here will be copied to `C:\\Users\\<new-username>\\AppData\\Roaming\\MyApp` for each new user profile created on the machine. This may or may not suit your application or you might even want to let the user to decide (by having this as an option in the installer).\n\n### What to sign\n\nIf you're digitally signing your app with a certificate, make sure you sign each and every executable; not only `myApp.exe` / `nw.exe` but also any `.exe`s your app spawns as well as any executables any of your node_modules dependencies spawn (which aren't already signed by the maintainers). If you were to use the [node-webkit-updatermodule](https://github.com/edjafarov/node-webkit-updater/), for example, it contains an `unsignedunzip.exe`. Make sure to sign all of these before building your installer, as well as signing the installer itself.\n\nThat's all folks! I've had to figure a lot of this stuff myself by trial and error so I hope it saves you some time. If I've missed anything, feel free to let me know in a comment below.\n",unfilteredRenderedBody:'<h2><a id="installing-your-nwjs-app-on-windows" class="post-header-anchor" href="#installing-your-nwjs-app-on-windows" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Installing your NW.js app on Windows</h2>\n<p><a href="https://github.com/nwjs/nw.js" rel="noopener">NW.js</a> is great for creating desktop applications using Web app technologies. If you\'re not familiar with NW.js, I\'d advise you to read an introductory article like <a href="http://tutorialzine.com/2015/01/your-first-node-webkit-app/" rel="noopener">Creating Your First Desktop App With HTML, JS and Node-WebKit</a> to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users. I\'ve been through it myself with <a href="https://www.teamwork.com/chat" rel="noopener">Teamwork Chat</a> and there are a few things to consider. What exactly should you provide the end user with? How? Where? And why?</p>\n<h3><a id="what-to-ship" class="post-header-anchor" href="#what-to-ship" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What to ship</h3>\n<p>If you want to keep it simple you can simply package everything up into a ZIP archive for your users to download. The ZIP should include your app, along with all of the files generated during the build; the dynamic-link libraries (<code>.dll</code>s), the nw.pak and the other PAK files in the locales directory. All of these extra files are required to be certain your app will function correctly on Windows, even if they already have some of these from a previous installation of Google Chrome, for example.</p>\n<p>When I say you need to include &quot;your app&quot; in this archive, I of course mean your <code>myApp.exe</code> if you\'ve used the <a href="https://github.com/nwjs/nw-builder" rel="noopener">nw-builder module</a> to build your app (which I recommend).</p>\n<p>If you want to use the <a href="https://github.com/nwjs/nw.js/wiki/How-to-run-apps" rel="noopener">.nw method</a> of running your app, you will have to distribute your app in separate pieces; <code>nw.exe</code>, a <code>.nw</code> archive containing your app code and <code>myApp.ink</code> a shortcut which executes <code>nw.exe</code> with your <code>.nw</code> archive. This is how the popular <a href="https://popcorntime.io/" rel="noopener">Popcorn Time</a> app works.</p>\n<p>You could rename <code>nw.exe</code> to something nicer but it\'s not advised to ensure <a href="https://github.com/nwjs/nw.js/issues/199#issuecomment-91411953" rel="noopener">native module compatibility</a>.</p>\n<h3><a id="installers" class="post-header-anchor" href="#installers" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Installers</h3>\n<p>Giving the user a simple ZIP isn\'t optimal though. It isn\'t the most user-friendly option and you wouldn\'t have much control over what the user does with your app; where they put it, how many copies of your app they have, etc. This is where installers come in. E.g. <a href="http://www.jrsoftware.org/isinfo.php" rel="noopener">Inno Setup</a>, <a href="http://nsis.sourceforge.net/Main_Page" rel="noopener">NSIS</a> or <a href="http://www.flexerasoftware.com/producer/products/software-installation/installshield-software-installer/" rel="noopener">Install Shield</a>. The applications provided to build these installers can be configured to grab all of your files and store them wherever you choose on the user\'s machine, pin your app to their start menu and a whole host of other options.</p>\n<h3><a id="where-to-store-your-app" class="post-header-anchor" href="#where-to-store-your-app" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Where to store your app</h3>\n<p>The first place that springs to mind is Program Files, right? Well, if your app has to add / overwrite / remove files from the directory in which it\'s located then you\'ll run into problems with permissions. To get around this I suggest storing your app in <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\MyApp</code> like a handful of big name apps do.</p>\n<p>If you really need to store your app in Program Files then you could theoretically use something like the node-windows node module to elevate the privileges of the current user to a local administrator and execute the problematic filesystem interactions using Windows services. This means though that Windows\' UAC (User Account Control) may show for the user depending on their settings. If you were to use node-windows, this also means that you\'d have to pass Windows commands as strings instead of using the fs module.</p>\n<p>Another possible location is <code>C:\\Users\\Default\\AppData\\Roaming\\MyApp</code>. Anything stored here will be copied to <code>C:\\Users\\&lt;new-username&gt;\\AppData\\Roaming\\MyApp</code> for each new user profile created on the machine. This may or may not suit your application or you might even want to let the user to decide (by having this as an option in the installer).</p>\n<h3><a id="what-to-sign" class="post-header-anchor" href="#what-to-sign" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What to sign</h3>\n<p>If you\'re digitally signing your app with a certificate, make sure you sign each and every executable; not only <code>myApp.exe</code> / <code>nw.exe</code> but also any <code>.exe</code>s your app spawns as well as any executables any of your node_modules dependencies spawn (which aren\'t already signed by the maintainers). If you were to use the <a href="https://github.com/edjafarov/node-webkit-updater/" rel="noopener">node-webkit-updatermodule</a>, for example, it contains an <code>unsignedunzip.exe</code>. Make sure to sign all of these before building your installer, as well as signing the installer itself.</p>\n<p>That\'s all folks! I\'ve had to figure a lot of this stuff myself by trial and error so I hope it saves you some time. If I\'ve missed anything, feel free to let me know in a comment below.</p>\n',attributes:{date:"2015-12-09T00:00:00.000Z",summary:"NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/installing-your-nwjs-app-windows"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"windows",name:"windows"},{id:"install",name:"install"},{id:"installer",name:"installer"},{id:"development",name:"development"}],title:"Installing your NW.js app on Windows",updated_at:"2019-05-22T08:25:55.401Z"},title:"Installing your NW.js app on Windows",renderedSummary:"<p>NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.</p>\n",rendered:'<h2><a id="installing-your-nwjs-app-on-windows" class="post-header-anchor" href="#installing-your-nwjs-app-on-windows" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Installing your NW.js app on Windows</h2>\n<p><a href="https://github.com/nwjs/nw.js" rel="noopener">NW.js</a> is great for creating desktop applications using Web app technologies. If you\'re not familiar with NW.js, I\'d advise you to read an introductory article like <a href="http://tutorialzine.com/2015/01/your-first-node-webkit-app/" rel="noopener">Creating Your First Desktop App With HTML, JS and Node-WebKit</a> to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users. I\'ve been through it myself with <a href="https://www.teamwork.com/chat" rel="noopener">Teamwork Chat</a> and there are a few things to consider. What exactly should you provide the end user with? How? Where? And why?</p>\n<h3><a id="what-to-ship" class="post-header-anchor" href="#what-to-ship" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What to ship</h3>\n<p>If you want to keep it simple you can simply package everything up into a ZIP archive for your users to download. The ZIP should include your app, along with all of the files generated during the build; the dynamic-link libraries (<code>.dll</code>s), the nw.pak and the other PAK files in the locales directory. All of these extra files are required to be certain your app will function correctly on Windows, even if they already have some of these from a previous installation of Google Chrome, for example.</p>\n<p>When I say you need to include &quot;your app&quot; in this archive, I of course mean your <code>myApp.exe</code> if you\'ve used the <a href="https://github.com/nwjs/nw-builder" rel="noopener">nw-builder module</a> to build your app (which I recommend).</p>\n<p>If you want to use the <a href="https://github.com/nwjs/nw.js/wiki/How-to-run-apps" rel="noopener">.nw method</a> of running your app, you will have to distribute your app in separate pieces; <code>nw.exe</code>, a <code>.nw</code> archive containing your app code and <code>myApp.ink</code> a shortcut which executes <code>nw.exe</code> with your <code>.nw</code> archive. This is how the popular <a href="https://popcorntime.io/" rel="noopener">Popcorn Time</a> app works.</p>\n<p>You could rename <code>nw.exe</code> to something nicer but it\'s not advised to ensure <a href="https://github.com/nwjs/nw.js/issues/199#issuecomment-91411953" rel="noopener">native module compatibility</a>.</p>\n<h3><a id="installers" class="post-header-anchor" href="#installers" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Installers</h3>\n<p>Giving the user a simple ZIP isn\'t optimal though. It isn\'t the most user-friendly option and you wouldn\'t have much control over what the user does with your app; where they put it, how many copies of your app they have, etc. This is where installers come in. E.g. <a href="http://www.jrsoftware.org/isinfo.php" rel="noopener">Inno Setup</a>, <a href="http://nsis.sourceforge.net/Main_Page" rel="noopener">NSIS</a> or <a href="http://www.flexerasoftware.com/producer/products/software-installation/installshield-software-installer/" rel="noopener">Install Shield</a>. The applications provided to build these installers can be configured to grab all of your files and store them wherever you choose on the user\'s machine, pin your app to their start menu and a whole host of other options.</p>\n<h3><a id="where-to-store-your-app" class="post-header-anchor" href="#where-to-store-your-app" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Where to store your app</h3>\n<p>The first place that springs to mind is Program Files, right? Well, if your app has to add / overwrite / remove files from the directory in which it\'s located then you\'ll run into problems with permissions. To get around this I suggest storing your app in <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\MyApp</code> like a handful of big name apps do.</p>\n<p>If you really need to store your app in Program Files then you could theoretically use something like the node-windows node module to elevate the privileges of the current user to a local administrator and execute the problematic filesystem interactions using Windows services. This means though that Windows\' UAC (User Account Control) may show for the user depending on their settings. If you were to use node-windows, this also means that you\'d have to pass Windows commands as strings instead of using the fs module.</p>\n<p>Another possible location is <code>C:\\Users\\Default\\AppData\\Roaming\\MyApp</code>. Anything stored here will be copied to <code>C:\\Users\\&lt;new-username&gt;\\AppData\\Roaming\\MyApp</code> for each new user profile created on the machine. This may or may not suit your application or you might even want to let the user to decide (by having this as an option in the installer).</p>\n<h3><a id="what-to-sign" class="post-header-anchor" href="#what-to-sign" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What to sign</h3>\n<p>If you\'re digitally signing your app with a certificate, make sure you sign each and every executable; not only <code>myApp.exe</code> / <code>nw.exe</code> but also any <code>.exe</code>s your app spawns as well as any executables any of your node_modules dependencies spawn (which aren\'t already signed by the maintainers). If you were to use the <a href="https://github.com/edjafarov/node-webkit-updater/" rel="noopener">node-webkit-updatermodule</a>, for example, it contains an <code>unsignedunzip.exe</code>. Make sure to sign all of these before building your installer, as well as signing the installer itself.</p>\n<p>That\'s all folks! I\'ve had to figure a lot of this stuff myself by trial and error so I hope it saves you some time. If I\'ve missed anything, feel free to let me know in a comment below.</p>\n',summary:"NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.\n",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/installing-your-nwjs-app-windows"},keywords:["node-webkit","desktop","javascript","windows","install","installer","development"],published_at:"2015-12-09T00:00:00.000Z",updated_at:"2019-05-22T08:25:55.401Z",year:2015,month:12,day:10,relevanceScore:.29166666666666674},{id:"npm-distribution-path-length-problems",slug:"npm-distribution-path-length-problems",highlightedLanguages:["javascript"],source:"---\ndate: 2015-12-07\nsummary: NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.\noriginal:\n  blogLink: https://www.packtpub.com/books/content/blogs\n  blogName: Packt books\n  url: https://www.packtpub.com/books/content/npm-and-distribution-path-length-problems\ntags:\n  - node-webkit\n  - desktop\n  - javascript\n  - npm\n  - distribution\n  - windows\n  - paths\n  - development\n---\n\n## npm and distribution path length problems\n\n:::summary\n\nYou might have been unfortunate enough to learn that Windows has a 256 character limit on file paths. You could've ran into this problem locally or on end users' machines. There's no real workaround but there are preventive measures you can take. Even if you haven't, feel free to take pleasure from reading my horror story.\n\n:::\n\n### npm\n\nNeither this problem nor our solution are exclusive to Node.js but a lot of the victims of the path length problem were probably running Node.js on Windows. Windows users know that they get left out in the cold often by npm package maintainers but even [the design of npm itself is a problem on Windows from the get-go](https://github.com/joyent/node/issues/6960#issuecomment-46704998).\n\nnpm stores your dependencies (listed in your package.json) in a `node_modules` directory. If those dependencies have dependencies of their own they're stored in their own `node_modules` directory (i.e. `your-project/node_modules/a/node_modules/b/`) and so on recursively. It's nice but in hindsight it's obviously incompatible with Windows's path length limit.\n\n### Delete delete delete\n\nMost people have probably been lucky enough to only have come across this problem when trying to delete dependencies where then Windows complains that the path is too long.\n\nA simple way around this is to take a module halfway down deep into your dependency graph (i.e. `node_modules/a/node_modules/b/node_modules/c/.../node_modules/h/`) in Windows Explorer and move it somewhere closer to the root (e.g. `node_modules/`) to cut the file path down before trying to delete it again. This would have to be repeated for every culprit.\n\nThere are also some tools which could help. I've noticed that you can delete really long paths while using [7-Zip](http://www.7-zip.org/) File Manager to browse files.\n\n### Runtime errors\n\nIf you've ran into actual bugs caused by this, you could find a module halfway down the dependency graph and add it as a dependency to your project so it will be installed under the top level `node_modules` and not a `node_modules` directory n levels deep. Make sure to install the correct version and test thoroughly.\n\nThere are also a few Node modules out there which \"flatten\" your dependency graph. The downside to these modules is that if there is a conflict (package A depends on version 1.0.0 of package Z and package B depends on version 3.2.1 of package Z) then the latest version of the module (package Z) is used, which could be problematic. So be careful.\n\n### Can't npm fix this?\n\n~~You might see people reference Windows APIs (which support long paths) as a possible fix but it is [very unlikely](https://github.com/joyent/node/issues/6960#issuecomment-46704998) <span style=\"text-decoration: line-through;\">this will be fixed in npm.[npm dedupe](https://docs.npmjs.com/cli/dedupe) _should_ help with this too but it's not reliable in my experience.~~\n\nYes, they, can! This has been fixed as of [npm 3.0.0](https://github.com/npm/npm/releases/tag/v3.0.0) (yet to be released).\n\nYour dependencies will now be installed _maximally_ flat. Insofar as is possible, all of your dependencies, and their dependencies, and THEIR dependencies will be installed in your project's `node_modules` folder with no nesting. You'll only see modules nested underneath one another when two (or more) modules have conflicting dependencies.\n\nExcuse me...\n\n:::figure npm-distribution-path-length-problems/dance.gif \\* Dances \\*\n:::\n\nMind you, it's a bit late for me. Unless npm 3 also ships with a time machine. More about that in a bit.\n\n### Manually checking for exceedingly long paths\n\nUp until now, I've had to routinely check for long paths using [Path Length Checker](https://pathlengthchecker.codeplex.com/) (on Windows) but a manual check is not good enough as stuff can still slip through the net.\n\n### Introducing gulp-path-length\n\nSo there's a simple [Gulp](http://gulpjs.com) plugin to help with this; [gulp-path-length](https://github.com/Teamwork/gulp-path-length). You could use it like this in a Gulp task:\n\n```javascript\nvar gulp = require('gulp');\nvar pathLength = require('gulp-path-length');\n\ngulp.task('default', function(){\n  gulp.src('./example/path/to/directory/**', {read: false})\n      .pipe(pathLength());\n});\n```\n\nIf all is well, nothing will happen. If you have a path exceeding 256 characters, the gulp task will stop and an error reveal the offending path. This is really fast either way as Gulp doesn't need to read the contents of the files. The limit can be changed with a parameter; i.e. `.pipe(pathLength({ maxLength: 50 });`.\n\nThis is fine if it's just for you locally but there are bigger fish to fry.\n\n### Distributed long paths\n\nWhat if there are multiple developers working on your project? What if a developer is using Mac OS X or Linux? There could easily be false positives. It's one thing having issues locally or within a team, it's a whole other thing to have path length problems in production on end users machines.\n\nI've had that pleasure myself with [Teamwork Chat](https://www.teamwork.com/chat), which we built on top of [NW.js](https://github.com/nwjs/nw.js). NW.js is basically Node.js and Chromium mashed together to allow you to create desktop apps from Web apps. Any NW.js can access all of node's core modules and any other modules you've installed from nom, for example. Therefore the npm - Windows path length issue applies here too. Depending on how long the end user's username was, the user might've seen something like this when they tried to launch Teamwork Chat:\n\n:::figure npm-distribution-path-length-problems/fatal.png The NW.js fatal error screen\n:::\n\nA dummy application. None of our app code is executed. This means no error reports and no way the app could even auto-update once a patch was released. As a maintainer of [nw-builder](https://github.com/nwjs/nw-builder), I know we're not the only ones who have faced this problem.\n\n### Is there anything we can do?\n\nOnce the code is shipped, it's too late. Luckily in my case, we have a rough idea where the files will exist on end users machines thanks to our Windows installer. This is where gulp-path-length's rewrite option comes in. It can be used like this to simulate path lengths:\n\n```javascript\nvar gulp = require('gulp');\nvar pathLength = require('gulp-path-length');\n\ngulp.task('default', function(){\n  gulp.src('./example/path/to/directory/**', {read: false})\n    .pipe(pathLength({\n      rewrite: {\n        match: './example/path/to/directory/',\n        replacement: 'C:\\\\Users\\\\a-long-username-here\\\\AppData\\\\Blah\\\\Blah\\\\Blah'\n      }\n    }));\n});\n```\n\nSo it doesn't matter where you are on your filesystem or which operating system you're using, it will test the length of files in a given directory as if they're in a hypothetical directory on Windows.\n\nYou could run this before you ship your code but we've added this to a compilation build step so we catch it as early as possible. If a Mac developer adds really long paths to the project (like an npm dependency which depends on a chain of [lodash](https://lodash.com/) modules), they'll see right away that this will break stuff for some Windows users. For good measure, we also run it in a continuous integration step.\n",unfilteredRenderedBody:'<h2><a id="npm-and-distribution-path-length-problems" class="post-header-anchor" href="#npm-and-distribution-path-length-problems" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>npm and distribution path length problems</h2>\n<article-summary><p>You might have been unfortunate enough to learn that Windows has a 256 character limit on file paths. You could\'ve ran into this problem locally or on end users\' machines. There\'s no real workaround but there are preventive measures you can take. Even if you haven\'t, feel free to take pleasure from reading my horror story.</p>\n</article-summary><h3><a id="npm" class="post-header-anchor" href="#npm" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>npm</h3>\n<p>Neither this problem nor our solution are exclusive to Node.js but a lot of the victims of the path length problem were probably running Node.js on Windows. Windows users know that they get left out in the cold often by npm package maintainers but even <a href="https://github.com/joyent/node/issues/6960#issuecomment-46704998" rel="noopener">the design of npm itself is a problem on Windows from the get-go</a>.</p>\n<p>npm stores your dependencies (listed in your package.json) in a <code>node_modules</code> directory. If those dependencies have dependencies of their own they\'re stored in their own <code>node_modules</code> directory (i.e. <code>your-project/node_modules/a/node_modules/b/</code>) and so on recursively. It\'s nice but in hindsight it\'s obviously incompatible with Windows\'s path length limit.</p>\n<h3><a id="delete-delete-delete" class="post-header-anchor" href="#delete-delete-delete" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Delete delete delete</h3>\n<p>Most people have probably been lucky enough to only have come across this problem when trying to delete dependencies where then Windows complains that the path is too long.</p>\n<p>A simple way around this is to take a module halfway down deep into your dependency graph (i.e. <code>node_modules/a/node_modules/b/node_modules/c/.../node_modules/h/</code>) in Windows Explorer and move it somewhere closer to the root (e.g. <code>node_modules/</code>) to cut the file path down before trying to delete it again. This would have to be repeated for every culprit.</p>\n<p>There are also some tools which could help. I\'ve noticed that you can delete really long paths while using <a href="http://www.7-zip.org/" rel="noopener">7-Zip</a> File Manager to browse files.</p>\n<h3><a id="runtime-errors" class="post-header-anchor" href="#runtime-errors" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Runtime errors</h3>\n<p>If you\'ve ran into actual bugs caused by this, you could find a module halfway down the dependency graph and add it as a dependency to your project so it will be installed under the top level <code>node_modules</code> and not a <code>node_modules</code> directory n levels deep. Make sure to install the correct version and test thoroughly.</p>\n<p>There are also a few Node modules out there which &quot;flatten&quot; your dependency graph. The downside to these modules is that if there is a conflict (package A depends on version 1.0.0 of package Z and package B depends on version 3.2.1 of package Z) then the latest version of the module (package Z) is used, which could be problematic. So be careful.</p>\n<h3><a id="cant-npm-fix-this" class="post-header-anchor" href="#cant-npm-fix-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Can\'t npm fix this?</h3>\n<p><s>You might see people reference Windows APIs (which support long paths) as a possible fix but it is <a href="https://github.com/joyent/node/issues/6960#issuecomment-46704998" rel="noopener">very unlikely</a> <span style="text-decoration: line-through;">this will be fixed in npm.<a href="https://docs.npmjs.com/cli/dedupe" rel="noopener">npm dedupe</a> <em>should</em> help with this too but it\'s not reliable in my experience.</s></p>\n<p>Yes, they, can! This has been fixed as of <a href="https://github.com/npm/npm/releases/tag/v3.0.0" rel="noopener">npm 3.0.0</a> (yet to be released).</p>\n<p>Your dependencies will now be installed <em>maximally</em> flat. Insofar as is possible, all of your dependencies, and their dependencies, and THEIR dependencies will be installed in your project\'s <code>node_modules</code> folder with no nesting. You\'ll only see modules nested underneath one another when two (or more) modules have conflicting dependencies.</p>\n<p>Excuse me...</p>\n<figure>\n          <a href="/images/blog-content/npm-distribution-path-length-problems/dance.gif"><img src="/images/blog-content/npm-distribution-path-length-problems/dance.gif" alt=""/></a>\n          <figcaption><p>* Dances *</p>\n</figcaption>\n        </figure><p>Mind you, it\'s a bit late for me. Unless npm 3 also ships with a time machine. More about that in a bit.</p>\n<h3><a id="manually-checking-for-exceedingly-long-paths" class="post-header-anchor" href="#manually-checking-for-exceedingly-long-paths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Manually checking for exceedingly long paths</h3>\n<p>Up until now, I\'ve had to routinely check for long paths using <a href="https://pathlengthchecker.codeplex.com/" rel="noopener">Path Length Checker</a> (on Windows) but a manual check is not good enough as stuff can still slip through the net.</p>\n<h3><a id="introducing-gulp-path-length" class="post-header-anchor" href="#introducing-gulp-path-length" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Introducing gulp-path-length</h3>\n<p>So there\'s a simple <a href="http://gulpjs.com" rel="noopener">Gulp</a> plugin to help with this; <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>. You could use it like this in a Gulp task:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/path/to/directory/**\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>If all is well, nothing will happen. If you have a path exceeding 256 characters, the gulp task will stop and an error reveal the offending path. This is really fast either way as Gulp doesn\'t need to read the contents of the files. The limit can be changed with a parameter; i.e. <code>.pipe(pathLength({ maxLength: 50 });</code>.</p>\n<p>This is fine if it\'s just for you locally but there are bigger fish to fry.</p>\n<h3><a id="distributed-long-paths" class="post-header-anchor" href="#distributed-long-paths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distributed long paths</h3>\n<p>What if there are multiple developers working on your project? What if a developer is using Mac OS X or Linux? There could easily be false positives. It\'s one thing having issues locally or within a team, it\'s a whole other thing to have path length problems in production on end users machines.</p>\n<p>I\'ve had that pleasure myself with <a href="https://www.teamwork.com/chat" rel="noopener">Teamwork Chat</a>, which we built on top of <a href="https://github.com/nwjs/nw.js" rel="noopener">NW.js</a>. NW.js is basically Node.js and Chromium mashed together to allow you to create desktop apps from Web apps. Any NW.js can access all of node\'s core modules and any other modules you\'ve installed from nom, for example. Therefore the npm - Windows path length issue applies here too. Depending on how long the end user\'s username was, the user might\'ve seen something like this when they tried to launch Teamwork Chat:</p>\n<figure>\n          <a href="/images/blog-content/npm-distribution-path-length-problems/fatal.png"><img src="/images/blog-content/npm-distribution-path-length-problems/fatal.png" alt=""/></a>\n          <figcaption><p>The NW.js fatal error screen</p>\n</figcaption>\n        </figure><p>A dummy application. None of our app code is executed. This means no error reports and no way the app could even auto-update once a patch was released. As a maintainer of <a href="https://github.com/nwjs/nw-builder" rel="noopener">nw-builder</a>, I know we\'re not the only ones who have faced this problem.</p>\n<h3><a id="is-there-anything-we-can-do" class="post-header-anchor" href="#is-there-anything-we-can-do" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Is there anything we can do?</h3>\n<p>Once the code is shipped, it\'s too late. Luckily in my case, we have a rough idea where the files will exist on end users machines thanks to our Windows installer. This is where gulp-path-length\'s rewrite option comes in. It can be used like this to simulate path lengths:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/path/to/directory/**\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        match<span class="token punctuation">:</span> <span class="token string">\'./example/path/to/directory/\'</span><span class="token punctuation">,</span>\n        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\a-long-username-here\\\\AppData\\\\Blah\\\\Blah\\\\Blah\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>So it doesn\'t matter where you are on your filesystem or which operating system you\'re using, it will test the length of files in a given directory as if they\'re in a hypothetical directory on Windows.</p>\n<p>You could run this before you ship your code but we\'ve added this to a compilation build step so we catch it as early as possible. If a Mac developer adds really long paths to the project (like an npm dependency which depends on a chain of <a href="https://lodash.com/" rel="noopener">lodash</a> modules), they\'ll see right away that this will break stuff for some Windows users. For good measure, we also run it in a continuous integration step.</p>\n',attributes:{date:"2015-12-07T00:00:00.000Z",summary:"NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/npm-and-distribution-path-length-problems"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"npm",name:"npm"},{id:"distribution",name:"distribution"},{id:"windows",name:"windows"},{id:"paths",name:"paths"},{id:"development",name:"development"}],title:"npm and distribution path length problems",updated_at:"2019-05-22T08:26:01.131Z",photo:"/images/blog-content/npm-distribution-path-length-problems/dance.gif"},title:"npm and distribution path length problems",renderedSummary:"<p>NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.</p>\n",rendered:'<h2><a id="npm-and-distribution-path-length-problems" class="post-header-anchor" href="#npm-and-distribution-path-length-problems" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>npm and distribution path length problems</h2>\n<p>You might have been unfortunate enough to learn that Windows has a 256 character limit on file paths. You could\'ve ran into this problem locally or on end users\' machines. There\'s no real workaround but there are preventive measures you can take. Even if you haven\'t, feel free to take pleasure from reading my horror story.</p>\n<h3><a id="npm" class="post-header-anchor" href="#npm" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>npm</h3>\n<p>Neither this problem nor our solution are exclusive to Node.js but a lot of the victims of the path length problem were probably running Node.js on Windows. Windows users know that they get left out in the cold often by npm package maintainers but even <a href="https://github.com/joyent/node/issues/6960#issuecomment-46704998" rel="noopener">the design of npm itself is a problem on Windows from the get-go</a>.</p>\n<p>npm stores your dependencies (listed in your package.json) in a <code>node_modules</code> directory. If those dependencies have dependencies of their own they\'re stored in their own <code>node_modules</code> directory (i.e. <code>your-project/node_modules/a/node_modules/b/</code>) and so on recursively. It\'s nice but in hindsight it\'s obviously incompatible with Windows\'s path length limit.</p>\n<h3><a id="delete-delete-delete" class="post-header-anchor" href="#delete-delete-delete" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Delete delete delete</h3>\n<p>Most people have probably been lucky enough to only have come across this problem when trying to delete dependencies where then Windows complains that the path is too long.</p>\n<p>A simple way around this is to take a module halfway down deep into your dependency graph (i.e. <code>node_modules/a/node_modules/b/node_modules/c/.../node_modules/h/</code>) in Windows Explorer and move it somewhere closer to the root (e.g. <code>node_modules/</code>) to cut the file path down before trying to delete it again. This would have to be repeated for every culprit.</p>\n<p>There are also some tools which could help. I\'ve noticed that you can delete really long paths while using <a href="http://www.7-zip.org/" rel="noopener">7-Zip</a> File Manager to browse files.</p>\n<h3><a id="runtime-errors" class="post-header-anchor" href="#runtime-errors" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Runtime errors</h3>\n<p>If you\'ve ran into actual bugs caused by this, you could find a module halfway down the dependency graph and add it as a dependency to your project so it will be installed under the top level <code>node_modules</code> and not a <code>node_modules</code> directory n levels deep. Make sure to install the correct version and test thoroughly.</p>\n<p>There are also a few Node modules out there which &quot;flatten&quot; your dependency graph. The downside to these modules is that if there is a conflict (package A depends on version 1.0.0 of package Z and package B depends on version 3.2.1 of package Z) then the latest version of the module (package Z) is used, which could be problematic. So be careful.</p>\n<h3><a id="cant-npm-fix-this" class="post-header-anchor" href="#cant-npm-fix-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Can\'t npm fix this?</h3>\n<p><s>You might see people reference Windows APIs (which support long paths) as a possible fix but it is <a href="https://github.com/joyent/node/issues/6960#issuecomment-46704998" rel="noopener">very unlikely</a> <span style="text-decoration: line-through;">this will be fixed in npm.<a href="https://docs.npmjs.com/cli/dedupe" rel="noopener">npm dedupe</a> <em>should</em> help with this too but it\'s not reliable in my experience.</s></p>\n<p>Yes, they, can! This has been fixed as of <a href="https://github.com/npm/npm/releases/tag/v3.0.0" rel="noopener">npm 3.0.0</a> (yet to be released).</p>\n<p>Your dependencies will now be installed <em>maximally</em> flat. Insofar as is possible, all of your dependencies, and their dependencies, and THEIR dependencies will be installed in your project\'s <code>node_modules</code> folder with no nesting. You\'ll only see modules nested underneath one another when two (or more) modules have conflicting dependencies.</p>\n<p>Excuse me...</p>\n<figure>\n          <a href="/images/blog-content/npm-distribution-path-length-problems/dance.gif"><img src="/images/blog-content/npm-distribution-path-length-problems/dance.gif" alt=""/></a>\n          <figcaption><p>* Dances *</p>\n</figcaption>\n        </figure><p>Mind you, it\'s a bit late for me. Unless npm 3 also ships with a time machine. More about that in a bit.</p>\n<h3><a id="manually-checking-for-exceedingly-long-paths" class="post-header-anchor" href="#manually-checking-for-exceedingly-long-paths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Manually checking for exceedingly long paths</h3>\n<p>Up until now, I\'ve had to routinely check for long paths using <a href="https://pathlengthchecker.codeplex.com/" rel="noopener">Path Length Checker</a> (on Windows) but a manual check is not good enough as stuff can still slip through the net.</p>\n<h3><a id="introducing-gulp-path-length" class="post-header-anchor" href="#introducing-gulp-path-length" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Introducing gulp-path-length</h3>\n<p>So there\'s a simple <a href="http://gulpjs.com" rel="noopener">Gulp</a> plugin to help with this; <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>. You could use it like this in a Gulp task:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/path/to/directory/**\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>If all is well, nothing will happen. If you have a path exceeding 256 characters, the gulp task will stop and an error reveal the offending path. This is really fast either way as Gulp doesn\'t need to read the contents of the files. The limit can be changed with a parameter; i.e. <code>.pipe(pathLength({ maxLength: 50 });</code>.</p>\n<p>This is fine if it\'s just for you locally but there are bigger fish to fry.</p>\n<h3><a id="distributed-long-paths" class="post-header-anchor" href="#distributed-long-paths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distributed long paths</h3>\n<p>What if there are multiple developers working on your project? What if a developer is using Mac OS X or Linux? There could easily be false positives. It\'s one thing having issues locally or within a team, it\'s a whole other thing to have path length problems in production on end users machines.</p>\n<p>I\'ve had that pleasure myself with <a href="https://www.teamwork.com/chat" rel="noopener">Teamwork Chat</a>, which we built on top of <a href="https://github.com/nwjs/nw.js" rel="noopener">NW.js</a>. NW.js is basically Node.js and Chromium mashed together to allow you to create desktop apps from Web apps. Any NW.js can access all of node\'s core modules and any other modules you\'ve installed from nom, for example. Therefore the npm - Windows path length issue applies here too. Depending on how long the end user\'s username was, the user might\'ve seen something like this when they tried to launch Teamwork Chat:</p>\n<figure>\n          <a href="/images/blog-content/npm-distribution-path-length-problems/fatal.png"><img src="/images/blog-content/npm-distribution-path-length-problems/fatal.png" alt=""/></a>\n          <figcaption><p>The NW.js fatal error screen</p>\n</figcaption>\n        </figure><p>A dummy application. None of our app code is executed. This means no error reports and no way the app could even auto-update once a patch was released. As a maintainer of <a href="https://github.com/nwjs/nw-builder" rel="noopener">nw-builder</a>, I know we\'re not the only ones who have faced this problem.</p>\n<h3><a id="is-there-anything-we-can-do" class="post-header-anchor" href="#is-there-anything-we-can-do" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Is there anything we can do?</h3>\n<p>Once the code is shipped, it\'s too late. Luckily in my case, we have a rough idea where the files will exist on end users machines thanks to our Windows installer. This is where gulp-path-length\'s rewrite option comes in. It can be used like this to simulate path lengths:</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/path/to/directory/**\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        match<span class="token punctuation">:</span> <span class="token string">\'./example/path/to/directory/\'</span><span class="token punctuation">,</span>\n        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\a-long-username-here\\\\AppData\\\\Blah\\\\Blah\\\\Blah\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>So it doesn\'t matter where you are on your filesystem or which operating system you\'re using, it will test the length of files in a given directory as if they\'re in a hypothetical directory on Windows.</p>\n<p>You could run this before you ship your code but we\'ve added this to a compilation build step so we catch it as early as possible. If a Mac developer adds really long paths to the project (like an npm dependency which depends on a chain of <a href="https://lodash.com/" rel="noopener">lodash</a> modules), they\'ll see right away that this will break stuff for some Windows users. For good measure, we also run it in a continuous integration step.</p>\n',summary:"NW.js is great for creating desktop applications using Web app technologies. If you're not familiar with NW.js, I'd advise you to read an introductory article like Creating Your First Desktop App With HTML, JS and Node-WebKit to get a good base first. This is a slightly more advanced article intended for anyone interested into distributing their NW.js app to Windows users.\n",original:{blogLink:"https://www.packtpub.com/books/content/blogs",blogName:"Packt books",url:"https://www.packtpub.com/books/content/npm-and-distribution-path-length-problems"},photo:"/images/blog-content/npm-distribution-path-length-problems/dance.gif",keywords:["node-webkit","desktop","javascript","npm","distribution","windows","paths","development"],published_at:"2015-12-07T00:00:00.000Z",updated_at:"2019-05-22T08:26:01.131Z",year:2015,month:12,day:8,relevanceScore:.29166666666666674}]}}],error:null,state:{nameToShow:"Adam Lynch",githubAccountUrl:"https://github.com/adam-lynch",siteUrl:"https://adamlynch.com",siteTitle:"Adam Lynch",repositoryUrl:"https://github.com/adam-lynch/adam-lynch.github.io"},serverRendered:!0}</script><script src="/_nuxt/manifest.25595636d53df74f38ab.js" defer></script><script src="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" defer></script><script src="/_nuxt/1.03bda2e583db241630d8.js" defer></script><script src="/_nuxt/vendor.ce05078a33ab89125ee8.js" defer></script><script src="/_nuxt/app.7fd5760da80466c89126.js" defer></script>

    <script src="https://use.typekit.net/tci5xbk.js"></script>
    <script>try{Typekit.load({async:!0})}catch(a){}</script>
    <script>!function(e,a,t,n,c,g,s){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,g=a.createElement("script"),s=a.getElementsByTagName("script")[0],g.async=1,g.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(g,s)}(window,document),ga("create","UA-31546953-1","auto"),ga("send","pageview")</script>
  

