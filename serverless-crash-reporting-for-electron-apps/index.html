<!DOCTYPE html>
<html data-n-head="" data-n-head-ssr>
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="#ffffff" theme-color="theme-color"><meta data-n-head="true" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
" name="description" data-hid="description"><meta data-n-head="true" content="serverless, electron, javascript, aws, development" name="keywords" data-hid="keywords"><meta data-n-head="true" content="summary" name="twitter:card" data-hid="twitter:card"><meta data-n-head="true" content="Serverless crash reporting for Electron apps" name="twitter:title" data-hid="twitter:title"><meta data-n-head="true" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
" name="twitter:description" data-hid="twitter:description"><meta data-n-head="true" content="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" name="twitter:image"><meta data-n-head="true" content="/serverless-crash-reporting-for-electron-apps" name="twitter:url" data-hid="twitter:url"><meta data-n-head="true" content="article" name="og:type" data-hid="og:type"><meta data-n-head="true" content="Serverless crash reporting for Electron apps" name="og:title" data-hid="og:title"><meta data-n-head="true" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
" name="og:description" data-hid="og:description"><meta data-n-head="true" content="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" name="og:image" data-hid="og:image"><meta data-n-head="true" content="/serverless-crash-reporting-for-electron-apps" name="og:url" data-hid="og:url"><title data-n-head="true">Serverless crash reporting for Electron apps</title><link href="/apple-touch-icon.png" rel="apple-touch-icon" data-n-head="true" sizes="76x76"><link href="/favicon-32x32.png" rel="icon" data-n-head="true" sizes="32x32" type="image/x-icon"><link href="/favicon-16x16.png" rel="icon" data-n-head="true" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" data-n-head="true" color="#53687a"><link href="//unpkg.com/prismjs/themes/prism.css" rel="stylesheet" data-n-head="true"><link href="/_nuxt/manifest.25595636d53df74f38ab.js" rel="preload" as="script"><link href="/_nuxt/vendor.ce05078a33ab89125ee8.js" rel="preload" as="script"><link href="/_nuxt/app.7fd5760da80466c89126.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" rel="preload" as="script"><link href="/_nuxt/1.03bda2e583db241630d8.js" rel="preload" as="script"><link href="/_nuxt/pages/index.5bad6aa85a4e69648400.js" rel="prefetch"><style data-vue-ssr-id="6dd13fd5:0">*{-webkit-box-sizing:border-box;box-sizing:border-box}body,html{margin:0;padding:0}ol,ul{list-style:none;padding-left:0;margin:0}a{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;text-decoration:none;color:inherit}body{font-family:Arial,sans-serif;line-height:1.55;letter-spacing:-.25px;-webkit-font-smoothing:antialiased}.wf-active body{font-family:Lato,Arial,sans-serif}html{font-size:14px}@media (min-width:470px){html{font-size:16px}}body{background:#ececec;color:#333;padding-top:28px;padding-top:2rem;overflow-x:hidden}.wrapper{max-width:840px;max-width:60rem;margin:0 auto}.header{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0 14px;padding:0 1rem;background:#ececec}@media (min-width:59rem){.header{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}@media (min-width:470px){.header{padding-left:2rem;padding-right:2rem}}.site-title{margin:0;text-align:center;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;min-width:100%;max-width:84px;max-width:6rem}@media (min-width:42rem){.site-title{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.site-title{-webkit-box-flex:initial;-ms-flex:initial;flex:initial}}.site-title:hover{opacity:.9}.site-link{display:inline-block;background:url(/_nuxt/img/Logo.542e06c.png) 0 no-repeat;background-size:6.09rem;height:126px;height:9rem;width:84px;width:6rem;margin:0 auto;text-indent:-9999px}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.site-link{background-image:url(/_nuxt/img/Logo@2x.b121531.png)}}.site-happy-text-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0 auto;padding:0;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:18.2px;font-size:1.3rem}@media (min-width:42rem){.site-happy-text-wrapper{-webkit-box-flex:2;-ms-flex:2;flex:2;padding:0 0 0 2rem}}@media (min-width:59rem){.site-happy-text-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;font-size:1.2rem}}@media (min-width:61rem){.site-happy-text-wrapper{font-size:1.3rem}}.site-happy-text{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;text-align:center}@media (min-width:42rem){.site-happy-text{text-align:left}}.site-happy-text-headline{display:block}.site-happy-text-headline,.wf-active .site-happy-text-headline{font-size:26.599px;font-size:1.9rem;font-weight:700}@media (min-width:25rem){.site-happy-text-headline{font-size:2.3rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:2.5rem}}@media (min-width:59rem){.site-happy-text-headline{font-size:2.9rem}.wf-active .site-happy-text-headline{font-size:3.1rem}}@media (min-width:61rem){.site-happy-text-headline{font-size:2.92rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:3.2rem}}.site-happy-text-tagline{display:inline}@media (min-width:42rem){.site-happy-text-tagline{display:block}}.navigation-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;padding:28px 0 0;padding:2rem 0 0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}@media (min-width:59rem){.navigation-wrapper{max-width:23rem;padding:0 0 0 2rem}}.navigation{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-width:100%;width:100%}@media (min-width:59rem){.navigation{-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-width:0}}.navigation-item{-webkit-box-flex:1;-ms-flex:1 1 33%;flex:1 1 33%;min-width:33%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;cursor:pointer;font-size:11.9px;font-size:.85rem;font-weight:200;-webkit-transition:background-color .25s;transition:background-color .25s}@media (min-width:25rem){.navigation-item{font-size:.9rem}}@media (min-width:45rem){.navigation-item{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.navigation-item{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:33%}}.navigation-item:first-child{background:#e2e2e2}.navigation-item:first-child:hover{background:#ddd}.navigation-item:nth-child(2){background:#e8e8e8}.navigation-item:nth-child(2):hover{background:#e3e3e3}.navigation-item:nth-child(3){background:#efefef}.navigation-item:nth-child(3):hover{background:#eaeaea}.navigation-item:nth-child(4){background:#ddd}.navigation-item:nth-child(4):hover{background:#d8d8d8}.navigation-item:nth-child(5){background:#e3e3e3}.navigation-item:nth-child(5):hover{background:#dedede}.navigation-item:nth-child(6){background:#eaeaea}.navigation-item:nth-child(6):hover{background:#e4e4e4}.navigation-link{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:14px;padding:1rem;text-decoration:none;font-size:12.6px;font-size:.9rem;color:#000;-webkit-transition:color .25s;transition:color .25s}@media (min-width:25rem){.navigation-link{padding:1.4rem}}.navigation-link:after{content:"";position:absolute;top:100%;left:0;bottom:0;right:0;height:0;width:100%;background:#fff;opacity:.1;cursor:pointer;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}.navigation-link:hover:after{top:50%;height:50%}.navigation-item-text{-webkit-box-flex:1;-ms-flex:1;flex:1}.posts{padding:28px 14px;padding:2rem 1rem}@media (min-width:470px){.posts{padding:2rem}}.post-wrapper{padding-bottom:28px;padding-bottom:2rem}.post-wrapper:last-child{padding-bottom:0}.post{padding:28px 14px;padding:2rem 1rem;margin:28px 0;margin:2rem 0;background:#fff;max-width:840px;max-width:60rem;position:relative}@media (min-width:470px){.post{padding:2rem}}.post:before{background:linear-gradient(180deg,hsla(0,0%,100%,0) 0,#fff 1500px);-webkit-animation:fadein 1s ease-in;animation:fadein 1s ease-in}.post:after,.post:before{content:" ";position:absolute;top:0;left:50%;bottom:0;width:100vw;-webkit-transform:translateX(-50%);transform:translateX(-50%);z-index:-1}.post:after{background:linear-gradient(0deg,#ececec 0,hsla(0,0%,100%,0) 1000px)}.posts .post{margin:0 auto}.posts .post:after,.posts .post:before{content:none}.posts .post:before{-webkit-animation:none;animation:none}.post>:first-child{margin-top:0}@media (min-width:62rem){.post-page-post-wrapper{margin-left:2rem;margin-right:2rem}}.post-content{font-size:15.4px;font-size:1.1rem;line-height:1.55}.post-content>*{margin:21px 0 0;margin:1.5rem 0 0}.post-content :not(figure)>a{color:#4580a7;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(104,130,197,.4)),to(rgba(104,130,197,.4)));background-image:linear-gradient(rgba(104,130,197,.4),rgba(104,130,197,.4));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-content :not(figure)>a:hover{color:#6882c5}.post-content blockquote{position:relative;font-size:18.2px;font-size:1.3rem;font-size:21.98px;font-size:1.57rem;font-style:italic;font-weight:100;padding-left:28px;padding-left:2rem;line-height:1.48;margin-top:28px;margin-top:2rem}.post-content blockquote:before{content:"\201C";position:absolute;top:-21px;top:-1.5rem;left:-7px;left:-.5rem;height:42px;height:3rem;width:25px;color:#f5f5f5;font-size:84px;font-size:6rem;font-style:normal;line-height:1}.post-content blockquote footer{margin-top:14px;margin-top:1rem;font-size:12.6px;font-size:.9rem;text-align:right}.post-content blockquote cite{display:inline-block;margin-left:7px;margin-left:.5rem}.post-content figure{text-align:center}.post-content figcaption{color:#666;font-size:12.6px;font-size:.9rem;font-style:italic}.post-content img{display:block;max-width:100%;height:auto;margin:0 auto;min-height:50px;min-width:150px;position:relative;color:#b6b6b6;font-size:12.6px;font-size:.9rem;text-align:center}.post-content img:before{content:"Image failed to load :/";display:block;font-size:13.299px;font-size:.95rem}.post-content code,.post-content pre{font-family:Consolas,Monaco,Andale Mono,monospace;text-shadow:0 1px #fff;white-space:pre;word-spacing:normal;word-break:normal;-webkit-font-feature-settings:none;font-feature-settings:none;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;word-wrap:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.post-content :not(h3):not(h4):not(h5):not(h6)>code,.post-content pre{font-size:11.9px;font-size:.85rem}.post-content :not(pre)>code,.post-content pre{background:#f5f5f5}.post-content pre{padding:14px;padding:1rem;overflow:auto;color:#000}.post-content :not(pre)>code{display:inline-block;padding:0 3.815px;padding:0 .2725rem;white-space:normal}.post-content a code{background:transparent none repeat 0 0/auto auto padding-box border-box scroll;background:initial;font-size:13.719px;font-size:.98rem;padding:0;padding:initial}.post-content p:first-child{margin-top:0}.post-content h2,.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3{font-size:22.75px;font-size:1.625rem}.post-content h4{font-size:19.446px;font-size:1.389rem}.post-content h5{font-size:16.142px;font-size:1.153rem}.post-content h6{font-size:13.034px;font-size:.931rem}.post-content .post-header-anchor{position:absolute;left:-14px;left:-1rem;top:20px;width:14px;width:1rem;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:0 0;text-align:center;line-height:1;text-shadow:none;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}@media (min-width:470px){.post-content .post-header-anchor{left:-2rem;top:20px;width:2rem}}.post-content .post-header-anchor:focus{outline:0}.post-content .post-header-anchor:hover svg{opacity:1}.post-content .post-header-anchor:after{content:" copied";position:absolute;bottom:-14px;left:0;right:0;font-size:.6em;color:gray;opacity:0;visibility:none;-webkit-transition:opacity 2s;transition:opacity 2s}.post-content .post-header-anchor svg{opacity:.2}.post-content h4 .post-header-anchor{top:18px}.post-content h5 .post-header-anchor{top:16px}.post-content h6 .post-header-anchor{top:14px}.post-content .post-header-anchor--copied:after{opacity:1}.post-content p:last-of-type{margin-bottom:0}.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3+p,.post-content h4+p,.post-content h5+p,.post-content h6+p{margin-top:7px;margin-top:.5rem}.post-content p+h3,.post-content p+h4,.post-content p+h5,.post-content p+h6{margin-top:28px;margin-top:2rem}.post-content ol,.post-content ul{padding-left:1.25em;list-style:disc outside none;list-style:initial}.post-content ol{list-style-type:decimal}.post-content li{margin-bottom:7px;margin-bottom:.5rem}.post-summary .post-content,.post-summary .post-content>*{display:inline}.post-content table{border-spacing:0;border-collapse:collapse}.post-content td,.post-content th{padding:0;padding:6px 13px;border:1px solid #dfe2e5}.post-content th{font-weight:600;text-align:left}.post-title-wrapper{margin:0}.post-title{line-height:1.4;font-size:19.599px;font-size:1.4rem;font-weight:700}.wf-active .post-title{font-size:21px;font-size:1.5rem;line-height:1.2}@media (min-width:30rem){.post-title{line-height:1.6;font-size:1.85rem}.wf-active .post-title{line-height:1.5;font-size:2rem}}.post-title-label{display:inline-block;position:relative;bottom:.3em;padding:.2em .4em;margin-left:.3em;font-size:.5em;background:#e3e3e3;color:#9e9e9e;border-radius:5%;font-weight:400;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in}.post-title:hover .post-title-label{opacity:.9}.post-title-label-parenthesis{display:none}.post-meta{font-size:12.6px;font-size:.9rem;margin:14px 0;margin:1rem 0;color:#a2a2a2}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.post-meta{color:#000;font-weight:300}}.post-blog-date{display:block;margin-top:7px;margin-top:.5rem}@media (min-width:30rem){.post-blog-date{display:inline;margin-top:0}.post-blog-date+.post-blog-title:before{display:inline-block;content:" \2014   ";margin:0 .25rem 0 .5rem}}.post-blog-link{font-weight:400;font-style:italic}.footer-link,.post-blog-link,.post-read-more-link,.post-title,.site-happy-text-headline-link,.site-happy-text-tagline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link:hover,.post-blog-link:hover,.post-read-more-link:hover,.post-title:hover,.site-happy-text-headline-link:hover,.site-happy-text-tagline-link:hover{color:#6882c5;background:-webkit-gradient(linear,left top,right top,from(#5c7b8f),to(#6882c5));background:linear-gradient(90deg,#5c7b8f,#6882c5);background-clip:border-box;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-box-decoration-break:clone;box-decoration-break:clone}.footer-link,.post-read-more-link,.post-title,.site-happy-text-tagline-link{color:#5c7b8f}.post-read-more-link{display:inline-block;font-weight:700;margin:0}.post-comments{margin:28px 28px 0;margin:2rem 2rem 0;padding:28px;padding:2rem;background:#fff}@media (min-width:62rem){.post-comments{margin-left:0;margin-right:0}}.post-comments a{color:#5c7b8f;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(rgba(0,0,0,.2)));background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-comments a:hover{color:#6882c5}@media (min-width:62rem){.more-articles{padding-left:0;padding-right:0}}.footer{text-align:center;font-size:11.2px;font-size:.8rem;margin-bottom:28px;margin-bottom:2rem}.footer-text{margin:0}.footer-link{font-weight:700}.copyright{display:block;color:gray}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.copyright{font-weight:100}}.fix-bug-ignore{color:red}.posts{position:relative}.post-wrapper{-webkit-transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out}.post{-webkit-transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out,-webkit-transform .1s ease-in-out}.posts--entering-post .post-wrapper:not(.post-wrapper--entering-from-posts) .post{opacity:.2;-webkit-transform:scale(.8);transform:scale(.8)}.posts--entering-post .post-wrapper--entering-from-posts{left:0;right:0}@media (min-width:62rem){.posts--entering-post .post-wrapper--entering-from-posts{margin-left:2rem;margin-right:2rem}}.post-skeleton{line-height:1.55;position:relative;opacity:0;max-height:0;overflow:hidden}.post-skeleton.post-skeleton--visible,.post-wrapper--entering-from-posts .post-skeleton{opacity:1;margin-top:28px;margin-top:2rem;max-height:none}.post-skeleton:after{content:" ";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;opacity:.2;-webkit-animation:1s skeleton infinite ease-in-out;animation:1s skeleton infinite ease-in-out}.post-skeleton-word{height:15.4px;height:1.1rem;background:#f7f7f7;width:46px;display:inline-block;margin:4px 6px 0 0}.post-skeleton-word:nth-child(2n){width:36px}.post-skeleton-word:nth-child(3n){width:76px}.post-skeleton+.post-skeleton .post-skeleton-word:nth-child(3n){width:71px}.post-skeleton-word:nth-child(5n){width:96px}.post-skeleton-word:nth-child(6n){width:63px}.post-skeleton-word:nth-child(7n){width:26px}@-webkit-keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}</style><style data-vue-ssr-id="1629eadd:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style>
    <script src="https://unpkg.com/scrollto-with-animation/dist/scrollto-with-animation.min.js"></script>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#869bad;opacity:0"></div><div id="__layout"><div class="wrapper"><main class="content"><header class="header"><h1 class="site-title"><a href="/" class="site-link nuxt-link-active">Adam Lynch</a></h1><div class="site-happy-text-wrapper"><p class="site-happy-text"><span class="site-happy-text-headline">
                I'm <a href="/" class="site-happy-text-headline-link nuxt-link-active">Adam Lynch</a>.
            </span><span class="site-happy-text-tagline">
                I like to
                <a href="https://github.com/adam-lynch" class="site-happy-text-tagline-link">code</a>,
                <a href="/" class="site-happy-text-tagline-link nuxt-link-active">write</a>, and dabble in design.
            </span><span class="site-happy-text-tagline">
                I lead <a href="https://www.teamwork.com" class="site-happy-text-tagline-link">Teamwork.com</a>'s next product.
            </span></div><nav class="navigation-wrapper" role="navigation"><ul class="navigation"><li class="navigation-item writing-navigation-item"><a href="/" class="navigation-link nuxt-link-active"><span class="navigation-item-text">Writing</span></a><li class="navigation-item code-navigation-item"><a href="https://github.com/adam-lynch" class="navigation-link" rel="noopener"><span class="navigation-item-text">Code</span></a><li class="navigation-item edit-navigation-item"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="navigation-link" rel="noopener"><span class="navigation-item-text">Edit page</span></a><li class="navigation-item twitter-navigation-item"><a href="https://twitter.com/lynchy010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">Twitter</span></a><li class="navigation-item email-navigation-item"><a href="mailto:contact@adamlynch.com" class="navigation-link" rel="noopener"><span class="navigation-item-text">Email</span></a><li class="navigation-item linkedin-navigation-item"><a href="https://www.linkedin.com/in/adamlynch010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">LinkedIn</span></a></ul></nav></header><div class="post-page-post-wrapper"><article class="post"><h2 class="post-title-wrapper"><a href="/serverless-crash-reporting-for-electron-apps" class="post-title nuxt-link-exact-active nuxt-link-active">Serverless crash reporting for Electron apps</a></h2><div class="post-meta"><time class="post-blog-date">November 22nd, 2016</time><div class="no-ssr-placeholder"></div></div><div class="post-content">
<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>
<p>The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>
<h3><a href="#the-conference" class="post-header-anchor" id="the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>
<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>
<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>
<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>
<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.</p>
<p>The conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.</p>
<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>
<p>Overall, I didn‚Äôt learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>
<h3><a href="#the-crash-reporter" class="post-header-anchor" id="the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>
<p>We‚Äôre currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>
<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 productName<span class="token punctuation">:</span> <span class="token string">'YourAppName;'</span><span class="token punctuation">,</span>
 companyName<span class="token punctuation">:</span> <span class="token string">'YourCompany;'</span><span class="token punctuation">,</span>
 submitURL<span class="token punctuation">:</span> <span class="token string">'https://your-domain.com/url-to-submit&amp'</span><span class="token punctuation">,</span>
 autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'electron‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>'ready‚Äô<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    productName<span class="token punctuation">:</span> 'YourAppName‚Äô<span class="token punctuation">,</span>
    companyName<span class="token punctuation">:</span> <span class="token string">'YourCompany'</span><span class="token punctuation">,</span>
    submitURL<span class="token punctuation">:</span> <span class="token string">'https://your-domain.com/url-to-submit'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h3><a href="#the-serverless-crash-reporter" class="post-header-anchor" id="the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>
<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.</p>
<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>
<ul>
<li>Search.</li>
<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>
<li>New (Electron) desktop apps.</li>
<li>New (native) mobile apps.</li>
</ul>
<p>Expect a few posts on those topics.</p>
<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>
<p>The function</p>
<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what‚Äôs the harm in a little ES6?</p>
<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>
<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>
 release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>
<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.</p>
<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>
<p>The Lambda function</p>
<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>
<p>It wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.</p>
<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.</p>
<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>
<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>
<p>The webtask</p>
<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.</p>
<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.</p>
<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>
<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js && wt create b.js‚Ää‚Äî‚Ääname a.</p>
<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.</p>
<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.</p>
<p>Side note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>
<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>
<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>
<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>
<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html '</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'&lt;h1>Hello, world!&lt;/h1>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>
<p>OK, so I got it working. Finally. Here is my webtask:</p>
<pre><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'formidable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raven'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'aws-sdk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'bluebird'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  sentryDsn<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  accessKey<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  bucket<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  secretAccessKey<span class="token punctuation">:</span> <span class="token string">'TODO'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>

<span class="token comment">// req - request {Object}</span>
<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>
<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>
        files<span class="token punctuation">:</span> files
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// name - {String}</span>
<span class="token comment">// contents - {String}</span>
<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>
<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>
    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      ACL<span class="token punctuation">:</span> <span class="token string">'public-read'</span><span class="token punctuation">,</span>
      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>
      Body<span class="token punctuation">:</span> contents
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// context - {Object}</span>
<span class="token comment">// req - {Object}</span>
<span class="token comment">// res - {Object}</span>
<span class="token comment">// Returns a Promise</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Successfully received crash and sent event to Sentry!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>
        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'upload_file_minidump'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>
            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>
            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">' crash'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        context<span class="token punctuation">:</span> context
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>One thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>
<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?</p>
<h3><a href="#the-conclusion" class="post-header-anchor" id="the-conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conclusion</h3>
<p>In the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>
<p>For this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>
<p>I didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>
<p>I‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.</p>
</div></article><aside><div class="post-comments"><p>Feedback is more than welcome via <a href="https://twitter.com/lynchy010">@lynchy010</a> or <a href="mailto:contact@adamlynch.com">contact@adamlynch.com</a></div><div class="no-ssr-placeholder"></div></aside></div><footer class="footer"><p class="footer-text"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="footer-link">This site is open source</a><span class="copyright">¬© 2019 Adam Lynch</span></footer></main></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{article:{id:"serverless-crash-reporting-for-electron-apps",slug:"serverless-crash-reporting-for-electron-apps",highlightedLanguages:["javascript"],source:"---\ndate: 2016-11-22\noriginal:\n  blogLink: https://engineroom.teamwork.com\n  blogName: Teamwork's Engine Room\n  url: https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a\ntags:\n  - serverless\n  - electron\n  - javascript\n  - aws\n  - development\n---\n\n## Serverless crash reporting for Electron apps\n\n[![](https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png)](https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png)\n\n\n:::summary\n\nThe term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from [Electron](http://electron.atom.io/) apps.\n\n:::\n\n### The conference\n\nI attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like [NodeConf EU](http://www.nodeconf.eu/). A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever [ServerlessConf](http://serverlessconf.io/).\n\nI bought a [Udemy](https://www.udemy.com/) course on [AWS Lambda](https://aws.amazon.com/lambda/) during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular [S3](https://aws.amazon.com/s3/) bucket.\n\n\n[![](https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png)](https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png)\n\nSo you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an [EC2](https://aws.amazon.com/ec2/) instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.\n\nThe conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning :/). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.\n\nMost of the talks involved AWS and there were a lot of jokes at [API Gateway](https://aws.amazon.com/api-gateway/)‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting [talk](http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development) on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like [Firebase](https://firebase.google.com/), [Auth0](https://auth0.com/), [Algolia](https://www.algolia.com/), [Netlify](https://www.netlify.com/), [Webtask.io](https://webtask.io/), and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.\n\nOverall, I didn‚Äôt learn _that_ much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.\n\n### The crash reporter\n\nWe‚Äôre currently rewriting our desktop apps to be based on Electron rather than [NW.js](http://nwjs.io/). I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called [Developing an Electron Edge](http://shop.oreilly.com/product/9781939902344.do) and while proofreading it, a nice serverless use case struck me; serverless crash reporting.\n\nSure, we report runtime errors to [Sentry](https://sentry.io/teamwork/) when they occur in [Teamwork Chat](https://teamwork.com/chat), but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs [`crash-reporter`](http://electron.atom.io/docs/api/crash-reporter/) module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.\n\n```javascript\nconst { crashReporter } = require('electron');\n\ncrashReporter.start({\n productName: 'YourAppName;',\n companyName: 'YourCompany;',\n submitURL: 'https://your-domain.com/url-to-submit&amp',\n autoSubmit: true\n});\n```\n\nThat‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.\n\n```javascript\nconst { app, crashReporter } = require('electron‚Äô);\n\napp.on('ready‚Äô, () => {\n  crashReporter.start({\n    productName: 'YourAppName‚Äô,\n    companyName: 'YourCompany',\n    submitURL: 'https://your-domain.com/url-to-submit',autoSubmit: true\n  });\n  setTimeout(() => {\n  process.crash()\n  }, 3000);\n})\n```\n\n### The serverless crash reporter\n\nSo how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.\n\nIt would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;\n\n*   Search.\n*   Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.\n*   New (Electron) desktop apps.\n*   New (native) mobile apps.\n\nExpect a few posts on those topics.\n\nAnyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.\n\nThe function\n\nI started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in [CoffeeScript at Teamwork](https://adamlynch.com/coffeescript-at-teamwork/) but this will only be a few lines long, what‚Äôs the harm in a little ES6?\n\nI quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with [express](http://expressjs.com/), and called my function whenever it received a POST.\n\n```javascript\nravenClient = new raven.Client(config.sentryDsn, {\n release: options._version\n});\n```\n\nWhen instantiating [Raven](https://github.com/getsentry/raven-node) (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.\n\nAnother thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.\n\nNow I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.\n\nThe Lambda function\n\nEven though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.\n\nIt wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.\n\nA few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.\n\nAround the same time, I started investigating the [Serverless Framework](https://serverless.com/). It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is [open-sourced](https://github.com/serverless/serverless), I think.\n\nMaybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which _does_ support POSTing of files. I [posted](http://forum.serverless.com/t/no-support-for-posting-files/307) in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.\n\nThe webtask\n\nDisappointed, I almost gave up until I remembered Webtask.io. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0\\. A quick look at their site got my hopes up again. There was even a _free_ plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.\n\nBased on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.\n\nI had a few little hiccups with their [wt-cli](https://www.npmjs.com/package/wt-cli) CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.\n\nWebtask.io has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; [webtask-bundle](https://www.npmjs.com/package/webtask-bundle). So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.\n\nThe bundler uses [Webpack](https://webpack.github.io/) underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used [bluebird](http://bluebirdjs.com/docs/getting-started.html) for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know Webtask.io have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.\n\nRunning the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.\n\nSide note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for [local debugging](https://github.com/auth0/wt-cli/pull/89) was added recently though.\n\nOnce I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.\n\nOne thing I should point out is the Webtask.io has a [Slack channel](https://webtask-chat.slack.com/) where you can receive some much appreciated support. It was pointed out to me there that Webtask.io actually supports [multiple function signatures](https://webtask.io/docs/model) and I should try one of the other options; specifically the one that uses express.\n\nOnce I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.\n\n```javascript\nmodule.exports = function(context, req, res) {\n  res.writeHead(200, {\n  'Content-Type': 'text/html '\n  });\n  res.end('<h1>Hello, world!</h1>');\n}\n```\n\nNote: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.\n\nOK, so I got it working. Finally. Here is my webtask:\n\n```javascript\n'use strict';\nconst fs = require('fs');\nconst path = require('path');\nconst formidable = require('formidable');\nconst raven = require('raven');\nconst aws = require('aws-sdk');\nconst Promise = require('bluebird');\nconst config = {\n  sentryDsn: 'TODO',\n  s3: {\n  accessKey: 'TODO',\n  bucket: 'TODO',\n  secretAccessKey: 'TODO'\n  }\n};\n\nvar ravenClient, onError;\n\n// req - request {Object}\n// Returns a Promise which resolves to an {Object} containing {fields} and {files}\nconst parseFormData = (req) => {\n  return new Promise((resolve, reject) => {\n    formidable.IncomingForm().parse(req, (err, fields, files) => {\n      if (err) {\n        return reject(err);\n      }\n      resolve({\n        fields: fields,\n        files: files\n      });\n    });\n  });\n};\n\n// name - {String}\n// contents - {String}\n// Returns a Promise which resolves to a {String} URL\nconst uploadDumpToS3 = (name, contents) => {\n  aws.config.update({\n    accessKeyId: config.s3.accessKey,\n    secretAccessKey: config.s3.secretAccessKey\n  });\n  const s3 = new aws.S3({\n    params: {\n      Bucket: config.s3.bucket\n    }\n  });\n  return new Promise((resolve, reject) => {\n    s3.upload({\n      ACL: 'public-read',\n      Key: name,\n      Body: contents\n    }, (err, data) => {\n      if (err) {\n        return reject(err);\n      }\n      resolve(data.Location);\n    });\n  });\n};\n\n// context - {Object}\n// req - {Object}\n// res - {Object}\n// Returns a Promise\nmodule.exports = (context, req, res) => {\n  onError = (error, options) => {\n    if (!ravenClient) {\n      ravenClient = new raven.Client(config.sentryDsn, {\n        release: options._version\n      });\n    }\n\n    ravenClient.captureException(error, options);\n    res.end('Successfully received crash and sent event to Sentry!');\n  }\n\n  return parseFormData(req)\n    .then(formData => {\n      const payload = {\n        tags: formData.fields,\n        extra: {}\n      };\n      const dump = formData.files['upload_file_minidump'];\n\n      if (dump) {\n        const contents = fs.readFileSync(dump.path).toString('utf8');\n        return uploadDumpToS3(dump.name, contents)\n          .then(url => {\n            payload.extra[dump.name] = url;\n            return payload;\n          });\n      } else {\n        return payload;\n      }\n    })\n    .then((payload) => {\n      return onError(new Error(payload.tags.process_type + ' crash'), payload);\n    })\n    .catch((err) => onError(err, {\n      extra: {\n        context: context\n      }\n    }));\n};\n```\n\nOne thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.\n\nNext up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that Webtask.io‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?\n\n### The conclusion\n\nIn the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it _should_ be that easy.\n\nFor this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.\n\nI didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at [Teamwork/serverless-crash-reporting](https://github.com/Teamwork/serverless-crash-reporting). Feedback is welcome, this stuff is completely new to me.\n\nI‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, [two new Lambda features](https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/) were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.\n",unfilteredRenderedBody:'<h2><a id="serverless-crash-reporting-for-electron-apps" class="post-header-anchor" href="#serverless-crash-reporting-for-electron-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Serverless crash reporting for Electron apps</h2>\n<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>\n<article-summary><p>The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n</article-summary><h3><a id="the-conference" class="post-header-anchor" href="#the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>\n<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>\n<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>\n<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>\n<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.</p>\n<p>The conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.</p>\n<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>\n<p>Overall, I didn‚Äôt learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>\n<h3><a id="the-crash-reporter" class="post-header-anchor" href="#the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>\n<p>We‚Äôre currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>\n<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you\'ve supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ncrashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n productName<span class="token punctuation">:</span> <span class="token string">\'YourAppName;\'</span><span class="token punctuation">,</span>\n companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany;\'</span><span class="token punctuation">,</span>\n submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit&amp;amp\'</span><span class="token punctuation">,</span>\n autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>That‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>\'electron‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>\'ready‚Äô<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    productName<span class="token punctuation">:</span> \'YourAppName‚Äô<span class="token punctuation">,</span>\n    companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany\'</span><span class="token punctuation">,</span>\n    submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit\'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<h3><a id="the-serverless-crash-reporter" class="post-header-anchor" href="#the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>\n<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.</p>\n<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>\n<ul>\n<li>Search.</li>\n<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>\n<li>New (Electron) desktop apps.</li>\n<li>New (native) mobile apps.</li>\n</ul>\n<p>Expect a few posts on those topics.</p>\n<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>\n<p>The function</p>\n<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what‚Äôs the harm in a little ES6?</p>\n<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>\n<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>\n<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.</p>\n<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>\n<p>The Lambda function</p>\n<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>\n<p>It wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.</p>\n<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.</p>\n<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>\n<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>\n<p>The webtask</p>\n<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.</p>\n<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.</p>\n<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>\n<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.</p>\n<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.</p>\n<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.</p>\n<p>Side note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>\n<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>\n<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>\n<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>\n<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token string">\'Content-Type\'</span><span class="token punctuation">:</span> <span class="token string">\'text/html \'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'&lt;h1>Hello, world!&lt;/h1>\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>\n<p>OK, so I got it working. Finally. Here is my webtask:</p>\n<pre><code class="language-javascript"><span class="token string">\'use strict\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'formidable\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'raven\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'aws-sdk\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'bluebird\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>\n  sentryDsn<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  accessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  bucket<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  secretAccessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>\n\n<span class="token comment">// req - request {Object}</span>\n<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>\n        files<span class="token punctuation">:</span> files\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// name - {String}</span>\n<span class="token comment">// contents - {String}</span>\n<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>\n<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>\n    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      ACL<span class="token punctuation">:</span> <span class="token string">\'public-read\'</span><span class="token punctuation">,</span>\n      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>\n      Body<span class="token punctuation">:</span> contents\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// context - {Object}</span>\n<span class="token comment">// req - {Object}</span>\n<span class="token comment">// res - {Object}</span>\n<span class="token comment">// Returns a Promise</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Successfully received crash and sent event to Sentry!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>\n        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>\n        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">\'upload_file_minidump\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">\'utf8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>\n            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>\n            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">\' crash\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        context<span class="token punctuation">:</span> context\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>One thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>\n<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?</p>\n<h3><a id="the-conclusion" class="post-header-anchor" href="#the-conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conclusion</h3>\n<p>In the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>\n<p>For this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>\n<p>I didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>\n<p>I‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.</p>\n',attributes:{date:"2016-11-22T00:00:00.000Z",original:{blogLink:"https://engineroom.teamwork.com",blogName:"Teamwork's Engine Room",url:"https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a"},tags:[{id:"serverless",name:"serverless"},{id:"electron",name:"electron"},{id:"javascript",name:"javascript"},{id:"aws",name:"aws"},{id:"development",name:"development"}],title:"Serverless crash reporting for Electron apps",updated_at:"2019-05-22T08:26:26.903Z",photo:"https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png"},title:"Serverless crash reporting for Electron apps",renderedSummary:'<p>The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n',rendered:'<h2><a id="serverless-crash-reporting-for-electron-apps" class="post-header-anchor" href="#serverless-crash-reporting-for-electron-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Serverless crash reporting for Electron apps</h2>\n<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>\n<p>The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n<h3><a id="the-conference" class="post-header-anchor" href="#the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>\n<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>\n<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>\n<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>\n<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.</p>\n<p>The conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.</p>\n<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>\n<p>Overall, I didn‚Äôt learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>\n<h3><a id="the-crash-reporter" class="post-header-anchor" href="#the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>\n<p>We‚Äôre currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>\n<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you\'ve supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ncrashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n productName<span class="token punctuation">:</span> <span class="token string">\'YourAppName;\'</span><span class="token punctuation">,</span>\n companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany;\'</span><span class="token punctuation">,</span>\n submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit&amp;amp\'</span><span class="token punctuation">,</span>\n autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>That‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>\'electron‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>\'ready‚Äô<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    productName<span class="token punctuation">:</span> \'YourAppName‚Äô<span class="token punctuation">,</span>\n    companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany\'</span><span class="token punctuation">,</span>\n    submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit\'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<h3><a id="the-serverless-crash-reporter" class="post-header-anchor" href="#the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>\n<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.</p>\n<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>\n<ul>\n<li>Search.</li>\n<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>\n<li>New (Electron) desktop apps.</li>\n<li>New (native) mobile apps.</li>\n</ul>\n<p>Expect a few posts on those topics.</p>\n<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>\n<p>The function</p>\n<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what‚Äôs the harm in a little ES6?</p>\n<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>\n<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>\n<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.</p>\n<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>\n<p>The Lambda function</p>\n<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>\n<p>It wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.</p>\n<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.</p>\n<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>\n<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>\n<p>The webtask</p>\n<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.</p>\n<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.</p>\n<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>\n<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.</p>\n<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.</p>\n<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.</p>\n<p>Side note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>\n<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>\n<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>\n<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>\n<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token string">\'Content-Type\'</span><span class="token punctuation">:</span> <span class="token string">\'text/html \'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'&lt;h1>Hello, world!&lt;/h1>\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>\n<p>OK, so I got it working. Finally. Here is my webtask:</p>\n<pre><code class="language-javascript"><span class="token string">\'use strict\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'formidable\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'raven\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'aws-sdk\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'bluebird\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>\n  sentryDsn<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  accessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  bucket<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  secretAccessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>\n\n<span class="token comment">// req - request {Object}</span>\n<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>\n        files<span class="token punctuation">:</span> files\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// name - {String}</span>\n<span class="token comment">// contents - {String}</span>\n<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>\n<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>\n    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      ACL<span class="token punctuation">:</span> <span class="token string">\'public-read\'</span><span class="token punctuation">,</span>\n      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>\n      Body<span class="token punctuation">:</span> contents\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// context - {Object}</span>\n<span class="token comment">// req - {Object}</span>\n<span class="token comment">// res - {Object}</span>\n<span class="token comment">// Returns a Promise</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Successfully received crash and sent event to Sentry!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>\n        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>\n        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">\'upload_file_minidump\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">\'utf8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>\n            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>\n            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">\' crash\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        context<span class="token punctuation">:</span> context\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>One thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>\n<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?</p>\n<h3><a id="the-conclusion" class="post-header-anchor" href="#the-conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conclusion</h3>\n<p>In the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>\n<p>For this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>\n<p>I didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>\n<p>I‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.</p>\n',summary:"The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.\n",original:{blogLink:"https://engineroom.teamwork.com",blogName:"Teamwork's Engine Room",url:"https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a"},photo:"https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png",keywords:["serverless","electron","javascript","aws","development"],published_at:"2016-11-22T00:00:00.000Z",updated_at:"2019-05-22T08:26:26.903Z",year:2016,month:11,day:23,relevanceScore:.75,moreArticles:[{id:"flexible-data-tables-with-css-grid",slug:"flexible-data-tables-with-css-grid",highlightedLanguages:["css"],source:'---\ndate: 2019-05-12\ntags:\n  - css grid\n  - css\n  - javascript\n  - table\n  - data\n  - responsive design\n  - responsive\n  - flexbox\n  - resize column\n  - web app\n  - development\n  - crm\n  - sales\n---\n\n## Flexible data tables with CSS Grid\n\n::: summary\n\nNow that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the [Teamwork CRM](https://www.teamwork.com/crm) puzzle was the "list view". \n\nIt\'s a powerful page component which exists seven times in the app ‚Äî a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n\n:::\n\n\nFirst, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to [skip to the CSS Grid bit](#just-get-to-css-grid-already).\n\n:::figure flexible-data-tables-with-css-grid/wide3.png The leads list view.\n:::\n\nPrimarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet ‚Äî we can do a better job at laying out the data, which there will be a lot of.\n\nEverything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints). \n\nAt its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen. \n\n:::figure flexible-data-tables-with-css-grid/narrow.png What a list view looks like on a narrow screen.\n:::\n\nResponsive tables are tricky. There are [several existing patterns](https://bradfrost.github.io/this-is-responsive/patterns.html) you could pick from. Consider what your users are trying to achieve and choose wisely. \n\nOnce we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.\n\nAssume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns. \n\nColumns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.\n\n:::figure flexible-data-tables-with-css-grid/resizing-window.gif How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.\n:::\n\nTo begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.\n\n## Just get to CSS Grid already\n\nI\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s [The New CSS Layout](https://abookapart.com/products/the-new-css-layout) or [A Complete Guide to Grid](https://css-tricks.com/snippets/css/complete-guide-grid/) and when you\'re done wondering where Grid was all your life, come back to me.\n\nThe first thing we do is apply `display: grid` to the `<table>` to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using `display:table`). Its children become grid items; the `<thead>` and `<tbody>`. It\'s not the `<thead>`, `<tbody>`, or even the `<tr>`s we\'re concerned with though. What we want to do is lay out our `<th>`s and `<td>`s on this grid. We could apply `display: grid` to each of these too (i.e. grids within grids), but that\'s not ideal. Each `<tr>` grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).\n\nA workaround is to use `display: contents` on the `<thead>`, `<tbody>`, and `<tr>`s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the `<th>`s and `<td>`s) to participate in the the `<table>` grid instead. \n\nThen we use the magic `grid-template-columns` to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:\n\n```css\ngrid-template-columns: minmax(150px, 1.33fr) minmax(150px, 2.33fr);\n```\n\nWe use the same minimum size for all columns but the max (`fr`) value is determined by the column data type. I tried using Grid\'s`auto` and `max-content` too but what we\'ve ended up with seems to produce the best result.\n\nHere is a simplified example:\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nYou should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.\n\n## Resizing columns with Grid\n\nOn top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields. \n\nFor example, a user could create a (date) custom field for contacts called "Date of birth" so that can be tracked in the system for each contact. \n\nSince a type like "Date" is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.\n\n1. The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for `mousedown` on the resize handle.\n2. When the user clicks the handle, we bind some more `mousemove` and `mousedown` event listeners (to the `window`). We also add some classes for decoration at this point.\n3. When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the `<table>`\'s `grid-template-columns`s rule (via `style` attribute), this time replacing the max (`fr`) value with a pixel value. For example, `grid-template-columns: minmax(150px, 1.33fr) 296px;`. We do this using `requestAnimationFrame` to keep it as smooth as possible.\n4. When `mouseup` is fired, we unbind event listeners and remove classes.\n\nEdit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using `table.scrollLeft` instead of `document.documentElement.scrollLeft` to get the horizontal scroll position of the *page*.\n\nTry this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nWhat\'s great here is that we only need to update one element in the DOM, not each cell.\n\nWe always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.\n\n## Fixed column widths\n\nYou might have noticed I didn\'t tell the whole truth. Not only do we "fix" the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.\n\nI originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nAfter some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions. \n\nWe shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.\n\nTherefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.\n\n:::figure flexible-data-tables-with-css-grid/resizing-columns.gif Before, during, and after resizing a column. Sorry the GIF is a bit janky.\n:::\n\nOnce someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.\n\nI can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and `display: contents` aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.\n\nUsing something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking "Hmm, I want this column to take up 20% of the window even if I resize it". Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.\n\n## Toggling columns\n\n:::figure flexible-data-tables-with-css-grid/manage-columns.png Our modal for customizing which columns are shown.\n:::\n\nImagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default `grid-template-column` values depending on their data type. For example, `minmax(150px, 3.33fr)`.\n\nIf any of the columns has a fixed width stored in localStorage, we make *all* of the chosen columns fixed width (and store those widths in localStorage too).\n\nOver time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.\n\nWe also store an array of column identifiers in localStorage, separate to the column width entries.\n\n## "Why didn\'t you just use {{ libraryName }}?"\n\nI didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use `<table>` at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.\n\n## "Why didn\'t you just use Flexbox?"\n\nEach row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.\n\nI could have switched to `<div>`s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a `<table>`. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.\n\n## "Why didn\'t you just use a `<colgroup>`?"\n\nCheck out [`<colgroup>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup), it\'s a handy old element. Once you define your columns using `<col>`s, styles applied to one will effectively be applied to all of the cells in that column. \n\nIn the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.\n\n## "Why didn\'t you just use table-layout: fixed?"\n\nI could have use `table-layout: fixed` on the `<table>` and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.\n\n## "But you could still have used a table!"\n\nYes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.\n\n## Don\'t go overboard with display: contents\n\n`display:contents` allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content. \n\nWe discovered a [strange bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1550728) when combining it with native drag & drop in Firefox.\n\nFortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See [Why display: contents is not CSS Grid Layout subgrid](https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/).\n\n## I\'m probably forgetting something\n\nThere\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore. \n\nWe use `position: sticky` to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.\n\nI didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.\n\nWe\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.\n\nAnyway, thanks for reading.\n',unfilteredRenderedBody:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<article-summary><p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app ‚Äî a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n</article-summary><p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet ‚Äî we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Edit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using <code>table.scrollLeft</code> instead of <code>document.documentElement.scrollLeft</code> to get the horizontal scroll position of the <em>page</em>.</p>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',attributes:{date:"2019-05-12T00:00:00.000Z",tags:[{id:"css-grid",name:"css grid"},{id:"css",name:"css"},{id:"javascript",name:"javascript"},{id:"table",name:"table"},{id:"data",name:"data"},{id:"responsive-design",name:"responsive design"},{id:"responsive",name:"responsive"},{id:"flexbox",name:"flexbox"},{id:"resize-column",name:"resize column"},{id:"web-app",name:"web app"},{id:"development",name:"development"},{id:"crm",name:"crm"},{id:"sales",name:"sales"}],title:"Flexible data tables with CSS Grid",updated_at:"2019-05-23T16:49:56.604Z",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"},title:"Flexible data tables with CSS Grid",renderedSummary:"<p>Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the <a href=\"https://www.teamwork.com/crm\" rel=\"noopener\">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It's a powerful page component which exists seven times in the app ‚Äî a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n",rendered:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app ‚Äî a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n<p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet ‚Äî we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Edit: Thank you Gideon Grossman for pointing out a column resize bug which happens when the page is horizontally scrolled. I was incorrectly using <code>table.scrollLeft</code> instead of <code>document.documentElement.scrollLeft</code> to get the horizontal scroll position of the <em>page</em>.</p>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',summary:"Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &quot;list view&quot;.\nIt's a powerful page component which exists seven times in the app ‚Äî a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png",keywords:["css grid","css","javascript","table","data","responsive design","responsive","flexbox","resize column","web app","development","crm","sales"],published_at:"2019-05-12T00:00:00.000Z",updated_at:"2019-05-23T16:49:56.604Z",year:2019,month:5,day:13,relevanceScore:2},{id:"beyond-the-browser-from-web-apps-to-desktop-apps",slug:"beyond-the-browser-from-web-apps-to-desktop-apps",highlightedLanguages:["javascript","markup"],source:'---\ndate: 2017-03-21\noriginal:\n  blogLink: https://www.smashingmagazine.com/\n  blogName: Smashing Magazine\n  url: https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/\ntags:\n  - node-webkit\n  - electron\n  - desktop\n  - javascript\n  - development\n---\n\n## Beyond The Browser: From Web Apps To Desktop Apps\n\n:::summary\n\nI started out as a web developer, and that‚Äôs now one part of what I do as a full-stack developer, but never had I imagined I‚Äôd create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least‚Ä¶ different.\n\n:::\n\nIt‚Äôs not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?\n\nOK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.\n\nIn this article, we‚Äôll look at the development of desktop applications using [NW.js](http://nwjs.io/) and [Electron](http://electron.atom.io/), the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.\n\n### Why?\n\nFirst of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user‚Äôs system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.\n\nMaybe you‚Äôve an idea that would only work as a desktop app; some things simply aren‚Äôt possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you‚Äôve an idea for the Mac App Store. Maybe it would simply be a fun side project.\n\nIt‚Äôs hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you‚Äôd like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a [chat application](https://teamwork.com/chat). On the other hand, a connection-dependent desktop app that doesn‚Äôt really have any desktop integration should be a web app and a web app alone. It wouldn‚Äôt be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn‚Äôt get any more value from it than from visiting a URL of yours in their favorite browser.\n\nInstead of describing the desktop app you personally should build and why, I‚Äôm hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.\n\n### NW.js\n\nDesktop applications have been around a long time but you don‚Äôt have all day, so let‚Äôs skip some history and begin in Shanghai, 2011. Roger Wang, of Intel‚Äôs Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within `<script>` tags.\n\nAfter some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.\n\n*Note*: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.\n\nSo, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn‚Äôt know any better. That‚Äôs pretty powerful, but how does it work? Well, first let‚Äôs take a look at Chromium.\n\n\n:::figure beyond-the-browser/chromiumDiagram.png A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)\n:::\n\nThere is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).\n\n:::figure beyond-the-browser/nwjsDiagram.png A rough diagram of an NW.js app\'s internals.\n:::\n\nThis is roughly what an NW.js app looks like. It‚Äôs basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you‚Äôve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.\n\nCreating an app is really easy. All you need is an HTML file and a `package.json`, like you would have when working with Node.js. You can create a default one by running `npm init --yes`. Typically, a `package.json` would point a JavaScript file as the ‚Äúmain‚Äù file for the module (i.e. using the `main` property), but with NW.js you need to edit the `main` property to point to your HTML file.\n\n```javascript\n{\n  "name": "example-app",\n  "version": "1.0.0",\n  "description": "",\n  "main": "index.html",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC"\n}\n```\n\n```markup\n\x3c!-- index.html --\x3e\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Example app</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body>\n    <h1>Hello, world!</h1>\n  </body>\n</html>\n```\n\nOnce you install the official `nw` package from npm (by running `npm install -g nw`), you can run `nw .` within the project directory to launch your app.\n\n:::figure beyond-the-browser/nwjsHelloWorld.png A screenshot of our example NW.js app.\n:::\n\nIt‚Äôs as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn‚Äôt look like much, but it‚Äôs up to you add some markup and styles, just like you would in a web app.\n\nYou could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and [resurrected Clippy](http://adamlynch.com/resurrecting-clippy/) using NW.js. There‚Äôs something weirdly satisfying about seeing Clippy on macOS or Windows 10.\n\n:::figure beyond-the-browser/clippy.png A screenshot of clippy.desktop on macOS.\n:::\n\nSo, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.\n\n:::figure beyond-the-browser/moduleCounts.png Bar graph showing the number of modules per major package manager. (Source: [Module Counts](http://modulecounts.com))\n:::\n\nYou get access not only to Node.js‚Äô APIs but to all of npm, which has over 350,000 modules now. For example, [auto-launch](https://github.com/Teamwork/node-auto-launch) is an open-source module we created at [Teamwork.com](https://www.teamwork.com/) to launch an NW.js or Electron app on startup.\n\nNode.js also has what‚Äôs known as ‚Äúnative modules,‚Äù which, if you really need to do something a bit lower level, allows you to create modules in C or C++.\n\nTo top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:\n\n```javascript\nnew Notification(\'Hello\', {\n  body: \'world\'\n});\n```\n\n### Electron\n\nYou might recognize GitHub‚Äôs text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.\n\n:::figure beyond-the-browser/atom.png A screenshot of Atom, GitHub\'s text editor.\n:::\n\n*Note*: It‚Äôs disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it‚Äôs effectively a fork for the end user because the APIs were almost identical.\n\nIn making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.\n\n:::figure beyond-the-browser/logos.png Logos of projects that use Electron.\n:::\n\nAs well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.\n\n### How Does It Differ?\n\nBut how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.\n\n:::figure beyond-the-browser/electronDiagram.png A rough diagram of an Electron app\'s internals.\n:::\n\nThe Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don‚Äôt have to do anything.\n\n_Note_: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn‚Äôt quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.\n\nBack to the main process. Your app hasn‚Äôt any window by default, but you can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like NW.js.\n\nSo, yeah, the minimum you need for an Electron app is a main JavaScript file (which we‚Äôll leave empty for now) and a `package.json` that points to it. Then, all you need to do is `npm install --save-dev electron` and run `electron .` to launch your app.\n\n```javascript\n{\n  "name": "example-app",\n  "version": "1.0.0",\n  "description": "",\n  "main": "main.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC"\n}\n```\n\n```javascript\n// main.js, which is empty\n```\n\nNot much will happen, though, because your app hasn‚Äôt any window by default. You can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like they‚Äôd have in an NW.js app.\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet mainWindow;\n\napp.on(\'ready\', () => {\n  mainWindow = new BrowserWindow({\n    width: 500,\n    height: 400\n  });\n  mainWindow.loadURL(\'file://\' + __dirname + \'/index.html\');\n});\n```\n\n```markup\n\x3c!-- index.html --\x3e\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Example app</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body>\n    <h1>Hello, world!</h1>\n  </body>\n</html>\n```\n\nYou could load a remote URL in this window, but typically you‚Äôd create a local HTML file and load that. Ta-da!\n\n:::figure beyond-the-browser/electronHelloWorld.png A screenshot of our example Electron app.\n:::\n\nOf the built-in modules Electron provides, like the `app` or `BrowserWindow` module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you‚Äôd catch the `click` event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.\n\nOK, so Electron has distinct processes, and you have to organize your app slightly differently, but that‚Äôs not a big deal. Why are people using Electron instead of NW.js? Well, there‚Äôs mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.\n\nElectron‚Äôs documentation really is amazing, though ‚Äî that‚Äôs worth emphasizing. Take the [Electron API Demos app](https://github.com/electron/electron-api-demos). It‚Äôs an Electron app that interactively demonstrates what you can do with Electron‚Äôs APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.\n\n:::figure beyond-the-browser/apiDemosApp.png A screenshot of the Electron API Demos app.\n:::\n\nIf you submit an issue via Electron‚Äôs bug tracker, you‚Äôll get a response within a couple of days. I‚Äôve seen three-year-old NW.js bugs, although I don‚Äôt hold it against them. It‚Äôs tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I‚Äôm extremely grateful for what NW.js has given us.\n\nElectron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn‚Äôt focused. An example API flaw I ran into was that binding to `Control + Shift + A` in an NW.js app did what you would expect on Windows, but actually bound to `Command + Shift + A` on a Mac. This was intentional but really weird. There was no way to bind to the `Control` key. Also, binding to the `Command` key did bind to the `Command` key but the `Windows` key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you‚Äôd expect. To be fair, NW.js has since fixed the former but not the latter.\n\nThere are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don‚Äôt go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you‚Äôd like. If you want to do something interesting with audio or video, use Electron, because some codecs don‚Äôt work out of the box with NW.js.\n\nElectron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I‚Äôll cover that later.\n\n### But How Does It Feel?\n\nIt feels fine. Sure, it‚Äôs not native. Most desktop apps these days don‚Äôt look like Windows Explorer or Finder anyway, so users won‚Äôt mind or realize that HTML is behind your user interface. You can make it feel more native if you‚Äôd like, but I‚Äôm not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That‚Äôs how a native desktop app would act, but is that better? There are also projects out there like [Photon Kit](http://photonkit.com/), which is basically a CSS framework like Bootstrap, but for macOS-style components.\n\n:::figure beyond-the-browser/photon.png A screenshot of an example Electron app made with Photon.\n:::\n\n### Performance\n\nWhat about performance? Is it slow or laggy? Well, your app is essentially a web app. It‚Äôll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that‚Äôs fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named [Devtron](http://electron.atom.io/devtron/) to monitor some Electron-specific stuff.\n\nYour desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it‚Äôs an isolated process, any computation or processing going on in that window won‚Äôt affect rendering, scrolling or anything else in your visible window(s).\n\nKeep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won‚Äôt).\n\n### Distribution\n\nBoth NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn‚Äôt support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you‚Äôll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don‚Äôt have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).\n\nElectron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be [phasing out Chrome Packaged Apps](http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html), but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.\n\nEven though 32-bit and 64-bit builds are supported, you‚Äôll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.\n\nSo, let‚Äôs say that Electron has won over and you want to ship an Electron app. There‚Äôs a nice Node.js module named [electron-packager](https://github.com/electron-userland/electron-packager) that helps with packing your app up into an `.app` or `.exe` file. A few similar projects exist, including interactive ones that prompt you step by step. You should use [electron-builder](https://github.com/electron-userland/electron-builder), though, which builds on top of electron-packager, plus a few other related modules. It generates `.dmg`s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.\n\nThe annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you‚Äôre serious about shipping desktop apps, then you‚Äôll need to build on multiple machines for each release.\n\nThis can feel a bit too manual or tedious, especially if you‚Äôre used to creating for the web. Thankfully, electron-builder was created with automation in mind. I‚Äôm talking here about continuous integration tools and services such as [Jenkins](https://jenkins.io/), [CodeShip](http://codeship.com/), [Travis-CI](https://travis-ci.org/), [AppVeyor](https://www.appveyor.com/) (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.\n\n### Automatic Updates\n\nNW.js doesn‚Äôt have automatic update support, but you‚Äôll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as [node-webkit-updater](https://github.com/edjafarov/node-webkit-updater), which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.\n\nElectron has built-in support for automatic updates, via its [autoUpdater](http://electron.atom.io/docs/api/auto-updater/) API. It doesn‚Äôt support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux ‚Äî don‚Äôt worry. The `autoUpdater` API is really simple; once you give it a URL, you can call the `checkForUpdates` method. It‚Äôs event-driven, so you can subscribe to the `update-downloaded` event, for example, and once it‚Äôs fired, call the `restartAndInstall` method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.\n\n_Note_: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.\n\nIt‚Äôs not quite as simple behind the API. It‚Äôs based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the [Squirrel.Mac](https://github.com/Squirrel/Squirrel.Mac) and [Squirrel.Windows](https://github.com/Squirrel/Squirrel.Windows) projects, respectively.\n\nThe update code within your Mac Electron app is simple, but you‚Äôll need a server (albeit a simple server). When you call the autoUpdater module‚Äôs `checkForUpdates` method, it will hit your server. What your server needs to do is return a 204 (‚ÄúNo Content‚Äù) if there isn‚Äôt an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a `.zip` file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It‚Äôll go get that `.zip`, unzip it and fire the appropriate events.\n\nThere a bit more (magic) going on in your Windows app when it comes to automatic updates. You won‚Äôt need a server, but you can have one if you‚Äôd like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.\n\nSquirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call `restartAndInstall`, it‚Äôll be a bit quicker because it‚Äôs ready and waiting. It also supports delta updates. Let‚Äôs say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you‚Äôre, say, three versions behind, but it will only do that if it‚Äôs worth it. Otherwise, if you‚Äôre, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it‚Äôs ready to go.\n\n_Note_: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.\n\nThanks to the Electron community, you don‚Äôt have to build your own server if you don‚Äôt want to. There are open-source projects you can use. Some allow you to [store updates on S3](https://github.com/ArekSredzki/electron-release-server) or use [GitHub releases](https://github.com/GitbookIO/nuts), and some even go as far as [providing administrative dashboards](https://github.com/ArekSredzki/electron-release-server) to manage the updates.\n\n### Desktop Versus Web\n\nSo, how does making a desktop app differ from making a web app? Let‚Äôs look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you‚Äôre used to using on the web, workflow pain points, maintenance woes and more.\n\nWell, the first thing that comes to mind is browser lock-in. It‚Äôs like a guilty pleasure. If you‚Äôre making a desktop app exclusively, you‚Äôll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You‚Äôll never have to deal with any cross-browser incompatibilities. This is on top of Node.js‚Äô APIs and all of npm. You can do anything.\n\n_Note_: You‚Äôll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.\n\n#### Working With file://\n\nAnother interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You‚Äôll need to pay more attention to how your app behaves if the network connection is lost while it‚Äôs running. You may need to adjust your mindset.\n\n_Note_: You can load remote URLs if you really want, but I wouldn‚Äôt.\n\nOne tip I can give you here is not to trust [`navigator.onLine`](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine) completely. This property returns a Boolean indicating whether or not there‚Äôs a connection, but watch out for false positives. It‚Äôll return `true` if there‚Äôs any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus‚Äô [`is-online`](https://github.com/sindresorhus/is-online) module to double-check; it will ping the Internet‚Äôs root servers and/or the favicon of a few popular websites. For example:\n\n```javascript\nconst isOnline = require(\'is-online\');\n\nif(navigator.onLine){\n  // hmm there\'s a connection, but is the Internet accessible?\n  isOnline().then(online => {\n    console.log(online); // true or false\n  });\n}\nelse {\n  // we can trust navigator.onLine when it says there is no connection\n  console.log(false);\n}\n```\n\nSpeaking of local files, there are a few things to be aware of when using the `file://` protocol ‚Äî protocol-less URLs, for one; you can‚Äôt use them anymore. I mean URLs that start with `//` instead of `http://` or `https://`. Typically, if a web app requests `//example.com/hello.json`, then your browser would expand this to `http://example.com/hello.json` or to `https://example.com/hello.json` if the current page is loaded over HTTPS. In our app, the current page would load using the `file://` protocol; so, if we requested the same URL, it would expand to `file://example.com/hello.json` and fail. The real worry here is third-party modules you might be using; authors aren‚Äôt thinking of desktop apps when they make a library.\n\nYou‚Äôd never use a CDN. Loading local files is basically instantaneous. There‚Äôs also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.\n\n#### Artifacts Galore\n\nA lot of asset generation is involved in creating a solid desktop app. You‚Äôll need to generate executables and installers and decide on an auto-update system. Then, for each update, you‚Äôll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.\n\nWeight is still a concern. A ‚ÄúHello, World!‚Äù Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn‚Äôt much I can offer you. The ‚ÄúHello, World!‚Äù app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I‚Äôm afraid). However, your users won‚Äôt be downloading your app on a 2G connection (hopefully!).\n\n#### Expect the Unexpected\n\nYou will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let‚Äôs say you‚Äôve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (`<select/>`), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you‚Äôre in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it‚Äôs not often the user would resize the window down to a small enough size.\n\n:::figure beyond-the-browser/dropdownComparison.png Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.\n:::\n\nYou may or may not know it, but on a Mac, every window has a header and a body. When a window isn‚Äôt focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it‚Äôs being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it‚Äôs Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn‚Äôt focused, though, they won‚Äôt react if you were to hover over them. Hover styles won‚Äôt be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that‚Äôs it. A second click would be required to actually click the button and close the app.\n\nTo add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It‚Äôs a confirmed bug; applying the hover styles on a blurred window body ‚Äúdoesn‚Äôt meet platform expectations,‚Äù so it will be fixed. Hopefully, I‚Äôm saving you some heartbreak here. You could have a situation in which you‚Äôve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it‚Äôs not native).\n\nSo, you must use native buttons on a Mac. There‚Äôs no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting `window` object‚Äôs `frame` property to `false` in your `package.json`).\n\nYou could do the same with an Electron app. This is controlled by setting the `frame` property when creating a window; for example, `new BrowserWindow({width: 800, height: 600, frame: true})`. As the Electron team does, they spotted this issue and added another option as a nice compromise; `titleBarStyle`. Setting this to `hidden` will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet mainWindow;\n\napp.on(\'ready\', () => {\n  mainWindow = new BrowserWindow({\n    width: 500,\n    height: 400,\n    titleBarStyle: \'hidden\'\n  });\n  mainWindow.loadURL(\'file://\' + __dirname + \'/index.html\');\n});\n```\n\nHere‚Äôs an app in which I‚Äôve disabled the title bar and given the `html` element a background image:\n\n:::figure beyond-the-browser/hiddenTitleBar.png A screenshot of our example app without the title bar.\n:::\n\nSee ‚Äú[Frameless Window](http://electron.atom.io/docs/api/frameless-window)‚Äù from Electron‚Äôs documentation for more.\n\n#### Tooling\n\nWell, you can pretty much use all of the tooling you‚Äôd use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn‚Äôt want to use electron-builder). [Electron-connect](https://github.com/Quramy/electron-connect) watches your files for changes, and when they occur, it‚Äôll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you‚Äôd like. You could run webpack inside your app if you wanted to ‚Äî I‚Äôve no idea why you would, but the options are endless. Make sure to check out [awesome-electron](https://github.com/sindresorhus/awesome-electron) for more resources.\n\n#### Release Flow\n\nWhat‚Äôs it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you‚Äôre working on the web app and you deploy a change that breaks something, it‚Äôs not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they‚Äôre reported or noticed. You can‚Äôt do that with desktop apps. You can‚Äôt take back updates you push out there. It‚Äôs more like a mobile app flow. You build the app, put it out there, and you can‚Äôt take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.\n\n#### Quantum Mechanics\n\nBecause a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you‚Äôll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it‚Äôs a breaking change or not. A version released a month ago could implode because it has some slightly different code.\n\n#### Fresh Problems to Solve\n\nYou might receive a few strange bug reports ‚Äî ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system‚Äôs environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you‚Äôll have to draw a line. This was something critical to our app, so we couldn‚Äôt ignore the error, and we couldn‚Äôt fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.\n\nSure, a few web-specific concerns are no longer applicable when you‚Äôre working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There‚Äôs a 256-character limit on file paths in Windows, for example.\n\nOld versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a `node_modules` directory in your project (for example, `node_modules/a`). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a `node_modules` within that directory (for example, `node_modules/a/node_modules/b`). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like `path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js`.\n\n_Note_: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.\n\nWe had a case in which our app wouldn‚Äôt launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app‚Äôs code into an [asar archive](http://electron.atom.io/docs/tutorial/application-packaging/), which protects against path length issues but has exceptions and can‚Äôt always be used.\n\nWe created a little Gulp plugin named [gulp-path-length](https://github.com/Teamwork/gulp-path-length), which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user‚Äôs machine will determine the true length of the path, though. In our case, our installer will install it to `C:\\Users\\<username>\\AppData\\Roaming`. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they‚Äôre stored there (on the user‚Äôs machine with a long username, to be safe).\n\n```javascript\nvar gulp = require(\'gulp\');\nvar pathLength = require(\'gulp-path-length\');\n\ngulp.task(\'default\', function(){\n    gulp.src(\'./example/**/*\', {read: false})\n        .pipe(pathLength({\n\t        rewrite: {\n\t\t        match: \'./example\',\n\t\t        replacement: \'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'\n\t        }\n        }));\n});\n```\n\n#### Fatal Errors Can Be Really Fatal\n\nBecause all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let‚Äôs say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and‚Ä¶ crash. So, you‚Äôd have to reach out to all of your users and let them know they‚Äôll need to reinstall the app. Trust me, I know. It‚Äôs horrible.\n\n#### Analytics and Bug Reports\n\nYou‚Äôll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won‚Äôt work (out of the box, at least). You‚Äôll have to find something that doesn‚Äôt mind an app that runs on `file://` URLs. If you‚Äôre using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you‚Äôre using [Sentry](https://sentry.io/welcome/) to track errors, make sure to [set the `release` property when setting up your client](https://docs.sentry.io/clients/javascript/config/#optional-settings), so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you‚Äôll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.\n\nElectron has a [`crashReporter`](http://electron.atom.io/docs/api/crash-reporter/) module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.\n\n#### Security\n\nBe extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.\n\nDon‚Äôt trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they‚Äôd have the problem, too. We contacted X‚Äôs support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn‚Äôt have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).\n\nHow can you mitigate this risk? You could try to catch errors, but you‚Äôve no idea what they company X might do in its JavaScript, so you‚Äôre better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X‚Äôs URL from your `<script>`, you could use [Google Tag Manager](https://www.google.ie/analytics/tag-manager/) or your own API to return either HTML containing the `<script>` tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.\n\nHowever, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven‚Äôt solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don‚Äôt want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You‚Äôre back to the same problem.\n\nAnother solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you‚Äôd do this via IPC now. You‚Äôd send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.\n\nThis brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We‚Äôd be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn‚Äôt run:\n\n```javascript\n// main.js\nconst {app, BrowserWindow} = require(\'electron\');\nlet thirdPartyWindow;\n\napp.on(\'ready\', () => {\n  thirdPartyWindow = new BrowserWindow({\n    width: 500,\n    height: 400,\n    webPreferences: {\n      nodeIntegration: false\n    }\n  });\n  thirdPartyWindow.loadURL(\'file://\' + __dirname + \'/third-party-snippets.html\');\n});\n```\n\n#### Automated Testing\n\nNW.js doesn‚Äôt have any built-in support for testing. But, again, you have access to Node.js, so it‚Äôs technically possible. There is a way to test stuff such as button-clicking within the app using [Chrome Remote Interface](https://github.com/cyrus-and/chrome-remote-interface), but it‚Äôs tricky. Even then, you can‚Äôt trigger a click on a native window control and test what happens, for example.\n\nThe Electron team has created [Spectron](http://electron.atom.io/spectron/) for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.\n\n```javascript\nvar Application = require(\'spectron\').Application\nvar assert = require(\'assert\')\n\ndescribe(\'application launch\', function () {\n  this.timeout(10000)\n\n  beforeEach(function () {\n    this.app = new Application({\n      path: \'/Applications/MyApp.app/Contents/MacOS/MyApp\'\n    })\n    return this.app.start()\n  })\n\n  afterEach(function () {\n    if (this.app && this.app.isRunning()) {\n      return this.app.stop()\n    }\n  })\n\n  it(\'shows an initial window\', function () {\n    return this.app.client.getWindowCount().then(function (count) {\n      assert.equal(count, 1)\n    })\n  })\n})\n```\n\nBecause your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you‚Äôd need to make sure the app can run in a web browser without Node.js.\n\n### Desktop And Web\n\nIt‚Äôs not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it‚Äôs worth it. I‚Äôll mention a few related topics and tools, which are complicated in their own right, so I‚Äôll keep just touch on them.\n\nFirst of all, forget about ‚Äúbrowser lock-in,‚Äù native WebSockets, etc. The same goes for ES6\\. You can either revert to writing plain old ES5 JavaScript or use something like [Babel](https://babeljs.io/) to transpile your ES6 into ES5, for web use.\n\nYou also have `require`s throughout your code (for importing other scripts or modules), which a browser won‚Äôt understand. Use a module bundler that supports CommonJS (i.e. Node.js-style `require`s), such as [Rollup](http://rollupjs.org), [webpack](https://webpack.github.io) or [Browserify](http://browserify.org). When making a build for the web, a module bundler will run over your code, traverse all of the `require`s and bundle them up into one script for you.\n\nAny code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether `process.version.nwjs` or `process.versions.electron` exists; if it does, then your app is currently running in the desktop environment.\n\nEven then, you‚Äôll be loading a lot of redundant code in the web app. Let‚Äôs say you have a `require` guarded behind a check like `if(app.isInDesktop)`, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting `app.isInDesktop`, you could pass `true` or `false` into your app as a flag at buildtime (for example, using the [envify](https://github.com/hughsk/envify) transform for Browserify). This will aide your module bundler of choice when it‚Äôs doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether `app.isInDesktop` is `true`. So, if you‚Äôre running your web build, it won‚Äôt bother going inside that `if` statement or traversing the `require` in question.\n\n#### Continuous Delivery\n\nThere‚Äôs that release mindset again; it‚Äôs challenging. When you‚Äôre working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.\n\nAs we covered earlier, you can‚Äôt really do this with a desktop app. OK, I guess you technically could if you‚Äôre using Electron, because electron-builder can be automated and, so, can spectron tests. I don‚Äôt know anyone doing this, and I wouldn‚Äôt have enough faith to do it myself. Remember, broken code can‚Äôt be taken back, and you could break the update flow. Besides, you don‚Äôt want to deliver desktop updates too often anyway. Updates aren‚Äôt silent, like they are on the web, so it‚Äôs not very nice for the user. Plus, for users on macOS, delta updates aren‚Äôt supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.\n\nYou‚Äôll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly ‚Äî unless you‚Äôre releasing a feature, that is. You don‚Äôt want to punish a user because they chose to install your desktop app. Nothing‚Äôs worse than seeing a press release for a really cool feature in an app you use, only to realize that you‚Äôll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that‚Äôs a whole separate topic. I first learned of feature flags from ‚Äú[Continuous Delivery: The Dirty Details](https://www.youtube.com/watch?v=JR-ccCTmMKY),‚Äù a talk by Etsy‚Äôs VP of Engineering, Mike Brittain.\n\n### Conclusion\n\nSo, there you have it. With minimal effort, you can add ‚Äúdesktop app developer‚Äù to your resum√©. We‚Äôve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I‚Äôve shared, you‚Äôll agree that it‚Äôs not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.\n\n#### Further Reading\n\n*   ‚Äú[Resurrecting Clippy](http://engineroom.teamwork.com/resurrecting-clippy/),‚Äù Adam Lynch (me)\n    How I built clippy.desktop with NW.js.\n*   ‚Äú[Essential Electron](http://jlord.us/essential-electron/),‚Äù Jessica Lord\n    A plain-speak introduction to Electron and its core concepts.\n*   [Electron Documentation](http://electron.atom.io/docs/)\n    Want to dig into the details? Get it straight from the source.\n*   ‚Äú[Electron Community](http://electron.atom.io/community/)‚Äù\n    A curated list of Electron-related tools, videos and more.\n*   ‚Äú[Serverless Crash Reporting for Electron Apps](https://adamlynch.com/serverless-crash-reports-for-electron-apps/),‚Äù Adam Lynch (me)\n    My experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.\n*   [electron-builder](https://github.com/electron-userland/electron-builder), Stefan Judis\n    The complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.\n*   ‚Äú[autoUpdater](http://electron.atom.io/docs/api/auto-updater/),‚Äù Electron Documentation\n    See just how simple Electron‚Äôs automatic-update API is.\n',unfilteredRenderedBody:'<h2><a id="beyond-the-browser-from-web-apps-to-desktop-apps" class="post-header-anchor" href="#beyond-the-browser-from-web-apps-to-desktop-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Beyond The Browser: From Web Apps To Desktop Apps</h2>\n<article-summary><p>I started out as a web developer, and that‚Äôs now one part of what I do as a full-stack developer, but never had I imagined I‚Äôd create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least‚Ä¶ different.</p>\n</article-summary><p>It‚Äôs not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?</p>\n<p>OK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.</p>\n<p>In this article, we‚Äôll look at the development of desktop applications using <a href="http://nwjs.io/" rel="noopener">NW.js</a> and <a href="http://electron.atom.io/" rel="noopener">Electron</a>, the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.</p>\n<h3><a id="why" class="post-header-anchor" href="#why" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why?</h3>\n<p>First of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user‚Äôs system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.</p>\n<p>Maybe you‚Äôve an idea that would only work as a desktop app; some things simply aren‚Äôt possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you‚Äôve an idea for the Mac App Store. Maybe it would simply be a fun side project.</p>\n<p>It‚Äôs hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you‚Äôd like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a <a href="https://teamwork.com/chat" rel="noopener">chat application</a>. On the other hand, a connection-dependent desktop app that doesn‚Äôt really have any desktop integration should be a web app and a web app alone. It wouldn‚Äôt be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn‚Äôt get any more value from it than from visiting a URL of yours in their favorite browser.</p>\n<p>Instead of describing the desktop app you personally should build and why, I‚Äôm hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.</p>\n<h3><a id="nwjs" class="post-header-anchor" href="#nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>NW.js</h3>\n<p>Desktop applications have been around a long time but you don‚Äôt have all day, so let‚Äôs skip some history and begin in Shanghai, 2011. Roger Wang, of Intel‚Äôs Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within <code>&lt;script&gt;</code> tags.</p>\n<p>After some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.</p>\n<p><em>Note</em>: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.</p>\n<p>So, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn‚Äôt know any better. That‚Äôs pretty powerful, but how does it work? Well, first let‚Äôs take a look at Chromium.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/chromiumDiagram.png"><img src="/images/blog-content/beyond-the-browser/chromiumDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)</p>\n</figcaption>\n        </figure><p>There is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsDiagram.png"><img src="/images/blog-content/beyond-the-browser/nwjsDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an NW.js app\'s internals.</p>\n</figcaption>\n        </figure><p>This is roughly what an NW.js app looks like. It‚Äôs basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you‚Äôve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.</p>\n<p>Creating an app is really easy. All you need is an HTML file and a <code>package.json</code>, like you would have when working with Node.js. You can create a default one by running <code>npm init --yes</code>. Typically, a <code>package.json</code> would point a JavaScript file as the ‚Äúmain‚Äù file for the module (i.e. using the <code>main</code> property), but with NW.js you need to edit the <code>main</code> property to point to your HTML file.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>Once you install the official <code>nw</code> package from npm (by running <code>npm install -g nw</code>), you can run <code>nw .</code> within the project directory to launch your app.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example NW.js app.</p>\n</figcaption>\n        </figure><p>It‚Äôs as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn‚Äôt look like much, but it‚Äôs up to you add some markup and styles, just like you would in a web app.</p>\n<p>You could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and <a href="http://adamlynch.com/resurrecting-clippy/" rel="noopener">resurrected Clippy</a> using NW.js. There‚Äôs something weirdly satisfying about seeing Clippy on macOS or Windows 10.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/clippy.png"><img src="/images/blog-content/beyond-the-browser/clippy.png" alt=""/></a>\n          <figcaption><p>A screenshot of clippy.desktop on macOS.</p>\n</figcaption>\n        </figure><p>So, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/moduleCounts.png"><img src="/images/blog-content/beyond-the-browser/moduleCounts.png" alt=""/></a>\n          <figcaption><p>Bar graph showing the number of modules per major package manager. (Source: <a href="http://modulecounts.com" rel="noopener">Module Counts</a>)</p>\n</figcaption>\n        </figure><p>You get access not only to Node.js‚Äô APIs but to all of npm, which has over 350,000 modules now. For example, <a href="https://github.com/Teamwork/node-auto-launch" rel="noopener">auto-launch</a> is an open-source module we created at <a href="https://www.teamwork.com/" rel="noopener">Teamwork.com</a> to launch an NW.js or Electron app on startup.</p>\n<p>Node.js also has what‚Äôs known as ‚Äúnative modules,‚Äù which, if you really need to do something a bit lower level, allows you to create modules in C or C++.</p>\n<p>To top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  body<span class="token punctuation">:</span> <span class="token string">\'world\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h3><a id="electron" class="post-header-anchor" href="#electron" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Electron</h3>\n<p>You might recognize GitHub‚Äôs text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/atom.png"><img src="/images/blog-content/beyond-the-browser/atom.png" alt=""/></a>\n          <figcaption><p>A screenshot of Atom, GitHub\'s text editor.</p>\n</figcaption>\n        </figure><p><em>Note</em>: It‚Äôs disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it‚Äôs effectively a fork for the end user because the APIs were almost identical.</p>\n<p>In making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/logos.png"><img src="/images/blog-content/beyond-the-browser/logos.png" alt=""/></a>\n          <figcaption><p>Logos of projects that use Electron.</p>\n</figcaption>\n        </figure><p>As well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.</p>\n<h3><a id="how-does-it-differ" class="post-header-anchor" href="#how-does-it-differ" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How Does It Differ?</h3>\n<p>But how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronDiagram.png"><img src="/images/blog-content/beyond-the-browser/electronDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an Electron app\'s internals.</p>\n</figcaption>\n        </figure><p>The Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don‚Äôt have to do anything.</p>\n<p><em>Note</em>: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn‚Äôt quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.</p>\n<p>Back to the main process. Your app hasn‚Äôt any window by default, but you can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like NW.js.</p>\n<p>So, yeah, the minimum you need for an Electron app is a main JavaScript file (which we‚Äôll leave empty for now) and a <code>package.json</code> that points to it. Then, all you need to do is <code>npm install --save-dev electron</code> and run <code>electron .</code> to launch your app.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-javascript"><span class="token comment">// main.js, which is empty</span>\n</code></pre>\n<p>Not much will happen, though, because your app hasn‚Äôt any window by default. You can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like they‚Äôd have in an NW.js app.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>You could load a remote URL in this window, but typically you‚Äôd create a local HTML file and load that. Ta-da!</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/electronHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example Electron app.</p>\n</figcaption>\n        </figure><p>Of the built-in modules Electron provides, like the <code>app</code> or <code>BrowserWindow</code> module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you‚Äôd catch the <code>click</code> event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.</p>\n<p>OK, so Electron has distinct processes, and you have to organize your app slightly differently, but that‚Äôs not a big deal. Why are people using Electron instead of NW.js? Well, there‚Äôs mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.</p>\n<p>Electron‚Äôs documentation really is amazing, though ‚Äî that‚Äôs worth emphasizing. Take the <a href="https://github.com/electron/electron-api-demos" rel="noopener">Electron API Demos app</a>. It‚Äôs an Electron app that interactively demonstrates what you can do with Electron‚Äôs APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/apiDemosApp.png"><img src="/images/blog-content/beyond-the-browser/apiDemosApp.png" alt=""/></a>\n          <figcaption><p>A screenshot of the Electron API Demos app.</p>\n</figcaption>\n        </figure><p>If you submit an issue via Electron‚Äôs bug tracker, you‚Äôll get a response within a couple of days. I‚Äôve seen three-year-old NW.js bugs, although I don‚Äôt hold it against them. It‚Äôs tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I‚Äôm extremely grateful for what NW.js has given us.</p>\n<p>Electron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn‚Äôt focused. An example API flaw I ran into was that binding to <code>Control + Shift + A</code> in an NW.js app did what you would expect on Windows, but actually bound to <code>Command + Shift + A</code> on a Mac. This was intentional but really weird. There was no way to bind to the <code>Control</code> key. Also, binding to the <code>Command</code> key did bind to the <code>Command</code> key but the <code>Windows</code> key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you‚Äôd expect. To be fair, NW.js has since fixed the former but not the latter.</p>\n<p>There are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don‚Äôt go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you‚Äôd like. If you want to do something interesting with audio or video, use Electron, because some codecs don‚Äôt work out of the box with NW.js.</p>\n<p>Electron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I‚Äôll cover that later.</p>\n<h3><a id="but-how-does-it-feel" class="post-header-anchor" href="#but-how-does-it-feel" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>But How Does It Feel?</h3>\n<p>It feels fine. Sure, it‚Äôs not native. Most desktop apps these days don‚Äôt look like Windows Explorer or Finder anyway, so users won‚Äôt mind or realize that HTML is behind your user interface. You can make it feel more native if you‚Äôd like, but I‚Äôm not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That‚Äôs how a native desktop app would act, but is that better? There are also projects out there like <a href="http://photonkit.com/" rel="noopener">Photon Kit</a>, which is basically a CSS framework like Bootstrap, but for macOS-style components.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/photon.png"><img src="/images/blog-content/beyond-the-browser/photon.png" alt=""/></a>\n          <figcaption><p>A screenshot of an example Electron app made with Photon.</p>\n</figcaption>\n        </figure><h3><a id="performance" class="post-header-anchor" href="#performance" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Performance</h3>\n<p>What about performance? Is it slow or laggy? Well, your app is essentially a web app. It‚Äôll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that‚Äôs fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named <a href="http://electron.atom.io/devtron/" rel="noopener">Devtron</a> to monitor some Electron-specific stuff.</p>\n<p>Your desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it‚Äôs an isolated process, any computation or processing going on in that window won‚Äôt affect rendering, scrolling or anything else in your visible window(s).</p>\n<p>Keep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won‚Äôt).</p>\n<h3><a id="distribution" class="post-header-anchor" href="#distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distribution</h3>\n<p>Both NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn‚Äôt support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you‚Äôll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don‚Äôt have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).</p>\n<p>Electron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be <a href="http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html" rel="noopener">phasing out Chrome Packaged Apps</a>, but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.</p>\n<p>Even though 32-bit and 64-bit builds are supported, you‚Äôll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.</p>\n<p>So, let‚Äôs say that Electron has won over and you want to ship an Electron app. There‚Äôs a nice Node.js module named <a href="https://github.com/electron-userland/electron-packager" rel="noopener">electron-packager</a> that helps with packing your app up into an <code>.app</code> or <code>.exe</code> file. A few similar projects exist, including interactive ones that prompt you step by step. You should use <a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, though, which builds on top of electron-packager, plus a few other related modules. It generates <code>.dmg</code>s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.</p>\n<p>The annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you‚Äôre serious about shipping desktop apps, then you‚Äôll need to build on multiple machines for each release.</p>\n<p>This can feel a bit too manual or tedious, especially if you‚Äôre used to creating for the web. Thankfully, electron-builder was created with automation in mind. I‚Äôm talking here about continuous integration tools and services such as <a href="https://jenkins.io/" rel="noopener">Jenkins</a>, <a href="http://codeship.com/" rel="noopener">CodeShip</a>, <a href="https://travis-ci.org/" rel="noopener">Travis-CI</a>, <a href="https://www.appveyor.com/" rel="noopener">AppVeyor</a> (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.</p>\n<h3><a id="automatic-updates" class="post-header-anchor" href="#automatic-updates" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automatic Updates</h3>\n<p>NW.js doesn‚Äôt have automatic update support, but you‚Äôll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as <a href="https://github.com/edjafarov/node-webkit-updater" rel="noopener">node-webkit-updater</a>, which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.</p>\n<p>Electron has built-in support for automatic updates, via its <a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a> API. It doesn‚Äôt support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux ‚Äî don‚Äôt worry. The <code>autoUpdater</code> API is really simple; once you give it a URL, you can call the <code>checkForUpdates</code> method. It‚Äôs event-driven, so you can subscribe to the <code>update-downloaded</code> event, for example, and once it‚Äôs fired, call the <code>restartAndInstall</code> method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.</p>\n<p><em>Note</em>: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.</p>\n<p>It‚Äôs not quite as simple behind the API. It‚Äôs based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the <a href="https://github.com/Squirrel/Squirrel.Mac" rel="noopener">Squirrel.Mac</a> and <a href="https://github.com/Squirrel/Squirrel.Windows" rel="noopener">Squirrel.Windows</a> projects, respectively.</p>\n<p>The update code within your Mac Electron app is simple, but you‚Äôll need a server (albeit a simple server). When you call the autoUpdater module‚Äôs <code>checkForUpdates</code> method, it will hit your server. What your server needs to do is return a 204 (‚ÄúNo Content‚Äù) if there isn‚Äôt an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a <code>.zip</code> file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It‚Äôll go get that <code>.zip</code>, unzip it and fire the appropriate events.</p>\n<p>There a bit more (magic) going on in your Windows app when it comes to automatic updates. You won‚Äôt need a server, but you can have one if you‚Äôd like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.</p>\n<p>Squirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call <code>restartAndInstall</code>, it‚Äôll be a bit quicker because it‚Äôs ready and waiting. It also supports delta updates. Let‚Äôs say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you‚Äôre, say, three versions behind, but it will only do that if it‚Äôs worth it. Otherwise, if you‚Äôre, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it‚Äôs ready to go.</p>\n<p><em>Note</em>: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.</p>\n<p>Thanks to the Electron community, you don‚Äôt have to build your own server if you don‚Äôt want to. There are open-source projects you can use. Some allow you to <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">store updates on S3</a> or use <a href="https://github.com/GitbookIO/nuts" rel="noopener">GitHub releases</a>, and some even go as far as <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">providing administrative dashboards</a> to manage the updates.</p>\n<h3><a id="desktop-versus-web" class="post-header-anchor" href="#desktop-versus-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop Versus Web</h3>\n<p>So, how does making a desktop app differ from making a web app? Let‚Äôs look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you‚Äôre used to using on the web, workflow pain points, maintenance woes and more.</p>\n<p>Well, the first thing that comes to mind is browser lock-in. It‚Äôs like a guilty pleasure. If you‚Äôre making a desktop app exclusively, you‚Äôll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You‚Äôll never have to deal with any cross-browser incompatibilities. This is on top of Node.js‚Äô APIs and all of npm. You can do anything.</p>\n<p><em>Note</em>: You‚Äôll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.</p>\n<h4><a id="working-with-file" class="post-header-anchor" href="#working-with-file" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Working With file://</h4>\n<p>Another interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You‚Äôll need to pay more attention to how your app behaves if the network connection is lost while it‚Äôs running. You may need to adjust your mindset.</p>\n<p><em>Note</em>: You can load remote URLs if you really want, but I wouldn‚Äôt.</p>\n<p>One tip I can give you here is not to trust <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine" rel="noopener"><code>navigator.onLine</code></a> completely. This property returns a Boolean indicating whether or not there‚Äôs a connection, but watch out for false positives. It‚Äôll return <code>true</code> if there‚Äôs any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus‚Äô <a href="https://github.com/sindresorhus/is-online" rel="noopener"><code>is-online</code></a> module to double-check; it will ping the Internet‚Äôs root servers and/or the favicon of a few popular websites. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'is-online\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// hmm there\'s a connection, but is the Internet accessible?</span>\n  <span class="token function">isOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>online <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>online<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true or false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token comment">// we can trust navigator.onLine when it says there is no connection</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Speaking of local files, there are a few things to be aware of when using the <code>file://</code> protocol ‚Äî protocol-less URLs, for one; you can‚Äôt use them anymore. I mean URLs that start with <code>//</code> instead of <code>http://</code> or <code>https://</code>. Typically, if a web app requests <code>//example.com/hello.json</code>, then your browser would expand this to <code>http://example.com/hello.json</code> or to <code>https://example.com/hello.json</code> if the current page is loaded over HTTPS. In our app, the current page would load using the <code>file://</code> protocol; so, if we requested the same URL, it would expand to <code>file://example.com/hello.json</code> and fail. The real worry here is third-party modules you might be using; authors aren‚Äôt thinking of desktop apps when they make a library.</p>\n<p>You‚Äôd never use a CDN. Loading local files is basically instantaneous. There‚Äôs also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.</p>\n<h4><a id="artifacts-galore" class="post-header-anchor" href="#artifacts-galore" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Artifacts Galore</h4>\n<p>A lot of asset generation is involved in creating a solid desktop app. You‚Äôll need to generate executables and installers and decide on an auto-update system. Then, for each update, you‚Äôll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.</p>\n<p>Weight is still a concern. A ‚ÄúHello, World!‚Äù Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn‚Äôt much I can offer you. The ‚ÄúHello, World!‚Äù app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I‚Äôm afraid). However, your users won‚Äôt be downloading your app on a 2G connection (hopefully!).</p>\n<h4><a id="expect-the-unexpected" class="post-header-anchor" href="#expect-the-unexpected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Expect the Unexpected</h4>\n<p>You will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let‚Äôs say you‚Äôve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (<code>&lt;select/&gt;</code>), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you‚Äôre in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it‚Äôs not often the user would resize the window down to a small enough size.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/dropdownComparison.png"><img src="/images/blog-content/beyond-the-browser/dropdownComparison.png" alt=""/></a>\n          <figcaption><p>Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.</p>\n</figcaption>\n        </figure><p>You may or may not know it, but on a Mac, every window has a header and a body. When a window isn‚Äôt focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it‚Äôs being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it‚Äôs Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn‚Äôt focused, though, they won‚Äôt react if you were to hover over them. Hover styles won‚Äôt be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that‚Äôs it. A second click would be required to actually click the button and close the app.</p>\n<p>To add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It‚Äôs a confirmed bug; applying the hover styles on a blurred window body ‚Äúdoesn‚Äôt meet platform expectations,‚Äù so it will be fixed. Hopefully, I‚Äôm saving you some heartbreak here. You could have a situation in which you‚Äôve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it‚Äôs not native).</p>\n<p>So, you must use native buttons on a Mac. There‚Äôs no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting <code>window</code> object‚Äôs <code>frame</code> property to <code>false</code> in your <code>package.json</code>).</p>\n<p>You could do the same with an Electron app. This is controlled by setting the <code>frame</code> property when creating a window; for example, <code>new BrowserWindow({width: 800, height: 600, frame: true})</code>. As the Electron team does, they spotted this issue and added another option as a nice compromise; <code>titleBarStyle</code>. Setting this to <code>hidden</code> will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    titleBarStyle<span class="token punctuation">:</span> <span class="token string">\'hidden\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Here‚Äôs an app in which I‚Äôve disabled the title bar and given the <code>html</code> element a background image:</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/hiddenTitleBar.png"><img src="/images/blog-content/beyond-the-browser/hiddenTitleBar.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example app without the title bar.</p>\n</figcaption>\n        </figure><p>See ‚Äú<a href="http://electron.atom.io/docs/api/frameless-window" rel="noopener">Frameless Window</a>‚Äù from Electron‚Äôs documentation for more.</p>\n<h4><a id="tooling" class="post-header-anchor" href="#tooling" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tooling</h4>\n<p>Well, you can pretty much use all of the tooling you‚Äôd use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn‚Äôt want to use electron-builder). <a href="https://github.com/Quramy/electron-connect" rel="noopener">Electron-connect</a> watches your files for changes, and when they occur, it‚Äôll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you‚Äôd like. You could run webpack inside your app if you wanted to ‚Äî I‚Äôve no idea why you would, but the options are endless. Make sure to check out <a href="https://github.com/sindresorhus/awesome-electron" rel="noopener">awesome-electron</a> for more resources.</p>\n<h4><a id="release-flow" class="post-header-anchor" href="#release-flow" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Release Flow</h4>\n<p>What‚Äôs it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you‚Äôre working on the web app and you deploy a change that breaks something, it‚Äôs not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they‚Äôre reported or noticed. You can‚Äôt do that with desktop apps. You can‚Äôt take back updates you push out there. It‚Äôs more like a mobile app flow. You build the app, put it out there, and you can‚Äôt take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.</p>\n<h4><a id="quantum-mechanics" class="post-header-anchor" href="#quantum-mechanics" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Quantum Mechanics</h4>\n<p>Because a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you‚Äôll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it‚Äôs a breaking change or not. A version released a month ago could implode because it has some slightly different code.</p>\n<h4><a id="fresh-problems-to-solve" class="post-header-anchor" href="#fresh-problems-to-solve" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fresh Problems to Solve</h4>\n<p>You might receive a few strange bug reports ‚Äî ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system‚Äôs environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you‚Äôll have to draw a line. This was something critical to our app, so we couldn‚Äôt ignore the error, and we couldn‚Äôt fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.</p>\n<p>Sure, a few web-specific concerns are no longer applicable when you‚Äôre working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There‚Äôs a 256-character limit on file paths in Windows, for example.</p>\n<p>Old versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a <code>node_modules</code> directory in your project (for example, <code>node_modules/a</code>). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a <code>node_modules</code> within that directory (for example, <code>node_modules/a/node_modules/b</code>). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like <code>path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js</code>.</p>\n<p><em>Note</em>: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.</p>\n<p>We had a case in which our app wouldn‚Äôt launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app‚Äôs code into an <a href="http://electron.atom.io/docs/tutorial/application-packaging/" rel="noopener">asar archive</a>, which protects against path length issues but has exceptions and can‚Äôt always be used.</p>\n<p>We created a little Gulp plugin named <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>, which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user‚Äôs machine will determine the true length of the path, though. In our case, our installer will install it to <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming</code>. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they‚Äôre stored there (on the user‚Äôs machine with a long username, to be safe).</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/**/*\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t        rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t        match<span class="token punctuation">:</span> <span class="token string">\'./example\'</span><span class="token punctuation">,</span>\n\t\t        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'</span>\n\t        <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="fatal-errors-can-be-really-fatal" class="post-header-anchor" href="#fatal-errors-can-be-really-fatal" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fatal Errors Can Be Really Fatal</h4>\n<p>Because all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let‚Äôs say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and‚Ä¶ crash. So, you‚Äôd have to reach out to all of your users and let them know they‚Äôll need to reinstall the app. Trust me, I know. It‚Äôs horrible.</p>\n<h4><a id="analytics-and-bug-reports" class="post-header-anchor" href="#analytics-and-bug-reports" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Analytics and Bug Reports</h4>\n<p>You‚Äôll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won‚Äôt work (out of the box, at least). You‚Äôll have to find something that doesn‚Äôt mind an app that runs on <code>file://</code> URLs. If you‚Äôre using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you‚Äôre using <a href="https://sentry.io/welcome/" rel="noopener">Sentry</a> to track errors, make sure to <a href="https://docs.sentry.io/clients/javascript/config/#optional-settings" rel="noopener">set the <code>release</code> property when setting up your client</a>, so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you‚Äôll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.</p>\n<p>Electron has a <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crashReporter</code></a> module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.</p>\n<h4><a id="security" class="post-header-anchor" href="#security" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Security</h4>\n<p>Be extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.</p>\n<p>Don‚Äôt trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they‚Äôd have the problem, too. We contacted X‚Äôs support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn‚Äôt have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).</p>\n<p>How can you mitigate this risk? You could try to catch errors, but you‚Äôve no idea what they company X might do in its JavaScript, so you‚Äôre better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X‚Äôs URL from your <code>&lt;script&gt;</code>, you could use <a href="https://www.google.ie/analytics/tag-manager/" rel="noopener">Google Tag Manager</a> or your own API to return either HTML containing the <code>&lt;script&gt;</code> tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.</p>\n<p>However, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven‚Äôt solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don‚Äôt want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You‚Äôre back to the same problem.</p>\n<p>Another solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you‚Äôd do this via IPC now. You‚Äôd send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.</p>\n<p>This brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We‚Äôd be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn‚Äôt run:</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> thirdPartyWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  thirdPartyWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      nodeIntegration<span class="token punctuation">:</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  thirdPartyWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/third-party-snippets.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="automated-testing" class="post-header-anchor" href="#automated-testing" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automated Testing</h4>\n<p>NW.js doesn‚Äôt have any built-in support for testing. But, again, you have access to Node.js, so it‚Äôs technically possible. There is a way to test stuff such as button-clicking within the app using <a href="https://github.com/cyrus-and/chrome-remote-interface" rel="noopener">Chrome Remote Interface</a>, but it‚Äôs tricky. Even then, you can‚Äôt trigger a click on a native window control and test what happens, for example.</p>\n<p>The Electron team has created <a href="http://electron.atom.io/spectron/" rel="noopener">Spectron</a> for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> Application <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'spectron\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Application\n<span class="token keyword">var</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'application launch\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>\n\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      path<span class="token punctuation">:</span> <span class="token string">\'/Applications/MyApp.app/Contents/MacOS/MyApp\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'shows an initial window\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getWindowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Because your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you‚Äôd need to make sure the app can run in a web browser without Node.js.</p>\n<h3><a id="desktop-and-web" class="post-header-anchor" href="#desktop-and-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop And Web</h3>\n<p>It‚Äôs not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it‚Äôs worth it. I‚Äôll mention a few related topics and tools, which are complicated in their own right, so I‚Äôll keep just touch on them.</p>\n<p>First of all, forget about ‚Äúbrowser lock-in,‚Äù native WebSockets, etc. The same goes for ES6. You can either revert to writing plain old ES5 JavaScript or use something like <a href="https://babeljs.io/" rel="noopener">Babel</a> to transpile your ES6 into ES5, for web use.</p>\n<p>You also have <code>require</code>s throughout your code (for importing other scripts or modules), which a browser won‚Äôt understand. Use a module bundler that supports CommonJS (i.e. Node.js-style <code>require</code>s), such as <a href="http://rollupjs.org" rel="noopener">Rollup</a>, <a href="https://webpack.github.io" rel="noopener">webpack</a> or <a href="http://browserify.org" rel="noopener">Browserify</a>. When making a build for the web, a module bundler will run over your code, traverse all of the <code>require</code>s and bundle them up into one script for you.</p>\n<p>Any code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether <code>process.version.nwjs</code> or <code>process.versions.electron</code> exists; if it does, then your app is currently running in the desktop environment.</p>\n<p>Even then, you‚Äôll be loading a lot of redundant code in the web app. Let‚Äôs say you have a <code>require</code> guarded behind a check like <code>if(app.isInDesktop)</code>, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting <code>app.isInDesktop</code>, you could pass <code>true</code> or <code>false</code> into your app as a flag at buildtime (for example, using the <a href="https://github.com/hughsk/envify" rel="noopener">envify</a> transform for Browserify). This will aide your module bundler of choice when it‚Äôs doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether <code>app.isInDesktop</code> is <code>true</code>. So, if you‚Äôre running your web build, it won‚Äôt bother going inside that <code>if</code> statement or traversing the <code>require</code> in question.</p>\n<h4><a id="continuous-delivery" class="post-header-anchor" href="#continuous-delivery" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Continuous Delivery</h4>\n<p>There‚Äôs that release mindset again; it‚Äôs challenging. When you‚Äôre working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.</p>\n<p>As we covered earlier, you can‚Äôt really do this with a desktop app. OK, I guess you technically could if you‚Äôre using Electron, because electron-builder can be automated and, so, can spectron tests. I don‚Äôt know anyone doing this, and I wouldn‚Äôt have enough faith to do it myself. Remember, broken code can‚Äôt be taken back, and you could break the update flow. Besides, you don‚Äôt want to deliver desktop updates too often anyway. Updates aren‚Äôt silent, like they are on the web, so it‚Äôs not very nice for the user. Plus, for users on macOS, delta updates aren‚Äôt supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.</p>\n<p>You‚Äôll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly ‚Äî unless you‚Äôre releasing a feature, that is. You don‚Äôt want to punish a user because they chose to install your desktop app. Nothing‚Äôs worse than seeing a press release for a really cool feature in an app you use, only to realize that you‚Äôll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that‚Äôs a whole separate topic. I first learned of feature flags from ‚Äú<a href="https://www.youtube.com/watch?v=JR-ccCTmMKY" rel="noopener">Continuous Delivery: The Dirty Details</a>,‚Äù a talk by Etsy‚Äôs VP of Engineering, Mike Brittain.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>So, there you have it. With minimal effort, you can add ‚Äúdesktop app developer‚Äù to your resum√©. We‚Äôve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I‚Äôve shared, you‚Äôll agree that it‚Äôs not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.</p>\n<h4><a id="further-reading" class="post-header-anchor" href="#further-reading" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Further Reading</h4>\n<ul>\n<li>‚Äú<a href="http://engineroom.teamwork.com/resurrecting-clippy/" rel="noopener">Resurrecting Clippy</a>,‚Äù Adam Lynch (me)<br>\nHow I built clippy.desktop with NW.js.</li>\n<li>‚Äú<a href="http://jlord.us/essential-electron/" rel="noopener">Essential Electron</a>,‚Äù Jessica Lord<br>\nA plain-speak introduction to Electron and its core concepts.</li>\n<li><a href="http://electron.atom.io/docs/" rel="noopener">Electron Documentation</a><br>\nWant to dig into the details? Get it straight from the source.</li>\n<li>‚Äú<a href="http://electron.atom.io/community/" rel="noopener">Electron Community</a>‚Äù<br>\nA curated list of Electron-related tools, videos and more.</li>\n<li>‚Äú<a href="https://adamlynch.com/serverless-crash-reports-for-electron-apps/" rel="noopener">Serverless Crash Reporting for Electron Apps</a>,‚Äù Adam Lynch (me)<br>\nMy experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.</li>\n<li><a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, Stefan Judis<br>\nThe complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.</li>\n<li>‚Äú<a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a>,‚Äù Electron Documentation<br>\nSee just how simple Electron‚Äôs automatic-update API is.</li>\n</ul>\n',attributes:{date:"2017-03-21T00:00:00.000Z",original:{blogLink:"https://www.smashingmagazine.com/",blogName:"Smashing Magazine",url:"https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/"},tags:[{id:"node-webkit",name:"node-webkit"},{id:"electron",name:"electron"},{id:"desktop",name:"desktop"},{id:"javascript",name:"javascript"},{id:"development",name:"development"}],title:"Beyond The Browser: From Web Apps To Desktop Apps",updated_at:"2019-05-22T08:25:28.847Z",photo:"/images/blog-content/beyond-the-browser/chromiumDiagram.png"},title:"Beyond The Browser: From Web Apps To Desktop Apps",renderedSummary:"<p>I started out as a web developer, and that‚Äôs now one part of what I do as a full-stack developer, but never had I imagined I‚Äôd create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least‚Ä¶ different.</p>\n",rendered:'<h2><a id="beyond-the-browser-from-web-apps-to-desktop-apps" class="post-header-anchor" href="#beyond-the-browser-from-web-apps-to-desktop-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Beyond The Browser: From Web Apps To Desktop Apps</h2>\n<p>I started out as a web developer, and that‚Äôs now one part of what I do as a full-stack developer, but never had I imagined I‚Äôd create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least‚Ä¶ different.</p>\n<p>It‚Äôs not an attractive prospect, right? Would you have to learn a new language or three? Imagine an archaic, alien workflow, with ancient tooling, and none of those things you love about the web. How would your career be affected?</p>\n<p>OK, take a breath. The reality is that, as a web developer, not only do you already possess all of the skills to make great modern desktop apps, but thanks to powerful new APIs at your disposal, the desktop is actually where your skills can be leveraged the most.</p>\n<p>In this article, we‚Äôll look at the development of desktop applications using <a href="http://nwjs.io/" rel="noopener">NW.js</a> and <a href="http://electron.atom.io/" rel="noopener">Electron</a>, the ups and downs of building one and living with one, using one code base for the desktop and the web, and more.</p>\n<h3><a id="why" class="post-header-anchor" href="#why" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Why?</h3>\n<p>First of all, why would anyone create a desktop app? Any existing web app (as opposed to a website, if you believe in the distinction) is probably suited to becoming a desktop app. You could build a desktop app around any web app that would benefit from integration in the user‚Äôs system; think native notifications, launching on startup, interacting with files, etc. Some users simply prefer having certain apps there permanently on their machine, accessible whether they have a connection or not.</p>\n<p>Maybe you‚Äôve an idea that would only work as a desktop app; some things simply aren‚Äôt possible with a web app (at least yet, but more about that in a little bit). You could create a self-contained utility app for internal company use, without requiring anyone to install anything other than your app (because Node.js in built-in). Maybe you‚Äôve an idea for the Mac App Store. Maybe it would simply be a fun side project.</p>\n<p>It‚Äôs hard to sum up why you should consider creating a desktop app because there are so many kinds of apps you could create. It really depends on what you‚Äôd like to achieve, how advantageous you find the additional APIs, and how much offline usage would enhance the experience for your users. For my team, it was a no-brainer because we were building a <a href="https://teamwork.com/chat" rel="noopener">chat application</a>. On the other hand, a connection-dependent desktop app that doesn‚Äôt really have any desktop integration should be a web app and a web app alone. It wouldn‚Äôt be fair to expect a user to download your app (which includes a browser of its own and Node.js) when they wouldn‚Äôt get any more value from it than from visiting a URL of yours in their favorite browser.</p>\n<p>Instead of describing the desktop app you personally should build and why, I‚Äôm hoping to spark an idea or at least spark your interest in this article. Read on to see just how easy it is to create powerful desktop apps using web technology and what that can afford you over (or alongside of) creating a web app.</p>\n<h3><a id="nwjs" class="post-header-anchor" href="#nwjs" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>NW.js</h3>\n<p>Desktop applications have been around a long time but you don‚Äôt have all day, so let‚Äôs skip some history and begin in Shanghai, 2011. Roger Wang, of Intel‚Äôs Open Source Technology Center, created node-webkit; a proof-of-concept Node.js module that allowed the user to spawn a WebKit browser window and use Node.js modules within <code>&lt;script&gt;</code> tags.</p>\n<p>After some progress and a switch from WebKit to Chromium (the open-source project Google Chrome is based on), an intern named Cheng Zhao joined the project. It was soon realized that an app runtime based on Node.js and Chromium would make a nice framework for building desktop apps. The project went on be quite popular.</p>\n<p><em>Note</em>: node-webkit was later renamed NW.js to make it a bit more generic because it no longer used Node.js or WebKit. Instead of Node.js, it was based on io.js (the Node.js fork) at the time, and Chromium had moved on from WebKit to its own fork, Blink.</p>\n<p>So, if you were to download an NW.js app, you would actually be downloading Chromium, plus Node.js, plus the actual app code. Not only does this mean a desktop app can be created using HTML, CSS and JavaScript, but the app would also have access to all of the Node.js APIs (to read and write to disk, for example), and the end user wouldn‚Äôt know any better. That‚Äôs pretty powerful, but how does it work? Well, first let‚Äôs take a look at Chromium.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/chromiumDiagram.png"><img src="/images/blog-content/beyond-the-browser/chromiumDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of Chromium\'s internals. (Note: this diagram is intentionally very simple; it\'s a lot more complex than this.)</p>\n</figcaption>\n        </figure><p>There is a main background process, and each tab gets its own process. You might have seen that Google Chrome always has at least two processes in Windows\' task manager or macOS\' activity monitor. I haven\'t even attempted to arrange the contents of the main process here, but it contains the Blink rendering engine, the V8 JavaScript engine (which is what Node.js is built on, too, by the way) and some platform APIs that abstract native APIs. Each isolated tab or renderer process has access to the JavaScript engine, CSS parser and so on, but it is completely separate to the main process for fault tolerance. Renderer processes interact with the main process through interprocess communication (IPC).</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsDiagram.png"><img src="/images/blog-content/beyond-the-browser/nwjsDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an NW.js app\'s internals.</p>\n</figcaption>\n        </figure><p>This is roughly what an NW.js app looks like. It‚Äôs basically the same, except that each window has access to Node.js now as well. So, you have access to the DOM and you can require other scripts, node modules you‚Äôve installed from npm, or built-in modules provided by NW.js. By default, your app has one window, and from there you can spawn other windows.</p>\n<p>Creating an app is really easy. All you need is an HTML file and a <code>package.json</code>, like you would have when working with Node.js. You can create a default one by running <code>npm init --yes</code>. Typically, a <code>package.json</code> would point a JavaScript file as the ‚Äúmain‚Äù file for the module (i.e. using the <code>main</code> property), but with NW.js you need to edit the <code>main</code> property to point to your HTML file.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>Once you install the official <code>nw</code> package from npm (by running <code>npm install -g nw</code>), you can run <code>nw .</code> within the project directory to launch your app.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/nwjsHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example NW.js app.</p>\n</figcaption>\n        </figure><p>It‚Äôs as easy as that. So, what happened here was that NW.js opened the initial window, loading your HTML file. I know this doesn‚Äôt look like much, but it‚Äôs up to you add some markup and styles, just like you would in a web app.</p>\n<p>You could drop the window bar and chrome if you like, or create your own custom frame. You could have semi to fully transparent windows, hidden windows and more. I took this a bit further recently and <a href="http://adamlynch.com/resurrecting-clippy/" rel="noopener">resurrected Clippy</a> using NW.js. There‚Äôs something weirdly satisfying about seeing Clippy on macOS or Windows 10.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/clippy.png"><img src="/images/blog-content/beyond-the-browser/clippy.png" alt=""/></a>\n          <figcaption><p>A screenshot of clippy.desktop on macOS.</p>\n</figcaption>\n        </figure><p>So, you get to write HTML, CSS and JavaScript. You can use Node.js to read and write to disk, execute system commands, spawn other executables and more. Hypothetically, you could build a multiplayer roulette game over WebRTC that deletes some of the users\' files randomly, if you wanted.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/moduleCounts.png"><img src="/images/blog-content/beyond-the-browser/moduleCounts.png" alt=""/></a>\n          <figcaption><p>Bar graph showing the number of modules per major package manager. (Source: <a href="http://modulecounts.com" rel="noopener">Module Counts</a>)</p>\n</figcaption>\n        </figure><p>You get access not only to Node.js‚Äô APIs but to all of npm, which has over 350,000 modules now. For example, <a href="https://github.com/Teamwork/node-auto-launch" rel="noopener">auto-launch</a> is an open-source module we created at <a href="https://www.teamwork.com/" rel="noopener">Teamwork.com</a> to launch an NW.js or Electron app on startup.</p>\n<p>Node.js also has what‚Äôs known as ‚Äúnative modules,‚Äù which, if you really need to do something a bit lower level, allows you to create modules in C or C++.</p>\n<p>To top it all off, NW.js exposes APIs that effectively wrap native APIs, allowing you to integrate closely with the desktop environment. You can have a tray icon, open a file or URL in the default system application, and a lot lot more. All you need to do to trigger a notification is use the HTML5 notification API:</p>\n<pre><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span><span class="token string">\'Hello\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  body<span class="token punctuation">:</span> <span class="token string">\'world\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h3><a id="electron" class="post-header-anchor" href="#electron" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Electron</h3>\n<p>You might recognize GitHub‚Äôs text editor, Atom, below. Whether you use it or not, Atom was a game-changer for desktop apps. GitHub started development of Atom in 2013, soon recruited Cheng Zhao, and forked node-webkit as its base, which it later open-sourced under the name atom-shell.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/atom.png"><img src="/images/blog-content/beyond-the-browser/atom.png" alt=""/></a>\n          <figcaption><p>A screenshot of Atom, GitHub\'s text editor.</p>\n</figcaption>\n        </figure><p><em>Note</em>: It‚Äôs disputed whether Electron is a fork of node-webkit or whether everything was rewritten from scratch. Either way, it‚Äôs effectively a fork for the end user because the APIs were almost identical.</p>\n<p>In making Atom, GitHub improved on the formula and ironed out a lot of the bugs. In 2015, atom-shell was renamed Electron. Since then it has hit version 1.0, and with GitHub pushing it, it has really taken off.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/logos.png"><img src="/images/blog-content/beyond-the-browser/logos.png" alt=""/></a>\n          <figcaption><p>Logos of projects that use Electron.</p>\n</figcaption>\n        </figure><p>As well as Atom, other notable projects built with Electron include Slack, Visual Studio Code, Brave, HyperTerm and Nylas, which is really doing some cutting-edge stuff with it. Mozilla Tofino is an interesting one, too. It was an internal project at Mozilla (the company behind Firefox), with the aim of radically improving web browsers. Yeah, a team within Mozilla chose Electron (which is based on Chromium) for this experiment.</p>\n<h3><a id="how-does-it-differ" class="post-header-anchor" href="#how-does-it-differ" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How Does It Differ?</h3>\n<p>But how is it different from NW.js? First of all, Electron is less browser-oriented than NW.js. The entry point for an Electron app is a script that runs in the main process.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronDiagram.png"><img src="/images/blog-content/beyond-the-browser/electronDiagram.png" alt=""/></a>\n          <figcaption><p>A rough diagram of an Electron app\'s internals.</p>\n</figcaption>\n        </figure><p>The Electron team patched Chromium to allow for the embedding of multiple JavaScript engines that could run at the same time. So, when Chromium releases a new version, they don‚Äôt have to do anything.</p>\n<p><em>Note</em>: NW.js hooks into Chromium a little differently, and this was often blamed on the fact NW.js wasn‚Äôt quite as good at keeping up with Chromium as Electron was. However, throughout 2016, NW.js has released a new version within 24 hours of each major Chromium release, which the team attributes to an organizational shift.</p>\n<p>Back to the main process. Your app hasn‚Äôt any window by default, but you can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like NW.js.</p>\n<p>So, yeah, the minimum you need for an Electron app is a main JavaScript file (which we‚Äôll leave empty for now) and a <code>package.json</code> that points to it. Then, all you need to do is <code>npm install --save-dev electron</code> and run <code>electron .</code> to launch your app.</p>\n<pre><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"example-app"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<pre><code class="language-javascript"><span class="token comment">// main.js, which is empty</span>\n</code></pre>\n<p>Not much will happen, though, because your app hasn‚Äôt any window by default. You can open as many windows as you‚Äôd like from the main process, each having its own renderer process, just like they‚Äôd have in an NW.js app.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<pre><code class="language-markup"><span class="token comment">&lt;!-- index.html --\x3e</span>\n<span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n<p>You could load a remote URL in this window, but typically you‚Äôd create a local HTML file and load that. Ta-da!</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/electronHelloWorld.png"><img src="/images/blog-content/beyond-the-browser/electronHelloWorld.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example Electron app.</p>\n</figcaption>\n        </figure><p>Of the built-in modules Electron provides, like the <code>app</code> or <code>BrowserWindow</code> module used in the previous example, most can only be used in either the main or a renderer process. For example, the main process is where, and only where, you can manage your windows, automatic updates and more. You might want a click of a button to trigger something in your main process, though, so Electron comes with built-in methods for IPC. You can basically emit arbitrary events and listen for them on the other side. In this case, you‚Äôd catch the <code>click</code> event in the renderer process, emit an event over IPC to the main process, catch it in the main process and finally perform the action.</p>\n<p>OK, so Electron has distinct processes, and you have to organize your app slightly differently, but that‚Äôs not a big deal. Why are people using Electron instead of NW.js? Well, there‚Äôs mindshare. So many related tools and modules are out there as a result of its popularity. The documentation is better. Most importantly, it has fewer bugs and superior APIs.</p>\n<p>Electron‚Äôs documentation really is amazing, though ‚Äî that‚Äôs worth emphasizing. Take the <a href="https://github.com/electron/electron-api-demos" rel="noopener">Electron API Demos app</a>. It‚Äôs an Electron app that interactively demonstrates what you can do with Electron‚Äôs APIs. Not only is the API described and sample code provided for creating a new window, for example, but clicking a button will actually execute the code and a new window will open.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/apiDemosApp.png"><img src="/images/blog-content/beyond-the-browser/apiDemosApp.png" alt=""/></a>\n          <figcaption><p>A screenshot of the Electron API Demos app.</p>\n</figcaption>\n        </figure><p>If you submit an issue via Electron‚Äôs bug tracker, you‚Äôll get a response within a couple of days. I‚Äôve seen three-year-old NW.js bugs, although I don‚Äôt hold it against them. It‚Äôs tough when an open-source project is written in languages drastically different from the languages known by its users. NW.js and Electron are written mostly in C++ (and a tiny bit of Objective C++) but used by people who write JavaScript. I‚Äôm extremely grateful for what NW.js has given us.</p>\n<p>Electron ironed out a few of the flaws in the NW.js APIs. For example, you can bind global keyboard shortcuts, which would be caught even if your app isn‚Äôt focused. An example API flaw I ran into was that binding to <code>Control + Shift + A</code> in an NW.js app did what you would expect on Windows, but actually bound to <code>Command + Shift + A</code> on a Mac. This was intentional but really weird. There was no way to bind to the <code>Control</code> key. Also, binding to the <code>Command</code> key did bind to the <code>Command</code> key but the <code>Windows</code> key on Windows and Linux as well. The Electron team spotted these problems (when adding shortcuts to Atom I assume) and quickly updated their globalShortcut API so both of these cases work as you‚Äôd expect. To be fair, NW.js has since fixed the former but not the latter.</p>\n<p>There are a few other differences. For instance, in recent NW.js versions, notifications that were previously native are now Chrome-style ones. These don‚Äôt go into the notification centre on Mac OS X or Windows 10, but there are modules on npm that you could use as a workaround if you‚Äôd like. If you want to do something interesting with audio or video, use Electron, because some codecs don‚Äôt work out of the box with NW.js.</p>\n<p>Electron has added a few new APIs as well, more desktop integration, and it has built-in support for automatic updates, but I‚Äôll cover that later.</p>\n<h3><a id="but-how-does-it-feel" class="post-header-anchor" href="#but-how-does-it-feel" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>But How Does It Feel?</h3>\n<p>It feels fine. Sure, it‚Äôs not native. Most desktop apps these days don‚Äôt look like Windows Explorer or Finder anyway, so users won‚Äôt mind or realize that HTML is behind your user interface. You can make it feel more native if you‚Äôd like, but I‚Äôm not convinced it will make the experience any better. For example, you could prevent the cursor from turning to a hand when the user hovers over a button. That‚Äôs how a native desktop app would act, but is that better? There are also projects out there like <a href="http://photonkit.com/" rel="noopener">Photon Kit</a>, which is basically a CSS framework like Bootstrap, but for macOS-style components.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/photon.png"><img src="/images/blog-content/beyond-the-browser/photon.png" alt=""/></a>\n          <figcaption><p>A screenshot of an example Electron app made with Photon.</p>\n</figcaption>\n        </figure><h3><a id="performance" class="post-header-anchor" href="#performance" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Performance</h3>\n<p>What about performance? Is it slow or laggy? Well, your app is essentially a web app. It‚Äôll perform pretty much like a web app in Google Chrome. You can create a performant app or a sluggish one, but that‚Äôs fine because you already have the skills to analyze and improve performance. One of the best things about your app being based on Chromium is that you get its DevTools. You can debug within the app or remotely, and the Electron team has even created a DevTools extension named <a href="http://electron.atom.io/devtron/" rel="noopener">Devtron</a> to monitor some Electron-specific stuff.</p>\n<p>Your desktop app can be more performant than a web app, though. One thing you could do is create a worker window, a hidden window that you use to perform any expensive work. Because it‚Äôs an isolated process, any computation or processing going on in that window won‚Äôt affect rendering, scrolling or anything else in your visible window(s).</p>\n<p>Keep in mind that you can always spawn system commands, spawn executables or drop down to native code if you really need to (you won‚Äôt).</p>\n<h3><a id="distribution" class="post-header-anchor" href="#distribution" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Distribution</h3>\n<p>Both NW.js and Electron support a wide array of platforms, including Windows, Mac and Linux. Electron doesn‚Äôt support Windows XP or Vista; NW.js does. Getting an NW.js app into the Mac App Store is a bit tricky; you‚Äôll have to jump through a few hoops. Electron, on the other hand, comes with Mac App Store-compatible builds, which are just like the normal builds except that you don‚Äôt have access to some modules, such as the auto-updater module (which is fine because your app will update via the Mac App Store anyway).</p>\n<p>Electron even supports ARM builds, so your app can run on a Chromebook or Raspberry Pi. Finally, Google may be <a href="http://blog.chromium.org/2016/08/from-chrome-apps-to-web.html" rel="noopener">phasing out Chrome Packaged Apps</a>, but NW.js allows you to port an app over to an NW.js app and still have access the same Chromium APIs.</p>\n<p>Even though 32-bit and 64-bit builds are supported, you‚Äôll get away with 64-bit Mac and Windows apps. You will need 32-bit and 64-bit Linux apps, though, for compatibility.</p>\n<p>So, let‚Äôs say that Electron has won over and you want to ship an Electron app. There‚Äôs a nice Node.js module named <a href="https://github.com/electron-userland/electron-packager" rel="noopener">electron-packager</a> that helps with packing your app up into an <code>.app</code> or <code>.exe</code> file. A few similar projects exist, including interactive ones that prompt you step by step. You should use <a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, though, which builds on top of electron-packager, plus a few other related modules. It generates <code>.dmg</code>s and Windows installers and takes care of the code-signing of your app for you. This is really important. Without it, your app would be labelled as untrusted by operating systems, your app could trigger anti-virus software, and Microsoft SmartScreen might try to block the user from launching your app.</p>\n<p>The annoying thing about code-signing is that you have to sign your app on a Mac for Mac and on Windows for Windows. So, if you‚Äôre serious about shipping desktop apps, then you‚Äôll need to build on multiple machines for each release.</p>\n<p>This can feel a bit too manual or tedious, especially if you‚Äôre used to creating for the web. Thankfully, electron-builder was created with automation in mind. I‚Äôm talking here about continuous integration tools and services such as <a href="https://jenkins.io/" rel="noopener">Jenkins</a>, <a href="http://codeship.com/" rel="noopener">CodeShip</a>, <a href="https://travis-ci.org/" rel="noopener">Travis-CI</a>, <a href="https://www.appveyor.com/" rel="noopener">AppVeyor</a> (for Windows) and so on. These could run your desktop app build at the press of a button or at every push to GitHub, for example.</p>\n<h3><a id="automatic-updates" class="post-header-anchor" href="#automatic-updates" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automatic Updates</h3>\n<p>NW.js doesn‚Äôt have automatic update support, but you‚Äôll have access to all of Node.js, so you can do whatever you want. Open-source modules are out there for it, such as <a href="https://github.com/edjafarov/node-webkit-updater" rel="noopener">node-webkit-updater</a>, which handles downloading and replacing your app with a newer version. You could also roll your own custom system if you wanted.</p>\n<p>Electron has built-in support for automatic updates, via its <a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a> API. It doesn‚Äôt support Linux, first of all; instead, publishing your app to Linux package managers is recommended. This is common on Linux ‚Äî don‚Äôt worry. The <code>autoUpdater</code> API is really simple; once you give it a URL, you can call the <code>checkForUpdates</code> method. It‚Äôs event-driven, so you can subscribe to the <code>update-downloaded</code> event, for example, and once it‚Äôs fired, call the <code>restartAndInstall</code> method to install the new version and restart the app. You can listen for a few other events, which you can use to tie the auto-updating functionality into your user interface nicely.</p>\n<p><em>Note</em>: You can have multiple update channels if you want, such as Google Chrome and Google Chrome Canary.</p>\n<p>It‚Äôs not quite as simple behind the API. It‚Äôs based on the Squirrel update framework, which differs drastically between Mac and Windows, which use the <a href="https://github.com/Squirrel/Squirrel.Mac" rel="noopener">Squirrel.Mac</a> and <a href="https://github.com/Squirrel/Squirrel.Windows" rel="noopener">Squirrel.Windows</a> projects, respectively.</p>\n<p>The update code within your Mac Electron app is simple, but you‚Äôll need a server (albeit a simple server). When you call the autoUpdater module‚Äôs <code>checkForUpdates</code> method, it will hit your server. What your server needs to do is return a 204 (‚ÄúNo Content‚Äù) if there isn‚Äôt an update; and if there is, it needs to return a 200 with a JSON containing a URL pointing to a <code>.zip</code> file. Back under the hood of your app (or the client), Squirrel.Mac will know what to do. It‚Äôll go get that <code>.zip</code>, unzip it and fire the appropriate events.</p>\n<p>There a bit more (magic) going on in your Windows app when it comes to automatic updates. You won‚Äôt need a server, but you can have one if you‚Äôd like. You could host the static (update) files somewhere, such as AWS S3, or even have them locally on your machine, which is really handy for testing. Despite the differences between Squirrel.Mac and Squirrel.Windows, a happy medium can be found; for example, having a server for both, and storing the updates on S3 or somewhere similar.</p>\n<p>Squirrel.Windows has a couple of nice features over Squirrel.Mac as well. It applies updates in the background; so, when you call <code>restartAndInstall</code>, it‚Äôll be a bit quicker because it‚Äôs ready and waiting. It also supports delta updates. Let‚Äôs say your app checks for updates and there is one newer version. A binary diff (between the currently installed app and the update) will be downloaded and applied as a patch to the current executable, instead of replacing it with a whole new app. It can even do that incrementally if you‚Äôre, say, three versions behind, but it will only do that if it‚Äôs worth it. Otherwise, if you‚Äôre, say, 15 versions behind, it will just download the latest version in its entirety instead. The great thing is that all of this is done under the hood for you. The API remains really simple. You check for updates, it will figure out the optimal method to apply the update, and it will let you know when it‚Äôs ready to go.</p>\n<p><em>Note</em>: You will have to generate those binary diffs, though, and host them alongside your standard updates. Thankfully, electron-builder generates these for you, too.</p>\n<p>Thanks to the Electron community, you don‚Äôt have to build your own server if you don‚Äôt want to. There are open-source projects you can use. Some allow you to <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">store updates on S3</a> or use <a href="https://github.com/GitbookIO/nuts" rel="noopener">GitHub releases</a>, and some even go as far as <a href="https://github.com/ArekSredzki/electron-release-server" rel="noopener">providing administrative dashboards</a> to manage the updates.</p>\n<h3><a id="desktop-versus-web" class="post-header-anchor" href="#desktop-versus-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop Versus Web</h3>\n<p>So, how does making a desktop app differ from making a web app? Let‚Äôs look at a few unexpected problems or gains you might come across along the way, some unexpected side effects of APIs you‚Äôre used to using on the web, workflow pain points, maintenance woes and more.</p>\n<p>Well, the first thing that comes to mind is browser lock-in. It‚Äôs like a guilty pleasure. If you‚Äôre making a desktop app exclusively, you‚Äôll know exactly which Chromium version all of your users are on. Let your imagination run wild; you can use flexbox, ES6, pure WebSockets, WebRTC, anything you want. You can even enable experimental features in Chromium for your app (i.e. features coming down the line) or tweak settings such as your localStorage allowance. You‚Äôll never have to deal with any cross-browser incompatibilities. This is on top of Node.js‚Äô APIs and all of npm. You can do anything.</p>\n<p><em>Note</em>: You‚Äôll still have to consider which operating system the user is running sometimes, though, but OS-sniffing is a lot more reliable and less frowned upon than browser sniffing.</p>\n<h4><a id="working-with-file" class="post-header-anchor" href="#working-with-file" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Working With file://</h4>\n<p>Another interesting thing is that your app is essentially offline-first. Keep that in mind when creating your app; a user can launch your app without a network connection and your app will run; it will still load the local files. You‚Äôll need to pay more attention to how your app behaves if the network connection is lost while it‚Äôs running. You may need to adjust your mindset.</p>\n<p><em>Note</em>: You can load remote URLs if you really want, but I wouldn‚Äôt.</p>\n<p>One tip I can give you here is not to trust <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine" rel="noopener"><code>navigator.onLine</code></a> completely. This property returns a Boolean indicating whether or not there‚Äôs a connection, but watch out for false positives. It‚Äôll return <code>true</code> if there‚Äôs any local connection without validating that connection. The Internet might not actually be accessible; it could be fooled by a dummy connection to a Vagrant virtual machine on your machine, etc. Instead, use Sindre Sorhus‚Äô <a href="https://github.com/sindresorhus/is-online" rel="noopener"><code>is-online</code></a> module to double-check; it will ping the Internet‚Äôs root servers and/or the favicon of a few popular websites. For example:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'is-online\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  <span class="token comment">// hmm there\'s a connection, but is the Internet accessible?</span>\n  <span class="token function">isOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>online <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>online<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true or false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token comment">// we can trust navigator.onLine when it says there is no connection</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Speaking of local files, there are a few things to be aware of when using the <code>file://</code> protocol ‚Äî protocol-less URLs, for one; you can‚Äôt use them anymore. I mean URLs that start with <code>//</code> instead of <code>http://</code> or <code>https://</code>. Typically, if a web app requests <code>//example.com/hello.json</code>, then your browser would expand this to <code>http://example.com/hello.json</code> or to <code>https://example.com/hello.json</code> if the current page is loaded over HTTPS. In our app, the current page would load using the <code>file://</code> protocol; so, if we requested the same URL, it would expand to <code>file://example.com/hello.json</code> and fail. The real worry here is third-party modules you might be using; authors aren‚Äôt thinking of desktop apps when they make a library.</p>\n<p>You‚Äôd never use a CDN. Loading local files is basically instantaneous. There‚Äôs also no limit on the number of concurrent requests (per domain), like there is on the web (with HTTP/1.1 at least). You can load as many as you want in parallel.</p>\n<h4><a id="artifacts-galore" class="post-header-anchor" href="#artifacts-galore" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Artifacts Galore</h4>\n<p>A lot of asset generation is involved in creating a solid desktop app. You‚Äôll need to generate executables and installers and decide on an auto-update system. Then, for each update, you‚Äôll have to build the executables again, more installers (because if someone goes to your website to download it, they should get the latest version) and binary diffs for delta updates.</p>\n<p>Weight is still a concern. A ‚ÄúHello, World!‚Äù Electron app is 40 MB zipped. Besides the typical advice you follow when creating a web app (write less code, minify it, have fewer dependencies, etc.), there isn‚Äôt much I can offer you. The ‚ÄúHello, World!‚Äù app is literally an app containing one HTML file; most of the weight comes from the fact that Chromium and Node.js are baked into your app. At least delta updates will reduce how much is downloaded when a user performs an update (on Windows only, I‚Äôm afraid). However, your users won‚Äôt be downloading your app on a 2G connection (hopefully!).</p>\n<h4><a id="expect-the-unexpected" class="post-header-anchor" href="#expect-the-unexpected" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Expect the Unexpected</h4>\n<p>You will discover unexpected behavior now and again. Some of it is more obvious than the rest, but a little annoying nonetheless. For example, let‚Äôs say you‚Äôve made a music player app that supports a mini-player mode, in which the window is really small and always in front of any other apps. If a user were to click or tap a dropdown (<code>&lt;select/&gt;</code>), then it would open to reveal its options, overflowing past the bottom edge of the app. If you were to use a non-native select library (such as select2 or chosen), though, you‚Äôre in trouble. When open, your dropdown will be cut off by the edge of your app. So, the user would see a few items and then nothing, which is really frustrating. This would happen in a web browser, too, but it‚Äôs not often the user would resize the window down to a small enough size.</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/dropdownComparison.png"><img src="/images/blog-content/beyond-the-browser/dropdownComparison.png" alt=""/></a>\n          <figcaption><p>Screenshots comparing what happens to a native dropdown versus a non-native one as they hit any edges of an app window.</p>\n</figcaption>\n        </figure><p>You may or may not know it, but on a Mac, every window has a header and a body. When a window isn‚Äôt focused, if you hover over an icon or button in the header, its appearance will reflect the fact that it‚Äôs being hovered over. For example, the close button on macOS is gray when the window is blurred but red when you hover over it. However, if you move your mouse over something in the body of the window, there is no visible change. This is intentional. Think about your desktop app, though; it‚Äôs Chromium missing the header, and your app is the web page, which is the body of the window. You could drop the native frame and create your own custom HTML buttons instead for minimize, maximize and close. If your window isn‚Äôt focused, though, they won‚Äôt react if you were to hover over them. Hover styles won‚Äôt be applied, and that feels really wrong. To make it worse, if you were to click the close button, for example, it would focus the window and that‚Äôs it. A second click would be required to actually click the button and close the app.</p>\n<p>To add insult to injury, Chromium has a bug that can mask the problem, making you think it works as you might have originally expected. If you move your mouse fast enough (nothing too unreasonable) from outside the window to an element inside the window, hover styles will be applied to that element. It‚Äôs a confirmed bug; applying the hover styles on a blurred window body ‚Äúdoesn‚Äôt meet platform expectations,‚Äù so it will be fixed. Hopefully, I‚Äôm saving you some heartbreak here. You could have a situation in which you‚Äôve created beautiful custom window controls, yet in reality a lot of your users will be frustrated with your app (and will guess it‚Äôs not native).</p>\n<p>So, you must use native buttons on a Mac. There‚Äôs no way around that. For an NW.js app, you must enable the native frame, which is the default anyway (you can disable it by setting <code>window</code> object‚Äôs <code>frame</code> property to <code>false</code> in your <code>package.json</code>).</p>\n<p>You could do the same with an Electron app. This is controlled by setting the <code>frame</code> property when creating a window; for example, <code>new BrowserWindow({width: 800, height: 600, frame: true})</code>. As the Electron team does, they spotted this issue and added another option as a nice compromise; <code>titleBarStyle</code>. Setting this to <code>hidden</code> will hide the native title bar but keep the native window controls overlaid over the top-left corner of your app. This gets you around the problem of having non-native buttons on Mac, but you can still style the top of the app (and the area behind the buttons) however you like.</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    titleBarStyle<span class="token punctuation">:</span> <span class="token string">\'hidden\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Here‚Äôs an app in which I‚Äôve disabled the title bar and given the <code>html</code> element a background image:</p>\n<figure>\n          <a href="/images/blog-content/beyond-the-browser/hiddenTitleBar.png"><img src="/images/blog-content/beyond-the-browser/hiddenTitleBar.png" alt=""/></a>\n          <figcaption><p>A screenshot of our example app without the title bar.</p>\n</figcaption>\n        </figure><p>See ‚Äú<a href="http://electron.atom.io/docs/api/frameless-window" rel="noopener">Frameless Window</a>‚Äù from Electron‚Äôs documentation for more.</p>\n<h4><a id="tooling" class="post-header-anchor" href="#tooling" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tooling</h4>\n<p>Well, you can pretty much use all of the tooling you‚Äôd use to create a web app. Your app is just HTML, CSS and JavaScript, right? Plenty of plugins and modules are out there specifically for desktop apps, too, such as Gulp plugins for signing your app, for example (if you didn‚Äôt want to use electron-builder). <a href="https://github.com/Quramy/electron-connect" rel="noopener">Electron-connect</a> watches your files for changes, and when they occur, it‚Äôll inject those changes into your open window(s) or relaunch the app if it was your main script that was modified. It is Node.js, after all; you can pretty much do anything you‚Äôd like. You could run webpack inside your app if you wanted to ‚Äî I‚Äôve no idea why you would, but the options are endless. Make sure to check out <a href="https://github.com/sindresorhus/awesome-electron" rel="noopener">awesome-electron</a> for more resources.</p>\n<h4><a id="release-flow" class="post-header-anchor" href="#release-flow" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Release Flow</h4>\n<p>What‚Äôs it like to maintain and live with a desktop app? First of all, the release flow is completely different. A significant mindset adjustment is required. When you‚Äôre working on the web app and you deploy a change that breaks something, it‚Äôs not really a huge deal (of course, that depends on your app and the bug). You can just roll out a fix. Users who reload or change the page and new users who trickle in will get the latest code. Developers under pressure might rush out a feature for a deadline and fix bugs as they‚Äôre reported or noticed. You can‚Äôt do that with desktop apps. You can‚Äôt take back updates you push out there. It‚Äôs more like a mobile app flow. You build the app, put it out there, and you can‚Äôt take it back. Some users might not even update from a buggy version to the fixed version. This will make you worry about all of the bugs out there in old versions.</p>\n<h4><a id="quantum-mechanics" class="post-header-anchor" href="#quantum-mechanics" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Quantum Mechanics</h4>\n<p>Because a host of different versions of your app are in use, your code will exist in multiple forms and states. Multiple variants of your client (desktop app) could be hitting your API in 10 slightly different ways. So, you‚Äôll need to strongly consider versioning your API, really locking down and testing it well. When an API change is to be introduced, you might not be sure if it‚Äôs a breaking change or not. A version released a month ago could implode because it has some slightly different code.</p>\n<h4><a id="fresh-problems-to-solve" class="post-header-anchor" href="#fresh-problems-to-solve" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fresh Problems to Solve</h4>\n<p>You might receive a few strange bug reports ‚Äî ones that involve bizarre user account arrangements, specific antivirus software or worse. I had a case in which a user had installed something (or had done something themselves) that messed with their system‚Äôs environment variables. This broke our app because a dependency we used for something critical failed to execute a system command because the command could no longer be found. This is a good example because there will be occasions when you‚Äôll have to draw a line. This was something critical to our app, so we couldn‚Äôt ignore the error, and we couldn‚Äôt fix their machine. For users like this, a lot of their desktop apps would be somewhat broken at best. In the end, we decided to show a tailored error screen to the user if this unlikely error were ever to pop up again. It links to a document explaining why it has occurred and has a step-by-step guide to fix it.</p>\n<p>Sure, a few web-specific concerns are no longer applicable when you‚Äôre working on a desktop app, such as legacy browsers. You will have a few new ones to take into consideration, though. There‚Äôs a 256-character limit on file paths in Windows, for example.</p>\n<p>Old versions of npm store dependencies in a recursive file structure. Your dependencies would each get stored in their own directory within a <code>node_modules</code> directory in your project (for example, <code>node_modules/a</code>). If any of your dependencies have dependencies of their own, those grandchild dependencies would be stored in a <code>node_modules</code> within that directory (for example, <code>node_modules/a/node_modules/b</code>). Because Node.js and npm encourage small single-purpose modules, you could easily end up with a really long path, like <code>path/to/your/project/node_modules/a/node_modules/b/node_modules/c/.../n/index.js</code>.</p>\n<p><em>Note</em>: Since version 3, npm flattens out the dependency tree as much as possible. However, there are other causes for long paths.</p>\n<p>We had a case in which our app wouldn‚Äôt launch at all (or would crash soon after launching) on certain versions of Windows due to an exceeding long path. This was a major headache. With Electron, you can put all of your app‚Äôs code into an <a href="http://electron.atom.io/docs/tutorial/application-packaging/" rel="noopener">asar archive</a>, which protects against path length issues but has exceptions and can‚Äôt always be used.</p>\n<p>We created a little Gulp plugin named <a href="https://github.com/Teamwork/gulp-path-length" rel="noopener">gulp-path-length</a>, which lets you know whether any dangerously long file paths are in your app. Where your app is stored on the end user‚Äôs machine will determine the true length of the path, though. In our case, our installer will install it to <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming</code>. So, when our app is built (locally by us or by a continuous integration service), gulp-path-length is instructed to audit our files as if they‚Äôre stored there (on the user‚Äôs machine with a long username, to be safe).</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> pathLength <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-path-length\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ngulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">\'default\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'./example/**/*\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>read<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">pathLength</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t        rewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t        match<span class="token punctuation">:</span> <span class="token string">\'./example\'</span><span class="token punctuation">,</span>\n\t\t        replacement<span class="token punctuation">:</span> <span class="token string">\'C:\\\\Users\\\\this-is-a-long-username\\\\AppData\\\\Roaming\\\\Teamwork Chat\\\\\'</span>\n\t        <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="fatal-errors-can-be-really-fatal" class="post-header-anchor" href="#fatal-errors-can-be-really-fatal" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fatal Errors Can Be Really Fatal</h4>\n<p>Because all of the automatic updates handling is done within the app, you could have an uncaught exception that crashes the app before it even gets to check for an update. Let‚Äôs say you discover the bug and release a new version containing a fix. If the user launches the app, an update would start downloading, and then the app would die. If they were to relaunch app, the update would start downloading again and‚Ä¶ crash. So, you‚Äôd have to reach out to all of your users and let them know they‚Äôll need to reinstall the app. Trust me, I know. It‚Äôs horrible.</p>\n<h4><a id="analytics-and-bug-reports" class="post-header-anchor" href="#analytics-and-bug-reports" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Analytics and Bug Reports</h4>\n<p>You‚Äôll probably want to track usage of the app and any errors that occur. First of all, Google Analytics won‚Äôt work (out of the box, at least). You‚Äôll have to find something that doesn‚Äôt mind an app that runs on <code>file://</code> URLs. If you‚Äôre using a tool to track errors, make sure to lock down errors by app version if the tool supports release-tracking. For example, if you‚Äôre using <a href="https://sentry.io/welcome/" rel="noopener">Sentry</a> to track errors, make sure to <a href="https://docs.sentry.io/clients/javascript/config/#optional-settings" rel="noopener">set the <code>release</code> property when setting up your client</a>, so that errors will be split up by app version. Otherwise, if you receive a report about an error and roll out a fix, you‚Äôll keep on receiving reports about the error, filling up your reports or logs with false positives. These errors will be coming from people using older versions.</p>\n<p>Electron has a <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crashReporter</code></a> module, which will send you a report any time the app completely crashes (i.e. the entire app dies, not for any old error thrown). You can also listen for events indicating that your renderer process has become unresponsive.</p>\n<h4><a id="security" class="post-header-anchor" href="#security" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Security</h4>\n<p>Be extra-careful when accepting user input or even trusting third-party scripts, because a malicious individual could have a lot of fun with access to Node.js. Also, never accept user input and pass it to a native API or command without proper sanitation.</p>\n<p>Don‚Äôt trust code from vendors either. We had a problem recently with a third-party snippet we had included in our app for analytics, provided by company X. The team behind it rolled out an update with some dodgy code, thereby introducing a fatal error in our app. When a user launched our app, the snippet grabbed the newest JavaScript from their CDN and ran it. The error thrown prevented anything further from executing. Anyone with the app already running was unaffected, but if they were to quit it and launch it again, they‚Äôd have the problem, too. We contacted X‚Äôs support team and they promptly rolled out a fix. Our app was fine again once our users restarted it, but it was scary there for a while. We wouldn‚Äôt have been able to patch the problem ourselves without forcing affected users to manually download a new version of the app (with the snippet removed).</p>\n<p>How can you mitigate this risk? You could try to catch errors, but you‚Äôve no idea what they company X might do in its JavaScript, so you‚Äôre better off with something more solid. You could add a level of abstraction. Instead of pointing directly to X‚Äôs URL from your <code>&lt;script&gt;</code>, you could use <a href="https://www.google.ie/analytics/tag-manager/" rel="noopener">Google Tag Manager</a> or your own API to return either HTML containing the <code>&lt;script&gt;</code> tags or a single JavaScript file containing all of your third-party dependencies somehow. This would enable you to change which snippets get loaded (by tweaking Google Tag Manager or your API endpoint) without having to roll out a new update.</p>\n<p>However, if the API no longer returned the analytics snippet, the global variable created by the snippet would still be there in your code, trying to call undefined functions. So, we haven‚Äôt solved the problem entirely. Also, this API call would fail if a user launches the app without a connection. You don‚Äôt want to restrict your app when offline. Sure, you could use a cached result from the last time the request succeeded, but what if there was a bug in that version? You‚Äôre back to the same problem.</p>\n<p>Another solution would be to create a hidden window and load a (local) HTML file there that contains all of your third-party snippets. So, any global variables that the snippets create would be scoped to that window. Any errors thrown would be thrown in that window and your main window(s) would be unaffected. If you needed to use those APIs or global variables in your main window(s), you‚Äôd do this via IPC now. You‚Äôd send an event over IPC to your main process, which would then send it onto the hidden window, and if it was still healthy, it would listen for the event and call the third-party function. That would work.</p>\n<p>This brings us back to security. What if someone malicious at company X were to include some dangerous Node.js code in their JavaScript? We‚Äôd be rightly screwed. Luckily, Electron has a nice option to disable Node.js for a given window, so it simply wouldn‚Äôt run:</p>\n<pre><code class="language-javascript"><span class="token comment">// main.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> thirdPartyWindow<span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'ready\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  thirdPartyWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>\n    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      nodeIntegration<span class="token punctuation">:</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  thirdPartyWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">\'file://\'</span> <span class="token operator">+</span> __dirname <span class="token operator">+</span> <span class="token string">\'/third-party-snippets.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<h4><a id="automated-testing" class="post-header-anchor" href="#automated-testing" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automated Testing</h4>\n<p>NW.js doesn‚Äôt have any built-in support for testing. But, again, you have access to Node.js, so it‚Äôs technically possible. There is a way to test stuff such as button-clicking within the app using <a href="https://github.com/cyrus-and/chrome-remote-interface" rel="noopener">Chrome Remote Interface</a>, but it‚Äôs tricky. Even then, you can‚Äôt trigger a click on a native window control and test what happens, for example.</p>\n<p>The Electron team has created <a href="http://electron.atom.io/spectron/" rel="noopener">Spectron</a> for automated testing, and it supports testing native controls, managing windows and simulating Electron events. It can even be run in continuous integration builds.</p>\n<pre><code class="language-javascript"><span class="token keyword">var</span> Application <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'spectron\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Application\n<span class="token keyword">var</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'application launch\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>\n\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      path<span class="token punctuation">:</span> <span class="token string">\'/Applications/MyApp.app/Contents/MacOS/MyApp\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'shows an initial window\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getWindowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Because your app is HTML, you could easily use any tool to test web apps, just by pointing the tool at your static files. However, in this case, you‚Äôd need to make sure the app can run in a web browser without Node.js.</p>\n<h3><a id="desktop-and-web" class="post-header-anchor" href="#desktop-and-web" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Desktop And Web</h3>\n<p>It‚Äôs not necessarily about desktop or web. As a web developer, you have all of the tools required to make an app for either environment. Why not both? It takes a bit more effort, but it‚Äôs worth it. I‚Äôll mention a few related topics and tools, which are complicated in their own right, so I‚Äôll keep just touch on them.</p>\n<p>First of all, forget about ‚Äúbrowser lock-in,‚Äù native WebSockets, etc. The same goes for ES6. You can either revert to writing plain old ES5 JavaScript or use something like <a href="https://babeljs.io/" rel="noopener">Babel</a> to transpile your ES6 into ES5, for web use.</p>\n<p>You also have <code>require</code>s throughout your code (for importing other scripts or modules), which a browser won‚Äôt understand. Use a module bundler that supports CommonJS (i.e. Node.js-style <code>require</code>s), such as <a href="http://rollupjs.org" rel="noopener">Rollup</a>, <a href="https://webpack.github.io" rel="noopener">webpack</a> or <a href="http://browserify.org" rel="noopener">Browserify</a>. When making a build for the web, a module bundler will run over your code, traverse all of the <code>require</code>s and bundle them up into one script for you.</p>\n<p>Any code using Node.js or Electron APIs (i.e. to write to disk or integrate with the desktop environment) should not be called when the app is running on the web. You can detect this by checking whether <code>process.version.nwjs</code> or <code>process.versions.electron</code> exists; if it does, then your app is currently running in the desktop environment.</p>\n<p>Even then, you‚Äôll be loading a lot of redundant code in the web app. Let‚Äôs say you have a <code>require</code> guarded behind a check like <code>if(app.isInDesktop)</code>, along with a big chunk of desktop-specific code. Instead of detecting the environment at runtime and setting <code>app.isInDesktop</code>, you could pass <code>true</code> or <code>false</code> into your app as a flag at buildtime (for example, using the <a href="https://github.com/hughsk/envify" rel="noopener">envify</a> transform for Browserify). This will aide your module bundler of choice when it‚Äôs doing its static analysis and tree-shaking (i.e. dead-code elimination). It will now know whether <code>app.isInDesktop</code> is <code>true</code>. So, if you‚Äôre running your web build, it won‚Äôt bother going inside that <code>if</code> statement or traversing the <code>require</code> in question.</p>\n<h4><a id="continuous-delivery" class="post-header-anchor" href="#continuous-delivery" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Continuous Delivery</h4>\n<p>There‚Äôs that release mindset again; it‚Äôs challenging. When you‚Äôre working on the web, you want to be able to roll out changes frequently. I believe in continually delivering small incremental changes that can be rolled back quickly. Ideally, with enough testing, an intern can push a little tweak to your master branch, resulting in your web app being automatically tested and deployed.</p>\n<p>As we covered earlier, you can‚Äôt really do this with a desktop app. OK, I guess you technically could if you‚Äôre using Electron, because electron-builder can be automated and, so, can spectron tests. I don‚Äôt know anyone doing this, and I wouldn‚Äôt have enough faith to do it myself. Remember, broken code can‚Äôt be taken back, and you could break the update flow. Besides, you don‚Äôt want to deliver desktop updates too often anyway. Updates aren‚Äôt silent, like they are on the web, so it‚Äôs not very nice for the user. Plus, for users on macOS, delta updates aren‚Äôt supported, so users would be downloading a full new app for each release, no matter how small a tweak it has.</p>\n<p>You‚Äôll have to find a balance. A happy medium might be to release all fixes to the web as soon as possible and release a desktop app weekly or monthly ‚Äî unless you‚Äôre releasing a feature, that is. You don‚Äôt want to punish a user because they chose to install your desktop app. Nothing‚Äôs worse than seeing a press release for a really cool feature in an app you use, only to realize that you‚Äôll have to wait a while longer than everyone else. You could employ a feature-flags API to roll out features on both platforms at the same time, but that‚Äôs a whole separate topic. I first learned of feature flags from ‚Äú<a href="https://www.youtube.com/watch?v=JR-ccCTmMKY" rel="noopener">Continuous Delivery: The Dirty Details</a>,‚Äù a talk by Etsy‚Äôs VP of Engineering, Mike Brittain.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>So, there you have it. With minimal effort, you can add ‚Äúdesktop app developer‚Äù to your resum√©. We‚Äôve looked at creating your first modern desktop app, packaging, distribution, after-sales service and a lot more. Hopefully, despite the pitfalls and horror stories I‚Äôve shared, you‚Äôll agree that it‚Äôs not as scary as it seems. You already have what it takes. All you need to do is look over some API documentation. Thanks to a few new powerful APIs at your disposal, you can get the most value from your skills as a web developer. I hope to see you around (in the NW.js or Electron community) soon.</p>\n<h4><a id="further-reading" class="post-header-anchor" href="#further-reading" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Further Reading</h4>\n<ul>\n<li>‚Äú<a href="http://engineroom.teamwork.com/resurrecting-clippy/" rel="noopener">Resurrecting Clippy</a>,‚Äù Adam Lynch (me)<br>\nHow I built clippy.desktop with NW.js.</li>\n<li>‚Äú<a href="http://jlord.us/essential-electron/" rel="noopener">Essential Electron</a>,‚Äù Jessica Lord<br>\nA plain-speak introduction to Electron and its core concepts.</li>\n<li><a href="http://electron.atom.io/docs/" rel="noopener">Electron Documentation</a><br>\nWant to dig into the details? Get it straight from the source.</li>\n<li>‚Äú<a href="http://electron.atom.io/community/" rel="noopener">Electron Community</a>‚Äù<br>\nA curated list of Electron-related tools, videos and more.</li>\n<li>‚Äú<a href="https://adamlynch.com/serverless-crash-reports-for-electron-apps/" rel="noopener">Serverless Crash Reporting for Electron Apps</a>,‚Äù Adam Lynch (me)<br>\nMy experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.</li>\n<li><a href="https://github.com/electron-userland/electron-builder" rel="noopener">electron-builder</a>, Stefan Judis<br>\nThe complete solution for packaging and building a ready-for-distribution Electron app, with support for automatic updates (and more) out of the box.</li>\n<li>‚Äú<a href="http://electron.atom.io/docs/api/auto-updater/" rel="noopener">autoUpdater</a>,‚Äù Electron Documentation<br>\nSee just how simple Electron‚Äôs automatic-update API is.</li>\n</ul>\n',summary:"I started out as a web developer, and that‚Äôs now one part of what I do as a full-stack developer, but never had I imagined I‚Äôd create things for the desktop. I love the web. I love how altruistic our community is, how it embraces open-source, testing and pushing the envelope. I love discovering beautiful websites and powerful apps. When I was first tasked with creating a desktop app, I was apprehensive and intimidated. It seemed like it would be difficult, or at least‚Ä¶ different.\n",original:{blogLink:"https://www.smashingmagazine.com/",blogName:"Smashing Magazine",url:"https://www.smashingmagazine.com/2017/03/beyond-browser-web-desktop-apps/"},photo:"/images/blog-content/beyond-the-browser/chromiumDiagram.png",keywords:["node-webkit","electron","desktop","javascript","development"],published_at:"2017-03-21T00:00:00.000Z",updated_at:"2019-05-22T08:25:28.847Z",year:2017,month:3,day:22,relevanceScore:.9166666666666667},{id:"random-open-api",slug:"random-open-api",highlightedLanguages:["javascript","javascripton","shell"],source:"---\ndate: 2019-02-02\ntags:\n  - api\n  - open API\n  - public API\n  - twitter\n  - bot\n  - zeit\n  - now\n  - serverless\n  - faas\n  - node.js\n  - cron\n  - development\n---\n\n## How I made the @randomOpenAPI Twitter bot in 42 minutes-ish\n\nIn my day job, I'm building a product in which nothing is simple. There's a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.\n\nSeriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That's what this project is about.\n\n::: summary\n\nI love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.\n\nThe natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' [@randomMDN](https://twitter.com/randommdn)? It tweets a random article from [MDN](https://developer.mozilla.org/en-US/) multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.\n\n:::\n\nI decided to time myself while I was at it. It took 42 minutes but read on, it wasn't all smooth sailing.\n\n#### Hello, world!\n\nI created a new directory with an `index.js` containing `console.log('Hello, world!)` and ran `node index` in the directory.\n\nOK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there's... of course there's an API to get the list of APIs. Luckily, the [Public API for Public APIs](https://api.publicapis.org/) has a `/random` endpoint. At a glance it had enough information:\n\n- title (string)\n- description (string)\n- category (string)\n- And some other stuff (more about that later).\n\nLooks good. Now, I need to hit the API. I don't necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran `npm init --yes && npm install axios` . Then I added the following code to `index.js`:\n\n```javascript\n  const axios = require('axios');\n  \n  axios.get('https://api.publicapis.org/random')\n  .then((response) => {\n    console.log(response.data);\n  })\n```\n\nNotice how little effort I'm putting into error handling. I'm on the clock.\n\nRunning `node index` resulted in:\n\n```javascripton\n{ count: 1,\n  entries:\n    [ { API: 'Livecoin',\n        Description: 'Cryptocurrency Exchange',\n        Auth: '',\n        HTTPS: true,\n        Cors: 'unknown',\n        Link: 'https://www.livecoin.net/api',\n        Category: 'Cryptocurrency' } ] }\n```\n\n### Writing the tweet\n\nNext, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:\n\n```javascript\nconst axios = require('axios');\nconst camelCase = require('camelcase');\n\nconst formatHashtag = (text) => {\n  return camelCase(text.replace(/[^a-zA-Z0-9]/g, ''));\n};\n\naxios.get('https://api.publicapis.org/random')\n.then((response) => {\n  if(!response.data.entries.length){\n    throw new Error('No APIs found');\n  }\n\n  // Build tweet content\n  const api = response.data.entries[0];\n  const isDescriptionShort = api.Description.split(' ').length <= 2;\n  let tweet = `üì° Random Open API üì°\\n\\n${api.API}`; // .API is the name of the API\n\n  // If the description is too short, it's shown as a hashtag later instead\n  if(!isDescriptionShort){\n    tweet += `: ${api.Description} `;\n  }\n\n  tweet += `${api.Link} `;\n\n  const tags = ['openApi', 'api', formatHashtag(api.Category)];\n  if(isDescriptionShort){\n    tags.push(formatHashtag(api.Description));\n  }\n\n  tweet += tags.map(tag => `#${tag}`).join(' ');\n  console.log(tweet);\n})\n```\n\nI didn't like how it looked when the description was short (e.g. `Discogs: Music`). In this case, I used it as a hashtag instead.\n\n### Tweet, tweet!\n\nNext is actually sending a tweet. I did a quick google and ended up running `npm install twitter-lite` . I chose [twitter-lite](https://www.npmjs.com/package/twitter-lite) because:\n\n1. The documentation showed me what I needed to do at a glance.\n2. It didn't seem too heavy or outdated.\n3. It had `lite` in the name ü§∑‚Äç‚ôÇÔ∏è.\n\nI needed the following Twitter credentials to post a tweet: \n\n- Consumer key.\n- Consumer secret.\n- Access token key.\n- Access token secret.\n\nThis is what took the longest in this project. I created the Twitter account, applied for access to [Twitter's APIs](https://developer.twitter.com/), created an app, and got the credentials I needed. I'm not going into too much detail here, it's tedious.\n\nI commented out the Axios call from before and threw in the following:\n\n```javascript\n// ...\nconst Twitter = require('twitter-lite');\n\nconst client = new Twitter({\n  subdomain: \"api\",\n  consumer_key: \"notTheRealValue\", // from Twitter.\n  consumer_secret: \"notTheRealValueEither\", // from Twitter.\n  access_token_key: \"nopeNotReal\", // from your User (oauth_token)\n  access_token_secret: \"hmmNoStillNotReal\" // from your User (oauth_token_secret)\n});\n\n// ....\n\nclient.post(\"statuses/update\", { status: 'Hello, World!' })\n.then(() => console.log('Success!'))\n```\n\nOnce I ran `node index` again, there was a `Hello, World!` tweet in my feed.\n\nNext, I combined the API and Twitter code, then ran it again;\n\n:::figure random-open-api/tweet.png A screenshot of the first Tweet posted (Daum maps).\n:::\n\nIsn't it beautiful?\n\n### Now, where to host this?\n\nI thought serverless would be a good fit for hosting this. I'd heard the praise Zeit's [Now](https://zeit.co/now) had gotten so I thought I'd give it a go. It's a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more. \n\nThey have integrations with GitHub and more but I went with the slightly more manual approach. I ran `npm install -g now && now login` and added a `now.json` file;\n\n```javascripton\n{\n  \"version\": 2,\n  \"builds\": [{ \"src\": \"*.js\", \"use\": \"@now/node\" }]\n}\n```\n\nThis tells Now that any JavaScript files should be built with their Node.js builder. \n\nI had to tweak my `index.js` slightly. First to add their function boilerplate, and secondly to call `res.end` to output something, rather than logging it to the console;\n\n```javascript\n// ...\n\nmodule.exports = (req, res) => { // Zeit boilerplate\n  axios.get('https://api.publicapis.org/random')\n  .then((response) => {\n    // ...\n    \n    // Tweet, tweet!\n    client.post(\"statuses/update\", { status: tweet })\n    .then(() => res.end('Success!'))\n    .catch((err) => {\n      res.end(`Error: ${err.message}\\n\\n${err.stack}`);\n    });\n  })\n  .catch((error) => {\n    res.end(`Error: ${error.message}\\n\\n${error.stack}`);\n  });\n};\n```\n\nI then ran `now` which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there's probably a lot going behind the scenes to achieve what Zeit provides. \n\nThe result:\n\n```shell\n> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n‚îå index.js        Ready               [24s]\n‚îî‚îÄ‚îÄ Œª index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n```\n\nNow gives you a new URL each time you deploy. I went to this URL in my browser and saw \"Success!\". Yes, it sent the tweet! That was easy.\n\n### Getting secretive\n\nI planned to open source the code and I didn't want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:\n\n```shell\nnow secret add CONSUMER_KEY \"notTheRealValue\"\nnow secret add CONSUMER_SECRET \"notTheRealValueEither\"\nnow secret add ACCESS_TOKEN_KEY \"nopeNotReal\"\nnow secret add ACCESS_TOKEN_SECRET \"hmmNoStillNotReal\"\n```\n\nThen I added the following `env` object to my `now.json` file. \n\n```javascripton\n{\n  \"version\": 2,\n  \"builds\": [{ \"src\": \"*.js\", \"use\": \"@now/node\" }],\n  \"env\": {\n    \"CONSUMER_KEY\": \"@consumer_key\",\n    \"CONSUMER_SECRET\": \"@consumer_secret\",\n    \"ACCESS_TOKEN_KEY\": \"@access_token_key\",\n    \"ACCESS_TOKEN_SECRET\": \"@access_token_secret\"\n  }\n}\n```\n\nThis then allowed me to use `process.env.CONSUMER_KEY` in my function, for example;\n\n```javascript\nconst client = new Twitter({\n  subdomain: \"api\",\n  consumer_key: process.env.CONSUMER_KEY, // from Twitter.\n  consumer_secret: process.env.CONSUMER_SECRET, // from Twitter.\n  access_token_key: process.env.ACCESS_TOKEN_KEY, // from your User (oauth_token)\n  access_token_secret: process.env.ACCESS_TOKEN_SECRET // from your User (oauth_token_secret)\n});\n```\n\nNow would replace those references with the actual values when deploying. Not too complicated right?\n\nI ran `now` again but this time it didn't work. I got a blank response in my browser. Well, what happened was I somehow managed to type `process.key` , not `process.env` . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, `now-env` , and more, before realizing my mistake.\n\n### Automation\n\nI was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit. \n\nWell, Zeit doesn't support running things on a schedule :(\n\nAt least they don't in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn't want to start a project by going back in time. \n\nThere were workarounds suggested in GitHub issues like having a `setInterval` in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn't covered.\n\nSo I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...\n\nI actually settled for a simple but uncomfortable solution. It turns out there's a completely free (and open source) service, [cron-job.org](https://cron-job.org/en/), which will call your URL on a schedule.\n\n:::figure random-open-api/cron.png The job configuration.\n:::\n\nAll I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn't even have to use the horrible [cron format](http://www.nncron.ru/help/EN/working/cron-format.htm). It was painless.\n\n### Deployment aliases\n\nI realized that if I ever deploy an update, I'll have to log into [cron-job.org](http://cron-job.org) and update the URL. Then I discovered Now's aliases. Individual deployments can be assigned deployments;\n\n:::figure random-open-api/alias.png The create alias modal.\n:::\n\nYou can choose a [now.sh](http://now.sh) subdomain or give your own domain.\n\nSo each time I update the code and deploy, I'll re-assign the alias to the new deployment. There's probably a better way around this but I didn't want to spend too long worrying about it. The code won't need to be updated much and if it ever does, I'd assume the Now dashboard is where it's managed.\n\n### The end\n\nSo that's it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye. \n\nGoodbye!\n\nHey, stop, why are you still reading?\n\nUgh, fine...\n\n### Palm, have you met face?\n\nWhile writing this, I noticed that the API returns more than strictly \"open\" APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.\n\nLooking through results, even the ones which require authentication are still free and publicly available. It doesn't bother me then if they're not 100% \"open\", the data is still there to use.\n\nOh wait, no... they're not all free either. The [Semantria API](https://semantria.readme.io/docs) is one entry I just found for example; a \"paid Saas text analytics service\".\n\n![\"Just when I thought I was out, they pull me back in!\" from the Godfather](/images/blog-content/random-open-api/godfather.gif)\n\nLooking at the Public API for Public APIs again, they also return an `auth` property for each API. I've seen results with `\"auth\": \"apiKey\"`, `\"auth\": \"OAuth\"`, and `\"auth\": \"\"`. I need to tweet about the last case.\n\nThe `/random` endpoint doesn't support filtering, so I'd have to keep calling it until I get one that's open. Hmm.\n\nThe `/entries` endpoint does support an `auth` filter parameter but it returns an array of APIs. This looks like my best bet. It doesn't support pagination so it must either return all or at least as many as it can. Here's the new API code:\n\n```javascript\naxios.get('https://api.publicapis.org/entries?auth=null')\n.then((response) => {\n  if(!response.data.entries.length){\n    throw new Error('No APIs found');\n  }\n\n  // Build tweet content from random result\n  const api = response.data.entries[Math.floor(Math.random() * response.data.entries.length)];\n```\n\nThere's no reason why `/random` couldn't also accept filter parameters. After I publish this, I'll go make a pull-request.\n\n### Conclusion\n\nIt was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don't recommend working like this. It was almost a disaster.\n\nFollow [@randomOpenAPI](twitter.com/randomOpenAPI) on Twitter. Check out the source code at [github.com/adam-lynch/random-open-api](github.com/adam-lynch/random-open-api).\n\nWhat could you make? I could imagine someone finding value in an account that tweets about *two* random APIs. The mashups might be handy for coming up with project ideas.\n",unfilteredRenderedBody:'<h2><a id="how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" class="post-header-anchor" href="#how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</h2>\n<p>In my day job, I\'m building a product in which nothing is simple. There\'s a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.</p>\n<p>Seriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That\'s what this project is about.</p>\n<article-summary><p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n</article-summary><p>I decided to time myself while I was at it. It took 42 minutes but read on, it wasn\'t all smooth sailing.</p>\n<h4><a id="hello-world" class="post-header-anchor" href="#hello-world" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Hello, world!</h4>\n<p>I created a new directory with an <code>index.js</code> containing <code>console.log(\'Hello, world!)</code> and ran <code>node index</code> in the directory.</p>\n<p>OK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there\'s... of course there\'s an API to get the list of APIs. Luckily, the <a href="https://api.publicapis.org/" rel="noopener">Public API for Public APIs</a> has a <code>/random</code> endpoint. At a glance it had enough information:</p>\n<ul>\n<li>title (string)</li>\n<li>description (string)</li>\n<li>category (string)</li>\n<li>And some other stuff (more about that later).</li>\n</ul>\n<p>Looks good. Now, I need to hit the API. I don\'t necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran <code>npm init --yes &amp;&amp; npm install axios</code> . Then I added the following code to <code>index.js</code>:</p>\n<pre><code class="language-javascript">  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Notice how little effort I\'m putting into error handling. I\'m on the clock.</p>\n<p>Running <code>node index</code> resulted in:</p>\n<pre><code class="language-javascripton">{ count: 1,\n  entries:\n    [ { API: \'Livecoin\',\n        Description: \'Cryptocurrency Exchange\',\n        Auth: \'\',\n        HTTPS: true,\n        Cors: \'unknown\',\n        Link: \'https://www.livecoin.net/api\',\n        Category: \'Cryptocurrency\' } ] }\n</code></pre>\n<h3><a id="writing-the-tweet" class="post-header-anchor" href="#writing-the-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Writing the tweet</h3>\n<p>Next, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> camelCase <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'camelcase\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">formatHashtag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^a-zA-Z0-9]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\naxios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> isDescriptionShort <span class="token operator">=</span> api<span class="token punctuation">.</span>Description<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> tweet <span class="token operator">=</span> <span class="token template-string"><span class="token string">`üì° Random Open API üì°\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>API<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// .API is the name of the API</span>\n\n  <span class="token comment">// If the description is too short, it\'s shown as a hashtag later instead</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'openApi\'</span><span class="token punctuation">,</span> <span class="token string">\'api\'</span><span class="token punctuation">,</span> <span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">=></span> <span class="token template-string"><span class="token string">`#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tweet<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>I didn\'t like how it looked when the description was short (e.g. <code>Discogs: Music</code>). In this case, I used it as a hashtag instead.</p>\n<h3><a id="tweet-tweet" class="post-header-anchor" href="#tweet-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tweet, tweet!</h3>\n<p>Next is actually sending a tweet. I did a quick google and ended up running <code>npm install twitter-lite</code> . I chose <a href="https://www.npmjs.com/package/twitter-lite" rel="noopener">twitter-lite</a> because:</p>\n<ol>\n<li>The documentation showed me what I needed to do at a glance.</li>\n<li>It didn\'t seem too heavy or outdated.</li>\n<li>It had <code>lite</code> in the name ü§∑‚Äç‚ôÇÔ∏è.</li>\n</ol>\n<p>I needed the following Twitter credentials to post a tweet:</p>\n<ul>\n<li>Consumer key.</li>\n<li>Consumer secret.</li>\n<li>Access token key.</li>\n<li>Access token secret.</li>\n</ul>\n<p>This is what took the longest in this project. I created the Twitter account, applied for access to <a href="https://developer.twitter.com/" rel="noopener">Twitter\'s APIs</a>, created an app, and got the credentials I needed. I\'m not going into too much detail here, it\'s tedious.</p>\n<p>I commented out the Axios call from before and threw in the following:</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'twitter-lite\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> <span class="token string">"notTheRealValue"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> <span class="token string">"notTheRealValueEither"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> <span class="token string">"nopeNotReal"</span><span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> <span class="token string">"hmmNoStillNotReal"</span> <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ....</span>\n\nclient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">\'Hello, World!\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Once I ran <code>node index</code> again, there was a <code>Hello, World!</code> tweet in my feed.</p>\n<p>Next, I combined the API and Twitter code, then ran it again;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/tweet.png"><img src="/images/blog-content/random-open-api/tweet.png" alt=""/></a>\n          <figcaption><p>A screenshot of the first Tweet posted (Daum maps).</p>\n</figcaption>\n        </figure><p>Isn\'t it beautiful?</p>\n<h3><a id="now-where-to-host-this" class="post-header-anchor" href="#now-where-to-host-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Now, where to host this?</h3>\n<p>I thought serverless would be a good fit for hosting this. I\'d heard the praise Zeit\'s <a href="https://zeit.co/now" rel="noopener">Now</a> had gotten so I thought I\'d give it a go. It\'s a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more.</p>\n<p>They have integrations with GitHub and more but I went with the slightly more manual approach. I ran <code>npm install -g now &amp;&amp; now login</code> and added a <code>now.json</code> file;</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }]\n}\n</code></pre>\n<p>This tells Now that any JavaScript files should be built with their Node.js builder.</p>\n<p>I had to tweak my <code>index.js</code> slightly. First to add their function boilerplate, and secondly to call <code>res.end</code> to output something, rather than logging it to the console;</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// Zeit boilerplate</span>\n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    \n    <span class="token comment">// Tweet, tweet!</span>\n    client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> tweet <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>I then ran <code>now</code> which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there\'s probably a lot going behind the scenes to achieve what Zeit provides.</p>\n<p>The result:</p>\n<pre><code class="language-shell">> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n‚îå index.js        Ready               [24s]\n‚îî‚îÄ‚îÄ Œª index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n</code></pre>\n<p>Now gives you a new URL each time you deploy. I went to this URL in my browser and saw &quot;Success!&quot;. Yes, it sent the tweet! That was easy.</p>\n<h3><a id="getting-secretive" class="post-header-anchor" href="#getting-secretive" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Getting secretive</h3>\n<p>I planned to open source the code and I didn\'t want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:</p>\n<pre><code class="language-shell">now secret add CONSUMER_KEY "notTheRealValue"\nnow secret add CONSUMER_SECRET "notTheRealValueEither"\nnow secret add ACCESS_TOKEN_KEY "nopeNotReal"\nnow secret add ACCESS_TOKEN_SECRET "hmmNoStillNotReal"\n</code></pre>\n<p>Then I added the following <code>env</code> object to my <code>now.json</code> file.</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }],\n  "env": {\n    "CONSUMER_KEY": "@consumer_key",\n    "CONSUMER_SECRET": "@consumer_secret",\n    "ACCESS_TOKEN_KEY": "@access_token_key",\n    "ACCESS_TOKEN_SECRET": "@access_token_secret"\n  }\n}\n</code></pre>\n<p>This then allowed me to use <code>process.env.CONSUMER_KEY</code> in my function, for example;</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_KEY<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_SECRET<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_KEY<span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_SECRET <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Now would replace those references with the actual values when deploying. Not too complicated right?</p>\n<p>I ran <code>now</code> again but this time it didn\'t work. I got a blank response in my browser. Well, what happened was I somehow managed to type <code>process.key</code> , not <code>process.env</code> . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, <code>now-env</code> , and more, before realizing my mistake.</p>\n<h3><a id="automation" class="post-header-anchor" href="#automation" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automation</h3>\n<p>I was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit.</p>\n<p>Well, Zeit doesn\'t support running things on a schedule üò¶</p>\n<p>At least they don\'t in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn\'t want to start a project by going back in time.</p>\n<p>There were workarounds suggested in GitHub issues like having a <code>setInterval</code> in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn\'t covered.</p>\n<p>So I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...</p>\n<p>I actually settled for a simple but uncomfortable solution. It turns out there\'s a completely free (and open source) service, <a href="https://cron-job.org/en/" rel="noopener">cron-job.org</a>, which will call your URL on a schedule.</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/cron.png"><img src="/images/blog-content/random-open-api/cron.png" alt=""/></a>\n          <figcaption><p>The job configuration.</p>\n</figcaption>\n        </figure><p>All I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn\'t even have to use the horrible <a href="http://www.nncron.ru/help/EN/working/cron-format.htm" rel="noopener">cron format</a>. It was painless.</p>\n<h3><a id="deployment-aliases" class="post-header-anchor" href="#deployment-aliases" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Deployment aliases</h3>\n<p>I realized that if I ever deploy an update, I\'ll have to log into <a href="http://cron-job.org" rel="noopener">cron-job.org</a> and update the URL. Then I discovered Now\'s aliases. Individual deployments can be assigned deployments;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/alias.png"><img src="/images/blog-content/random-open-api/alias.png" alt=""/></a>\n          <figcaption><p>The create alias modal.</p>\n</figcaption>\n        </figure><p>You can choose a <a href="http://now.sh" rel="noopener">now.sh</a> subdomain or give your own domain.</p>\n<p>So each time I update the code and deploy, I\'ll re-assign the alias to the new deployment. There\'s probably a better way around this but I didn\'t want to spend too long worrying about it. The code won\'t need to be updated much and if it ever does, I\'d assume the Now dashboard is where it\'s managed.</p>\n<h3><a id="the-end" class="post-header-anchor" href="#the-end" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The end</h3>\n<p>So that\'s it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye.</p>\n<p>Goodbye!</p>\n<p>Hey, stop, why are you still reading?</p>\n<p>Ugh, fine...</p>\n<h3><a id="palm-have-you-met-face" class="post-header-anchor" href="#palm-have-you-met-face" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Palm, have you met face?</h3>\n<p>While writing this, I noticed that the API returns more than strictly &quot;open&quot; APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.</p>\n<p>Looking through results, even the ones which require authentication are still free and publicly available. It doesn\'t bother me then if they\'re not 100% &quot;open&quot;, the data is still there to use.</p>\n<p>Oh wait, no... they\'re not all free either. The <a href="https://semantria.readme.io/docs" rel="noopener">Semantria API</a> is one entry I just found for example; a &quot;paid Saas text analytics service&quot;.</p>\n<p><img src="/images/blog-content/random-open-api/godfather.gif" alt="&quot;Just when I thought I was out, they pull me back in!&quot; from the Godfather"></p>\n<p>Looking at the Public API for Public APIs again, they also return an <code>auth</code> property for each API. I\'ve seen results with <code>&quot;auth&quot;: &quot;apiKey&quot;</code>, <code>&quot;auth&quot;: &quot;OAuth&quot;</code>, and <code>&quot;auth&quot;: &quot;&quot;</code>. I need to tweet about the last case.</p>\n<p>The <code>/random</code> endpoint doesn\'t support filtering, so I\'d have to keep calling it until I get one that\'s open. Hmm.</p>\n<p>The <code>/entries</code> endpoint does support an <code>auth</code> filter parameter but it returns an array of APIs. This looks like my best bet. It doesn\'t support pagination so it must either return all or at least as many as it can. Here\'s the new API code:</p>\n<pre><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/entries?auth=null\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content from random result</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre>\n<p>There\'s no reason why <code>/random</code> couldn\'t also accept filter parameters. After I publish this, I\'ll go make a pull-request.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>It was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don\'t recommend working like this. It was almost a disaster.</p>\n<p>Follow <a href="twitter.com/randomOpenAPI">@randomOpenAPI</a> on Twitter. Check out the source code at <a href="github.com/adam-lynch/random-open-api">github.com/adam-lynch/random-open-api</a>.</p>\n<p>What could you make? I could imagine someone finding value in an account that tweets about <em>two</em> random APIs. The mashups might be handy for coming up with project ideas.</p>\n',attributes:{date:"2019-02-02T00:00:00.000Z",tags:[{id:"api",name:"api"},{id:"open-api",name:"open API"},{id:"public-api",name:"public API"},{id:"twitter",name:"twitter"},{id:"bot",name:"bot"},{id:"zeit",name:"zeit"},{id:"now",name:"now"},{id:"serverless",name:"serverless"},{id:"faas",name:"faas"},{id:"nodejs",name:"node.js"},{id:"cron",name:"cron"},{id:"development",name:"development"}],title:"How I made the @randomOpenAPI Twitter bot in 42 minutes-ish",updated_at:"2019-05-22T08:26:12.392Z",photo:"/images/blog-content/random-open-api/tweet.png"},title:"How I made the @randomOpenAPI Twitter bot in 42 minutes-ish",renderedSummary:'<p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n',rendered:'<h2><a id="how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" class="post-header-anchor" href="#how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</h2>\n<p>In my day job, I\'m building a product in which nothing is simple. There\'s a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.</p>\n<p>Seriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That\'s what this project is about.</p>\n<p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n<p>I decided to time myself while I was at it. It took 42 minutes but read on, it wasn\'t all smooth sailing.</p>\n<h4><a id="hello-world" class="post-header-anchor" href="#hello-world" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Hello, world!</h4>\n<p>I created a new directory with an <code>index.js</code> containing <code>console.log(\'Hello, world!)</code> and ran <code>node index</code> in the directory.</p>\n<p>OK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there\'s... of course there\'s an API to get the list of APIs. Luckily, the <a href="https://api.publicapis.org/" rel="noopener">Public API for Public APIs</a> has a <code>/random</code> endpoint. At a glance it had enough information:</p>\n<ul>\n<li>title (string)</li>\n<li>description (string)</li>\n<li>category (string)</li>\n<li>And some other stuff (more about that later).</li>\n</ul>\n<p>Looks good. Now, I need to hit the API. I don\'t necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran <code>npm init --yes &amp;&amp; npm install axios</code> . Then I added the following code to <code>index.js</code>:</p>\n<pre><code class="language-javascript">  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Notice how little effort I\'m putting into error handling. I\'m on the clock.</p>\n<p>Running <code>node index</code> resulted in:</p>\n<pre><code class="language-javascripton">{ count: 1,\n  entries:\n    [ { API: \'Livecoin\',\n        Description: \'Cryptocurrency Exchange\',\n        Auth: \'\',\n        HTTPS: true,\n        Cors: \'unknown\',\n        Link: \'https://www.livecoin.net/api\',\n        Category: \'Cryptocurrency\' } ] }\n</code></pre>\n<h3><a id="writing-the-tweet" class="post-header-anchor" href="#writing-the-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Writing the tweet</h3>\n<p>Next, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> camelCase <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'camelcase\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">formatHashtag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^a-zA-Z0-9]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\naxios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> isDescriptionShort <span class="token operator">=</span> api<span class="token punctuation">.</span>Description<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> tweet <span class="token operator">=</span> <span class="token template-string"><span class="token string">`üì° Random Open API üì°\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>API<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// .API is the name of the API</span>\n\n  <span class="token comment">// If the description is too short, it\'s shown as a hashtag later instead</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'openApi\'</span><span class="token punctuation">,</span> <span class="token string">\'api\'</span><span class="token punctuation">,</span> <span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">=></span> <span class="token template-string"><span class="token string">`#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tweet<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>I didn\'t like how it looked when the description was short (e.g. <code>Discogs: Music</code>). In this case, I used it as a hashtag instead.</p>\n<h3><a id="tweet-tweet" class="post-header-anchor" href="#tweet-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tweet, tweet!</h3>\n<p>Next is actually sending a tweet. I did a quick google and ended up running <code>npm install twitter-lite</code> . I chose <a href="https://www.npmjs.com/package/twitter-lite" rel="noopener">twitter-lite</a> because:</p>\n<ol>\n<li>The documentation showed me what I needed to do at a glance.</li>\n<li>It didn\'t seem too heavy or outdated.</li>\n<li>It had <code>lite</code> in the name ü§∑‚Äç‚ôÇÔ∏è.</li>\n</ol>\n<p>I needed the following Twitter credentials to post a tweet:</p>\n<ul>\n<li>Consumer key.</li>\n<li>Consumer secret.</li>\n<li>Access token key.</li>\n<li>Access token secret.</li>\n</ul>\n<p>This is what took the longest in this project. I created the Twitter account, applied for access to <a href="https://developer.twitter.com/" rel="noopener">Twitter\'s APIs</a>, created an app, and got the credentials I needed. I\'m not going into too much detail here, it\'s tedious.</p>\n<p>I commented out the Axios call from before and threw in the following:</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'twitter-lite\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> <span class="token string">"notTheRealValue"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> <span class="token string">"notTheRealValueEither"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> <span class="token string">"nopeNotReal"</span><span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> <span class="token string">"hmmNoStillNotReal"</span> <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ....</span>\n\nclient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">\'Hello, World!\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Once I ran <code>node index</code> again, there was a <code>Hello, World!</code> tweet in my feed.</p>\n<p>Next, I combined the API and Twitter code, then ran it again;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/tweet.png"><img src="/images/blog-content/random-open-api/tweet.png" alt=""/></a>\n          <figcaption><p>A screenshot of the first Tweet posted (Daum maps).</p>\n</figcaption>\n        </figure><p>Isn\'t it beautiful?</p>\n<h3><a id="now-where-to-host-this" class="post-header-anchor" href="#now-where-to-host-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Now, where to host this?</h3>\n<p>I thought serverless would be a good fit for hosting this. I\'d heard the praise Zeit\'s <a href="https://zeit.co/now" rel="noopener">Now</a> had gotten so I thought I\'d give it a go. It\'s a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more.</p>\n<p>They have integrations with GitHub and more but I went with the slightly more manual approach. I ran <code>npm install -g now &amp;&amp; now login</code> and added a <code>now.json</code> file;</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }]\n}\n</code></pre>\n<p>This tells Now that any JavaScript files should be built with their Node.js builder.</p>\n<p>I had to tweak my <code>index.js</code> slightly. First to add their function boilerplate, and secondly to call <code>res.end</code> to output something, rather than logging it to the console;</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// Zeit boilerplate</span>\n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    \n    <span class="token comment">// Tweet, tweet!</span>\n    client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> tweet <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>I then ran <code>now</code> which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there\'s probably a lot going behind the scenes to achieve what Zeit provides.</p>\n<p>The result:</p>\n<pre><code class="language-shell">> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n‚îå index.js        Ready               [24s]\n‚îî‚îÄ‚îÄ Œª index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n</code></pre>\n<p>Now gives you a new URL each time you deploy. I went to this URL in my browser and saw &quot;Success!&quot;. Yes, it sent the tweet! That was easy.</p>\n<h3><a id="getting-secretive" class="post-header-anchor" href="#getting-secretive" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Getting secretive</h3>\n<p>I planned to open source the code and I didn\'t want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:</p>\n<pre><code class="language-shell">now secret add CONSUMER_KEY "notTheRealValue"\nnow secret add CONSUMER_SECRET "notTheRealValueEither"\nnow secret add ACCESS_TOKEN_KEY "nopeNotReal"\nnow secret add ACCESS_TOKEN_SECRET "hmmNoStillNotReal"\n</code></pre>\n<p>Then I added the following <code>env</code> object to my <code>now.json</code> file.</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }],\n  "env": {\n    "CONSUMER_KEY": "@consumer_key",\n    "CONSUMER_SECRET": "@consumer_secret",\n    "ACCESS_TOKEN_KEY": "@access_token_key",\n    "ACCESS_TOKEN_SECRET": "@access_token_secret"\n  }\n}\n</code></pre>\n<p>This then allowed me to use <code>process.env.CONSUMER_KEY</code> in my function, for example;</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_KEY<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_SECRET<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_KEY<span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_SECRET <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Now would replace those references with the actual values when deploying. Not too complicated right?</p>\n<p>I ran <code>now</code> again but this time it didn\'t work. I got a blank response in my browser. Well, what happened was I somehow managed to type <code>process.key</code> , not <code>process.env</code> . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, <code>now-env</code> , and more, before realizing my mistake.</p>\n<h3><a id="automation" class="post-header-anchor" href="#automation" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automation</h3>\n<p>I was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit.</p>\n<p>Well, Zeit doesn\'t support running things on a schedule üò¶</p>\n<p>At least they don\'t in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn\'t want to start a project by going back in time.</p>\n<p>There were workarounds suggested in GitHub issues like having a <code>setInterval</code> in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn\'t covered.</p>\n<p>So I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...</p>\n<p>I actually settled for a simple but uncomfortable solution. It turns out there\'s a completely free (and open source) service, <a href="https://cron-job.org/en/" rel="noopener">cron-job.org</a>, which will call your URL on a schedule.</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/cron.png"><img src="/images/blog-content/random-open-api/cron.png" alt=""/></a>\n          <figcaption><p>The job configuration.</p>\n</figcaption>\n        </figure><p>All I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn\'t even have to use the horrible <a href="http://www.nncron.ru/help/EN/working/cron-format.htm" rel="noopener">cron format</a>. It was painless.</p>\n<h3><a id="deployment-aliases" class="post-header-anchor" href="#deployment-aliases" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Deployment aliases</h3>\n<p>I realized that if I ever deploy an update, I\'ll have to log into <a href="http://cron-job.org" rel="noopener">cron-job.org</a> and update the URL. Then I discovered Now\'s aliases. Individual deployments can be assigned deployments;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/alias.png"><img src="/images/blog-content/random-open-api/alias.png" alt=""/></a>\n          <figcaption><p>The create alias modal.</p>\n</figcaption>\n        </figure><p>You can choose a <a href="http://now.sh" rel="noopener">now.sh</a> subdomain or give your own domain.</p>\n<p>So each time I update the code and deploy, I\'ll re-assign the alias to the new deployment. There\'s probably a better way around this but I didn\'t want to spend too long worrying about it. The code won\'t need to be updated much and if it ever does, I\'d assume the Now dashboard is where it\'s managed.</p>\n<h3><a id="the-end" class="post-header-anchor" href="#the-end" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The end</h3>\n<p>So that\'s it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye.</p>\n<p>Goodbye!</p>\n<p>Hey, stop, why are you still reading?</p>\n<p>Ugh, fine...</p>\n<h3><a id="palm-have-you-met-face" class="post-header-anchor" href="#palm-have-you-met-face" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Palm, have you met face?</h3>\n<p>While writing this, I noticed that the API returns more than strictly &quot;open&quot; APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.</p>\n<p>Looking through results, even the ones which require authentication are still free and publicly available. It doesn\'t bother me then if they\'re not 100% &quot;open&quot;, the data is still there to use.</p>\n<p>Oh wait, no... they\'re not all free either. The <a href="https://semantria.readme.io/docs" rel="noopener">Semantria API</a> is one entry I just found for example; a &quot;paid Saas text analytics service&quot;.</p>\n<p><img src="/images/blog-content/random-open-api/godfather.gif" alt="&quot;Just when I thought I was out, they pull me back in!&quot; from the Godfather"></p>\n<p>Looking at the Public API for Public APIs again, they also return an <code>auth</code> property for each API. I\'ve seen results with <code>&quot;auth&quot;: &quot;apiKey&quot;</code>, <code>&quot;auth&quot;: &quot;OAuth&quot;</code>, and <code>&quot;auth&quot;: &quot;&quot;</code>. I need to tweet about the last case.</p>\n<p>The <code>/random</code> endpoint doesn\'t support filtering, so I\'d have to keep calling it until I get one that\'s open. Hmm.</p>\n<p>The <code>/entries</code> endpoint does support an <code>auth</code> filter parameter but it returns an array of APIs. This looks like my best bet. It doesn\'t support pagination so it must either return all or at least as many as it can. Here\'s the new API code:</p>\n<pre><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/entries?auth=null\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content from random result</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre>\n<p>There\'s no reason why <code>/random</code> couldn\'t also accept filter parameters. After I publish this, I\'ll go make a pull-request.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>It was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don\'t recommend working like this. It was almost a disaster.</p>\n<p>Follow <a href="twitter.com/randomOpenAPI">@randomOpenAPI</a> on Twitter. Check out the source code at <a href="github.com/adam-lynch/random-open-api">github.com/adam-lynch/random-open-api</a>.</p>\n<p>What could you make? I could imagine someone finding value in an account that tweets about <em>two</em> random APIs. The mashups might be handy for coming up with project ideas.</p>\n',summary:"I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.\nThe natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' @randomMDN? It tweets a random article from MDN multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.\n",photo:"/images/blog-content/random-open-api/tweet.png",keywords:["api","open API","public API","twitter","bot","zeit","now","serverless","faas","node.js","cron","development"],published_at:"2019-02-02T00:00:00.000Z",updated_at:"2019-05-22T08:26:12.392Z",year:2019,month:2,day:3,relevanceScore:1.875}]}}],error:null,state:{nameToShow:"Adam Lynch",githubAccountUrl:"https://github.com/adam-lynch",siteUrl:"https://adamlynch.com",siteTitle:"Adam Lynch",repositoryUrl:"https://github.com/adam-lynch/adam-lynch.github.io"},serverRendered:!0}</script><script src="/_nuxt/manifest.25595636d53df74f38ab.js" defer></script><script src="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" defer></script><script src="/_nuxt/1.03bda2e583db241630d8.js" defer></script><script src="/_nuxt/vendor.ce05078a33ab89125ee8.js" defer></script><script src="/_nuxt/app.7fd5760da80466c89126.js" defer></script>

    <script src="https://use.typekit.net/tci5xbk.js"></script>
    <script>try{Typekit.load({async:!0})}catch(a){}</script>
    <script>!function(e,a,t,n,c,g,s){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,g=a.createElement("script"),s=a.getElementsByTagName("script")[0],g.async=1,g.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(g,s)}(window,document),ga("create","UA-31546953-1","auto"),ga("send","pageview")</script>
  

