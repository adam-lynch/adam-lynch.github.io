<!DOCTYPE html>
<html data-n-head-ssr data-n-head="">
  <head>
    <meta data-n-head="true" charset="utf-8"/><meta data-n-head="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-n-head="true" theme-color="theme-color" content="#ffffff"/><meta data-n-head="true" data-hid="description" name="description" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
"/><meta data-n-head="true" data-hid="keywords" name="keywords" content="serverless, electron, javascript, aws"/><meta data-n-head="true" data-hid="twitter:card" name="twitter:card" content="summary"/><meta data-n-head="true" data-hid="twitter:title" name="twitter:title" content="Serverless crash reporting for Electron apps"/><meta data-n-head="true" data-hid="twitter:description" name="twitter:description" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
"/><meta data-n-head="true" name="twitter:image" content="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png"/><meta data-n-head="true" data-hid="twitter:url" name="twitter:url" content="/serverless-crash-reporting-for-electron-apps"/><meta data-n-head="true" data-hid="og:type" name="og:type" content="article"/><meta data-n-head="true" data-hid="og:title" name="og:title" content="Serverless crash reporting for Electron apps"/><meta data-n-head="true" data-hid="og:description" name="og:description" content="The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.
"/><meta data-n-head="true" data-hid="og:image" name="og:image" content="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png"/><meta data-n-head="true" data-hid="og:url" name="og:url" content="/serverless-crash-reporting-for-electron-apps"/><title data-n-head="true">Serverless crash reporting for Electron apps</title><link data-n-head="true" rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="76x76"/><link data-n-head="true" rel="icon" type="image/x-icon" href="/favicon-32x32.png" sizes="32x32"/><link data-n-head="true" rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link data-n-head="true" rel="mask-icon" href="/safari-pinned-tab.svg" color="#53687a"/><link data-n-head="true" rel="stylesheet" href="//unpkg.com/prismjs/themes/prism.css"/><link rel="preload" href="/_nuxt/manifest.fd1e600c8b5d15d4a9ba.js" as="script"><link rel="preload" href="/_nuxt/vendor.ce05078a33ab89125ee8.js" as="script"><link rel="preload" href="/_nuxt/app.3b3400f1b40887e49e2f.js" as="script"><link rel="preload" href="/_nuxt/layouts/default.6643d645675aedf759ca.js" as="script"><link rel="preload" href="/_nuxt/2.5948147b0c4c5c3303c4.js" as="script"><link rel="prefetch" href="/_nuxt/pages/index.59c05e7c9bb220545891.js"><style data-vue-ssr-id="6dd13fd5:0">*{-webkit-box-sizing:border-box;box-sizing:border-box}body,html{margin:0;padding:0}ol,ul{list-style:none;padding-left:0;margin:0}a{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;text-decoration:none;color:inherit}body{font-family:Arial,sans-serif;line-height:1.55;letter-spacing:-.25px;-webkit-font-smoothing:antialiased}.wf-active body{font-family:Lato,Arial,sans-serif}body{background:#ececec;color:#333;padding-top:32px;padding-top:2rem}.wrapper{max-width:960px;max-width:60rem;margin:0 auto}.header{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0 32px;padding:0 2rem;background:#ececec}@media (min-width:59rem){.header{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}.site-title{margin:0;text-align:center;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;min-width:100%;max-width:96px;max-width:6rem}@media (min-width:42rem){.site-title{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.site-title{-webkit-box-flex:initial;-ms-flex:initial;flex:initial}}.site-title:hover{opacity:.9}.site-link{display:inline-block;background:url(/_nuxt/img/Logo.542e06c.png) 0 no-repeat;background-size:5.99rem;height:144px;height:9rem;width:96px;width:6rem;margin:0 auto;text-indent:-9999px}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.site-link{background-image:url(/_nuxt/img/Logo@2x.b121531.png)}}.site-happy-text-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0 auto;padding:0;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:20.8px;font-size:1.3rem}@media (min-width:42rem){.site-happy-text-wrapper{-webkit-box-flex:2;-ms-flex:2;flex:2;padding:0 0 0 2rem}}@media (min-width:59rem){.site-happy-text-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;font-size:1.2rem}}@media (min-width:61rem){.site-happy-text-wrapper{font-size:1.3rem}}.site-happy-text{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;text-align:center}@media (min-width:42rem){.site-happy-text{text-align:left}}.site-happy-text-headline{display:block}.site-happy-text-headline,.wf-active .site-happy-text-headline{font-size:30.4px;font-size:1.9rem;font-weight:700}@media (min-width:25rem){.site-happy-text-headline{font-size:2.3rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:2.5rem}}@media (min-width:59rem){.site-happy-text-headline{font-size:2.9rem}.wf-active .site-happy-text-headline{font-size:3.1rem}}@media (min-width:61rem){.site-happy-text-headline{font-size:2.92rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:3.2rem}}.site-happy-text-tagline{display:inline}@media (min-width:42rem){.site-happy-text-tagline{display:block}}.navigation-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;padding:32px 0 0;padding:2rem 0 0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}@media (min-width:59rem){.navigation-wrapper{max-width:23rem;padding:0 0 0 2rem}}.navigation{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-width:100%;width:100%}@media (min-width:59rem){.navigation{-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-width:0}}.navigation-item{-webkit-box-flex:1;-ms-flex:1 1 33%;flex:1 1 33%;min-width:33%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;cursor:pointer;font-size:11.2px;font-size:.7rem;font-weight:700;text-shadow:0 1px 1px rgba(0,0,0,.2)}@media (min-width:25rem){.navigation-item{font-size:.75rem}}@media (min-width:45rem){.navigation-item{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.navigation-item{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:33%}}.writing-navigation-item{background:rgba(151,167,182,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.writing-navigation-item:hover{background:#889bab}.edit-navigation-item{background:hsla(210,7%,73%,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.edit-navigation-item:hover{background:#a8aeb4}.code-navigation-item{background:rgba(167,177,186,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.code-navigation-item:hover{background:#99a5af}.twitter-navigation-item{background:rgba(134,155,173,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.twitter-navigation-item:hover{background:#778ea3}.email-navigation-item{background:rgba(151,165,177,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.email-navigation-item:hover{background:#8898a6}.linkedin-navigation-item{background:hsla(208,9%,68%,.9);-webkit-transition:background-color .25s;transition:background-color .25s}.linkedin-navigation-item:hover{background:#99a2aa}.navigation-link{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px;padding:1rem;text-decoration:none;color:#f5f5f5;font-size:12.8px;font-size:.8rem;-webkit-transition:color .25s;transition:color .25s}@media (min-width:25rem){.navigation-link{padding:1.5rem}}.navigation-link:after{content:"";position:absolute;top:100%;left:0;bottom:0;right:0;height:0;width:100%;background:#000;opacity:.02;cursor:pointer;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}.navigation-link:hover{color:#fff}.navigation-link:hover:after{top:50%;height:50%}.navigation-item-text{-webkit-box-flex:1;-ms-flex:1;flex:1}.posts{padding:32px;padding:2rem}.post-wrapper{padding-bottom:32px;padding-bottom:2rem}.post-wrapper:last-child{padding-bottom:0}.post{padding:32px;padding:2rem;margin:32px;margin:2rem;background:#fff;max-width:960px;max-width:60rem}.posts .post{margin:0 auto}.post>:first-child{margin-top:0}.post-content{font-size:17.6px;font-size:1.1rem;line-height:1.55}.post-content>*{margin:24px 0 0;margin:1.5rem 0 0}.post-content :not(figure)>a{color:#3f729e;padding-bottom:.8px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(rgba(0,0,0,.2)));background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-content :not(figure)>a:hover{color:#223d55}.post-content blockquote{position:relative;font-size:20.8px;font-size:1.3rem;font-size:25.12px;font-size:1.57rem;font-style:italic;font-weight:100;padding-left:32px;padding-left:2rem;line-height:1.48;margin-top:32px;margin-top:2rem}.post-content blockquote:before{content:"\201C";position:absolute;top:-24px;top:-1.5rem;left:-8px;left:-.5rem;height:48px;height:3rem;width:25px;color:#f5f5f5;font-size:96px;font-size:6rem;font-style:normal;line-height:1}.post-content blockquote footer{margin-top:16px;margin-top:1rem;font-size:14.4px;font-size:.9rem;text-align:right}.post-content blockquote cite{display:inline-block;margin-left:8px;margin-left:.5rem}.post-content figure{text-align:center}.post-content figcaption{color:#666;font-size:14.4px;font-size:.9rem;font-style:italic}.post-content img{display:block;max-width:100%;height:auto;margin:0 auto;min-height:50px;min-width:150px;position:relative;color:#b6b6b6;font-size:14.4px;font-size:.9rem;text-align:center}.post-content img:before{content:"Image failed to load :/";display:block;font-size:15.2px;font-size:.95rem}.post-content code,.post-content pre{font-family:Consolas,Monaco,Andale Mono,monospace;text-shadow:0 1px #fff;white-space:pre;word-spacing:normal;word-break:normal;-webkit-font-feature-settings:none;font-feature-settings:none;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;word-wrap:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.post-content :not(h3):not(h4):not(h5):not(h6)>code,.post-content pre{font-size:13.6px;font-size:.85rem}.post-content :not(pre)>code,.post-content pre{background:#f5f5f5}.post-content pre{padding:16px;padding:1rem;overflow:auto;color:#000}.post-content :not(pre)>code{display:inline-block;padding:0 4.36px;padding:0 .2725rem;white-space:normal}.post-content a code{background:transparent none repeat 0 0/auto auto padding-box border-box scroll;background:initial;font-size:15.68px;font-size:.98rem;padding:0;padding:initial}.post-content p:first-child{margin-top:0}.post-content h3{font-size:26px;font-size:1.625rem}.post-content h4{font-size:22.224px;font-size:1.389rem}.post-content h5{font-size:18.448px;font-size:1.153rem}.post-content h6{font-size:14.896px;font-size:.931rem}.post-content .post-header-anchor{position:absolute;left:-32px;left:-2rem;top:20px;width:32px;width:2rem;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:none;text-align:center;line-height:1;text-shadow:none;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}.post-content .post-header-anchor:focus{outline:none}.post-content .post-header-anchor:hover svg{opacity:1}.post-content .post-header-anchor:after{content:" copied";position:absolute;bottom:-14px;left:0;right:0;font-size:.6em;color:gray;opacity:0;visibility:none;-webkit-transition:opacity 2s;transition:opacity 2s}.post-content .post-header-anchor svg{opacity:.2}.post-content h4 .post-header-anchor{top:18px}.post-content h5 .post-header-anchor{top:16px}.post-content h6 .post-header-anchor{top:14px}.post-content .post-header-anchor--copied:after{opacity:1}.post-content p:last-of-type{margin-bottom:0}.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3+p,.post-content h4+p,.post-content h5+p,.post-content h6+p{margin-top:8px;margin-top:.5rem}.post-content p+h3,.post-content p+h4,.post-content p+h5,.post-content p+h6{margin-top:32px;margin-top:2rem}.post-content ol,.post-content ul{padding-left:1.25em;list-style:disc outside none;list-style:initial}.post-content li{margin-bottom:8px;margin-bottom:.5rem}.post-summary .post-content,.post-summary .post-content>*{display:inline}.post-content table{border-spacing:0;border-collapse:collapse}.post-content td,.post-content th{padding:0;padding:6px 13px;border:1px solid #dfe2e5}.post-content th{font-weight:600;text-align:left}.post-title-wrapper{margin:0}.post-title{line-height:1.4;font-size:22.4px;font-size:1.4rem;font-weight:700}.wf-active .post-title{font-size:24px;font-size:1.5rem;line-height:1.2}@media (min-width:30rem){.post-title{line-height:1.6;font-size:1.85rem}.wf-active .post-title{line-height:1.5;font-size:2rem}}.post-title-label{display:inline-block;position:relative;bottom:.3em;padding:.2em .4em;margin-left:.3em;font-size:.5em;background:#e3e3e3;color:#9e9e9e;border-radius:5%;font-weight:400;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in}.post-title:hover .post-title-label{opacity:.9}.post-title-label-parenthesis{display:none}.post-meta{font-size:14.4px;font-size:.9rem;margin:16px 0;margin:1rem 0;color:#a2a2a2}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.post-meta{color:#000;font-weight:300}}.post-blog-date{display:block;margin-top:8px;margin-top:.5rem}@media (min-width:30rem){.post-blog-date{display:inline;margin-top:0}.post-blog-date+.post-blog-title:before{display:inline-block;content:" \2014   ";margin:0 .25rem 0 .5rem}}.post-blog-link{font-weight:400;font-style:italic}.footer-link,.post-blog-link,.post-read-more-link,.post-title,.site-happy-text-headline-link,.site-happy-text-tagline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link:hover,.post-blog-link:hover,.post-read-more-link:hover,.post-title:hover,.site-happy-text-headline-link:hover,.site-happy-text-tagline-link:hover{color:#869bad}.footer-link,.post-read-more-link,.post-title,.site-happy-text-tagline-link{color:#53687a}.post-read-more-link{display:inline-block;font-weight:700;margin:0}.post-comments{margin:32px;margin:2rem;padding:32px;padding:2rem;background:#fff}.footer{text-align:center;font-size:12.8px;font-size:.8rem;margin-bottom:32px;margin-bottom:2rem}.footer-text{margin:0}.footer-link{font-weight:700}.copyright{display:block;color:gray}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.copyright{font-weight:100}}.fix-bug-ignore{color:red}.posts{position:relative}.post-wrapper{-webkit-transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out}.post{-webkit-transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out,-webkit-transform .1s ease-in-out}.posts--entering-post .post-wrapper:not(.post-wrapper--entering-from-posts) .post{opacity:.2;-webkit-transform:scale(.8);transform:scale(.8)}.posts--entering-post .post-wrapper--entering-from-posts{left:32px;left:2rem;right:32px;right:2rem}.post-skeleton{line-height:1.55;position:relative;opacity:0;max-height:0;overflow:hidden}.post-skeleton.post-skeleton--visible,.post-wrapper--entering-from-posts .post-skeleton{opacity:1;margin-top:32px;margin-top:2rem;max-height:none}.post-skeleton:after{content:" ";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;opacity:.2;-webkit-animation:1s skeleton infinite ease-in-out;animation:1s skeleton infinite ease-in-out}.post-skeleton-word{height:17.6px;height:1.1rem;background:#f7f7f7;width:46px;display:inline-block;margin:4px 6px 0 0}.post-skeleton-word:nth-child(2n){width:36px}.post-skeleton-word:nth-child(3n){width:76px}.post-skeleton+.post-skeleton .post-skeleton-word:nth-child(3n){width:71px}.post-skeleton-word:nth-child(5n){width:96px}.post-skeleton-word:nth-child(6n){width:63px}.post-skeleton-word:nth-child(7n){width:26px}@-webkit-keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}</style><style data-vue-ssr-id="772bbed7:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style>
    <script src="https://unpkg.com/scrollto-with-animation/dist/scrollto-with-animation.min.js"></script>
  </head>
  <body data-n-head="">
    <div data-server-rendered="true" id="__nuxt"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#869bad;opacity:0;"></div><div id="__layout"><div class="wrapper"><main class="content"><header class="header"><h1 class="site-title"><a href="/" class="site-link nuxt-link-active">Adam Lynch</a></h1><div class="site-happy-text-wrapper"><p class="site-happy-text"><span class="site-happy-text-headline">
                I'm <a href="/" class="site-happy-text-headline-link nuxt-link-active">Adam Lynch</a>.
            </span><span class="site-happy-text-tagline">
                I like to
                <a href="https://github.com/adam-lynch" class="site-happy-text-tagline-link">code</a>,
                <a href="/" class="site-happy-text-tagline-link nuxt-link-active">write</a>, and dabble in design.
            </span><span class="site-happy-text-tagline">
                I lead <a href="https://www.teamwork.com" class="site-happy-text-tagline-link">Teamwork.com</a>'s next product.
            </span></p></div><nav role="navigation" class="navigation-wrapper"><ul class="navigation"><li class="navigation-item writing-navigation-item"><a href="/" class="navigation-link nuxt-link-active"><span class="navigation-item-text">Writing</span></a></li><li class="navigation-item code-navigation-item"><a href="https://github.com/adam-lynch" rel="noopener" class="navigation-link"><span class="navigation-item-text">Code</span></a></li><li class="navigation-item edit-navigation-item"><a href="https://github.com/adam-lynch/adam-lynch.github.io" rel="noopener" class="navigation-link"><span class="navigation-item-text">Edit page</span></a></li><li class="navigation-item twitter-navigation-item"><a href="https://twitter.com/lynchy010/" rel="noopener" class="navigation-link"><span class="navigation-item-text">Twitter</span></a></li><li class="navigation-item email-navigation-item"><a href="mailto:contact@adamlynch.com" rel="noopener" class="navigation-link"><span class="navigation-item-text">Email</span></a></li><li class="navigation-item linkedin-navigation-item"><a href="https://www.linkedin.com/in/adamlynch010/" rel="noopener" class="navigation-link"><span class="navigation-item-text">LinkedIn</span></a></li></ul></nav></header><div><article class="post"><h2 class="post-title-wrapper"><a href="/serverless-crash-reporting-for-electron-apps" class="post-title nuxt-link-exact-active nuxt-link-active">Serverless crash reporting for Electron apps</a></h2><div class="post-meta"><time class="post-blog-date">November 22nd, 2016</time><span class="post-blog-title">
            Originally posted on <a href="https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a" class="post-blog-link">Teamwork's Engine Room</a></span></div><div class="post-content">
<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>
<p>The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>
<h3><a id="the-conference" class="post-header-anchor" href="#the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>
<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>
<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>
<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>
<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.</p>
<p>The conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.</p>
<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>
<p>Overall, I didn‚Äôt learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>
<h3><a id="the-crash-reporter" class="post-header-anchor" href="#the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>
<p>We‚Äôre currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>
<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 productName<span class="token punctuation">:</span> <span class="token string">'YourAppName;'</span><span class="token punctuation">,</span>
 companyName<span class="token punctuation">:</span> <span class="token string">'YourCompany;'</span><span class="token punctuation">,</span>
 submitURL<span class="token punctuation">:</span> <span class="token string">'https://your-domain.com/url-to-submit&amp;amp'</span><span class="token punctuation">,</span>
 autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'electron‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>'ready‚Äô<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    productName<span class="token punctuation">:</span> 'YourAppName‚Äô<span class="token punctuation">,</span>
    companyName<span class="token punctuation">:</span> <span class="token string">'YourCompany'</span><span class="token punctuation">,</span>
    submitURL<span class="token punctuation">:</span> <span class="token string">'https://your-domain.com/url-to-submit'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h3><a id="the-serverless-crash-reporter" class="post-header-anchor" href="#the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>
<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.</p>
<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>
<ul>
<li>Search.</li>
<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>
<li>New (Electron) desktop apps.</li>
<li>New (native) mobile apps.</li>
</ul>
<p>Expect a few posts on those topics.</p>
<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>
<p>The function</p>
<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what‚Äôs the harm in a little ES6?</p>
<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>
<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>
 release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>
<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.</p>
<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>
<p>The Lambda function</p>
<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>
<p>It wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.</p>
<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.</p>
<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>
<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>
<p>The webtask</p>
<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.</p>
<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.</p>
<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>
<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.</p>
<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.</p>
<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.</p>
<p>Side note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>
<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>
<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>
<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>
<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html '</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'&lt;h1>Hello, world!&lt;/h1>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>
<p>OK, so I got it working. Finally. Here is my webtask:</p>
<pre><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'formidable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raven'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'aws-sdk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'bluebird'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  sentryDsn<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  accessKey<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  bucket<span class="token punctuation">:</span> <span class="token string">'TODO'</span><span class="token punctuation">,</span>
  secretAccessKey<span class="token punctuation">:</span> <span class="token string">'TODO'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>

<span class="token comment">// req - request {Object}</span>
<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>
<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>
        files<span class="token punctuation">:</span> files
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// name - {String}</span>
<span class="token comment">// contents - {String}</span>
<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>
<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>
    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      ACL<span class="token punctuation">:</span> <span class="token string">'public-read'</span><span class="token punctuation">,</span>
      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>
      Body<span class="token punctuation">:</span> contents
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// context - {Object}</span>
<span class="token comment">// req - {Object}</span>
<span class="token comment">// res - {Object}</span>
<span class="token comment">// Returns a Promise</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Successfully received crash and sent event to Sentry!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>
        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'upload_file_minidump'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>
            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>
            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">' crash'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        context<span class="token punctuation">:</span> context
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>One thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>
<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?</p>
<p>###¬†The conclusion</p>
<p>In the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>
<p>For this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>
<p>I didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>
<p>I‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.</p>
</div></article><aside class="post-comments"><div id="disqus_thread"></div><div aria-hidden="true" class="post-skeleton post-skeleton--visible"><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span><span class="post-skeleton-word"></span></div></aside></div><footer class="footer"><p class="footer-text"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="footer-link">This site is open source</a><span class="copyright">¬© 2018 Adam Lynch</span></p></footer></main></div></div></div><script type="text/javascript">window.__NUXT__={"layout":"default","data":[{"article":{"id":"serverless-crash-reporting-for-electron-apps","slug":"serverless-crash-reporting-for-electron-apps","highlightedLanguages":["javascript"],"source":"---\ndate: 2016-11-22\noriginal:\n  blogLink: https:\u002F\u002Fengineroom.teamwork.com\n  blogName: Teamwork's Engine Room\n  url: https:\u002F\u002Fengineroom.teamwork.com\u002Fserverless-crash-reporting-for-electron-apps-fe6e62e5982a\ntags:\n  - serverless\n  - electron\n  - javascript\n  - aws\n---\n\n## Serverless crash reporting for Electron apps\n\n[![](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png)](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png)\n\n\n:::summary\n\nThe term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from [Electron](http:\u002F\u002Felectron.atom.io\u002F) apps.\n\n:::\n\n### The conference\n\nI attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like [NodeConf EU](http:\u002F\u002Fwww.nodeconf.eu\u002F). A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever [ServerlessConf](http:\u002F\u002Fserverlessconf.io\u002F).\n\nI bought a [Udemy](https:\u002F\u002Fwww.udemy.com\u002F) course on [AWS Lambda](https:\u002F\u002Faws.amazon.com\u002Flambda\u002F) during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular [S3](https:\u002F\u002Faws.amazon.com\u002Fs3\u002F) bucket.\n\n\n[![](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png)](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png)\n\nSo you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an [EC2](https:\u002F\u002Faws.amazon.com\u002Fec2\u002F) instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.\n\nThe conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning :\u002F). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.\n\nMost of the talks involved AWS and there were a lot of jokes at [API Gateway](https:\u002F\u002Faws.amazon.com\u002Fapi-gateway\u002F)‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting [talk](http:\u002F\u002Fwww.slideshare.net\u002FServerlessConf\u002Fjoe-emison-10x-product-development) on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like [Firebase](https:\u002F\u002Ffirebase.google.com\u002F), [Auth0](https:\u002F\u002Fauth0.com\u002F), [Algolia](https:\u002F\u002Fwww.algolia.com\u002F), [Netlify](https:\u002F\u002Fwww.netlify.com\u002F), [Webtask.io](https:\u002F\u002Fwebtask.io\u002F), and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.\n\nOverall, I didn‚Äôt learn _that_ much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.\n\n### The crash reporter\n\nWe‚Äôre currently rewriting our desktop apps to be based on Electron rather than [NW.js](http:\u002F\u002Fnwjs.io\u002F). I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called [Developing an Electron Edge](http:\u002F\u002Fshop.oreilly.com\u002Fproduct\u002F9781939902344.do) and while proofreading it, a nice serverless use case struck me; serverless crash reporting.\n\nSure, we report runtime errors to [Sentry](https:\u002F\u002Fsentry.io\u002Fteamwork\u002F) when they occur in [Teamwork Chat](https:\u002F\u002Fteamwork.com\u002Fchat), but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs [`crash-reporter`](http:\u002F\u002Felectron.atom.io\u002Fdocs\u002Fapi\u002Fcrash-reporter\u002F) module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.\n\n```javascript\nconst { crashReporter } = require('electron');\n\ncrashReporter.start({\n productName: 'YourAppName;',\n companyName: 'YourCompany;',\n submitURL: 'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit&amp',\n autoSubmit: true\n});\n```\n\nThat‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.\n\n```javascript\nconst { app, crashReporter } = require('electron‚Äô);\n\napp.on('ready‚Äô, () =\u003E {\n  crashReporter.start({\n    productName: 'YourAppName‚Äô,\n    companyName: 'YourCompany',\n    submitURL: 'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit',autoSubmit: true\n  });\n  setTimeout(() =\u003E {\n  process.crash()\n  }, 3000);\n})\n```\n\n### The serverless crash reporter\n\nSo how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.\n\nIt would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;\n\n*   Search.\n*   Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.\n*   New (Electron) desktop apps.\n*   New (native) mobile apps.\n\nExpect a few posts on those topics.\n\nAnyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.\n\nThe function\n\nI started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in [CoffeeScript at Teamwork](https:\u002F\u002Fadamlynch.com\u002Fcoffeescript-at-teamwork\u002F) but this will only be a few lines long, what‚Äôs the harm in a little ES6?\n\nI quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with [express](http:\u002F\u002Fexpressjs.com\u002F), and called my function whenever it received a POST.\n\n```javascript\nravenClient = new raven.Client(config.sentryDsn, {\n release: options._version\n});\n```\n\nWhen instantiating [Raven](https:\u002F\u002Fgithub.com\u002Fgetsentry\u002Fraven-node) (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.\n\nAnother thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.\n\nNow I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.\n\nThe Lambda function\n\nEven though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.\n\nIt wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.\n\nA few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.\n\nAround the same time, I started investigating the [Serverless Framework](https:\u002F\u002Fserverless.com\u002F). It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is [open-sourced](https:\u002F\u002Fgithub.com\u002Fserverless\u002Fserverless), I think.\n\nMaybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which _does_ support POSTing of files. I [posted](http:\u002F\u002Fforum.serverless.com\u002Ft\u002Fno-support-for-posting-files\u002F307) in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.\n\nThe webtask\n\nDisappointed, I almost gave up until I remembered Webtask.io. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0\\. A quick look at their site got my hopes up again. There was even a _free_ plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.\n\nBased on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.\n\nI had a few little hiccups with their [wt-cli](https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwt-cli) CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.\n\nWebtask.io has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; [webtask-bundle](https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwebtask-bundle). So now instead of just running wt create a.js to publish\u002Fupdate a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.\n\nThe bundler uses [Webpack](https:\u002F\u002Fwebpack.github.io\u002F) underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used [bluebird](http:\u002F\u002Fbluebirdjs.com\u002Fdocs\u002Fgetting-started.html) for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know Webtask.io have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.\n\nRunning the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.\n\nSide note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for [local debugging](https:\u002F\u002Fgithub.com\u002Fauth0\u002Fwt-cli\u002Fpull\u002F89) was added recently though.\n\nOnce I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.\n\nOne thing I should point out is the Webtask.io has a [Slack channel](https:\u002F\u002Fwebtask-chat.slack.com\u002F) where you can receive some much appreciated support. It was pointed out to me there that Webtask.io actually supports [multiple function signatures](https:\u002F\u002Fwebtask.io\u002Fdocs\u002Fmodel) and I should try one of the other options; specifically the one that uses express.\n\nOnce I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.\n\n```javascript\nmodule.exports = function(context, req, res) {\n  res.writeHead(200, {\n  'Content-Type': 'text\u002Fhtml '\n  });\n  res.end('\u003Ch1\u003EHello, world!\u003C\u002Fh1\u003E');\n}\n```\n\nNote: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.\n\nOK, so I got it working. Finally. Here is my webtask:\n\n```javascript\n'use strict';\nconst fs = require('fs');\nconst path = require('path');\nconst formidable = require('formidable');\nconst raven = require('raven');\nconst aws = require('aws-sdk');\nconst Promise = require('bluebird');\nconst config = {\n  sentryDsn: 'TODO',\n  s3: {\n  accessKey: 'TODO',\n  bucket: 'TODO',\n  secretAccessKey: 'TODO'\n  }\n};\n\nvar ravenClient, onError;\n\n\u002F\u002F req - request {Object}\n\u002F\u002F Returns a Promise which resolves to an {Object} containing {fields} and {files}\nconst parseFormData = (req) =\u003E {\n  return new Promise((resolve, reject) =\u003E {\n    formidable.IncomingForm().parse(req, (err, fields, files) =\u003E {\n      if (err) {\n        return reject(err);\n      }\n      resolve({\n        fields: fields,\n        files: files\n      });\n    });\n  });\n};\n\n\u002F\u002F name - {String}\n\u002F\u002F contents - {String}\n\u002F\u002F Returns a Promise which resolves to a {String} URL\nconst uploadDumpToS3 = (name, contents) =\u003E {\n  aws.config.update({\n    accessKeyId: config.s3.accessKey,\n    secretAccessKey: config.s3.secretAccessKey\n  });\n  const s3 = new aws.S3({\n    params: {\n      Bucket: config.s3.bucket\n    }\n  });\n  return new Promise((resolve, reject) =\u003E {\n    s3.upload({\n      ACL: 'public-read',\n      Key: name,\n      Body: contents\n    }, (err, data) =\u003E {\n      if (err) {\n        return reject(err);\n      }\n      resolve(data.Location);\n    });\n  });\n};\n\n\u002F\u002F context - {Object}\n\u002F\u002F req - {Object}\n\u002F\u002F res - {Object}\n\u002F\u002F Returns a Promise\nmodule.exports = (context, req, res) =\u003E {\n  onError = (error, options) =\u003E {\n    if (!ravenClient) {\n      ravenClient = new raven.Client(config.sentryDsn, {\n        release: options._version\n      });\n    }\n\n    ravenClient.captureException(error, options);\n    res.end('Successfully received crash and sent event to Sentry!');\n  }\n\n  return parseFormData(req)\n    .then(formData =\u003E {\n      const payload = {\n        tags: formData.fields,\n        extra: {}\n      };\n      const dump = formData.files['upload_file_minidump'];\n\n      if (dump) {\n        const contents = fs.readFileSync(dump.path).toString('utf8');\n        return uploadDumpToS3(dump.name, contents)\n          .then(url =\u003E {\n            payload.extra[dump.name] = url;\n            return payload;\n          });\n      } else {\n        return payload;\n      }\n    })\n    .then((payload) =\u003E {\n      return onError(new Error(payload.tags.process_type + ' crash'), payload);\n    })\n    .catch((err) =\u003E onError(err, {\n      extra: {\n        context: context\n      }\n    }));\n};\n```\n\nOne thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.\n\nNext up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that Webtask.io‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?\n\n###¬†The conclusion\n\nIn the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it _should_ be that easy.\n\nFor this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.\n\nI didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at [Teamwork\u002Fserverless-crash-reporting](https:\u002F\u002Fgithub.com\u002FTeamwork\u002Fserverless-crash-reporting). Feedback is welcome, this stuff is completely new to me.\n\nI‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, [two new Lambda features](https:\u002F\u002Faws.amazon.com\u002Fblogs\u002Faws\u002Fnew-for-aws-lambda-environment-variables-and-serverless-application-model\u002F) were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.\n","unfilteredRenderedBody":"\u003Ch2\u003E\u003Ca id=\"serverless-crash-reporting-for-electron-apps\" class=\"post-header-anchor\" href=\"#serverless-crash-reporting-for-electron-apps\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EServerless crash reporting for Electron apps\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png\" rel=\"noopener\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png\" alt=\"\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Carticle-summary\u003E\u003Cp\u003EThe term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from \u003Ca href=\"http:\u002F\u002Felectron.atom.io\u002F\" rel=\"noopener\"\u003EElectron\u003C\u002Fa\u003E apps.\u003C\u002Fp\u003E\n\u003C\u002Farticle-summary\u003E\u003Ch3\u003E\u003Ca id=\"the-conference\" class=\"post-header-anchor\" href=\"#the-conference\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe conference\u003C\u002Fh3\u003E\n\u003Cp\u003EI attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like \u003Ca href=\"http:\u002F\u002Fwww.nodeconf.eu\u002F\" rel=\"noopener\"\u003ENodeConf EU\u003C\u002Fa\u003E. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever \u003Ca href=\"http:\u002F\u002Fserverlessconf.io\u002F\" rel=\"noopener\"\u003EServerlessConf\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EI bought a \u003Ca href=\"https:\u002F\u002Fwww.udemy.com\u002F\" rel=\"noopener\"\u003EUdemy\u003C\u002Fa\u003E course on \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Flambda\u002F\" rel=\"noopener\"\u003EAWS Lambda\u003C\u002Fa\u003E during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fs3\u002F\" rel=\"noopener\"\u003ES3\u003C\u002Fa\u003E bucket.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png\" rel=\"noopener\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png\" alt=\"\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ESo you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fec2\u002F\" rel=\"noopener\"\u003EEC2\u003C\u002Fa\u003E instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.\u003C\u002Fp\u003E\n\u003Cp\u003EThe conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.\u003C\u002Fp\u003E\n\u003Cp\u003EMost of the talks involved AWS and there were a lot of jokes at \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fapi-gateway\u002F\" rel=\"noopener\"\u003EAPI Gateway\u003C\u002Fa\u003E‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting \u003Ca href=\"http:\u002F\u002Fwww.slideshare.net\u002FServerlessConf\u002Fjoe-emison-10x-product-development\" rel=\"noopener\"\u003Etalk\u003C\u002Fa\u003E on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like \u003Ca href=\"https:\u002F\u002Ffirebase.google.com\u002F\" rel=\"noopener\"\u003EFirebase\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fauth0.com\u002F\" rel=\"noopener\"\u003EAuth0\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.algolia.com\u002F\" rel=\"noopener\"\u003EAlgolia\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.netlify.com\u002F\" rel=\"noopener\"\u003ENetlify\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwebtask.io\u002F\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.\u003C\u002Fp\u003E\n\u003Cp\u003EOverall, I didn‚Äôt learn \u003Cem\u003Ethat\u003C\u002Fem\u003E much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.\u003C\u002Fp\u003E\n\u003Ch3\u003E\u003Ca id=\"the-crash-reporter\" class=\"post-header-anchor\" href=\"#the-crash-reporter\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe crash reporter\u003C\u002Fh3\u003E\n\u003Cp\u003EWe‚Äôre currently rewriting our desktop apps to be based on Electron rather than \u003Ca href=\"http:\u002F\u002Fnwjs.io\u002F\" rel=\"noopener\"\u003ENW.js\u003C\u002Fa\u003E. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called \u003Ca href=\"http:\u002F\u002Fshop.oreilly.com\u002Fproduct\u002F9781939902344.do\" rel=\"noopener\"\u003EDeveloping an Electron Edge\u003C\u002Fa\u003E and while proofreading it, a nice serverless use case struck me; serverless crash reporting.\u003C\u002Fp\u003E\n\u003Cp\u003ESure, we report runtime errors to \u003Ca href=\"https:\u002F\u002Fsentry.io\u002Fteamwork\u002F\" rel=\"noopener\"\u003ESentry\u003C\u002Fa\u003E when they occur in \u003Ca href=\"https:\u002F\u002Fteamwork.com\u002Fchat\" rel=\"noopener\"\u003ETeamwork Chat\u003C\u002Fa\u003E, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs \u003Ca href=\"http:\u002F\u002Felectron.atom.io\u002Fdocs\u002Fapi\u002Fcrash-reporter\u002F\" rel=\"noopener\"\u003E\u003Ccode\u003Ecrash-reporter\u003C\u002Fcode\u003E\u003C\u002Fa\u003E module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E crashReporter \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'electron'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\ncrashReporter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n productName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourAppName;'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n companyName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourCompany;'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n submitURL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit&amp;amp'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n autoSubmit\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThat‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E app\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E crashReporter \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E'electron‚Äô\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\napp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eon\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E'ready‚Äô\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  crashReporter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    productName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E 'YourAppName‚Äô\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    companyName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourCompany'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    submitURL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003EautoSubmit\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function\"\u003EsetTimeout\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  process\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ecrash\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E3000\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3\u003E\u003Ca id=\"the-serverless-crash-reporter\" class=\"post-header-anchor\" href=\"#the-serverless-crash-reporter\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe serverless crash reporter\u003C\u002Fh3\u003E\n\u003Cp\u003ESo how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.\u003C\u002Fp\u003E\n\u003Cp\u003EIt would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ESearch.\u003C\u002Fli\u003E\n\u003Cli\u003ERedoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.\u003C\u002Fli\u003E\n\u003Cli\u003ENew (Electron) desktop apps.\u003C\u002Fli\u003E\n\u003Cli\u003ENew (native) mobile apps.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EExpect a few posts on those topics.\u003C\u002Fp\u003E\n\u003Cp\u003EAnyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.\u003C\u002Fp\u003E\n\u003Cp\u003EThe function\u003C\u002Fp\u003E\n\u003Cp\u003EI started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in \u003Ca href=\"https:\u002F\u002Fadamlynch.com\u002Fcoffeescript-at-teamwork\u002F\" rel=\"noopener\"\u003ECoffeeScript at Teamwork\u003C\u002Fa\u003E but this will only be a few lines long, what‚Äôs the harm in a little ES6?\u003C\u002Fp\u003E\n\u003Cp\u003EI quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with \u003Ca href=\"http:\u002F\u002Fexpressjs.com\u002F\" rel=\"noopener\"\u003Eexpress\u003C\u002Fa\u003E, and called my function whenever it received a POST.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003EravenClient \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eraven\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EClient\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsentryDsn\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n release\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E_version\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWhen instantiating \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgetsentry\u002Fraven-node\" rel=\"noopener\"\u003ERaven\u003C\u002Fa\u003E (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.\u003C\u002Fp\u003E\n\u003Cp\u003EAnother thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.\u003C\u002Fp\u003E\n\u003Cp\u003ENow I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.\u003C\u002Fp\u003E\n\u003Cp\u003EThe Lambda function\u003C\u002Fp\u003E\n\u003Cp\u003EEven though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.\u003C\u002Fp\u003E\n\u003Cp\u003EIt wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.\u003C\u002Fp\u003E\n\u003Cp\u003EA few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.\u003C\u002Fp\u003E\n\u003Cp\u003EAround the same time, I started investigating the \u003Ca href=\"https:\u002F\u002Fserverless.com\u002F\" rel=\"noopener\"\u003EServerless Framework\u003C\u002Fa\u003E. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fserverless\u002Fserverless\" rel=\"noopener\"\u003Eopen-sourced\u003C\u002Fa\u003E, I think.\u003C\u002Fp\u003E\n\u003Cp\u003EMaybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which \u003Cem\u003Edoes\u003C\u002Fem\u003E support POSTing of files. I \u003Ca href=\"http:\u002F\u002Fforum.serverless.com\u002Ft\u002Fno-support-for-posting-files\u002F307\" rel=\"noopener\"\u003Eposted\u003C\u002Fa\u003E in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.\u003C\u002Fp\u003E\n\u003Cp\u003EThe webtask\u003C\u002Fp\u003E\n\u003Cp\u003EDisappointed, I almost gave up until I remembered \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a \u003Cem\u003Efree\u003C\u002Fem\u003E plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.\u003C\u002Fp\u003E\n\u003Cp\u003EBased on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.\u003C\u002Fp\u003E\n\u003Cp\u003EI had a few little hiccups with their \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwt-cli\" rel=\"noopener\"\u003Ewt-cli\u003C\u002Fa\u003E CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwebtask-bundle\" rel=\"noopener\"\u003Ewebtask-bundle\u003C\u002Fa\u003E. So now instead of just running wt create a.js to publish\u002Fupdate a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.\u003C\u002Fp\u003E\n\u003Cp\u003EThe bundler uses \u003Ca href=\"https:\u002F\u002Fwebpack.github.io\u002F\" rel=\"noopener\"\u003EWebpack\u003C\u002Fa\u003E underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used \u003Ca href=\"http:\u002F\u002Fbluebirdjs.com\u002Fdocs\u002Fgetting-started.html\" rel=\"noopener\"\u003Ebluebird\u003C\u002Fa\u003E for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.\u003C\u002Fp\u003E\n\u003Cp\u003ERunning the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.\u003C\u002Fp\u003E\n\u003Cp\u003ESide note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fauth0\u002Fwt-cli\u002Fpull\u002F89\" rel=\"noopener\"\u003Elocal debugging\u003C\u002Fa\u003E was added recently though.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.\u003C\u002Fp\u003E\n\u003Cp\u003EOne thing I should point out is the \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E has a \u003Ca href=\"https:\u002F\u002Fwebtask-chat.slack.com\u002F\" rel=\"noopener\"\u003ESlack channel\u003C\u002Fa\u003E where you can receive some much appreciated support. It was pointed out to me there that \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E actually supports \u003Ca href=\"https:\u002F\u002Fwebtask.io\u002Fdocs\u002Fmodel\" rel=\"noopener\"\u003Emultiple function signatures\u003C\u002Fa\u003E and I should try one of the other options; specifically the one that uses express.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003Emodule\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function-variable function\"\u003Eexports\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econtext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E res\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EwriteHead\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E'Content-Type'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'text\u002Fhtml '\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eend\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'&lt;h1\u003EHello, world!&lt;\u002Fh1\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENote: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.\u003C\u002Fp\u003E\n\u003Cp\u003EOK, so I got it working. Finally. Here is my webtask:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token string\"\u003E'use strict'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E fs \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'fs'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E path \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'path'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E formidable \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'formidable'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E raven \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'raven'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E aws \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'aws-sdk'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E Promise \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'bluebird'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E config \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  sentryDsn\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  s3\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  accessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  bucket\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  secretAccessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E ravenClient\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E onError\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F req - request {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise which resolves to an {Object} containing {fields} and {files}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token function-variable function\"\u003EparseFormData\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EPromise\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresolve\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E reject\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    formidable\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EIncomingForm\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eparse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E files\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ereject\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token function\"\u003Eresolve\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        fields\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E fields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        files\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E files\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F name - {String}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F contents - {String}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise which resolves to a {String} URL\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token function-variable function\"\u003EuploadDumpToS3\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E contents\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  aws\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eupdate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    accessKeyId\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EaccessKey\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    secretAccessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsecretAccessKey\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E s3 \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eaws\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ES3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    params\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      Bucket\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ebucket\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EPromise\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresolve\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E reject\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    s3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eupload\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      ACL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'public-read'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n      Key\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E name\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n      Body\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E contents\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ereject\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token function\"\u003Eresolve\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELocation\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F context - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F req - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F res - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise\u003C\u002Fspan\u003E\nmodule\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function-variable function\"\u003Eexports\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econtext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E res\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function-variable function\"\u003EonError\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003EravenClient\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      ravenClient \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eraven\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EClient\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsentryDsn\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        release\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E_version\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n    ravenClient\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EcaptureException\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eend\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Successfully received crash and sent event to Sentry!'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EparseFormData\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EformData \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E payload \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        tags\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E formData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Efields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        extra\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E dump \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E formData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Efiles\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'upload_file_minidump'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E contents \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EreadFileSync\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Epath\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EtoString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'utf8'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EuploadDumpToS3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E contents\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n          \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n            payload\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eextra\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E url\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n          \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Epayload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EonError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Epayload\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Etags\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eprocess_type \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E' crash'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Ecatch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EonError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      extra\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        context\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E context\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EOne thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.\u003C\u002Fp\u003E\n\u003Cp\u003ENext up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?\u003C\u002Fp\u003E\n\u003Cp\u003E###¬†The conclusion\u003C\u002Fp\u003E\n\u003Cp\u003EIn the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it \u003Cem\u003Eshould\u003C\u002Fem\u003E be that easy.\u003C\u002Fp\u003E\n\u003Cp\u003EFor this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.\u003C\u002Fp\u003E\n\u003Cp\u003EI didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FTeamwork\u002Fserverless-crash-reporting\" rel=\"noopener\"\u003ETeamwork\u002Fserverless-crash-reporting\u003C\u002Fa\u003E. Feedback is welcome, this stuff is completely new to me.\u003C\u002Fp\u003E\n\u003Cp\u003EI‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fblogs\u002Faws\u002Fnew-for-aws-lambda-environment-variables-and-serverless-application-model\u002F\" rel=\"noopener\"\u003Etwo new Lambda features\u003C\u002Fa\u003E were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.\u003C\u002Fp\u003E\n","attributes":{"date":"2016-11-22T00:00:00.000Z","original":{"blogLink":"https:\u002F\u002Fengineroom.teamwork.com","blogName":"Teamwork's Engine Room","url":"https:\u002F\u002Fengineroom.teamwork.com\u002Fserverless-crash-reporting-for-electron-apps-fe6e62e5982a"},"tags":[{"id":"serverless","name":"serverless"},{"id":"electron","name":"electron"},{"id":"javascript","name":"javascript"},{"id":"aws","name":"aws"}],"title":"Serverless crash reporting for Electron apps","updated_at":"2018-01-11T19:45:11.000Z","photo":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png"},"title":"Serverless crash reporting for Electron apps","renderedSummary":"\u003Cp\u003EThe term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from \u003Ca href=\"http:\u002F\u002Felectron.atom.io\u002F\" rel=\"noopener\"\u003EElectron\u003C\u002Fa\u003E apps.\u003C\u002Fp\u003E\n","rendered":"\u003Ch2\u003E\u003Ca id=\"serverless-crash-reporting-for-electron-apps\" class=\"post-header-anchor\" href=\"#serverless-crash-reporting-for-electron-apps\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EServerless crash reporting for Electron apps\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png\" rel=\"noopener\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png\" alt=\"\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from \u003Ca href=\"http:\u002F\u002Felectron.atom.io\u002F\" rel=\"noopener\"\u003EElectron\u003C\u002Fa\u003E apps.\u003C\u002Fp\u003E\n\u003Ch3\u003E\u003Ca id=\"the-conference\" class=\"post-header-anchor\" href=\"#the-conference\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe conference\u003C\u002Fh3\u003E\n\u003Cp\u003EI attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like \u003Ca href=\"http:\u002F\u002Fwww.nodeconf.eu\u002F\" rel=\"noopener\"\u003ENodeConf EU\u003C\u002Fa\u003E. A few others were slightly disappointing, in that I expected to learn more. If you‚Äôre unlucky, some conferences can feel a little like a recap of the articles and books you‚Äôve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever \u003Ca href=\"http:\u002F\u002Fserverlessconf.io\u002F\" rel=\"noopener\"\u003EServerlessConf\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EI bought a \u003Ca href=\"https:\u002F\u002Fwww.udemy.com\u002F\" rel=\"noopener\"\u003EUdemy\u003C\u002Fa\u003E course on \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Flambda\u002F\" rel=\"noopener\"\u003EAWS Lambda\u003C\u002Fa\u003E during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does ‚Äúserverless‚Äù even mean? I‚Äôm not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless ‚Äúfunction‚Äù) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fs3\u002F\" rel=\"noopener\"\u003ES3\u003C\u002Fa\u003E bucket.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png\" rel=\"noopener\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F0*PunR2epJ6yYV0f9_.png\" alt=\"\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ESo you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fec2\u002F\" rel=\"noopener\"\u003EEC2\u003C\u002Fa\u003E instance where you‚Äôll pay even if it‚Äôs sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1‚Äì300 seconds). What‚Äôs great as well is that Lambda will completely handle scaling for you.\u003C\u002Fp\u003E\n\u003Cp\u003EThe conference was good, especially for one so cheap (even though I‚Äôd have paid for some air conditioning üòï). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn‚Äôt agree on what ‚Äúserverless‚Äù meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that ‚Äúserverless‚Äù is really about ‚Äúfunctions as a unit of deployment‚Äù and everything else is secondary. It‚Äôs up to you how you use it.\u003C\u002Fp\u003E\n\u003Cp\u003EMost of the talks involved AWS and there were a lot of jokes at \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fapi-gateway\u002F\" rel=\"noopener\"\u003EAPI Gateway\u003C\u002Fa\u003E‚Äôs expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting \u003Ca href=\"http:\u002F\u002Fwww.slideshare.net\u002FServerlessConf\u002Fjoe-emison-10x-product-development\" rel=\"noopener\"\u003Etalk\u003C\u002Fa\u003E on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like \u003Ca href=\"https:\u002F\u002Ffirebase.google.com\u002F\" rel=\"noopener\"\u003EFirebase\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fauth0.com\u002F\" rel=\"noopener\"\u003EAuth0\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.algolia.com\u002F\" rel=\"noopener\"\u003EAlgolia\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.netlify.com\u002F\" rel=\"noopener\"\u003ENetlify\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwebtask.io\u002F\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don‚Äôt mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.\u003C\u002Fp\u003E\n\u003Cp\u003EOverall, I didn‚Äôt learn \u003Cem\u003Ethat\u003C\u002Fem\u003E much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.\u003C\u002Fp\u003E\n\u003Ch3\u003E\u003Ca id=\"the-crash-reporter\" class=\"post-header-anchor\" href=\"#the-crash-reporter\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe crash reporter\u003C\u002Fh3\u003E\n\u003Cp\u003EWe‚Äôre currently rewriting our desktop apps to be based on Electron rather than \u003Ca href=\"http:\u002F\u002Fnwjs.io\u002F\" rel=\"noopener\"\u003ENW.js\u003C\u002Fa\u003E. I‚Äôm sure this is going to be the first of many posts on that so I won‚Äôt go into too much detail here. I recently wrote a book on Electron called \u003Ca href=\"http:\u002F\u002Fshop.oreilly.com\u002Fproduct\u002F9781939902344.do\" rel=\"noopener\"\u003EDeveloping an Electron Edge\u003C\u002Fa\u003E and while proofreading it, a nice serverless use case struck me; serverless crash reporting.\u003C\u002Fp\u003E\n\u003Cp\u003ESure, we report runtime errors to \u003Ca href=\"https:\u002F\u002Fsentry.io\u002Fteamwork\u002F\" rel=\"noopener\"\u003ESentry\u003C\u002Fa\u003E when they occur in \u003Ca href=\"https:\u002F\u002Fteamwork.com\u002Fchat\" rel=\"noopener\"\u003ETeamwork Chat\u003C\u002Fa\u003E, but what if the app crashes entirely? Well, we‚Äôre in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron‚Äôs \u003Ca href=\"http:\u002F\u002Felectron.atom.io\u002Fdocs\u002Fapi\u002Fcrash-reporter\u002F\" rel=\"noopener\"\u003E\u003Ccode\u003Ecrash-reporter\u003C\u002Fcode\u003E\u003C\u002Fa\u003E module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E crashReporter \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'electron'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\ncrashReporter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n productName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourAppName;'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n companyName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourCompany;'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n submitURL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit&amp;amp'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n autoSubmit\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThat‚Äôs all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E app\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E crashReporter \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E'electron‚Äô\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\napp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eon\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E'ready‚Äô\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  crashReporter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    productName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E 'YourAppName‚Äô\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    companyName\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'YourCompany'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    submitURL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'https:\u002F\u002Fyour-domain.com\u002Furl-to-submit'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003EautoSubmit\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function\"\u003EsetTimeout\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  process\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ecrash\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E3000\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3\u003E\u003Ca id=\"the-serverless-crash-reporter\" class=\"post-header-anchor\" href=\"#the-serverless-crash-reporter\" aria-hidden=\"true\"\u003E\u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"15\" height=\"15\" viewBox=\"0 0 8 8\"\u003E\u003Cpath d=\"M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z\"\u003E\u003C\u002Fpath\u003E\u003C\u002Fsvg\u003E\u003C\u002Fa\u003EThe serverless crash reporter\u003C\u002Fh3\u003E\n\u003Cp\u003ESo how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don‚Äôt want a whole server there running and waiting for crash reports. Ideally you wouldn‚Äôt have too many of these and therefore using Lambda should be very cheap.\u003C\u002Fp\u003E\n\u003Cp\u003EIt would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ESearch.\u003C\u002Fli\u003E\n\u003Cli\u003ERedoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.\u003C\u002Fli\u003E\n\u003Cli\u003ENew (Electron) desktop apps.\u003C\u002Fli\u003E\n\u003Cli\u003ENew (native) mobile apps.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EExpect a few posts on those topics.\u003C\u002Fp\u003E\n\u003Cp\u003EAnyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.\u003C\u002Fp\u003E\n\u003Cp\u003EThe function\u003C\u002Fp\u003E\n\u003Cp\u003EI started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in \u003Ca href=\"https:\u002F\u002Fadamlynch.com\u002Fcoffeescript-at-teamwork\u002F\" rel=\"noopener\"\u003ECoffeeScript at Teamwork\u003C\u002Fa\u003E but this will only be a few lines long, what‚Äôs the harm in a little ES6?\u003C\u002Fp\u003E\n\u003Cp\u003EI quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with \u003Ca href=\"http:\u002F\u002Fexpressjs.com\u002F\" rel=\"noopener\"\u003Eexpress\u003C\u002Fa\u003E, and called my function whenever it received a POST.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003EravenClient \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eraven\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EClient\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsentryDsn\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n release\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E_version\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWhen instantiating \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgetsentry\u002Fraven-node\" rel=\"noopener\"\u003ERaven\u003C\u002Fa\u003E (Sentry‚Äôs Node.js client module), it‚Äôs important to note that I‚Äôm passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.\u003C\u002Fp\u003E\n\u003Cp\u003EAnother thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don‚Äôt need to clean up that variable, that callback won‚Äôt be called again, etc.\u003C\u002Fp\u003E\n\u003Cp\u003ENow I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I‚Äôm not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.\u003C\u002Fp\u003E\n\u003Cp\u003EThe Lambda function\u003C\u002Fp\u003E\n\u003Cp\u003EEven though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn‚Äôt expect Lambda to be installing modules from npm. I assumed all I‚Äôd need to do is bundle them up into a ZIP or something like that for Lambda to use.\u003C\u002Fp\u003E\n\u003Cp\u003EIt wasn‚Äôt so easy in reality. Gordon stepped in to help out but long story short‚Ä¶ it‚Äôs not possible to do what I had planned to do with Lambda; it doesn‚Äôt support file uploads.\u003C\u002Fp\u003E\n\u003Cp\u003EA few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I‚Äôd have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That‚Äôs back to the original problem though; if I went with that, there‚Äôs no point in using Lambda at all.\u003C\u002Fp\u003E\n\u003Cp\u003EAround the same time, I started investigating the \u003Ca href=\"https:\u002F\u002Fserverless.com\u002F\" rel=\"noopener\"\u003EServerless Framework\u003C\u002Fa\u003E. It looked interesting. It‚Äôs a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there‚Äôs a company behind it but a lot of it is \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fserverless\u002Fserverless\" rel=\"noopener\"\u003Eopen-sourced\u003C\u002Fa\u003E, I think.\u003C\u002Fp\u003E\n\u003Cp\u003EMaybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which \u003Cem\u003Edoes\u003C\u002Fem\u003E support POSTing of files. I \u003Ca href=\"http:\u002F\u002Fforum.serverless.com\u002Ft\u002Fno-support-for-posting-files\u002F307\" rel=\"noopener\"\u003Eposted\u003C\u002Fa\u003E in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.\u003C\u002Fp\u003E\n\u003Cp\u003EThe webtask\u003C\u002Fp\u003E\n\u003Cp\u003EDisappointed, I almost gave up until I remembered \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a \u003Cem\u003Efree\u003C\u002Fem\u003E plan which limited us to one execution per second, which was fine by me as I wouldn‚Äôt expect there to be many crash reports.\u003C\u002Fp\u003E\n\u003Cp\u003EBased on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a ‚Äúwebtask‚Äù now. After spending some time with the site, I‚Äôd say it‚Äôs OK. Some things are hard to get to, but I‚Äôm told there is a dashboard in the works.\u003C\u002Fp\u003E\n\u003Cp\u003EI had a few little hiccups with their \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwt-cli\" rel=\"noopener\"\u003Ewt-cli\u003C\u002Fa\u003E CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module‚Äôs function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E has some pre-installed npm modules but if you use anything outside of those, you‚Äôll need to bundle them into your webtask. To do this, you‚Äôll need their another module; \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fwebtask-bundle\" rel=\"noopener\"\u003Ewebtask-bundle\u003C\u002Fa\u003E. So now instead of just running wt create a.js to publish\u002Fupdate a webtask named a, I needed to run webtask-bundle‚Ää‚Äî‚Ääoutput b.js a.js &amp;&amp; wt create b.js‚Ää‚Äî‚Ääname a.\u003C\u002Fp\u003E\n\u003Cp\u003EThe bundler uses \u003Ca href=\"https:\u002F\u002Fwebpack.github.io\u002F\" rel=\"noopener\"\u003EWebpack\u003C\u002Fa\u003E underneath so all it‚Äôs doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn‚Äôt really look into it. I just used \u003Ca href=\"http:\u002F\u002Fbluebirdjs.com\u002Fdocs\u002Fgetting-started.html\" rel=\"noopener\"\u003Ebluebird\u003C\u002Fa\u003E for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E have. I don‚Äôt really mind since my script was still far below the 100KB webtask weight limit.\u003C\u002Fp\u003E\n\u003Cp\u003ERunning the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it‚Äôs a bit hard to find; there is pretty much no way to navigate to it from the site. It‚Äôs handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won‚Äôt even start like mine wouldn‚Äôt.\u003C\u002Fp\u003E\n\u003Cp\u003ESide note: there isn‚Äôt any real consensus on the best way to work with webtasks. Support for \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fauth0\u002Fwt-cli\u002Fpull\u002F89\" rel=\"noopener\"\u003Elocal debugging\u003C\u002Fa\u003E was added recently though.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn‚Äôt like that the dump file Electron is sending is 560KB, which shouldn‚Äôt be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.\u003C\u002Fp\u003E\n\u003Cp\u003EOne thing I should point out is the \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E has a \u003Ca href=\"https:\u002F\u002Fwebtask-chat.slack.com\u002F\" rel=\"noopener\"\u003ESlack channel\u003C\u002Fa\u003E where you can receive some much appreciated support. It was pointed out to me there that \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E actually supports \u003Ca href=\"https:\u002F\u002Fwebtask.io\u002Fdocs\u002Fmodel\" rel=\"noopener\"\u003Emultiple function signatures\u003C\u002Fa\u003E and I should try one of the other options; specifically the one that uses express.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003Emodule\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function-variable function\"\u003Eexports\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econtext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E res\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EwriteHead\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E'Content-Type'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'text\u002Fhtml '\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eend\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'&lt;h1\u003EHello, world!&lt;\u002Fh1\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENote: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.\u003C\u002Fp\u003E\n\u003Cp\u003EOK, so I got it working. Finally. Here is my webtask:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token string\"\u003E'use strict'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E fs \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'fs'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E path \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'path'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E formidable \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'formidable'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E raven \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'raven'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E aws \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'aws-sdk'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E Promise \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'bluebird'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E config \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  sentryDsn\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  s3\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  accessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  bucket\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  secretAccessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'TODO'\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E ravenClient\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E onError\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F req - request {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise which resolves to an {Object} containing {fields} and {files}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token function-variable function\"\u003EparseFormData\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EPromise\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresolve\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E reject\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    formidable\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EIncomingForm\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eparse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E files\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ereject\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token function\"\u003Eresolve\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        fields\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E fields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        files\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E files\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F name - {String}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F contents - {String}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise which resolves to a {String} URL\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token function-variable function\"\u003EuploadDumpToS3\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E contents\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  aws\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eupdate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    accessKeyId\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EaccessKey\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    secretAccessKey\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsecretAccessKey\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E s3 \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eaws\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ES3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    params\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      Bucket\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E config\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Es3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ebucket\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EPromise\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresolve\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E reject\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    s3\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eupload\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      ACL\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'public-read'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n      Key\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E name\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n      Body\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E contents\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ereject\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token function\"\u003Eresolve\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ELocation\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F context - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F req - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F res - {Object}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F Returns a Promise\u003C\u002Fspan\u003E\nmodule\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function-variable function\"\u003Eexports\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econtext\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E req\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E res\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function-variable function\"\u003EonError\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003EravenClient\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      ravenClient \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003Eraven\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EClient\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Econfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EsentryDsn\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        release\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E_version\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n    ravenClient\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EcaptureException\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E options\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    res\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eend\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Successfully received crash and sent event to Sentry!'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EparseFormData\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ereq\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EformData \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E payload \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        tags\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E formData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Efields\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        extra\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E dump \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E formData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Efiles\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'upload_file_minidump'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n      \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E contents \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EreadFileSync\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Epath\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EtoString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'utf8'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EuploadDumpToS3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E contents\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n          \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n            payload\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eextra\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Edump\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E url\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n            \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n          \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Epayload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EonError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Epayload\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Etags\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eprocess_type \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E' crash'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E payload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Ecatch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EonError\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      extra\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        context\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E context\n      \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EOne thing that‚Äôs nice is that any error that occurs in the promise chain will also be logged to Sentry.\u003C\u002Fp\u003E\n\u003Cp\u003ENext up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that \u003Ca href=\"http:\u002F\u002FWebtask.io\" rel=\"noopener\"\u003EWebtask.io\u003C\u002Fa\u003E‚Äôs free plan only allows for ‚Äú30 days webtask lifetime,‚Äù whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn‚Äôt support custom domains, so it‚Äôs not so cheap after all, eh?\u003C\u002Fp\u003E\n\u003Cp\u003E###¬†The conclusion\u003C\u002Fp\u003E\n\u003Cp\u003EIn the end, I decided we‚Äôll just add an endpoint to our existing API for this. It was an interesting experiment but I‚Äôll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn‚Äôt want to spend a lot of time on it, but nevertheless it \u003Cem\u003Eshould\u003C\u002Fem\u003E be that easy.\u003C\u002Fp\u003E\n\u003Cp\u003EFor this specific use case, there‚Äôs probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.\u003C\u002Fp\u003E\n\u003Cp\u003EI didn‚Äôt want to come away empty handed so along with writing this, I‚Äôve published my serverless crash reporting function on GitHub at \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FTeamwork\u002Fserverless-crash-reporting\" rel=\"noopener\"\u003ETeamwork\u002Fserverless-crash-reporting\u003C\u002Fa\u003E. Feedback is welcome, this stuff is completely new to me.\u003C\u002Fp\u003E\n\u003Cp\u003EI‚Äôm not disregarding ‚Äúserverless‚Äù just yet. Last week, \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fblogs\u002Faws\u002Fnew-for-aws-lambda-environment-variables-and-serverless-application-model\u002F\" rel=\"noopener\"\u003Etwo new Lambda features\u003C\u002Fa\u003E were announced by AWS. I‚Äôm going to keep an eye on it and I‚Äôm sure I‚Äôll revisit this topic in the future.\u003C\u002Fp\u003E\n","summary":"The term ‚Äúserverless‚Äù has been trendy for a while now. In this post, I‚Äôm going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.\n","original":{"blogLink":"https:\u002F\u002Fengineroom.teamwork.com","blogName":"Teamwork's Engine Room","url":"https:\u002F\u002Fengineroom.teamwork.com\u002Fserverless-crash-reporting-for-electron-apps-fe6e62e5982a"},"photo":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1600\u002F1*7_8IQl1UmmFdv-Z3EwGNJg.png","keywords":["serverless","electron","javascript","aws"],"published_at":"2016-11-22T00:00:00.000Z","updated_at":"2018-01-11T19:45:11.000Z","year":2016,"month":11,"day":23}}],"error":null,"state":{"nameToShow":"Adam Lynch","githubAccountUrl":"https:\u002F\u002Fgithub.com\u002Fadam-lynch","siteUrl":"https:\u002F\u002Fadamlynch.com","siteTitle":"Adam Lynch","repositoryUrl":"https:\u002F\u002Fgithub.com\u002Fadam-lynch\u002Fadam-lynch.github.io"},"serverRendered":true};</script><script src="/_nuxt/manifest.fd1e600c8b5d15d4a9ba.js" defer></script><script src="/_nuxt/layouts/default.6643d645675aedf759ca.js" defer></script><script src="/_nuxt/2.5948147b0c4c5c3303c4.js" defer></script><script src="/_nuxt/vendor.ce05078a33ab89125ee8.js" defer></script><script src="/_nuxt/app.3b3400f1b40887e49e2f.js" defer></script>

    <script src="https://use.typekit.net/tci5xbk.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-31546953-1', 'auto');
        ga('send', 'pageview');
    </script>
  </body>
</html>
