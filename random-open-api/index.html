<!DOCTYPE html>
<html data-n-head="" data-n-head-ssr>
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="#ffffff" theme-color="theme-color"><meta data-n-head="true" content="I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.
The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' @randomMDN? It tweets a random article from MDN multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.
" name="description" data-hid="description"><meta data-n-head="true" content="api, open API, public API, twitter, bot, zeit, now, serverless, faas, node.js, cron, development" name="keywords" data-hid="keywords"><meta data-n-head="true" content="summary" name="twitter:card" data-hid="twitter:card"><meta data-n-head="true" content="How I made the @randomOpenAPI Twitter bot in 42 minutes-ish" name="twitter:title" data-hid="twitter:title"><meta data-n-head="true" content="I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.
The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' @randomMDN? It tweets a random article from MDN multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.
" name="twitter:description" data-hid="twitter:description"><meta data-n-head="true" content="/images/blog-content/random-open-api/tweet.png" name="twitter:image"><meta data-n-head="true" content="/random-open-api" name="twitter:url" data-hid="twitter:url"><meta data-n-head="true" content="article" name="og:type" data-hid="og:type"><meta data-n-head="true" content="How I made the @randomOpenAPI Twitter bot in 42 minutes-ish" name="og:title" data-hid="og:title"><meta data-n-head="true" content="I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.
The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' @randomMDN? It tweets a random article from MDN multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.
" name="og:description" data-hid="og:description"><meta data-n-head="true" content="/images/blog-content/random-open-api/tweet.png" name="og:image" data-hid="og:image"><meta data-n-head="true" content="/random-open-api" name="og:url" data-hid="og:url"><title data-n-head="true">How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</title><link href="/apple-touch-icon.png" rel="apple-touch-icon" data-n-head="true" sizes="76x76"><link href="/favicon-32x32.png" rel="icon" data-n-head="true" sizes="32x32" type="image/x-icon"><link href="/favicon-16x16.png" rel="icon" data-n-head="true" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" data-n-head="true" color="#53687a"><link href="//unpkg.com/prismjs/themes/prism.css" rel="stylesheet" data-n-head="true"><link href="/_nuxt/manifest.65913a97086adc66c060.js" rel="preload" as="script"><link href="/_nuxt/vendor.ce05078a33ab89125ee8.js" rel="preload" as="script"><link href="/_nuxt/app.4156c854185051639b89.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" rel="preload" as="script"><link href="/_nuxt/1.03bda2e583db241630d8.js" rel="preload" as="script"><link href="/_nuxt/pages/index.5bad6aa85a4e69648400.js" rel="prefetch"><style data-vue-ssr-id="6dd13fd5:0">*{-webkit-box-sizing:border-box;box-sizing:border-box}body,html{margin:0;padding:0}ol,ul{list-style:none;padding-left:0;margin:0}a{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;text-decoration:none;color:inherit}body{font-family:Arial,sans-serif;line-height:1.55;letter-spacing:-.25px;-webkit-font-smoothing:antialiased}.wf-active body{font-family:Lato,Arial,sans-serif}html{font-size:14px}@media (min-width:470px){html{font-size:16px}}body{background:#ececec;color:#333;padding-top:28px;padding-top:2rem}.wrapper{max-width:840px;max-width:60rem;margin:0 auto}.header{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0 14px;padding:0 1rem;background:#ececec}@media (min-width:59rem){.header{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}@media (min-width:470px){.header{padding-left:2rem;padding-right:2rem}}.site-title{margin:0;text-align:center;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;min-width:100%;max-width:84px;max-width:6rem}@media (min-width:42rem){.site-title{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.site-title{-webkit-box-flex:initial;-ms-flex:initial;flex:initial}}.site-title:hover{opacity:.9}.site-link{display:inline-block;background:url(/_nuxt/img/Logo.542e06c.png) 0 no-repeat;background-size:5.99rem;height:126px;height:9rem;width:84px;width:6rem;margin:0 auto;text-indent:-9999px}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.site-link{background-image:url(/_nuxt/img/Logo@2x.b121531.png)}}.site-happy-text-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0 auto;padding:0;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:18.2px;font-size:1.3rem}@media (min-width:42rem){.site-happy-text-wrapper{-webkit-box-flex:2;-ms-flex:2;flex:2;padding:0 0 0 2rem}}@media (min-width:59rem){.site-happy-text-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;font-size:1.2rem}}@media (min-width:61rem){.site-happy-text-wrapper{font-size:1.3rem}}.site-happy-text{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;text-align:center}@media (min-width:42rem){.site-happy-text{text-align:left}}.site-happy-text-headline{display:block}.site-happy-text-headline,.wf-active .site-happy-text-headline{font-size:26.599px;font-size:1.9rem;font-weight:700}@media (min-width:25rem){.site-happy-text-headline{font-size:2.3rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:2.5rem}}@media (min-width:59rem){.site-happy-text-headline{font-size:2.9rem}.wf-active .site-happy-text-headline{font-size:3.1rem}}@media (min-width:61rem){.site-happy-text-headline{font-size:2.92rem;line-height:1.7}.wf-active .site-happy-text-headline{line-height:1.5;font-size:3.2rem}}.site-happy-text-tagline{display:inline}@media (min-width:42rem){.site-happy-text-tagline{display:block}}.navigation-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;padding:28px 0 0;padding:2rem 0 0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}@media (min-width:59rem){.navigation-wrapper{max-width:23rem;padding:0 0 0 2rem}}.navigation{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-width:100%;width:100%}@media (min-width:59rem){.navigation{-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-width:0}}.navigation-item{-webkit-box-flex:1;-ms-flex:1 1 33%;flex:1 1 33%;min-width:33%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;cursor:pointer;font-size:11.9px;font-size:.85rem;font-weight:200;-webkit-transition:background-color .25s;transition:background-color .25s}@media (min-width:25rem){.navigation-item{font-size:.9rem}}@media (min-width:45rem){.navigation-item{min-width:0;-webkit-box-flex:1;-ms-flex:1;flex:1}}@media (min-width:59rem){.navigation-item{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:33%}}.navigation-item:first-child{background:#e2e2e2}.navigation-item:first-child:hover{background:#ddd}.navigation-item:nth-child(2){background:#e8e8e8}.navigation-item:nth-child(2):hover{background:#e3e3e3}.navigation-item:nth-child(3){background:#efefef}.navigation-item:nth-child(3):hover{background:#eaeaea}.navigation-item:nth-child(4){background:#ddd}.navigation-item:nth-child(4):hover{background:#d8d8d8}.navigation-item:nth-child(5){background:#e3e3e3}.navigation-item:nth-child(5):hover{background:#dedede}.navigation-item:nth-child(6){background:#eaeaea}.navigation-item:nth-child(6):hover{background:#e4e4e4}.navigation-link{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:14px;padding:1rem;text-decoration:none;font-size:12.6px;font-size:.9rem;color:#000;-webkit-transition:color .25s;transition:color .25s}@media (min-width:25rem){.navigation-link{padding:1.4rem}}.navigation-link:after{content:"";position:absolute;top:100%;left:0;bottom:0;right:0;height:0;width:100%;background:#fff;opacity:.1;cursor:pointer;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}.navigation-link:hover:after{top:50%;height:50%}.navigation-item-text{-webkit-box-flex:1;-ms-flex:1;flex:1}.posts{padding:28px 14px;padding:2rem 1rem}@media (min-width:470px){.posts{padding:2rem}}.post-wrapper{padding-bottom:28px;padding-bottom:2rem}.post-wrapper:last-child{padding-bottom:0}.post{padding:28px 14px;padding:2rem 1rem;margin:28px 0;margin:2rem 0;background:#fff;max-width:840px;max-width:60rem;overflow:hidden;position:relative}@media (min-width:470px){.post{padding:2rem}}.post:before{background:linear-gradient(180deg,hsla(0,0%,100%,0) 0,#fff 1500px);-webkit-animation:fadein 1s ease-in;animation:fadein 1s ease-in}.post:after,.post:before{content:" ";position:absolute;top:0;left:50%;bottom:0;width:100vw;-webkit-transform:translateX(-50%);transform:translateX(-50%);z-index:-1}.post:after{background:linear-gradient(0deg,#ececec 0,hsla(0,0%,100%,0) 1000px)}.posts .post{margin:0 auto}.posts .post:after,.posts .post:before{content:none}.posts .post:before{-webkit-animation:none;animation:none}.post>:first-child{margin-top:0}@media (min-width:62rem){.post-page-post-wrapper{margin-left:2rem;margin-right:2rem}}.post-content{font-size:15.4px;font-size:1.1rem;line-height:1.55}.post-content>*{margin:21px 0 0;margin:1.5rem 0 0}.post-content :not(figure)>a{color:#4580a7;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(104,130,197,.4)),to(rgba(104,130,197,.4)));background-image:linear-gradient(rgba(104,130,197,.4),rgba(104,130,197,.4));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-content :not(figure)>a:hover{color:#6882c5}.post-content blockquote{position:relative;font-size:18.2px;font-size:1.3rem;font-size:21.98px;font-size:1.57rem;font-style:italic;font-weight:100;padding-left:28px;padding-left:2rem;line-height:1.48;margin-top:28px;margin-top:2rem}.post-content blockquote:before{content:"\201C";position:absolute;top:-21px;top:-1.5rem;left:-7px;left:-.5rem;height:42px;height:3rem;width:25px;color:#f5f5f5;font-size:84px;font-size:6rem;font-style:normal;line-height:1}.post-content blockquote footer{margin-top:14px;margin-top:1rem;font-size:12.6px;font-size:.9rem;text-align:right}.post-content blockquote cite{display:inline-block;margin-left:7px;margin-left:.5rem}.post-content figure{text-align:center}.post-content figcaption{color:#666;font-size:12.6px;font-size:.9rem;font-style:italic}.post-content img{display:block;max-width:100%;height:auto;margin:0 auto;min-height:50px;min-width:150px;position:relative;color:#b6b6b6;font-size:12.6px;font-size:.9rem;text-align:center}.post-content img:before{content:"Image failed to load :/";display:block;font-size:13.299px;font-size:.95rem}.post-content code,.post-content pre{font-family:Consolas,Monaco,Andale Mono,monospace;text-shadow:0 1px #fff;white-space:pre;word-spacing:normal;word-break:normal;-webkit-font-feature-settings:none;font-feature-settings:none;-webkit-font-variant-ligatures:none;font-variant-ligatures:none;word-wrap:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.post-content :not(h3):not(h4):not(h5):not(h6)>code,.post-content pre{font-size:11.9px;font-size:.85rem}.post-content :not(pre)>code,.post-content pre{background:#f5f5f5}.post-content pre{padding:14px;padding:1rem;overflow:auto;color:#000}.post-content :not(pre)>code{display:inline-block;padding:0 3.815px;padding:0 .2725rem;white-space:normal}.post-content a code{background:transparent none repeat 0 0/auto auto padding-box border-box scroll;background:initial;font-size:13.719px;font-size:.98rem;padding:0;padding:initial}.post-content p:first-child{margin-top:0}.post-content h2,.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3{font-size:22.75px;font-size:1.625rem}.post-content h4{font-size:19.446px;font-size:1.389rem}.post-content h5{font-size:16.142px;font-size:1.153rem}.post-content h6{font-size:13.034px;font-size:.931rem}.post-content .post-header-anchor{position:absolute;left:-14px;left:-1rem;top:20px;width:14px;width:1rem;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:0 0;text-align:center;line-height:1;text-shadow:none;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}.post-content .post-header-anchor:focus{outline:0}.post-content .post-header-anchor:hover svg{opacity:1}.post-content .post-header-anchor:after{content:" copied";position:absolute;bottom:-14px;left:0;right:0;font-size:.6em;color:gray;opacity:0;visibility:none;-webkit-transition:opacity 2s;transition:opacity 2s}.post-content .post-header-anchor svg{opacity:.2}.post-content h4 .post-header-anchor{top:18px}.post-content h5 .post-header-anchor{top:16px}.post-content h6 .post-header-anchor{top:14px}.post-content .post-header-anchor--copied:after{opacity:1}.post-content p:last-of-type{margin-bottom:0}.post-content h3,.post-content h4,.post-content h5,.post-content h6{position:relative}.post-content h3+p,.post-content h4+p,.post-content h5+p,.post-content h6+p{margin-top:7px;margin-top:.5rem}.post-content p+h3,.post-content p+h4,.post-content p+h5,.post-content p+h6{margin-top:28px;margin-top:2rem}.post-content ol,.post-content ul{padding-left:1.25em;list-style:disc outside none;list-style:initial}.post-content ol{list-style-type:decimal}.post-content li{margin-bottom:7px;margin-bottom:.5rem}.post-summary .post-content,.post-summary .post-content>*{display:inline}.post-content table{border-spacing:0;border-collapse:collapse}.post-content td,.post-content th{padding:0;padding:6px 13px;border:1px solid #dfe2e5}.post-content th{font-weight:600;text-align:left}.post-title-wrapper{margin:0}.post-title{line-height:1.4;font-size:19.599px;font-size:1.4rem;font-weight:700}.wf-active .post-title{font-size:21px;font-size:1.5rem;line-height:1.2}@media (min-width:30rem){.post-title{line-height:1.6;font-size:1.85rem}.wf-active .post-title{line-height:1.5;font-size:2rem}}.post-title-label{display:inline-block;position:relative;bottom:.3em;padding:.2em .4em;margin-left:.3em;font-size:.5em;background:#e3e3e3;color:#9e9e9e;border-radius:5%;font-weight:400;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in}.post-title:hover .post-title-label{opacity:.9}.post-title-label-parenthesis{display:none}.post-meta{font-size:12.6px;font-size:.9rem;margin:14px 0;margin:1rem 0;color:#a2a2a2}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.post-meta{color:#000;font-weight:300}}.post-blog-date{display:block;margin-top:7px;margin-top:.5rem}@media (min-width:30rem){.post-blog-date{display:inline;margin-top:0}.post-blog-date+.post-blog-title:before{display:inline-block;content:" \2014   ";margin:0 .25rem 0 .5rem}}.post-blog-link{font-weight:400;font-style:italic}.footer-link,.post-blog-link,.post-read-more-link,.post-title,.site-happy-text-tagline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link:hover,.post-blog-link:hover,.post-read-more-link:hover,.post-title:hover,.site-happy-text-tagline-link:hover{color:#6882c5;background:-webkit-gradient(linear,left top,right top,from(#5c7b8f),to(#6882c5));background:linear-gradient(90deg,#5c7b8f,#6882c5);background-clip:border-box;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-box-decoration-break:clone;box-decoration-break:clone}.site-happy-text-headline-link{-webkit-transition:color .25s;transition:color .25s}.footer-link,.post-read-more-link,.post-title,.site-happy-text-headline-link:hover,.site-happy-text-tagline-link{color:#5c7b8f}.post-read-more-link{display:inline-block;font-weight:700;margin:0}.post-comments{margin:28px 28px 0;margin:2rem 2rem 0;padding:28px;padding:2rem;background:#fff}@media (min-width:62rem){.post-comments{margin-left:0;margin-right:0}}.post-comments a{color:#5c7b8f;padding-bottom:.7px;padding-bottom:.05rem;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(rgba(0,0,0,.2)));background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2));background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 10%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;-webkit-transition:color .25s;transition:color .25s}.post-comments a:hover{color:#6882c5}@media (min-width:62rem){.more-articles{padding-left:0;padding-right:0}}.footer{text-align:center;font-size:11.2px;font-size:.8rem;margin-bottom:28px;margin-bottom:2rem}.footer-text{margin:0}.footer-link{font-weight:700}.copyright{display:block;color:gray}@media (-webkit-min-device-pixel-ratio:2),(min-device-pixel-ratio:2),(min-resolution:192dpi){.copyright{font-weight:100}}.fix-bug-ignore{color:red}.posts{position:relative}.post-wrapper{-webkit-transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,-webkit-transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out;transition:padding .5s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out}.post{-webkit-transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,-webkit-transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out;transition:opacity .1s ease-in-out,transform .1s ease-in-out,-webkit-transform .1s ease-in-out}.posts--entering-post .post-wrapper:not(.post-wrapper--entering-from-posts) .post{opacity:.2;-webkit-transform:scale(.8);transform:scale(.8)}.posts--entering-post .post-wrapper--entering-from-posts{left:0;right:0}@media (min-width:62rem){.posts--entering-post .post-wrapper--entering-from-posts{margin-left:2rem;margin-right:2rem}}.post-skeleton{line-height:1.55;position:relative;opacity:0;max-height:0;overflow:hidden}.post-skeleton.post-skeleton--visible,.post-wrapper--entering-from-posts .post-skeleton{opacity:1;margin-top:28px;margin-top:2rem;max-height:none}.post-skeleton:after{content:" ";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;opacity:.2;-webkit-animation:1s skeleton infinite ease-in-out;animation:1s skeleton infinite ease-in-out}.post-skeleton-word{height:15.4px;height:1.1rem;background:#f7f7f7;width:46px;display:inline-block;margin:4px 6px 0 0}.post-skeleton-word:nth-child(2n){width:36px}.post-skeleton-word:nth-child(3n){width:76px}.post-skeleton+.post-skeleton .post-skeleton-word:nth-child(3n){width:71px}.post-skeleton-word:nth-child(5n){width:96px}.post-skeleton-word:nth-child(6n){width:63px}.post-skeleton-word:nth-child(7n){width:26px}@-webkit-keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes skeleton{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}98%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}99%{-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}</style><style data-vue-ssr-id="1629eadd:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style>
    <script src="https://unpkg.com/scrollto-with-animation/dist/scrollto-with-animation.min.js"></script>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#869bad;opacity:0"></div><div id="__layout"><div class="wrapper"><main class="content"><header class="header"><h1 class="site-title"><a href="/" class="site-link nuxt-link-active">Adam Lynch</a></h1><div class="site-happy-text-wrapper"><p class="site-happy-text"><span class="site-happy-text-headline">
                I'm <a href="/" class="site-happy-text-headline-link nuxt-link-active">Adam Lynch</a>.
            </span><span class="site-happy-text-tagline">
                I like to
                <a href="https://github.com/adam-lynch" class="site-happy-text-tagline-link">code</a>,
                <a href="/" class="site-happy-text-tagline-link nuxt-link-active">write</a>, and dabble in design.
            </span><span class="site-happy-text-tagline">
                I lead <a href="https://www.teamwork.com" class="site-happy-text-tagline-link">Teamwork.com</a>'s next product.
            </span></div><nav class="navigation-wrapper" role="navigation"><ul class="navigation"><li class="navigation-item writing-navigation-item"><a href="/" class="navigation-link nuxt-link-active"><span class="navigation-item-text">Writing</span></a><li class="navigation-item code-navigation-item"><a href="https://github.com/adam-lynch" class="navigation-link" rel="noopener"><span class="navigation-item-text">Code</span></a><li class="navigation-item edit-navigation-item"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="navigation-link" rel="noopener"><span class="navigation-item-text">Edit page</span></a><li class="navigation-item twitter-navigation-item"><a href="https://twitter.com/lynchy010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">Twitter</span></a><li class="navigation-item email-navigation-item"><a href="mailto:contact@adamlynch.com" class="navigation-link" rel="noopener"><span class="navigation-item-text">Email</span></a><li class="navigation-item linkedin-navigation-item"><a href="https://www.linkedin.com/in/adamlynch010/" class="navigation-link" rel="noopener"><span class="navigation-item-text">LinkedIn</span></a></ul></nav></header><div class="post-page-post-wrapper"><article class="post"><h2 class="post-title-wrapper"><a href="/random-open-api" class="post-title nuxt-link-exact-active nuxt-link-active">How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</a></h2><div class="post-meta"><time class="post-blog-date">February 2nd</time><div class="no-ssr-placeholder"></div></div><div class="post-content">
<p>In my day job, I'm building a product in which nothing is simple. There's a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.</p>
<p>Seriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That's what this project is about.</p>
<p>I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>
<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.</p>
<p>I decided to time myself while I was at it. It took 42 minutes but read on, it wasn't all smooth sailing.</p>
<h4><a href="#hello-world" class="post-header-anchor" id="hello-world" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Hello, world!</h4>
<p>I created a new directory with an <code>index.js</code> containing <code>console.log('Hello, world!)</code> and ran <code>node index</code> in the directory.</p>
<p>OK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there's... of course there's an API to get the list of APIs. Luckily, the <a href="https://api.publicapis.org/" rel="noopener">Public API for Public APIs</a> has a <code>/random</code> endpoint. At a glance it had enough information:</p>
<ul>
<li>title (string)</li>
<li>description (string)</li>
<li>category (string)</li>
<li>And some other stuff (more about that later).</li>
</ul>
<p>Looks good. Now, I need to hit the API. I don't necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran <code>npm init --yes && npm install axios</code> . Then I added the following code to <code>index.js</code>:</p>
<pre><code class="language-javascript">  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://api.publicapis.org/random'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Notice how little effort I'm putting into error handling. I'm on the clock.</p>
<p>Running <code>node index</code> resulted in:</p>
<pre><code class="language-javascripton">{ count: 1,
  entries:
    [ { API: 'Livecoin',
        Description: 'Cryptocurrency Exchange',
        Auth: '',
        HTTPS: true,
        Cors: 'unknown',
        Link: 'https://www.livecoin.net/api',
        Category: 'Cryptocurrency' } ] }
</code></pre>
<h3><a href="#writing-the-tweet" class="post-header-anchor" id="writing-the-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Writing the tweet</h3>
<p>Next, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> camelCase <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'camelcase'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">formatHashtag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^a-zA-Z0-9]/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://api.publicapis.org/random'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'No APIs found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Build tweet content</span>
  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> isDescriptionShort <span class="token operator">=</span> api<span class="token punctuation">.</span>Description<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tweet <span class="token operator">=</span> <span class="token template-string"><span class="token string">`📡 Random Open API 📡\n\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>API<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// .API is the name of the API</span>

  <span class="token comment">// If the description is too short, it's shown as a hashtag later instead</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>
    tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'openApi'</span><span class="token punctuation">,</span> <span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>
    tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  tweet <span class="token operator">+=</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">=></span> <span class="token template-string"><span class="token string">`#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tweet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>I didn't like how it looked when the description was short (e.g. <code>Discogs: Music</code>). In this case, I used it as a hashtag instead.</p>
<h3><a href="#tweet-tweet" class="post-header-anchor" id="tweet-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tweet, tweet!</h3>
<p>Next is actually sending a tweet. I did a quick google and ended up running <code>npm install twitter-lite</code> . I chose <a href="https://www.npmjs.com/package/twitter-lite" rel="noopener">twitter-lite</a> because:</p>
<ol>
<li>The documentation showed me what I needed to do at a glance.</li>
<li>It didn't seem too heavy or outdated.</li>
<li>It had <code>lite</code> in the name 🤷‍♂️.</li>
</ol>
<p>I needed the following Twitter credentials to post a tweet:</p>
<ul>
<li>Consumer key.</li>
<li>Consumer secret.</li>
<li>Access token key.</li>
<li>Access token secret.</li>
</ul>
<p>This is what took the longest in this project. I created the Twitter account, applied for access to <a href="https://developer.twitter.com/" rel="noopener">Twitter's APIs</a>, created an app, and got the credentials I needed. I'm not going into too much detail here, it's tedious.</p>
<p>I commented out the Axios call from before and threw in the following:</p>
<pre><code class="language-javascript"><span class="token comment">// ...</span>
<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'twitter-lite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>
  consumer_key<span class="token punctuation">:</span> <span class="token string">"notTheRealValue"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>
  consumer_secret<span class="token punctuation">:</span> <span class="token string">"notTheRealValueEither"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>
  access_token_key<span class="token punctuation">:</span> <span class="token string">"nopeNotReal"</span><span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>
  access_token_secret<span class="token punctuation">:</span> <span class="token string">"hmmNoStillNotReal"</span> <span class="token comment">// from your User (oauth_token_secret)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ....</span>

client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">'Hello, World!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Once I ran <code>node index</code> again, there was a <code>Hello, World!</code> tweet in my feed.</p>
<p>Next, I combined the API and Twitter code, then ran it again;</p>
<figure>
          <a href="/images/blog-content/random-open-api/tweet.png"><img src="/images/blog-content/random-open-api/tweet.png" alt=""></a>
          <figcaption><p>A screenshot of the first Tweet posted (Daum maps).</p>
</figcaption>
        </figure><p>Isn't it beautiful?</p>
<h3><a href="#now-where-to-host-this" class="post-header-anchor" id="now-where-to-host-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Now, where to host this?</h3>
<p>I thought serverless would be a good fit for hosting this. I'd heard the praise Zeit's <a href="https://zeit.co/now" rel="noopener">Now</a> had gotten so I thought I'd give it a go. It's a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more.</p>
<p>They have integrations with GitHub and more but I went with the slightly more manual approach. I ran <code>npm install -g now && now login</code> and added a <code>now.json</code> file;</p>
<pre><code class="language-javascripton">{
  "version": 2,
  "builds": [{ "src": "*.js", "use": "@now/node" }]
}
</code></pre>
<p>This tells Now that any JavaScript files should be built with their Node.js builder.</p>
<p>I had to tweak my <code>index.js</code> slightly. First to add their function boilerplate, and secondly to call <code>res.end</code> to output something, rather than logging it to the console;</p>
<pre><code class="language-javascript"><span class="token comment">// ...</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// Zeit boilerplate</span>
  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://api.publicapis.org/random'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    
    <span class="token comment">// Tweet, tweet!</span>
    client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> tweet <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>I then ran <code>now</code> which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there's probably a lot going behind the scenes to achieve what Zeit provides.</p>
<p>The result:</p>
<pre><code class="language-shell">> Deploying ~/Code/random-open-api under notmyreal@email.com
> Using project random-open-api
> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]
┌ index.js        Ready               [24s]
└── λ index.js (39.83KB) [bru1]
> Success! Deployment ready [28s]
</code></pre>
<p>Now gives you a new URL each time you deploy. I went to this URL in my browser and saw "Success!". Yes, it sent the tweet! That was easy.</p>
<h3><a href="#getting-secretive" class="post-header-anchor" id="getting-secretive" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Getting secretive</h3>
<p>I planned to open source the code and I didn't want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:</p>
<pre><code class="language-shell">now secret add CONSUMER_KEY "notTheRealValue"
now secret add CONSUMER_SECRET "notTheRealValueEither"
now secret add ACCESS_TOKEN_KEY "nopeNotReal"
now secret add ACCESS_TOKEN_SECRET "hmmNoStillNotReal"
</code></pre>
<p>Then I added the following <code>env</code> object to my <code>now.json</code> file.</p>
<pre><code class="language-javascripton">{
  "version": 2,
  "builds": [{ "src": "*.js", "use": "@now/node" }],
  "env": {
    "CONSUMER_KEY": "@consumer_key",
    "CONSUMER_SECRET": "@consumer_secret",
    "ACCESS_TOKEN_KEY": "@access_token_key",
    "ACCESS_TOKEN_SECRET": "@access_token_secret"
  }
}
</code></pre>
<p>This then allowed me to use <code>process.env.CONSUMER_KEY</code> in my function, for example;</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>
  consumer_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_KEY<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>
  consumer_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_SECRET<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>
  access_token_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_KEY<span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>
  access_token_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_SECRET <span class="token comment">// from your User (oauth_token_secret)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now would replace those references with the actual values when deploying. Not too complicated right?</p>
<p>I ran <code>now</code> again but this time it didn't work. I got a blank response in my browser. Well, what happened was I somehow managed to type <code>process.key</code> , not <code>process.env</code> . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, <code>now-env</code> , and more, before realizing my mistake.</p>
<h3><a href="#automation" class="post-header-anchor" id="automation" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automation</h3>
<p>I was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit.</p>
<p>Well, Zeit doesn't support running things on a schedule 😦</p>
<p>At least they don't in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn't want to start a project by going back in time.</p>
<p>There were workarounds suggested in GitHub issues like having a <code>setInterval</code> in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn't covered.</p>
<p>So I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...</p>
<p>I actually settled for a simple but uncomfortable solution. It turns out there's a completely free (and open source) service, <a href="https://cron-job.org/en/" rel="noopener">cron-job.org</a>, which will call your URL on a schedule.</p>
<figure>
          <a href="/images/blog-content/random-open-api/cron.png"><img src="/images/blog-content/random-open-api/cron.png" alt=""></a>
          <figcaption><p>The job configuration.</p>
</figcaption>
        </figure><p>All I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn't even have to use the horrible <a href="http://www.nncron.ru/help/EN/working/cron-format.htm" rel="noopener">cron format</a>. It was painless.</p>
<h3><a href="#deployment-aliases" class="post-header-anchor" id="deployment-aliases" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Deployment aliases</h3>
<p>I realized that if I ever deploy an update, I'll have to log into <a href="http://cron-job.org" rel="noopener">cron-job.org</a> and update the URL. Then I discovered Now's aliases. Individual deployments can be assigned deployments;</p>
<figure>
          <a href="/images/blog-content/random-open-api/alias.png"><img src="/images/blog-content/random-open-api/alias.png" alt=""></a>
          <figcaption><p>The create alias modal.</p>
</figcaption>
        </figure><p>You can choose a <a href="http://now.sh" rel="noopener">now.sh</a> subdomain or give your own domain.</p>
<p>So each time I update the code and deploy, I'll re-assign the alias to the new deployment. There's probably a better way around this but I didn't want to spend too long worrying about it. The code won't need to be updated much and if it ever does, I'd assume the Now dashboard is where it's managed.</p>
<h3><a href="#the-end" class="post-header-anchor" id="the-end" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The end</h3>
<p>So that's it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye.</p>
<p>Goodbye!</p>
<p>Hey, stop, why are you still reading?</p>
<p>Ugh, fine...</p>
<h3><a href="#palm-have-you-met-face" class="post-header-anchor" id="palm-have-you-met-face" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Palm, have you met face?</h3>
<p>While writing this, I noticed that the API returns more than strictly "open" APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.</p>
<p>Looking through results, even the ones which require authentication are still free and publicly available. It doesn't bother me then if they're not 100% "open", the data is still there to use.</p>
<p>Oh wait, no... they're not all free either. The <a href="https://semantria.readme.io/docs" rel="noopener">Semantria API</a> is one entry I just found for example; a "paid Saas text analytics service".</p>
<p><img src="/images/blog-content/random-open-api/godfather.gif" alt='"Just when I thought I was out, they pull me back in!" from the Godfather'></p>
<p>Looking at the Public API for Public APIs again, they also return an <code>auth</code> property for each API. I've seen results with <code>"auth": "apiKey"</code>, <code>"auth": "OAuth"</code>, and <code>"auth": ""</code>. I need to tweet about the last case.</p>
<p>The <code>/random</code> endpoint doesn't support filtering, so I'd have to keep calling it until I get one that's open. Hmm.</p>
<p>The <code>/entries</code> endpoint does support an <code>auth</code> filter parameter but it returns an array of APIs. This looks like my best bet. It doesn't support pagination so it must either return all or at least as many as it can. Here's the new API code:</p>
<pre><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://api.publicapis.org/entries?auth=null'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'No APIs found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Build tweet content from random result</span>
  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>There's no reason why <code>/random</code> couldn't also accept filter parameters. After I publish this, I'll go make a pull-request.</p>
<h3><a href="#conclusion" class="post-header-anchor" id="conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>
<p>It was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don't recommend working like this. It was almost a disaster.</p>
<p>Follow <a href="twitter.com/randomOpenAPI">@randomOpenAPI</a> on Twitter. Check out the source code at <a href="github.com/adam-lynch/random-open-api">github.com/adam-lynch/random-open-api</a>.</p>
<p>What could you make? I could imagine someone finding value in an account that tweets about <em>two</em> random APIs. The mashups might be handy for coming up with project ideas.</p>
</div></article><aside><div class="post-comments"><p>Feedback is more than welcome via <a href="https://twitter.com/lynchy010">@lynchy010</a> or <a href="mailto:contact@adamlynch.com">contact@adamlynch.com</a></div><div class="no-ssr-placeholder"></div></aside></div><footer class="footer"><p class="footer-text"><a href="https://github.com/adam-lynch/adam-lynch.github.io" class="footer-link">This site is open source</a><span class="copyright">© 2019 Adam Lynch</span></footer></main></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{article:{id:"random-open-api",slug:"random-open-api",highlightedLanguages:["javascript","javascripton","shell"],source:"---\ndate: 2019-02-02\ntags:\n  - api\n  - open API\n  - public API\n  - twitter\n  - bot\n  - zeit\n  - now\n  - serverless\n  - faas\n  - node.js\n  - cron\n  - development\n---\n\n## How I made the @randomOpenAPI Twitter bot in 42 minutes-ish\n\nIn my day job, I'm building a product in which nothing is simple. There's a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.\n\nSeriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That's what this project is about.\n\n::: summary\n\nI love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.\n\nThe natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' [@randomMDN](https://twitter.com/randommdn)? It tweets a random article from [MDN](https://developer.mozilla.org/en-US/) multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.\n\n:::\n\nI decided to time myself while I was at it. It took 42 minutes but read on, it wasn't all smooth sailing.\n\n#### Hello, world!\n\nI created a new directory with an `index.js` containing `console.log('Hello, world!)` and ran `node index` in the directory.\n\nOK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there's... of course there's an API to get the list of APIs. Luckily, the [Public API for Public APIs](https://api.publicapis.org/) has a `/random` endpoint. At a glance it had enough information:\n\n- title (string)\n- description (string)\n- category (string)\n- And some other stuff (more about that later).\n\nLooks good. Now, I need to hit the API. I don't necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran `npm init --yes && npm install axios` . Then I added the following code to `index.js`:\n\n```javascript\n  const axios = require('axios');\n  \n  axios.get('https://api.publicapis.org/random')\n  .then((response) => {\n    console.log(response.data);\n  })\n```\n\nNotice how little effort I'm putting into error handling. I'm on the clock.\n\nRunning `node index` resulted in:\n\n```javascripton\n{ count: 1,\n  entries:\n    [ { API: 'Livecoin',\n        Description: 'Cryptocurrency Exchange',\n        Auth: '',\n        HTTPS: true,\n        Cors: 'unknown',\n        Link: 'https://www.livecoin.net/api',\n        Category: 'Cryptocurrency' } ] }\n```\n\n### Writing the tweet\n\nNext, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:\n\n```javascript\nconst axios = require('axios');\nconst camelCase = require('camelcase');\n\nconst formatHashtag = (text) => {\n  return camelCase(text.replace(/[^a-zA-Z0-9]/g, ''));\n};\n\naxios.get('https://api.publicapis.org/random')\n.then((response) => {\n  if(!response.data.entries.length){\n    throw new Error('No APIs found');\n  }\n\n  // Build tweet content\n  const api = response.data.entries[0];\n  const isDescriptionShort = api.Description.split(' ').length <= 2;\n  let tweet = `📡 Random Open API 📡\\n\\n${api.API}`; // .API is the name of the API\n\n  // If the description is too short, it's shown as a hashtag later instead\n  if(!isDescriptionShort){\n    tweet += `: ${api.Description} `;\n  }\n\n  tweet += `${api.Link} `;\n\n  const tags = ['openApi', 'api', formatHashtag(api.Category)];\n  if(isDescriptionShort){\n    tags.push(formatHashtag(api.Description));\n  }\n\n  tweet += tags.map(tag => `#${tag}`).join(' ');\n  console.log(tweet);\n})\n```\n\nI didn't like how it looked when the description was short (e.g. `Discogs: Music`). In this case, I used it as a hashtag instead.\n\n### Tweet, tweet!\n\nNext is actually sending a tweet. I did a quick google and ended up running `npm install twitter-lite` . I chose [twitter-lite](https://www.npmjs.com/package/twitter-lite) because:\n\n1. The documentation showed me what I needed to do at a glance.\n2. It didn't seem too heavy or outdated.\n3. It had `lite` in the name 🤷‍♂️.\n\nI needed the following Twitter credentials to post a tweet: \n\n- Consumer key.\n- Consumer secret.\n- Access token key.\n- Access token secret.\n\nThis is what took the longest in this project. I created the Twitter account, applied for access to [Twitter's APIs](https://developer.twitter.com/), created an app, and got the credentials I needed. I'm not going into too much detail here, it's tedious.\n\nI commented out the Axios call from before and threw in the following:\n\n```javascript\n// ...\nconst Twitter = require('twitter-lite');\n\nconst client = new Twitter({\n  subdomain: \"api\",\n  consumer_key: \"notTheRealValue\", // from Twitter.\n  consumer_secret: \"notTheRealValueEither\", // from Twitter.\n  access_token_key: \"nopeNotReal\", // from your User (oauth_token)\n  access_token_secret: \"hmmNoStillNotReal\" // from your User (oauth_token_secret)\n});\n\n// ....\n\nclient.post(\"statuses/update\", { status: 'Hello, World!' })\n.then(() => console.log('Success!'))\n```\n\nOnce I ran `node index` again, there was a `Hello, World!` tweet in my feed.\n\nNext, I combined the API and Twitter code, then ran it again;\n\n:::figure random-open-api/tweet.png A screenshot of the first Tweet posted (Daum maps).\n:::\n\nIsn't it beautiful?\n\n### Now, where to host this?\n\nI thought serverless would be a good fit for hosting this. I'd heard the praise Zeit's [Now](https://zeit.co/now) had gotten so I thought I'd give it a go. It's a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more. \n\nThey have integrations with GitHub and more but I went with the slightly more manual approach. I ran `npm install -g now && now login` and added a `now.json` file;\n\n```javascripton\n{\n  \"version\": 2,\n  \"builds\": [{ \"src\": \"*.js\", \"use\": \"@now/node\" }]\n}\n```\n\nThis tells Now that any JavaScript files should be built with their Node.js builder. \n\nI had to tweak my `index.js` slightly. First to add their function boilerplate, and secondly to call `res.end` to output something, rather than logging it to the console;\n\n```javascript\n// ...\n\nmodule.exports = (req, res) => { // Zeit boilerplate\n  axios.get('https://api.publicapis.org/random')\n  .then((response) => {\n    // ...\n    \n    // Tweet, tweet!\n    client.post(\"statuses/update\", { status: tweet })\n    .then(() => res.end('Success!'))\n    .catch((err) => {\n      res.end(`Error: ${err.message}\\n\\n${err.stack}`);\n    });\n  })\n  .catch((error) => {\n    res.end(`Error: ${error.message}\\n\\n${error.stack}`);\n  });\n};\n```\n\nI then ran `now` which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there's probably a lot going behind the scenes to achieve what Zeit provides. \n\nThe result:\n\n```shell\n> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n┌ index.js        Ready               [24s]\n└── λ index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n```\n\nNow gives you a new URL each time you deploy. I went to this URL in my browser and saw \"Success!\". Yes, it sent the tweet! That was easy.\n\n### Getting secretive\n\nI planned to open source the code and I didn't want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:\n\n```shell\nnow secret add CONSUMER_KEY \"notTheRealValue\"\nnow secret add CONSUMER_SECRET \"notTheRealValueEither\"\nnow secret add ACCESS_TOKEN_KEY \"nopeNotReal\"\nnow secret add ACCESS_TOKEN_SECRET \"hmmNoStillNotReal\"\n```\n\nThen I added the following `env` object to my `now.json` file. \n\n```javascripton\n{\n  \"version\": 2,\n  \"builds\": [{ \"src\": \"*.js\", \"use\": \"@now/node\" }],\n  \"env\": {\n    \"CONSUMER_KEY\": \"@consumer_key\",\n    \"CONSUMER_SECRET\": \"@consumer_secret\",\n    \"ACCESS_TOKEN_KEY\": \"@access_token_key\",\n    \"ACCESS_TOKEN_SECRET\": \"@access_token_secret\"\n  }\n}\n```\n\nThis then allowed me to use `process.env.CONSUMER_KEY` in my function, for example;\n\n```javascript\nconst client = new Twitter({\n  subdomain: \"api\",\n  consumer_key: process.env.CONSUMER_KEY, // from Twitter.\n  consumer_secret: process.env.CONSUMER_SECRET, // from Twitter.\n  access_token_key: process.env.ACCESS_TOKEN_KEY, // from your User (oauth_token)\n  access_token_secret: process.env.ACCESS_TOKEN_SECRET // from your User (oauth_token_secret)\n});\n```\n\nNow would replace those references with the actual values when deploying. Not too complicated right?\n\nI ran `now` again but this time it didn't work. I got a blank response in my browser. Well, what happened was I somehow managed to type `process.key` , not `process.env` . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, `now-env` , and more, before realizing my mistake.\n\n### Automation\n\nI was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit. \n\nWell, Zeit doesn't support running things on a schedule :(\n\nAt least they don't in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn't want to start a project by going back in time. \n\nThere were workarounds suggested in GitHub issues like having a `setInterval` in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn't covered.\n\nSo I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...\n\nI actually settled for a simple but uncomfortable solution. It turns out there's a completely free (and open source) service, [cron-job.org](https://cron-job.org/en/), which will call your URL on a schedule.\n\n:::figure random-open-api/cron.png The job configuration.\n:::\n\nAll I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn't even have to use the horrible [cron format](http://www.nncron.ru/help/EN/working/cron-format.htm). It was painless.\n\n### Deployment aliases\n\nI realized that if I ever deploy an update, I'll have to log into [cron-job.org](http://cron-job.org) and update the URL. Then I discovered Now's aliases. Individual deployments can be assigned deployments;\n\n:::figure random-open-api/alias.png The create alias modal.\n:::\n\nYou can choose a [now.sh](http://now.sh) subdomain or give your own domain.\n\nSo each time I update the code and deploy, I'll re-assign the alias to the new deployment. There's probably a better way around this but I didn't want to spend too long worrying about it. The code won't need to be updated much and if it ever does, I'd assume the Now dashboard is where it's managed.\n\n### The end\n\nSo that's it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye. \n\nGoodbye!\n\nHey, stop, why are you still reading?\n\nUgh, fine...\n\n### Palm, have you met face?\n\nWhile writing this, I noticed that the API returns more than strictly \"open\" APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.\n\nLooking through results, even the ones which require authentication are still free and publicly available. It doesn't bother me then if they're not 100% \"open\", the data is still there to use.\n\nOh wait, no... they're not all free either. The [Semantria API](https://semantria.readme.io/docs) is one entry I just found for example; a \"paid Saas text analytics service\".\n\n![\"Just when I thought I was out, they pull me back in!\" from the Godfather](/images/blog-content/random-open-api/godfather.gif)\n\nLooking at the Public API for Public APIs again, they also return an `auth` property for each API. I've seen results with `\"auth\": \"apiKey\"`, `\"auth\": \"OAuth\"`, and `\"auth\": \"\"`. I need to tweet about the last case.\n\nThe `/random` endpoint doesn't support filtering, so I'd have to keep calling it until I get one that's open. Hmm.\n\nThe `/entries` endpoint does support an `auth` filter parameter but it returns an array of APIs. This looks like my best bet. It doesn't support pagination so it must either return all or at least as many as it can. Here's the new API code:\n\n```javascript\naxios.get('https://api.publicapis.org/entries?auth=null')\n.then((response) => {\n  if(!response.data.entries.length){\n    throw new Error('No APIs found');\n  }\n\n  // Build tweet content from random result\n  const api = response.data.entries[Math.floor(Math.random() * response.data.entries.length)];\n```\n\nThere's no reason why `/random` couldn't also accept filter parameters. After I publish this, I'll go make a pull-request.\n\n### Conclusion\n\nIt was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don't recommend working like this. It was almost a disaster.\n\nFollow [@randomOpenAPI](twitter.com/randomOpenAPI) on Twitter. Check out the source code at [github.com/adam-lynch/random-open-api](github.com/adam-lynch/random-open-api).\n\nWhat could you make? I could imagine someone finding value in an account that tweets about *two* random APIs. The mashups might be handy for coming up with project ideas.\n",unfilteredRenderedBody:'<h2><a id="how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" class="post-header-anchor" href="#how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</h2>\n<p>In my day job, I\'m building a product in which nothing is simple. There\'s a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.</p>\n<p>Seriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That\'s what this project is about.</p>\n<article-summary><p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n</article-summary><p>I decided to time myself while I was at it. It took 42 minutes but read on, it wasn\'t all smooth sailing.</p>\n<h4><a id="hello-world" class="post-header-anchor" href="#hello-world" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Hello, world!</h4>\n<p>I created a new directory with an <code>index.js</code> containing <code>console.log(\'Hello, world!)</code> and ran <code>node index</code> in the directory.</p>\n<p>OK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there\'s... of course there\'s an API to get the list of APIs. Luckily, the <a href="https://api.publicapis.org/" rel="noopener">Public API for Public APIs</a> has a <code>/random</code> endpoint. At a glance it had enough information:</p>\n<ul>\n<li>title (string)</li>\n<li>description (string)</li>\n<li>category (string)</li>\n<li>And some other stuff (more about that later).</li>\n</ul>\n<p>Looks good. Now, I need to hit the API. I don\'t necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran <code>npm init --yes &amp;&amp; npm install axios</code> . Then I added the following code to <code>index.js</code>:</p>\n<pre><code class="language-javascript">  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Notice how little effort I\'m putting into error handling. I\'m on the clock.</p>\n<p>Running <code>node index</code> resulted in:</p>\n<pre><code class="language-javascripton">{ count: 1,\n  entries:\n    [ { API: \'Livecoin\',\n        Description: \'Cryptocurrency Exchange\',\n        Auth: \'\',\n        HTTPS: true,\n        Cors: \'unknown\',\n        Link: \'https://www.livecoin.net/api\',\n        Category: \'Cryptocurrency\' } ] }\n</code></pre>\n<h3><a id="writing-the-tweet" class="post-header-anchor" href="#writing-the-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Writing the tweet</h3>\n<p>Next, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> camelCase <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'camelcase\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">formatHashtag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^a-zA-Z0-9]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\naxios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> isDescriptionShort <span class="token operator">=</span> api<span class="token punctuation">.</span>Description<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> tweet <span class="token operator">=</span> <span class="token template-string"><span class="token string">`📡 Random Open API 📡\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>API<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// .API is the name of the API</span>\n\n  <span class="token comment">// If the description is too short, it\'s shown as a hashtag later instead</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'openApi\'</span><span class="token punctuation">,</span> <span class="token string">\'api\'</span><span class="token punctuation">,</span> <span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">=></span> <span class="token template-string"><span class="token string">`#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tweet<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>I didn\'t like how it looked when the description was short (e.g. <code>Discogs: Music</code>). In this case, I used it as a hashtag instead.</p>\n<h3><a id="tweet-tweet" class="post-header-anchor" href="#tweet-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tweet, tweet!</h3>\n<p>Next is actually sending a tweet. I did a quick google and ended up running <code>npm install twitter-lite</code> . I chose <a href="https://www.npmjs.com/package/twitter-lite" rel="noopener">twitter-lite</a> because:</p>\n<ol>\n<li>The documentation showed me what I needed to do at a glance.</li>\n<li>It didn\'t seem too heavy or outdated.</li>\n<li>It had <code>lite</code> in the name 🤷‍♂️.</li>\n</ol>\n<p>I needed the following Twitter credentials to post a tweet:</p>\n<ul>\n<li>Consumer key.</li>\n<li>Consumer secret.</li>\n<li>Access token key.</li>\n<li>Access token secret.</li>\n</ul>\n<p>This is what took the longest in this project. I created the Twitter account, applied for access to <a href="https://developer.twitter.com/" rel="noopener">Twitter\'s APIs</a>, created an app, and got the credentials I needed. I\'m not going into too much detail here, it\'s tedious.</p>\n<p>I commented out the Axios call from before and threw in the following:</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'twitter-lite\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> <span class="token string">"notTheRealValue"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> <span class="token string">"notTheRealValueEither"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> <span class="token string">"nopeNotReal"</span><span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> <span class="token string">"hmmNoStillNotReal"</span> <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ....</span>\n\nclient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">\'Hello, World!\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Once I ran <code>node index</code> again, there was a <code>Hello, World!</code> tweet in my feed.</p>\n<p>Next, I combined the API and Twitter code, then ran it again;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/tweet.png"><img src="/images/blog-content/random-open-api/tweet.png" alt=""/></a>\n          <figcaption><p>A screenshot of the first Tweet posted (Daum maps).</p>\n</figcaption>\n        </figure><p>Isn\'t it beautiful?</p>\n<h3><a id="now-where-to-host-this" class="post-header-anchor" href="#now-where-to-host-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Now, where to host this?</h3>\n<p>I thought serverless would be a good fit for hosting this. I\'d heard the praise Zeit\'s <a href="https://zeit.co/now" rel="noopener">Now</a> had gotten so I thought I\'d give it a go. It\'s a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more.</p>\n<p>They have integrations with GitHub and more but I went with the slightly more manual approach. I ran <code>npm install -g now &amp;&amp; now login</code> and added a <code>now.json</code> file;</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }]\n}\n</code></pre>\n<p>This tells Now that any JavaScript files should be built with their Node.js builder.</p>\n<p>I had to tweak my <code>index.js</code> slightly. First to add their function boilerplate, and secondly to call <code>res.end</code> to output something, rather than logging it to the console;</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// Zeit boilerplate</span>\n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    \n    <span class="token comment">// Tweet, tweet!</span>\n    client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> tweet <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>I then ran <code>now</code> which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there\'s probably a lot going behind the scenes to achieve what Zeit provides.</p>\n<p>The result:</p>\n<pre><code class="language-shell">> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n┌ index.js        Ready               [24s]\n└── λ index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n</code></pre>\n<p>Now gives you a new URL each time you deploy. I went to this URL in my browser and saw &quot;Success!&quot;. Yes, it sent the tweet! That was easy.</p>\n<h3><a id="getting-secretive" class="post-header-anchor" href="#getting-secretive" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Getting secretive</h3>\n<p>I planned to open source the code and I didn\'t want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:</p>\n<pre><code class="language-shell">now secret add CONSUMER_KEY "notTheRealValue"\nnow secret add CONSUMER_SECRET "notTheRealValueEither"\nnow secret add ACCESS_TOKEN_KEY "nopeNotReal"\nnow secret add ACCESS_TOKEN_SECRET "hmmNoStillNotReal"\n</code></pre>\n<p>Then I added the following <code>env</code> object to my <code>now.json</code> file.</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }],\n  "env": {\n    "CONSUMER_KEY": "@consumer_key",\n    "CONSUMER_SECRET": "@consumer_secret",\n    "ACCESS_TOKEN_KEY": "@access_token_key",\n    "ACCESS_TOKEN_SECRET": "@access_token_secret"\n  }\n}\n</code></pre>\n<p>This then allowed me to use <code>process.env.CONSUMER_KEY</code> in my function, for example;</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_KEY<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_SECRET<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_KEY<span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_SECRET <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Now would replace those references with the actual values when deploying. Not too complicated right?</p>\n<p>I ran <code>now</code> again but this time it didn\'t work. I got a blank response in my browser. Well, what happened was I somehow managed to type <code>process.key</code> , not <code>process.env</code> . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, <code>now-env</code> , and more, before realizing my mistake.</p>\n<h3><a id="automation" class="post-header-anchor" href="#automation" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automation</h3>\n<p>I was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit.</p>\n<p>Well, Zeit doesn\'t support running things on a schedule 😦</p>\n<p>At least they don\'t in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn\'t want to start a project by going back in time.</p>\n<p>There were workarounds suggested in GitHub issues like having a <code>setInterval</code> in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn\'t covered.</p>\n<p>So I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...</p>\n<p>I actually settled for a simple but uncomfortable solution. It turns out there\'s a completely free (and open source) service, <a href="https://cron-job.org/en/" rel="noopener">cron-job.org</a>, which will call your URL on a schedule.</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/cron.png"><img src="/images/blog-content/random-open-api/cron.png" alt=""/></a>\n          <figcaption><p>The job configuration.</p>\n</figcaption>\n        </figure><p>All I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn\'t even have to use the horrible <a href="http://www.nncron.ru/help/EN/working/cron-format.htm" rel="noopener">cron format</a>. It was painless.</p>\n<h3><a id="deployment-aliases" class="post-header-anchor" href="#deployment-aliases" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Deployment aliases</h3>\n<p>I realized that if I ever deploy an update, I\'ll have to log into <a href="http://cron-job.org" rel="noopener">cron-job.org</a> and update the URL. Then I discovered Now\'s aliases. Individual deployments can be assigned deployments;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/alias.png"><img src="/images/blog-content/random-open-api/alias.png" alt=""/></a>\n          <figcaption><p>The create alias modal.</p>\n</figcaption>\n        </figure><p>You can choose a <a href="http://now.sh" rel="noopener">now.sh</a> subdomain or give your own domain.</p>\n<p>So each time I update the code and deploy, I\'ll re-assign the alias to the new deployment. There\'s probably a better way around this but I didn\'t want to spend too long worrying about it. The code won\'t need to be updated much and if it ever does, I\'d assume the Now dashboard is where it\'s managed.</p>\n<h3><a id="the-end" class="post-header-anchor" href="#the-end" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The end</h3>\n<p>So that\'s it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye.</p>\n<p>Goodbye!</p>\n<p>Hey, stop, why are you still reading?</p>\n<p>Ugh, fine...</p>\n<h3><a id="palm-have-you-met-face" class="post-header-anchor" href="#palm-have-you-met-face" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Palm, have you met face?</h3>\n<p>While writing this, I noticed that the API returns more than strictly &quot;open&quot; APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.</p>\n<p>Looking through results, even the ones which require authentication are still free and publicly available. It doesn\'t bother me then if they\'re not 100% &quot;open&quot;, the data is still there to use.</p>\n<p>Oh wait, no... they\'re not all free either. The <a href="https://semantria.readme.io/docs" rel="noopener">Semantria API</a> is one entry I just found for example; a &quot;paid Saas text analytics service&quot;.</p>\n<p><img src="/images/blog-content/random-open-api/godfather.gif" alt="&quot;Just when I thought I was out, they pull me back in!&quot; from the Godfather"></p>\n<p>Looking at the Public API for Public APIs again, they also return an <code>auth</code> property for each API. I\'ve seen results with <code>&quot;auth&quot;: &quot;apiKey&quot;</code>, <code>&quot;auth&quot;: &quot;OAuth&quot;</code>, and <code>&quot;auth&quot;: &quot;&quot;</code>. I need to tweet about the last case.</p>\n<p>The <code>/random</code> endpoint doesn\'t support filtering, so I\'d have to keep calling it until I get one that\'s open. Hmm.</p>\n<p>The <code>/entries</code> endpoint does support an <code>auth</code> filter parameter but it returns an array of APIs. This looks like my best bet. It doesn\'t support pagination so it must either return all or at least as many as it can. Here\'s the new API code:</p>\n<pre><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/entries?auth=null\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content from random result</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre>\n<p>There\'s no reason why <code>/random</code> couldn\'t also accept filter parameters. After I publish this, I\'ll go make a pull-request.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>It was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don\'t recommend working like this. It was almost a disaster.</p>\n<p>Follow <a href="twitter.com/randomOpenAPI">@randomOpenAPI</a> on Twitter. Check out the source code at <a href="github.com/adam-lynch/random-open-api">github.com/adam-lynch/random-open-api</a>.</p>\n<p>What could you make? I could imagine someone finding value in an account that tweets about <em>two</em> random APIs. The mashups might be handy for coming up with project ideas.</p>\n',attributes:{date:"2019-02-02T00:00:00.000Z",tags:[{id:"api",name:"api"},{id:"open-api",name:"open API"},{id:"public-api",name:"public API"},{id:"twitter",name:"twitter"},{id:"bot",name:"bot"},{id:"zeit",name:"zeit"},{id:"now",name:"now"},{id:"serverless",name:"serverless"},{id:"faas",name:"faas"},{id:"nodejs",name:"node.js"},{id:"cron",name:"cron"},{id:"development",name:"development"}],title:"How I made the @randomOpenAPI Twitter bot in 42 minutes-ish",updated_at:"2019-05-22T08:26:12.392Z",photo:"/images/blog-content/random-open-api/tweet.png"},title:"How I made the @randomOpenAPI Twitter bot in 42 minutes-ish",renderedSummary:'<p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n',rendered:'<h2><a id="how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" class="post-header-anchor" href="#how-i-made-the-randomopenapi-twitter-bot-in-42-minutes-ish" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>How I made the @randomOpenAPI Twitter bot in 42 minutes-ish</h2>\n<p>In my day job, I\'m building a product in which nothing is simple. There\'s a lot of flexibility, customization, and connected dots. Sometimes I daydream about working on an app which has one page, no settings, customization, or integrations, a single fixed viewport size to worry about, and so on. You know, an empty page.</p>\n<p>Seriously, I do love the challenge and I know it will make a lot of people happy. However, I do wonder how quickly I could make something simple from scratch. That\'s what this project is about.</p>\n<p>I love APIs. Especially open APIs. I wish there were way more of them. There\'s a lot of data out there we can\'t get our hands on. Imagine all of the unborn apps, studies, and infographics.</p>\n<p>The natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis\' <a href="https://twitter.com/randommdn" rel="noopener">@randomMDN</a>? It tweets a random article from <a href="https://developer.mozilla.org/en-US/" rel="noopener">MDN</a> multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it\'s an excuse for a small fun project.</p>\n<p>I decided to time myself while I was at it. It took 42 minutes but read on, it wasn\'t all smooth sailing.</p>\n<h4><a id="hello-world" class="post-header-anchor" href="#hello-world" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Hello, world!</h4>\n<p>I created a new directory with an <code>index.js</code> containing <code>console.log(\'Hello, world!)</code> and ran <code>node index</code> in the directory.</p>\n<p>OK, I managed not to mess that up. Then, I needed data about open APIs. Did you know people make curated lists of these APIs? Did you know there\'s... of course there\'s an API to get the list of APIs. Luckily, the <a href="https://api.publicapis.org/" rel="noopener">Public API for Public APIs</a> has a <code>/random</code> endpoint. At a glance it had enough information:</p>\n<ul>\n<li>title (string)</li>\n<li>description (string)</li>\n<li>category (string)</li>\n<li>And some other stuff (more about that later).</li>\n</ul>\n<p>Looks good. Now, I need to hit the API. I don\'t necessarily need to use a library but one library is better than two interfaces. I prefer a HTTP client library which supports both client and server-side usage. Axios is my latest library of choice for this. So I ran <code>npm init --yes &amp;&amp; npm install axios</code> . Then I added the following code to <code>index.js</code>:</p>\n<pre><code class="language-javascript">  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Notice how little effort I\'m putting into error handling. I\'m on the clock.</p>\n<p>Running <code>node index</code> resulted in:</p>\n<pre><code class="language-javascripton">{ count: 1,\n  entries:\n    [ { API: \'Livecoin\',\n        Description: \'Cryptocurrency Exchange\',\n        Auth: \'\',\n        HTTPS: true,\n        Cors: \'unknown\',\n        Link: \'https://www.livecoin.net/api\',\n        Category: \'Cryptocurrency\' } ] }\n</code></pre>\n<h3><a id="writing-the-tweet" class="post-header-anchor" href="#writing-the-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Writing the tweet</h3>\n<p>Next, I constructed a tweet from the data. Luckily, none of the text is very long and Twitter doubled their tweet character limit to 280. I fiddled around way too long here. This is what I ended up with:</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'axios\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> camelCase <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'camelcase\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">formatHashtag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^a-zA-Z0-9]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\naxios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> isDescriptionShort <span class="token operator">=</span> api<span class="token punctuation">.</span>Description<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> tweet <span class="token operator">=</span> <span class="token template-string"><span class="token string">`📡 Random Open API 📡\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>API<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// .API is the name of the API</span>\n\n  <span class="token comment">// If the description is too short, it\'s shown as a hashtag later instead</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>api<span class="token punctuation">.</span>Link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> `</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'openApi\'</span><span class="token punctuation">,</span> <span class="token string">\'api\'</span><span class="token punctuation">,</span> <span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span>isDescriptionShort<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatHashtag</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  tweet <span class="token operator">+=</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">=></span> <span class="token template-string"><span class="token string">`#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\' \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tweet<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<p>I didn\'t like how it looked when the description was short (e.g. <code>Discogs: Music</code>). In this case, I used it as a hashtag instead.</p>\n<h3><a id="tweet-tweet" class="post-header-anchor" href="#tweet-tweet" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Tweet, tweet!</h3>\n<p>Next is actually sending a tweet. I did a quick google and ended up running <code>npm install twitter-lite</code> . I chose <a href="https://www.npmjs.com/package/twitter-lite" rel="noopener">twitter-lite</a> because:</p>\n<ol>\n<li>The documentation showed me what I needed to do at a glance.</li>\n<li>It didn\'t seem too heavy or outdated.</li>\n<li>It had <code>lite</code> in the name 🤷‍♂️.</li>\n</ol>\n<p>I needed the following Twitter credentials to post a tweet:</p>\n<ul>\n<li>Consumer key.</li>\n<li>Consumer secret.</li>\n<li>Access token key.</li>\n<li>Access token secret.</li>\n</ul>\n<p>This is what took the longest in this project. I created the Twitter account, applied for access to <a href="https://developer.twitter.com/" rel="noopener">Twitter\'s APIs</a>, created an app, and got the credentials I needed. I\'m not going into too much detail here, it\'s tedious.</p>\n<p>I commented out the Axios call from before and threw in the following:</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'twitter-lite\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> <span class="token string">"notTheRealValue"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> <span class="token string">"notTheRealValueEither"</span><span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> <span class="token string">"nopeNotReal"</span><span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> <span class="token string">"hmmNoStillNotReal"</span> <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ....</span>\n\nclient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">\'Hello, World!\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre>\n<p>Once I ran <code>node index</code> again, there was a <code>Hello, World!</code> tweet in my feed.</p>\n<p>Next, I combined the API and Twitter code, then ran it again;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/tweet.png"><img src="/images/blog-content/random-open-api/tweet.png" alt=""/></a>\n          <figcaption><p>A screenshot of the first Tweet posted (Daum maps).</p>\n</figcaption>\n        </figure><p>Isn\'t it beautiful?</p>\n<h3><a id="now-where-to-host-this" class="post-header-anchor" href="#now-where-to-host-this" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Now, where to host this?</h3>\n<p>I thought serverless would be a good fit for hosting this. I\'d heard the praise Zeit\'s <a href="https://zeit.co/now" rel="noopener">Now</a> had gotten so I thought I\'d give it a go. It\'s a serverless hosting platform which supports static files, JavaScript, PHP, Python, Go, and more.</p>\n<p>They have integrations with GitHub and more but I went with the slightly more manual approach. I ran <code>npm install -g now &amp;&amp; now login</code> and added a <code>now.json</code> file;</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }]\n}\n</code></pre>\n<p>This tells Now that any JavaScript files should be built with their Node.js builder.</p>\n<p>I had to tweak my <code>index.js</code> slightly. First to add their function boilerplate, and secondly to call <code>res.end</code> to output something, rather than logging it to the console;</p>\n<pre><code class="language-javascript"><span class="token comment">// ...</span>\n\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// Zeit boilerplate</span>\n  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/random\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    \n    <span class="token comment">// Tweet, tweet!</span>\n    client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"statuses/update"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token punctuation">:</span> tweet <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Success!\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>I then ran <code>now</code> which is their command for deploying your serverless function. This took a bit longer than I expected to be honest, but to be fair there\'s probably a lot going behind the scenes to achieve what Zeit provides.</p>\n<p>The result:</p>\n<pre><code class="language-shell">> Deploying ~/Code/random-open-api under notmyreal@email.com\n> Using project random-open-api\n> https://random-open-api-jdhf89whf3489.now.sh [v2] [in clipboard] [3s]\n┌ index.js        Ready               [24s]\n└── λ index.js (39.83KB) [bru1]\n> Success! Deployment ready [28s]\n</code></pre>\n<p>Now gives you a new URL each time you deploy. I went to this URL in my browser and saw &quot;Success!&quot;. Yes, it sent the tweet! That was easy.</p>\n<h3><a id="getting-secretive" class="post-header-anchor" href="#getting-secretive" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Getting secretive</h3>\n<p>I planned to open source the code and I didn\'t want to commit my Twitter credentials. First, I needed to create a secret for each so I ran the following commands:</p>\n<pre><code class="language-shell">now secret add CONSUMER_KEY "notTheRealValue"\nnow secret add CONSUMER_SECRET "notTheRealValueEither"\nnow secret add ACCESS_TOKEN_KEY "nopeNotReal"\nnow secret add ACCESS_TOKEN_SECRET "hmmNoStillNotReal"\n</code></pre>\n<p>Then I added the following <code>env</code> object to my <code>now.json</code> file.</p>\n<pre><code class="language-javascripton">{\n  "version": 2,\n  "builds": [{ "src": "*.js", "use": "@now/node" }],\n  "env": {\n    "CONSUMER_KEY": "@consumer_key",\n    "CONSUMER_SECRET": "@consumer_secret",\n    "ACCESS_TOKEN_KEY": "@access_token_key",\n    "ACCESS_TOKEN_SECRET": "@access_token_secret"\n  }\n}\n</code></pre>\n<p>This then allowed me to use <code>process.env.CONSUMER_KEY</code> in my function, for example;</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  subdomain<span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>\n  consumer_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_KEY<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  consumer_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>CONSUMER_SECRET<span class="token punctuation">,</span> <span class="token comment">// from Twitter.</span>\n  access_token_key<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_KEY<span class="token punctuation">,</span> <span class="token comment">// from your User (oauth_token)</span>\n  access_token_secret<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ACCESS_TOKEN_SECRET <span class="token comment">// from your User (oauth_token_secret)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>Now would replace those references with the actual values when deploying. Not too complicated right?</p>\n<p>I ran <code>now</code> again but this time it didn\'t work. I got a blank response in my browser. Well, what happened was I somehow managed to type <code>process.key</code> , not <code>process.env</code> . I went down a rabbit hole trying all sorts of other ways of using environment variables, secrets, <code>now-env</code> , and more, before realizing my mistake.</p>\n<h3><a id="automation" class="post-header-anchor" href="#automation" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Automation</h3>\n<p>I was feeling good. All I had to do was configure Now to run the function on a schedule, publish the code, write and publish the blog post. Profit.</p>\n<p>Well, Zeit doesn\'t support running things on a schedule 😦</p>\n<p>At least they don\'t in Now version 2. I remember there was a bit of talk around the fact they released a backwards incompatible v2. It was forward thinking but had fewer features than v1. I think v1 supported what I needed but I didn\'t want to start a project by going back in time.</p>\n<p>There were workarounds suggested in GitHub issues like having a <code>setInterval</code> in your function. Em, no. I swear, every time I play around with serverless, FaaS, or IoT, an obvious use case isn\'t covered.</p>\n<p>So I gave up on Now. I decided to manually log into Twitter and tweet a few times a day...</p>\n<p>I actually settled for a simple but uncomfortable solution. It turns out there\'s a completely free (and open source) service, <a href="https://cron-job.org/en/" rel="noopener">cron-job.org</a>, which will call your URL on a schedule.</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/cron.png"><img src="/images/blog-content/random-open-api/cron.png" alt=""/></a>\n          <figcaption><p>The job configuration.</p>\n</figcaption>\n        </figure><p>All I had to do was sign up, create a job with my URL, and schedule it. As you see, I didn\'t even have to use the horrible <a href="http://www.nncron.ru/help/EN/working/cron-format.htm" rel="noopener">cron format</a>. It was painless.</p>\n<h3><a id="deployment-aliases" class="post-header-anchor" href="#deployment-aliases" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Deployment aliases</h3>\n<p>I realized that if I ever deploy an update, I\'ll have to log into <a href="http://cron-job.org" rel="noopener">cron-job.org</a> and update the URL. Then I discovered Now\'s aliases. Individual deployments can be assigned deployments;</p>\n<figure>\n          <a href="/images/blog-content/random-open-api/alias.png"><img src="/images/blog-content/random-open-api/alias.png" alt=""/></a>\n          <figcaption><p>The create alias modal.</p>\n</figcaption>\n        </figure><p>You can choose a <a href="http://now.sh" rel="noopener">now.sh</a> subdomain or give your own domain.</p>\n<p>So each time I update the code and deploy, I\'ll re-assign the alias to the new deployment. There\'s probably a better way around this but I didn\'t want to spend too long worrying about it. The code won\'t need to be updated much and if it ever does, I\'d assume the Now dashboard is where it\'s managed.</p>\n<h3><a id="the-end" class="post-header-anchor" href="#the-end" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The end</h3>\n<p>So that\'s it. It took me 42 minutes in total, including a couple of blunders. Thank you, bye.</p>\n<p>Goodbye!</p>\n<p>Hey, stop, why are you still reading?</p>\n<p>Ugh, fine...</p>\n<h3><a id="palm-have-you-met-face" class="post-header-anchor" href="#palm-have-you-met-face" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Palm, have you met face?</h3>\n<p>While writing this, I noticed that the API returns more than strictly &quot;open&quot; APIs. Some are, while others require some kind of signup and authentication. I guess I was trying to move too fast.</p>\n<p>Looking through results, even the ones which require authentication are still free and publicly available. It doesn\'t bother me then if they\'re not 100% &quot;open&quot;, the data is still there to use.</p>\n<p>Oh wait, no... they\'re not all free either. The <a href="https://semantria.readme.io/docs" rel="noopener">Semantria API</a> is one entry I just found for example; a &quot;paid Saas text analytics service&quot;.</p>\n<p><img src="/images/blog-content/random-open-api/godfather.gif" alt="&quot;Just when I thought I was out, they pull me back in!&quot; from the Godfather"></p>\n<p>Looking at the Public API for Public APIs again, they also return an <code>auth</code> property for each API. I\'ve seen results with <code>&quot;auth&quot;: &quot;apiKey&quot;</code>, <code>&quot;auth&quot;: &quot;OAuth&quot;</code>, and <code>&quot;auth&quot;: &quot;&quot;</code>. I need to tweet about the last case.</p>\n<p>The <code>/random</code> endpoint doesn\'t support filtering, so I\'d have to keep calling it until I get one that\'s open. Hmm.</p>\n<p>The <code>/entries</code> endpoint does support an <code>auth</code> filter parameter but it returns an array of APIs. This looks like my best bet. It doesn\'t support pagination so it must either return all or at least as many as it can. Here\'s the new API code:</p>\n<pre><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'https://api.publicapis.org/entries?auth=null\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'No APIs found\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// Build tweet content from random result</span>\n  <span class="token keyword">const</span> api <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre>\n<p>There\'s no reason why <code>/random</code> couldn\'t also accept filter parameters. After I publish this, I\'ll go make a pull-request.</p>\n<h3><a id="conclusion" class="post-header-anchor" href="#conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Conclusion</h3>\n<p>It was a nice break to rush head first into a small project, hacking something together without reading documentation, properly handling errors, etc. but I don\'t recommend working like this. It was almost a disaster.</p>\n<p>Follow <a href="twitter.com/randomOpenAPI">@randomOpenAPI</a> on Twitter. Check out the source code at <a href="github.com/adam-lynch/random-open-api">github.com/adam-lynch/random-open-api</a>.</p>\n<p>What could you make? I could imagine someone finding value in an account that tweets about <em>two</em> random APIs. The mashups might be handy for coming up with project ideas.</p>\n',summary:"I love APIs. Especially open APIs. I wish there were way more of them. There's a lot of data out there we can't get our hands on. Imagine all of the unborn apps, studies, and infographics.\nThe natural conclusion was to create a Twitter bot. Have you ever seen Stefan Judis' @randomMDN? It tweets a random article from MDN multiple times a day. I decided to create one of my own to raise awareness about open APIs. Plus it's an excuse for a small fun project.\n",photo:"/images/blog-content/random-open-api/tweet.png",keywords:["api","open API","public API","twitter","bot","zeit","now","serverless","faas","node.js","cron","development"],published_at:"2019-02-02T00:00:00.000Z",updated_at:"2019-05-22T08:26:12.392Z",year:2019,month:2,day:3,relevanceScore:.875,moreArticles:[{id:"flexible-data-tables-with-css-grid",slug:"flexible-data-tables-with-css-grid",highlightedLanguages:["css"],source:'---\ndate: 2019-05-12\ntags:\n  - css grid\n  - css\n  - javascript\n  - table\n  - data\n  - responsive design\n  - responsive\n  - flexbox\n  - resize column\n  - web app\n  - development\n  - crm\n  - sales\n---\n\n## Flexible data tables with CSS Grid\n\n::: summary\n\nNow that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the [Teamwork CRM](https://www.teamwork.com/crm) puzzle was the "list view". \n\nIt\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n\n:::\n\n\nFirst, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to [skip to the CSS Grid bit](#just-get-to-css-grid-already).\n\n:::figure flexible-data-tables-with-css-grid/wide3.png The leads list view.\n:::\n\nPrimarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.\n\nEverything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints). \n\nAt its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen. \n\n:::figure flexible-data-tables-with-css-grid/narrow.png What a list view looks like on a narrow screen.\n:::\n\nResponsive tables are tricky. There are [several existing patterns](https://bradfrost.github.io/this-is-responsive/patterns.html) you could pick from. Consider what your users are trying to achieve and choose wisely. \n\nOnce we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.\n\nAssume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns. \n\nColumns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.\n\n:::figure flexible-data-tables-with-css-grid/resizing-window.gif How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.\n:::\n\nTo begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.\n\n## Just get to CSS Grid already\n\nI\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s [The New CSS Layout](https://abookapart.com/products/the-new-css-layout) or [A Complete Guide to Grid](https://css-tricks.com/snippets/css/complete-guide-grid/) and when you\'re done wondering where Grid was all your life, come back to me.\n\nThe first thing we do is apply `display: grid` to the `<table>` to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using `display:table`). Its children become grid items; the `<thead>` and `<tbody>`. It\'s not the `<thead>`, `<tbody>`, or even the `<tr>`s we\'re concerned with though. What we want to do is lay out our `<th>`s and `<td>`s on this grid. We could apply `display: grid` to each of these too (i.e. grids within grids), but that\'s not ideal. Each `<tr>` grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).\n\nA workaround is to use `display: contents` on the `<thead>`, `<tbody>`, and `<tr>`s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the `<th>`s and `<td>`s) to participate in the the `<table>` grid instead. \n\nThen we use the magic `grid-template-columns` to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:\n\n```css\ngrid-template-columns: minmax(150px, 1.33fr) minmax(150px, 2.33fr);\n```\n\nWe use the same minimum size for all columns but the max (`fr`) value is determined by the column data type. I tried using Grid\'s`auto` and `max-content` too but what we\'ve ended up with seems to produce the best result.\n\nHere is a simplified example:\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nYou should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.\n\n## Resizing columns with Grid\n\nOn top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields. \n\nFor example, a user could create a (date) custom field for contacts called "Date of birth" so that can be tracked in the system for each contact. \n\nSince a type like "Date" is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.\n\n1. The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for `mousedown` on the resize handle.\n2. When the user clicks the handle, we bind some more `mousemove` and `mousedown` event listeners (to the `window`). We also add some classes for decoration at this point.\n3. When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the `<table>`\'s `grid-template-columns`s rule (via `style` attribute), this time replacing the max (`fr`) value with a pixel value. For example, `grid-template-columns: minmax(150px, 1.33fr) 296px;`. We do this using `requestAnimationFrame` to keep it as smooth as possible.\n4. When `mouseup` is fired, we unbind event listeners and remove classes.\n\nTry this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nWhat\'s great here is that we only need to update one element in the DOM, not each cell.\n\nWe always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.\n\n## Fixed column widths\n\nYou might have noticed I didn\'t tell the whole truth. Not only do we "fix" the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.\n\nI originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):\n\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n\nAfter some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions. \n\nWe shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.\n\nTherefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.\n\n:::figure flexible-data-tables-with-css-grid/resizing-columns.gif Before, during, and after resizing a column. Sorry the GIF is a bit janky.\n:::\n\nOnce someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.\n\nI can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and `display: contents` aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.\n\nUsing something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking "Hmm, I want this column to take up 20% of the window even if I resize it". Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.\n\n## Toggling columns\n\n:::figure flexible-data-tables-with-css-grid/manage-columns.png Our modal for customizing which columns are shown.\n:::\n\nImagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default `grid-template-column` values depending on their data type. For example, `minmax(150px, 3.33fr)`.\n\nIf any of the columns has a fixed width stored in localStorage, we make *all* of the chosen columns fixed width (and store those widths in localStorage too).\n\nOver time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.\n\nWe also store an array of column identifiers in localStorage, separate to the column width entries.\n\n## "Why didn\'t you just use {{ libraryName }}?"\n\nI didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use `<table>` at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.\n\n## "Why didn\'t you just use Flexbox?"\n\nEach row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.\n\nI could have switched to `<div>`s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a `<table>`. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.\n\n## "Why didn\'t you just use a `<colgroup>`?"\n\nCheck out [`<colgroup>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup), it\'s a handy old element. Once you define your columns using `<col>`s, styles applied to one will effectively be applied to all of the cells in that column. \n\nIn the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.\n\n## "Why didn\'t you just use table-layout: fixed?"\n\nI could have use `table-layout: fixed` on the `<table>` and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.\n\n## "But you could still have used a table!"\n\nYes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.\n\n## Don\'t go overboard with display: contents\n\n`display:contents` allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content. \n\nWe discovered a [strange bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1550728) when combining it with native drag & drop in Firefox.\n\nFortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See [Why display: contents is not CSS Grid Layout subgrid](https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/).\n\n## I\'m probably forgetting something\n\nThere\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore. \n\nWe use `position: sticky` to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.\n\nI didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.\n\nWe\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.\n\nAnyway, thanks for reading.\n',unfilteredRenderedBody:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<article-summary><p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n</article-summary><p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',attributes:{date:"2019-05-12T00:00:00.000Z",tags:[{id:"css-grid",name:"css grid"},{id:"css",name:"css"},{id:"javascript",name:"javascript"},{id:"table",name:"table"},{id:"data",name:"data"},{id:"responsive-design",name:"responsive design"},{id:"responsive",name:"responsive"},{id:"flexbox",name:"flexbox"},{id:"resize-column",name:"resize column"},{id:"web-app",name:"web app"},{id:"development",name:"development"},{id:"crm",name:"crm"},{id:"sales",name:"sales"}],title:"Flexible data tables with CSS Grid",updated_at:"2019-05-12T15:23:45.287Z",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"},title:"Flexible data tables with CSS Grid",renderedSummary:"<p>Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the <a href=\"https://www.teamwork.com/crm\" rel=\"noopener\">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n",rendered:'<h2><a id="flexible-data-tables-with-css-grid" class="post-header-anchor" href="#flexible-data-tables-with-css-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Flexible data tables with CSS Grid</h2>\n<p>Now that we\'ve launched, I can finally talk about the secret project I\'ve been working on for the last two years. One interesting piece of the <a href="https://www.teamwork.com/crm" rel="noopener">Teamwork CRM</a> puzzle was the &quot;list view&quot;.</p>\n<p>It\'s a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won\'t bore you. I\'ll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.</p>\n<p>First, I need to give some more context, starting with the purpose and design goals of these screens. Feel free to <a href="#just-get-to-css-grid-already">skip to the CSS Grid bit</a>.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/wide3.png" alt=""/></a>\n          <figcaption><p>The leads list view.</p>\n</figcaption>\n        </figure><p>Primarily it allows salespeople to scan a list of items like their leads or contacts, and find anything important they need to take action on. It\'s not like an Excel spreadsheet — we can do a better job at laying out the data, which there will be a lot of.</p>\n<p>Everything we do is responsively designed. We start with the most narrow / constrained variant first and tweak the layout based on content, design, use cases (we don\'t have device-orientated breakpoints).</p>\n<p>At its most minimal, the columns are stacked vertically within rows, spanning the full width of the screen.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/narrow.png" alt=""/></a>\n          <figcaption><p>What a list view looks like on a narrow screen.</p>\n</figcaption>\n        </figure><p>Responsive tables are tricky. There are <a href="https://bradfrost.github.io/this-is-responsive/patterns.html" rel="noopener">several existing patterns</a> you could pick from. Consider what your users are trying to achieve and choose wisely.</p>\n<p>Once we have enough pixels in our canvas to play with, we switch to a more typical table layout such that the columns are... well, columns. There are no major layout changes beyond this point but we still want to display the columns as best as we can for the salesperson viewing it.</p>\n<p>Assume there are a lot of columns (we\'ll look at how the user can configure the columns in more detail later). The table should fill the width of the screen (at least). Column widths then should be determined by their content and the type of values they contain; e.g. short / long text, date, number, URL, etc. Date columns should take up less room than long text columns.</p>\n<p>Columns must have a minimum width and therefore only so many can fit into the viewport. As a result this table will be vertically and horizontally scrollable for a lot of salespeople.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-window.gif" alt=""/></a>\n          <figcaption><p>How the layout varies per window width. Sorry the GIF is a bit janky, I provide some interactive examples below.</p>\n</figcaption>\n        </figure><p>To begin with, we lay the table out as best we can using regular old-school table-layout CSS. Next, I\'ll show you how we enhance it with CSS Grid. Following that, how we leverage Grid to allow users to resize columns, which would be a lot more awkward with regular table-layout CSS.</p>\n<h2><a id="just-get-to-css-grid-already" class="post-header-anchor" href="#just-get-to-css-grid-already" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Just get to CSS Grid already</h2>\n<p>I\'m no CSS Grid expert but I love it. It\'s extremely powerful and simple, allowing you to implement previously tricky layouts with minute amounts of code. I\'ll skip giving an introduction to Grid in this article. Go read Rachel Andrew\'s <a href="https://abookapart.com/products/the-new-css-layout" rel="noopener">The New CSS Layout</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/" rel="noopener">A Complete Guide to Grid</a> and when you\'re done wondering where Grid was all your life, come back to me.</p>\n<p>The first thing we do is apply <code>display: grid</code> to the <code>&lt;table&gt;</code> to make it a grid. This won\'t break anything if the browser doesn\'t support it (it will carry on using <code>display:table</code>). Its children become grid items; the <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code>. It\'s not the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, or even the <code>&lt;tr&gt;</code>s we\'re concerned with though. What we want to do is lay out our <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s on this grid. We could apply <code>display: grid</code> to each of these too (i.e. grids within grids), but that\'s not ideal. Each <code>&lt;tr&gt;</code> grid would be independent of others and that\'s not good (you\'ll see later that I had the same problem with Flexbox).</p>\n<p>A workaround is to use <code>display: contents</code> on the <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and <code>&lt;tr&gt;</code>s. This basically removes the them from the Grid layout, bypassing them, and promotes their children (the <code>&lt;th&gt;</code>s and <code>&lt;td&gt;</code>s) to participate in the the <code>&lt;table&gt;</code> grid instead.</p>\n<p>Then we use the magic <code>grid-template-columns</code> to control the grid items. Yes, one line of CSS. For example, if we had one date column and one URL column, it might be something like:</p>\n<pre><code class="language-css"><span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 1.33fr<span class="token punctuation">)</span> <span class="token function">minmax</span><span class="token punctuation">(</span>150px, 2.33fr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>We use the same minimum size for all columns but the max (<code>fr</code>) value is determined by the column data type. I tried using Grid\'s<code>auto</code> and <code>max-content</code> too but what we\'ve ended up with seems to produce the best result.</p>\n<p>Here is a simplified example:</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="XwKWdG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/XwKWdG/" target="_blank">\n  Flexible data table with CSS Grid</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>You should <a href="https://codepen.io/adam-lynch/debug/XwKWdG" target="_blank">open it in a new tab</a> as it\'s a bit constrained embedded here like this. Then try resizing the window.</p>\n<h2><a id="resizing-columns-with-grid" class="post-header-anchor" href="#resizing-columns-with-grid" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Resizing columns with Grid</h2>\n<p>On top of this, we support reordering, resizing, and toggling which columns are shown. The lists of possible columns are long, including properties of the item (e.g. leads) itself, properties of related items (e.g. the company linked to the lead), and custom fields.</p>\n<p>For example, a user could create a (date) custom field for contacts called &quot;Date of birth&quot; so that can be tracked in the system for each contact.</p>\n<p>Since a type like &quot;Date&quot; is selected when creating a custom field, our system already handles custom fields. There\'s more to think about when columns are toggled, but first I need to explain how resizing works.</p>\n<ol>\n<li>The user hovers over a column header, a resize handle is shown on the right hand side. We\'re listening for <code>mousedown</code> on the resize handle.</li>\n<li>When the user clicks the handle, we bind some more <code>mousemove</code> and <code>mousedown</code> event listeners (to the <code>window</code>). We also add some classes for decoration at this point.</li>\n<li>When the user moves their mouse, we calculate the new column width. This takes the cursor position, the table\'s scroll position, and our minimum into account. Then we re-set the <code>&lt;table&gt;</code>\'s <code>grid-template-columns</code>s rule (via <code>style</code> attribute), this time replacing the max (<code>fr</code>) value with a pixel value. For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>. We do this using <code>requestAnimationFrame</code> to keep it as smooth as possible.</li>\n<li>When <code>mouseup</code> is fired, we unbind event listeners and remove classes.</li>\n</ol>\n<p>Try this simplified example (or ideally <a href="https://codepen.io/adam-lynch/pen/GaqgXP" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="GaqgXP" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with good UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/GaqgXP/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with good UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p>\n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>What\'s great here is that we only need to update one element in the DOM, not each cell.</p>\n<p>We always build with touch users in mind, but it\'s OK not to support this via touch. It\'s a very precise action. Even if I wanted to resize a column using touch, I\'d probably expect a different interaction, like a multi-touch spread gesture.</p>\n<h2><a id="fixed-column-widths" class="post-header-anchor" href="#fixed-column-widths" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Fixed column widths</h2>\n<p>You might have noticed I didn\'t tell the whole truth. Not only do we &quot;fix&quot; the width of the column you\'re resizing, we make all column widths fixed. Maybe you didn\'t even notice, because that\'s exactly how it should work.</p>\n<p>I originally thought that users would like that when they stretched or squeezed columns, the other ones could adjust too. If the columns filled the screen width nicely and you make one smaller, one (or some) of the others could grow if they had more content to show. Try this example for yourself below (or ideally <a href="https://codepen.io/adam-lynch/pen/wbWvep" target="_blank">open it in a new tab</a>):</p>\n<p class="codepen" data-height="390" data-theme-id="light" data-default-tab="result" data-user="adam-lynch" data-slug-hash="wbWvep" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Flexible data table with CSS Grid (resizable columns with bad UX)">\n  <span>Something went wrong. View <a href="https://codepen.io/adam-lynch/pen/wbWvep/" target="_blank">\n  Flexible data table with CSS Grid (resizable columns with bad UX)</a> by Adam Lynch (<a href="https://codepen.io/adam-lynch">@adam-lynch</a>)\n  on <a href="https://codepen.io">CodePen</a>.</span>\n</p> \n<script async src="https://static.codepen.io/assets/embed/ei.js"><\/script>\n<p>After some user testing, it was clear this is unexpected behaviour. As a user, I feel less in control when there are unpredictable side-effects to my actions.</p>\n<p>We shouldn\'t make assumptions based on which column was or wasn\'t interacted with. When resizing one column, a user could have already made an implicit decision that the rest were perfect.</p>\n<p>Therefore, if you open the app for the first time, the columns are laid out as best as possible. If you resize your screen, they resize using the same ratios. Once you touch the resize handler of any column, all of the visible columns become fixed width.</p>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif"><img src="/images/blog-content/flexible-data-tables-with-css-grid/resizing-columns.gif" alt=""/></a>\n          <figcaption><p>Before, during, and after resizing a column. Sorry the GIF is a bit janky.</p>\n</figcaption>\n        </figure><p>Once someone takes the time to tailor the screen to their needs, we take note. Any time a column is resized or made fixed, we create an independent localStorage entry mapping a column identifier to a pixel value.</p>\n<p>I can\'t remember exactly why we decided to set the fixed value using pixels, rather than something more fluid. Maybe it was just to keep it simple. Maybe it\'s because we do actually fall back to using a more archaic approach to setting column widths if Grid and <code>display: contents</code> aren\'t supported. You don\'t have to do this, it would have been too important to leave out for our users.</p>\n<p>Using something fluid probably wouldn\'t align with the user\'s intentions anyway. We can\'t assume that making all columns smaller in order to keep more of them in the screen is the most important thing. If they had resized a column, it\'s to see a certain amount of content in that column. If we used a fluid unit, and then they made the screen narrower, we\'d be disregarding the choice they made. They\'d have to resize the column again to see the same content. Users are unlikely to be thinking &quot;Hmm, I want this column to take up 20% of the window even if I resize it&quot;. Anyway, users rarely resize windows; I\'m going into too much detail on an edge case here.</p>\n<h2><a id="toggling-columns" class="post-header-anchor" href="#toggling-columns" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Toggling columns</h2>\n<figure>\n          <a href="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png"><img src="/images/blog-content/flexible-data-tables-with-css-grid/manage-columns.png" alt=""/></a>\n          <figcaption><p>Our modal for customizing which columns are shown.</p>\n</figcaption>\n        </figure><p>Imagine a salesperson has changed the column set using the above modal. If none of the chosen columns have been resized previously, they get laid out using the default <code>grid-template-column</code> values depending on their data type. For example, <code>minmax(150px, 3.33fr)</code>.</p>\n<p>If any of the columns has a fixed width stored in localStorage, we make <em>all</em> of the chosen columns fixed width (and store those widths in localStorage too).</p>\n<p>Over time, more and more columns will become fixed. The only way for users to get back to fluid columns is if they were to reset the columns.</p>\n<p>We also store an array of column identifiers in localStorage, separate to the column width entries.</p>\n<h2><a id="why-didnt-you-just-use--libraryname-" class="post-header-anchor" href="#why-didnt-you-just-use--libraryname-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use {{ libraryName }}?&quot;</h2>\n<p>I didn\'t want to just offload the problem to a heavy JavaScript library. It would be heavy, janky, wouldn\'t be responsive, and might not even use <code>&lt;table&gt;</code> at all. I also didn\'t want to write something like that myself. There must be a better way, I thought.</p>\n<h2><a id="why-didnt-you-just-use-flexbox" class="post-header-anchor" href="#why-didnt-you-just-use-flexbox" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use Flexbox?&quot;</h2>\n<p>Each row would be evaluated / spaced independently of each other. A column might not be aligned with the column above it because of varying content length.</p>\n<p>I could have switched to <code>&lt;div&gt;</code>s representing the column containing the vertically stacked cells within. I didn\'t want to have to do this though. I wanted to use a <code>&lt;table&gt;</code>. On top of that, I could have easily ran into issues from the reverse angle anyway, like cells not matching in height across columns.</p>\n<h2><a id="why-didnt-you-just-use-a-colgroup-" class="post-header-anchor" href="#why-didnt-you-just-use-a-colgroup-" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use a <code>&lt;colgroup&gt;</code>?&quot;</h2>\n<p>Check out <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup" rel="noopener"><code>&lt;colgroup&gt;</code></a>, it\'s a handy old element. Once you define your columns using <code>&lt;col&gt;</code>s, styles applied to one will effectively be applied to all of the cells in that column.</p>\n<p>In the end though, it was simply too limited for what I needed to do. It didn\'t take long to realise it was a no-go. So much so, that I can\'t remember exactly what the problems were. I\'m pretty sure it was impossible to achieve the level of fluidity I wanted, and it didn\'t work well with Flexbox or Grid.</p>\n<h2><a id="why-didnt-you-just-use-table-layout-fixed" class="post-header-anchor" href="#why-didnt-you-just-use-table-layout-fixed" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;Why didn\'t you just use table-layout: fixed?&quot;</h2>\n<p>I could have use <code>table-layout: fixed</code> on the <code>&lt;table&gt;</code> and set the column widths using percentages. However, from looking at examples and playing around, this only seems to work if the table is 100% in width. Also resizing one column causes the other columns to resize to fill the 100% width.</p>\n<h2><a id="but-you-could-still-have-used-a-table" class="post-header-anchor" href="#but-you-could-still-have-used-a-table" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>&quot;But you could still have used a table!&quot;</h2>\n<p>Yes, tables can do a lot of smart things out of the box, but they can\'t efficiently support everything I wanted to do. Still disagree? OK you wizard, teach me.</p>\n<h2><a id="dont-go-overboard-with-display-contents" class="post-header-anchor" href="#dont-go-overboard-with-display-contents" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Don\'t go overboard with display: contents</h2>\n<p><code>display:contents</code> allowed us to keep our table markup. Use it only when you really have to though. There is, or at least were, issues in some browsers around accessibility and how screen readers would read the content.</p>\n<p>We discovered a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550728" rel="noopener">strange bug</a> when combining it with native drag &amp; drop in Firefox.</p>\n<p>Fortunately, subgrid on the way which will properly allow descendants to participate in grids. Our use case is simple in that we want to effectively flatten the markup but subgrid will open the door for wilder multi-dimensional grid orgies. See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/" rel="noopener">Why display: contents is not CSS Grid Layout subgrid</a>.</p>\n<h2><a id="im-probably-forgetting-something" class="post-header-anchor" href="#im-probably-forgetting-something" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>I\'m probably forgetting something</h2>\n<p>There\'s a lot more to this screen. I think there was some text-overflow issue when resizing columns but I can\'t remember anymore.</p>\n<p>We use <code>position: sticky</code> to keep the table headers in place as you scroll down. It\'s a lovely enhancement and it degrades nicely. However, we do have a JavaScript fallback for IE11 users. I really wouldn\'t recommend doing that. It\'s tricky to achieve with horizontally scrollable tables.</p>\n<p>I didn\'t even touch on all of the features of these list views. Users can apply, save, and share custom filters (e.g. show me leads over $500 or where the contact is in Europe). These column filters can be set to remember the column set you had when you created them, because you might always want to see certain columns for a given workflow.</p>\n<p>We\'ll soon support bulk editing via the list view, as well exporting your tailored view to CSV.</p>\n<p>Anyway, thanks for reading.</p>\n',summary:"Now that we've launched, I can finally talk about the secret project I've been working on for the last two years. One interesting piece of the Teamwork CRM puzzle was the &quot;list view&quot;.\nIt's a powerful page component which exists seven times in the app — a table on steroids essentially. I could talk about it for days but I won't bore you. I'll focus on how we added a lot of flexibility with a few lines of CSS (Grid). Namely, how we lay out data-heavy tables, how we support resizing of columns, and more.\n",photo:"/images/blog-content/flexible-data-tables-with-css-grid/wide3.png",keywords:["css grid","css","javascript","table","data","responsive design","responsive","flexbox","resize column","web app","development","crm","sales"],published_at:"2019-05-12T00:00:00.000Z",updated_at:"2019-05-12T15:23:45.287Z",year:2019,month:5,day:13,relevanceScore:2},{id:"lessons-learned-leading-teams",slug:"lessons-learned-leading-teams",highlightedLanguages:[],source:"---\ndate: 2018-11-14\ntags:\n  - leadership\n  - management\n  - teams\n  - development\n  - lead\n  - leading\n  - managing\n  - manager\n  - programming\n  - delegating\n  - efficiency\n  - communication\n  - people\n  - technical\n  - transition\n  - job\n  - career\n  - growth\n  - product management\n  - project management\n  - product lead\n  - technical lead\n  - lead developer\n---\n\n## Lessons learned leading teams\n\n::: summary\n\nI've been thinking about team leading a lot lately. When revisiting advice a friend asked for when transitioning to a team lead position, I decided to flesh it out and put it online. Most of the following will hopefully be helpful to anyone leading a team or any manager, although some will be more relevant to leaders of developers and developers transitioning into leadership roles. If it helps anyone, great. It will be a good reference for me at least. Alright, let's get to it.\n\n:::\n\n\n### Delegate, delegate, delegate!\n\nI've struggled with this and have seen almost every person in a leadership position struggle with it as well, but trust me, it's really worth getting over. If someone can do something 80% as well as you or better, delegate! Focus on the stuff only you can do. Don't feel like you have to touch everything and be the best or most active person on the team. You're responsible for making sure everyone else does their best and grows.\n\nIf you don't delegate enough, people feel like they're only doing the boring stuff and they'll feel undervalued as a result. They'll find somewhere they can have more impact and feel more valued. You'll be stressed because everyone is asking you to make a decision. Key decisions will stall as they wait for your call. The team will already have enough dependencies, which you're trying to resolve; don't become one.\n\nAlways try to find more ways to delegate. Don't just give people work to do in small orchestrated pieces. It makes people more reliant on you. They learn less. Although it is hard when you know how to do it and they're still learning. Delegate decision making for a particular problem to the right person. People love autonomy. Try to ask yourself if the right people are looking at a problem so the best possible decision can be made. Show people how *they* can safely spread responsibilities and knowledge.\n\nMake yourself as redundant in the day-to-day work as possible. Ensure the team has the skills, knowledge, experience to get things done. You don't need to have the final say on everything and solve every hard problem. This gives you more time to work on the stuff only you can do.\n\nOn the flip side, as you start to delegate more, you will become less familiar with the actual code and feel like more of an [imposter](https://en.wikipedia.org/wiki/Impostor_syndrome). Don't let this stop you from delegating though.\n\n\n### Efficiency\n\nKeep the team as efficient as possible. Protect them from distractions. For example, this also includes telling them about potential disruptive process changes being considered and meetings they'd like to be in but really don't need to be.\n\nEmphasise knowledge sharing. Avoid someone fixing bugs related to X because they implemented X originally. Single points of failure are hard to avoid. People love to own their work. Taking responsibility is good but often leads to one person holding exclusive knowledge of something. Give someone territory and they'll likely become defensive.\n\nUnblock the team, address issues that are holding back the team or individuals; dependencies, external issues like blocking stakeholders, lack of knowledge, etc. Reduce friction. Always look for ways to make your team's life easier so they can do their best work. Shield them from company politics, pointless meetings, and other distractions. Resolve disagreements.\n\nGet the most out of different personalities. Understand what individuals need to perform optimally. Compromise, cultivate a team spirit. Promote continuous integration.\n\nDetermine the type of lead you will be. Don't identify yourself or become a title / dependency. This will only limit team members. The title isn't an excuse to micro-manage. Don't read into the word \"lead\" too much. People shouldn't be at your mercy or at your beck and call. Focus on getting to a point where everyone can learn from each other and get their best possible work done.\n\nKeep an ear to the ground. Too much talk within the team might indicate a lack of productivity, decision making, or that they're enjoying themselves too much. If it's a bit too quiet, it might mean everyone is head down and there'll be problems once their code is integrated, or that people might not be getting along.\n\n\n### Communication\n\nYou have to be an excellent communicator. There's no room for negotiation here. Be assertive, be clear, and be honest. \n\nBeing specific and confident in what you're saying about a task is critical. You can't rely on intention. People will do exactly as you say. Discover and minimize misunderstandings early. The same goes for your interactions with stakeholders; play your part and remove ambiguity when it appears.\n\nThis is a simple one but when messaging a team member about having a chat with them, give them a rough idea what it's about in advance.\n\n:::figure lessons-learned-leading-teams/graph.png A beautiful line graph showing that the \"importance of giving heads up\" is inversely proportional to \"frequency of contact\". Watch out for \"The 'OMG I'm getting fired' zone\" if contact is minimal.\n:::\n\nDisagreements aren't criticism. They're healthy as long as they don't block progression or damage relationships. Don't be mean, but say what you mean, early. Make sure everyone has a fair say. There's always a better way but what is the most feasible solution right now? Try to get agreement from everyone and ensure everyone understands the outcome.\n\nEncourage your team to challenge you, to tell you when you're wrong, but respectfully. The last thing you want is for them to be afraid to point out when you're wrong. Be your own harshest critic. Be honest when you don't know X and don't be afraid to admit you're learning. *Everyone is*.\n\nYou need to be serious and firm when giving criticism. If you're too lenient, it's harder to say something isn't acceptable later. The culture and standards of the team come from what you tolerate and promote.\n\n::: quote https://twitter.com/notch/status/1055887409035034624 Notch\nWe just need to stop letting people to trick us into thinking we actually CARE about the arguments we have over things we haven't researched. If we did, we'd research.\n:::\n\nDon't spend time debating that which doesn't warrant it. Once you have good people, trust that they've looked into what they're talking about, that they've looked at the details. Don't second guess the small stuff. When there's a disagreement over a decision, be honest about how much you care about the outcome. If it's 2/10 for you but 9/10 for them, let it go. This is related to having a personal attachment to details (\"perfectionism\") but I'll leave that for another post. \n\n\n### Represent and protect\n\nRepresent your team. Voice their concerns and share updates with them. Celebrate and recognise their hard work and achievements. Protect your team. Be an umbrella. Take negative criticism for them and only pass it down if they really need to hear it. Having anyone as a lead makes the team stronger, no matter who it is. Someone can stand up for the team and make things happen. Under promise, over deliver.\n\nYou now represent \"the man\". Understand top-down decisions; you need to in order to believe in them, and to then make others believe in them. Support your superiors. If they don't understand the challenges you're facing, that's your fault. Give them more situational awareness. Support them. Make them look good.\n\nManage stakeholder expectations as well as internal perspectives of your team and their work. Criticise team members if they're less than nice with other teams, for example. They're representing the team. Larger organisations can be tough as not everyone will respect the work being done by your team. Avoid pointing fingers or blaming other teams. I could benefit from being more savvy when it comes to politics but that's not what I'm about. You're all on the same side, act like it. When listing our values at [Teamwork](http://teamwork.com/), the following is often cited as a good example:\n\n::: quote\nLet the other person save face, even if they are clearly wrong\n:::\n\n\n### Process\n\nDon't go overboard on process. Start small, experiment, keep what works. Team members' past experiences and opinions will vary a lot. Make it clear that the process is evolving and can always be improved with a suggestion from a team member. Each team is different, you'll discover the best processes. Set as few rules as possible and strive for minimal viable bureaucracy or process.\n\n::: quote https://twitter.com/tastapod/status/1059384774131965952 Dan North \nYou shouldn’t start with the Spotify model. Spotify didn’t start with the Spotify model. You shouldn’t start with Scrum. Scrum didn’t start with Scrum. You should start by identifying what you want to improve, and introduce constraints that force the improvement.\n:::\n\nI'd recommend doing daily standups. They're really good when done properly. It should ideally be at the same time everyday, as early as possible. If everyone is in the same location, actually stand (otherwise people go on too long). If one person is remote, everyone should connect to the video call separately and ensure sound quality is good. If someone's late without notice / rescheduling it, start without them. Listen to each other, otherwise there isn't much point. People shouldn't go into too much detail or interject when others are talking. If a discussion needs to happen, finish the standup first, then anyone can stay for the discussion if they want. To sum up, keep it short and efficient.\n\nSchedule a regular chat with each person individually. Give them a chance to highlight successes or issues. This could be related to code, colleagues, your leadership, the company, home life, etc. Listen, empathise. Make sure you're up to speed on the work beforehand; it should be about them, not a status update for you. This is a good time to give feedback but keep it light. Try to give good with the bad. These conversations are really good; you'll be surprised by what comes up or how honest people will be. A lot of the time, the person will point out what they could improve on before you even get to it.\n\n\n### Probably the most difficult part of the job\n\nThe role is people oriented, and people problems are not trivial. Even the toughest bugs are a lot more straight-forward to solve than \"How can I keep this person happy?\" Keeping morale high has to be a focus and part of that is mixing the right people. Each individual person can differ in what drives them, in their skills, weaknesses, experiences, standards, and more. Getting great people in your team is key. Worries about how best to educate and manage fade away and you're left to figure out how best to delegate.\n\nYou will have opinionated team members and you'll have to drag words out of others. Developers tend to provide solutions and opinions rather than facts. This can lead to heated discussions. Monitor these. Get to a solution with healthy tension and without damaging relationships.\n\nYou also need to give people space to grow though. It's tempting to solve problems for people but you should step back and let people fail. Failure is part of the learning process. Notice when people are happy to stay in their comfort zone. Encourage them to improve their weak areas and clear their path. Make developers around you better. It's a sign of a great senior developer.\n\nPrepare to have to explain rationales for things. Don't get frustrated that people won't just do what you say. Explain. They'll learn from that. On the other hand, keep an eye out for people who have a problem with authority or taking over others' work / legacy code. There are times where all of us have to do something we don't like and people like this are less likely to improve their attitude in my experience.\n\n\n### A new technical mindset\n\nEven though the role is certainly people oriented, people come and go, what we build remains. You might be used to coming up with elegant solutions to clear problems as a developer, but you will now have to resolve hazy problems with far reaching solutions. Focus on the long term when it comes to a design decision. Is this solution advancing us towards our overall goals? Is it compatible with foreseeable future changes? You don't want to make a decision that makes it more difficult to make changes or add features later. Strongly consider long-term maintainability, architecture, deployment, stability, availability, scalability, and so on. Think about the whole ecosystem of apps, alignment, etc.\n\nIt's important to still be hands-on with code though. Some lessons can only be learned this way. Keep in touch, stay up to date, be respected. Identify patterns over time and keep an eye out for anyone implementing a pattern which'll come back to haunt us. Be careful when dropping the team lead role to play full-time developer on the other hand, other unnoticed issues might bubble up until they are too big to solve quickly.\n\nIn general, I'd promote test-driven development, as well as continuous integration, deployment, and delivery. Check out Steve Smith's [Measuring Continuous Delivery](https://www.youtube.com/watch?v=afEzqDExCTE) talk if you haven't seen it. You should also measure app performance, feature usage, and so on. Don't go overboard but carefully select a few key metrics to begin with. \n\nLet the team influence code style. I absolutely hate arguments over code style, e.g. tabs vs spaces. Discuss as a team and agree, but keep it short. Document the outcome. It shouldn't be acceptable to argue about it in pull requests; code either matches the code style or not. Plan a separate time to discuss a change to the code style if needed. Where possible, use linting tools which automatically formats code as it's written or pre-commit, e.g. [Prettier](https://prettier.io/).\n\nMonitor gaps in the team and knowledge, fill them. If a new developer joins the team with valuable insights or coding style,  re-align the team / integrate that.\n\nIt's easy to get sucked into the current work and dragged into the weeds but try to stay ahead of the team. Look at what's coming down the line, find problems, solutions, prototype. Steer the technical direction based on these discoveries. This, like everything else, is a lot of easier once you have great team members which you trust.\n\n\n### Transition and expectations\n\nThe transition is not easy. It's a lonely role and your context will be unique. Even others in the same role in different teams in the organization will have different values and problems to solve. Relationships will change. There is a change of perspective from working alongside people to managing them while working alongside them.\n\nYou'll find yourself reframing conversations not to offend anyone, more than you'd like. You need to bring positive energy even when you don't feel like it. Expect to have to give a lot of yourself, to facilitate, especially when the problem is unclear or complex. It's a bit lonelier. On the other hand, you get to see the whole picture. You get to step back and have more influence on the success of the company.\n\nTime management is difficult. There are a lot of interruptions and context-switching. Some of these interruptions will be from other teams; everyone else has priorities and everything needs to be done ASAP, but you have to think of your priorities. The person shouting the loudest shouldn't necessarily always get your attention first. \n\nWriting code and dealing with other issues is always going to clash. Deciding to be a tech lead means less coding, unless you work longer hours (but this isn't sustainable). There's less time to focus on a problem as a result and it's hard to measure your own performance. It's just not as tangible. As much as you'd like to shut your door to focus, you must be accessible to your team. You might find yourself coming in early, staying late, or working on the weekend. This again ties into delegating and the imposter syndrome.\n\n\n### What do I know?\n\nI'm no expert and I don't get everything right. I have been leading teams for just a few years, but I have also had a broad range of experiences; all sorts of management styles (good and bad), tiny startups, large corporate companies, and more. My current role is \"product lead\" at [Teamwork](https://www.teamwork.com/) which is like a product manager, project manger, technical lead, and lead developer rolled into one.\n\nThere are far too many people to thank for their hand in my role and this advice. Managers I've had, many authors of books, articles, and speakers. Thank you! If something I said doesn't feel right, that's OK. You can read as much as you like on the topic, but a lot of it comes with experience. Feel it out. Try things, make a few mistakes, learn from them.\n\nI'm always open to improving so please feel free to give feedback on what I've written.\n",unfilteredRenderedBody:'<h2><a id="lessons-learned-leading-teams" class="post-header-anchor" href="#lessons-learned-leading-teams" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Lessons learned leading teams</h2>\n<article-summary><p>I\'ve been thinking about team leading a lot lately. When revisiting advice a friend asked for when transitioning to a team lead position, I decided to flesh it out and put it online. Most of the following will hopefully be helpful to anyone leading a team or any manager, although some will be more relevant to leaders of developers and developers transitioning into leadership roles. If it helps anyone, great. It will be a good reference for me at least. Alright, let\'s get to it.</p>\n</article-summary><h3><a id="delegate-delegate-delegate" class="post-header-anchor" href="#delegate-delegate-delegate" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Delegate, delegate, delegate!</h3>\n<p>I\'ve struggled with this and have seen almost every person in a leadership position struggle with it as well, but trust me, it\'s really worth getting over. If someone can do something 80% as well as you or better, delegate! Focus on the stuff only you can do. Don\'t feel like you have to touch everything and be the best or most active person on the team. You\'re responsible for making sure everyone else does their best and grows.</p>\n<p>If you don\'t delegate enough, people feel like they\'re only doing the boring stuff and they\'ll feel undervalued as a result. They\'ll find somewhere they can have more impact and feel more valued. You\'ll be stressed because everyone is asking you to make a decision. Key decisions will stall as they wait for your call. The team will already have enough dependencies, which you\'re trying to resolve; don\'t become one.</p>\n<p>Always try to find more ways to delegate. Don\'t just give people work to do in small orchestrated pieces. It makes people more reliant on you. They learn less. Although it is hard when you know how to do it and they\'re still learning. Delegate decision making for a particular problem to the right person. People love autonomy. Try to ask yourself if the right people are looking at a problem so the best possible decision can be made. Show people how <em>they</em> can safely spread responsibilities and knowledge.</p>\n<p>Make yourself as redundant in the day-to-day work as possible. Ensure the team has the skills, knowledge, experience to get things done. You don\'t need to have the final say on everything and solve every hard problem. This gives you more time to work on the stuff only you can do.</p>\n<p>On the flip side, as you start to delegate more, you will become less familiar with the actual code and feel like more of an <a href="https://en.wikipedia.org/wiki/Impostor_syndrome" rel="noopener">imposter</a>. Don\'t let this stop you from delegating though.</p>\n<h3><a id="efficiency" class="post-header-anchor" href="#efficiency" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Efficiency</h3>\n<p>Keep the team as efficient as possible. Protect them from distractions. For example, this also includes telling them about potential disruptive process changes being considered and meetings they\'d like to be in but really don\'t need to be.</p>\n<p>Emphasise knowledge sharing. Avoid someone fixing bugs related to X because they implemented X originally. Single points of failure are hard to avoid. People love to own their work. Taking responsibility is good but often leads to one person holding exclusive knowledge of something. Give someone territory and they\'ll likely become defensive.</p>\n<p>Unblock the team, address issues that are holding back the team or individuals; dependencies, external issues like blocking stakeholders, lack of knowledge, etc. Reduce friction. Always look for ways to make your team\'s life easier so they can do their best work. Shield them from company politics, pointless meetings, and other distractions. Resolve disagreements.</p>\n<p>Get the most out of different personalities. Understand what individuals need to perform optimally. Compromise, cultivate a team spirit. Promote continuous integration.</p>\n<p>Determine the type of lead you will be. Don\'t identify yourself or become a title / dependency. This will only limit team members. The title isn\'t an excuse to micro-manage. Don\'t read into the word &quot;lead&quot; too much. People shouldn\'t be at your mercy or at your beck and call. Focus on getting to a point where everyone can learn from each other and get their best possible work done.</p>\n<p>Keep an ear to the ground. Too much talk within the team might indicate a lack of productivity, decision making, or that they\'re enjoying themselves too much. If it\'s a bit too quiet, it might mean everyone is head down and there\'ll be problems once their code is integrated, or that people might not be getting along.</p>\n<h3><a id="communication" class="post-header-anchor" href="#communication" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Communication</h3>\n<p>You have to be an excellent communicator. There\'s no room for negotiation here. Be assertive, be clear, and be honest.</p>\n<p>Being specific and confident in what you\'re saying about a task is critical. You can\'t rely on intention. People will do exactly as you say. Discover and minimize misunderstandings early. The same goes for your interactions with stakeholders; play your part and remove ambiguity when it appears.</p>\n<p>This is a simple one but when messaging a team member about having a chat with them, give them a rough idea what it\'s about in advance.</p>\n<figure>\n          <a href="/images/blog-content/lessons-learned-leading-teams/graph.png"><img src="/images/blog-content/lessons-learned-leading-teams/graph.png" alt=""/></a>\n          <figcaption><p>A beautiful line graph showing that the &quot;importance of giving heads up&quot; is inversely proportional to &quot;frequency of contact&quot;. Watch out for &quot;The \'OMG I\'m getting fired\' zone&quot; if contact is minimal.</p>\n</figcaption>\n        </figure><p>Disagreements aren\'t criticism. They\'re healthy as long as they don\'t block progression or damage relationships. Don\'t be mean, but say what you mean, early. Make sure everyone has a fair say. There\'s always a better way but what is the most feasible solution right now? Try to get agreement from everyone and ensure everyone understands the outcome.</p>\n<p>Encourage your team to challenge you, to tell you when you\'re wrong, but respectfully. The last thing you want is for them to be afraid to point out when you\'re wrong. Be your own harshest critic. Be honest when you don\'t know X and don\'t be afraid to admit you\'re learning. <em>Everyone is</em>.</p>\n<p>You need to be serious and firm when giving criticism. If you\'re too lenient, it\'s harder to say something isn\'t acceptable later. The culture and standards of the team come from what you tolerate and promote.</p>\n<blockquote cite="https://twitter.com/notch/status/1055887409035034624 "><p>We just need to stop letting people to trick us into thinking we actually CARE about the arguments we have over things we haven\'t researched. If we did, we\'d research.</p>\n<footer>&mdash;<cite><p>Notch</p>\n</cite></footer></blockquote><p>Don\'t spend time debating that which doesn\'t warrant it. Once you have good people, trust that they\'ve looked into what they\'re talking about, that they\'ve looked at the details. Don\'t second guess the small stuff. When there\'s a disagreement over a decision, be honest about how much you care about the outcome. If it\'s 2/10 for you but 9/10 for them, let it go. This is related to having a personal attachment to details (&quot;perfectionism&quot;) but I\'ll leave that for another post.</p>\n<h3><a id="represent-and-protect" class="post-header-anchor" href="#represent-and-protect" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Represent and protect</h3>\n<p>Represent your team. Voice their concerns and share updates with them. Celebrate and recognise their hard work and achievements. Protect your team. Be an umbrella. Take negative criticism for them and only pass it down if they really need to hear it. Having anyone as a lead makes the team stronger, no matter who it is. Someone can stand up for the team and make things happen. Under promise, over deliver.</p>\n<p>You now represent &quot;the man&quot;. Understand top-down decisions; you need to in order to believe in them, and to then make others believe in them. Support your superiors. If they don\'t understand the challenges you\'re facing, that\'s your fault. Give them more situational awareness. Support them. Make them look good.</p>\n<p>Manage stakeholder expectations as well as internal perspectives of your team and their work. Criticise team members if they\'re less than nice with other teams, for example. They\'re representing the team. Larger organisations can be tough as not everyone will respect the work being done by your team. Avoid pointing fingers or blaming other teams. I could benefit from being more savvy when it comes to politics but that\'s not what I\'m about. You\'re all on the same side, act like it. When listing our values at <a href="http://teamwork.com/" rel="noopener">Teamwork</a>, the following is often cited as a good example:</p>\n<blockquote><p>Let the other person save face, even if they are clearly wrong</p>\n</blockquote><h3><a id="process" class="post-header-anchor" href="#process" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Process</h3>\n<p>Don\'t go overboard on process. Start small, experiment, keep what works. Team members\' past experiences and opinions will vary a lot. Make it clear that the process is evolving and can always be improved with a suggestion from a team member. Each team is different, you\'ll discover the best processes. Set as few rules as possible and strive for minimal viable bureaucracy or process.</p>\n<blockquote cite="https://twitter.com/tastapod/status/1059384774131965952 "><p>You shouldn’t start with the Spotify model. Spotify didn’t start with the Spotify model. You shouldn’t start with Scrum. Scrum didn’t start with Scrum. You should start by identifying what you want to improve, and introduce constraints that force the improvement.</p>\n<footer>&mdash;<cite><p>Dan North</p>\n</cite></footer></blockquote><p>I\'d recommend doing daily standups. They\'re really good when done properly. It should ideally be at the same time everyday, as early as possible. If everyone is in the same location, actually stand (otherwise people go on too long). If one person is remote, everyone should connect to the video call separately and ensure sound quality is good. If someone\'s late without notice / rescheduling it, start without them. Listen to each other, otherwise there isn\'t much point. People shouldn\'t go into too much detail or interject when others are talking. If a discussion needs to happen, finish the standup first, then anyone can stay for the discussion if they want. To sum up, keep it short and efficient.</p>\n<p>Schedule a regular chat with each person individually. Give them a chance to highlight successes or issues. This could be related to code, colleagues, your leadership, the company, home life, etc. Listen, empathise. Make sure you\'re up to speed on the work beforehand; it should be about them, not a status update for you. This is a good time to give feedback but keep it light. Try to give good with the bad. These conversations are really good; you\'ll be surprised by what comes up or how honest people will be. A lot of the time, the person will point out what they could improve on before you even get to it.</p>\n<h3><a id="probably-the-most-difficult-part-of-the-job" class="post-header-anchor" href="#probably-the-most-difficult-part-of-the-job" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Probably the most difficult part of the job</h3>\n<p>The role is people oriented, and people problems are not trivial. Even the toughest bugs are a lot more straight-forward to solve than &quot;How can I keep this person happy?&quot; Keeping morale high has to be a focus and part of that is mixing the right people. Each individual person can differ in what drives them, in their skills, weaknesses, experiences, standards, and more. Getting great people in your team is key. Worries about how best to educate and manage fade away and you\'re left to figure out how best to delegate.</p>\n<p>You will have opinionated team members and you\'ll have to drag words out of others. Developers tend to provide solutions and opinions rather than facts. This can lead to heated discussions. Monitor these. Get to a solution with healthy tension and without damaging relationships.</p>\n<p>You also need to give people space to grow though. It\'s tempting to solve problems for people but you should step back and let people fail. Failure is part of the learning process. Notice when people are happy to stay in their comfort zone. Encourage them to improve their weak areas and clear their path. Make developers around you better. It\'s a sign of a great senior developer.</p>\n<p>Prepare to have to explain rationales for things. Don\'t get frustrated that people won\'t just do what you say. Explain. They\'ll learn from that. On the other hand, keep an eye out for people who have a problem with authority or taking over others\' work / legacy code. There are times where all of us have to do something we don\'t like and people like this are less likely to improve their attitude in my experience.</p>\n<h3><a id="a-new-technical-mindset" class="post-header-anchor" href="#a-new-technical-mindset" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>A new technical mindset</h3>\n<p>Even though the role is certainly people oriented, people come and go, what we build remains. You might be used to coming up with elegant solutions to clear problems as a developer, but you will now have to resolve hazy problems with far reaching solutions. Focus on the long term when it comes to a design decision. Is this solution advancing us towards our overall goals? Is it compatible with foreseeable future changes? You don\'t want to make a decision that makes it more difficult to make changes or add features later. Strongly consider long-term maintainability, architecture, deployment, stability, availability, scalability, and so on. Think about the whole ecosystem of apps, alignment, etc.</p>\n<p>It\'s important to still be hands-on with code though. Some lessons can only be learned this way. Keep in touch, stay up to date, be respected. Identify patterns over time and keep an eye out for anyone implementing a pattern which\'ll come back to haunt us. Be careful when dropping the team lead role to play full-time developer on the other hand, other unnoticed issues might bubble up until they are too big to solve quickly.</p>\n<p>In general, I\'d promote test-driven development, as well as continuous integration, deployment, and delivery. Check out Steve Smith\'s <a href="https://www.youtube.com/watch?v=afEzqDExCTE" rel="noopener">Measuring Continuous Delivery</a> talk if you haven\'t seen it. You should also measure app performance, feature usage, and so on. Don\'t go overboard but carefully select a few key metrics to begin with.</p>\n<p>Let the team influence code style. I absolutely hate arguments over code style, e.g. tabs vs spaces. Discuss as a team and agree, but keep it short. Document the outcome. It shouldn\'t be acceptable to argue about it in pull requests; code either matches the code style or not. Plan a separate time to discuss a change to the code style if needed. Where possible, use linting tools which automatically formats code as it\'s written or pre-commit, e.g. <a href="https://prettier.io/" rel="noopener">Prettier</a>.</p>\n<p>Monitor gaps in the team and knowledge, fill them. If a new developer joins the team with valuable insights or coding style,  re-align the team / integrate that.</p>\n<p>It\'s easy to get sucked into the current work and dragged into the weeds but try to stay ahead of the team. Look at what\'s coming down the line, find problems, solutions, prototype. Steer the technical direction based on these discoveries. This, like everything else, is a lot of easier once you have great team members which you trust.</p>\n<h3><a id="transition-and-expectations" class="post-header-anchor" href="#transition-and-expectations" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Transition and expectations</h3>\n<p>The transition is not easy. It\'s a lonely role and your context will be unique. Even others in the same role in different teams in the organization will have different values and problems to solve. Relationships will change. There is a change of perspective from working alongside people to managing them while working alongside them.</p>\n<p>You\'ll find yourself reframing conversations not to offend anyone, more than you\'d like. You need to bring positive energy even when you don\'t feel like it. Expect to have to give a lot of yourself, to facilitate, especially when the problem is unclear or complex. It\'s a bit lonelier. On the other hand, you get to see the whole picture. You get to step back and have more influence on the success of the company.</p>\n<p>Time management is difficult. There are a lot of interruptions and context-switching. Some of these interruptions will be from other teams; everyone else has priorities and everything needs to be done ASAP, but you have to think of your priorities. The person shouting the loudest shouldn\'t necessarily always get your attention first.</p>\n<p>Writing code and dealing with other issues is always going to clash. Deciding to be a tech lead means less coding, unless you work longer hours (but this isn\'t sustainable). There\'s less time to focus on a problem as a result and it\'s hard to measure your own performance. It\'s just not as tangible. As much as you\'d like to shut your door to focus, you must be accessible to your team. You might find yourself coming in early, staying late, or working on the weekend. This again ties into delegating and the imposter syndrome.</p>\n<h3><a id="what-do-i-know" class="post-header-anchor" href="#what-do-i-know" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What do I know?</h3>\n<p>I\'m no expert and I don\'t get everything right. I have been leading teams for just a few years, but I have also had a broad range of experiences; all sorts of management styles (good and bad), tiny startups, large corporate companies, and more. My current role is &quot;product lead&quot; at <a href="https://www.teamwork.com/" rel="noopener">Teamwork</a> which is like a product manager, project manger, technical lead, and lead developer rolled into one.</p>\n<p>There are far too many people to thank for their hand in my role and this advice. Managers I\'ve had, many authors of books, articles, and speakers. Thank you! If something I said doesn\'t feel right, that\'s OK. You can read as much as you like on the topic, but a lot of it comes with experience. Feel it out. Try things, make a few mistakes, learn from them.</p>\n<p>I\'m always open to improving so please feel free to give feedback on what I\'ve written.</p>\n',attributes:{date:"2018-11-14T00:00:00.000Z",tags:[{id:"leadership",name:"leadership"},{id:"management",name:"management"},{id:"teams",name:"teams"},{id:"development",name:"development"},{id:"lead",name:"lead"},{id:"leading",name:"leading"},{id:"managing",name:"managing"},{id:"manager",name:"manager"},{id:"programming",name:"programming"},{id:"delegating",name:"delegating"},{id:"efficiency",name:"efficiency"},{id:"communication",name:"communication"},{id:"people",name:"people"},{id:"technical",name:"technical"},{id:"transition",name:"transition"},{id:"job",name:"job"},{id:"career",name:"career"},{id:"growth",name:"growth"},{id:"product-management",name:"product management"},{id:"project-management",name:"project management"},{id:"product-lead",name:"product lead"},{id:"technical-lead",name:"technical lead"},{id:"lead-developer",name:"lead developer"}],title:"Lessons learned leading teams",updated_at:"2019-05-22T08:26:30.905Z",photo:"/images/blog-content/lessons-learned-leading-teams/graph.png"},title:"Lessons learned leading teams",renderedSummary:"<p>I've been thinking about team leading a lot lately. When revisiting advice a friend asked for when transitioning to a team lead position, I decided to flesh it out and put it online. Most of the following will hopefully be helpful to anyone leading a team or any manager, although some will be more relevant to leaders of developers and developers transitioning into leadership roles. If it helps anyone, great. It will be a good reference for me at least. Alright, let's get to it.</p>\n",rendered:'<h2><a id="lessons-learned-leading-teams" class="post-header-anchor" href="#lessons-learned-leading-teams" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Lessons learned leading teams</h2>\n<p>I\'ve been thinking about team leading a lot lately. When revisiting advice a friend asked for when transitioning to a team lead position, I decided to flesh it out and put it online. Most of the following will hopefully be helpful to anyone leading a team or any manager, although some will be more relevant to leaders of developers and developers transitioning into leadership roles. If it helps anyone, great. It will be a good reference for me at least. Alright, let\'s get to it.</p>\n<h3><a id="delegate-delegate-delegate" class="post-header-anchor" href="#delegate-delegate-delegate" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Delegate, delegate, delegate!</h3>\n<p>I\'ve struggled with this and have seen almost every person in a leadership position struggle with it as well, but trust me, it\'s really worth getting over. If someone can do something 80% as well as you or better, delegate! Focus on the stuff only you can do. Don\'t feel like you have to touch everything and be the best or most active person on the team. You\'re responsible for making sure everyone else does their best and grows.</p>\n<p>If you don\'t delegate enough, people feel like they\'re only doing the boring stuff and they\'ll feel undervalued as a result. They\'ll find somewhere they can have more impact and feel more valued. You\'ll be stressed because everyone is asking you to make a decision. Key decisions will stall as they wait for your call. The team will already have enough dependencies, which you\'re trying to resolve; don\'t become one.</p>\n<p>Always try to find more ways to delegate. Don\'t just give people work to do in small orchestrated pieces. It makes people more reliant on you. They learn less. Although it is hard when you know how to do it and they\'re still learning. Delegate decision making for a particular problem to the right person. People love autonomy. Try to ask yourself if the right people are looking at a problem so the best possible decision can be made. Show people how <em>they</em> can safely spread responsibilities and knowledge.</p>\n<p>Make yourself as redundant in the day-to-day work as possible. Ensure the team has the skills, knowledge, experience to get things done. You don\'t need to have the final say on everything and solve every hard problem. This gives you more time to work on the stuff only you can do.</p>\n<p>On the flip side, as you start to delegate more, you will become less familiar with the actual code and feel like more of an <a href="https://en.wikipedia.org/wiki/Impostor_syndrome" rel="noopener">imposter</a>. Don\'t let this stop you from delegating though.</p>\n<h3><a id="efficiency" class="post-header-anchor" href="#efficiency" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Efficiency</h3>\n<p>Keep the team as efficient as possible. Protect them from distractions. For example, this also includes telling them about potential disruptive process changes being considered and meetings they\'d like to be in but really don\'t need to be.</p>\n<p>Emphasise knowledge sharing. Avoid someone fixing bugs related to X because they implemented X originally. Single points of failure are hard to avoid. People love to own their work. Taking responsibility is good but often leads to one person holding exclusive knowledge of something. Give someone territory and they\'ll likely become defensive.</p>\n<p>Unblock the team, address issues that are holding back the team or individuals; dependencies, external issues like blocking stakeholders, lack of knowledge, etc. Reduce friction. Always look for ways to make your team\'s life easier so they can do their best work. Shield them from company politics, pointless meetings, and other distractions. Resolve disagreements.</p>\n<p>Get the most out of different personalities. Understand what individuals need to perform optimally. Compromise, cultivate a team spirit. Promote continuous integration.</p>\n<p>Determine the type of lead you will be. Don\'t identify yourself or become a title / dependency. This will only limit team members. The title isn\'t an excuse to micro-manage. Don\'t read into the word &quot;lead&quot; too much. People shouldn\'t be at your mercy or at your beck and call. Focus on getting to a point where everyone can learn from each other and get their best possible work done.</p>\n<p>Keep an ear to the ground. Too much talk within the team might indicate a lack of productivity, decision making, or that they\'re enjoying themselves too much. If it\'s a bit too quiet, it might mean everyone is head down and there\'ll be problems once their code is integrated, or that people might not be getting along.</p>\n<h3><a id="communication" class="post-header-anchor" href="#communication" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Communication</h3>\n<p>You have to be an excellent communicator. There\'s no room for negotiation here. Be assertive, be clear, and be honest.</p>\n<p>Being specific and confident in what you\'re saying about a task is critical. You can\'t rely on intention. People will do exactly as you say. Discover and minimize misunderstandings early. The same goes for your interactions with stakeholders; play your part and remove ambiguity when it appears.</p>\n<p>This is a simple one but when messaging a team member about having a chat with them, give them a rough idea what it\'s about in advance.</p>\n<figure>\n          <a href="/images/blog-content/lessons-learned-leading-teams/graph.png"><img src="/images/blog-content/lessons-learned-leading-teams/graph.png" alt=""/></a>\n          <figcaption><p>A beautiful line graph showing that the &quot;importance of giving heads up&quot; is inversely proportional to &quot;frequency of contact&quot;. Watch out for &quot;The \'OMG I\'m getting fired\' zone&quot; if contact is minimal.</p>\n</figcaption>\n        </figure><p>Disagreements aren\'t criticism. They\'re healthy as long as they don\'t block progression or damage relationships. Don\'t be mean, but say what you mean, early. Make sure everyone has a fair say. There\'s always a better way but what is the most feasible solution right now? Try to get agreement from everyone and ensure everyone understands the outcome.</p>\n<p>Encourage your team to challenge you, to tell you when you\'re wrong, but respectfully. The last thing you want is for them to be afraid to point out when you\'re wrong. Be your own harshest critic. Be honest when you don\'t know X and don\'t be afraid to admit you\'re learning. <em>Everyone is</em>.</p>\n<p>You need to be serious and firm when giving criticism. If you\'re too lenient, it\'s harder to say something isn\'t acceptable later. The culture and standards of the team come from what you tolerate and promote.</p>\n<blockquote cite="https://twitter.com/notch/status/1055887409035034624 "><p>We just need to stop letting people to trick us into thinking we actually CARE about the arguments we have over things we haven\'t researched. If we did, we\'d research.</p>\n<footer>&mdash;<cite><p>Notch</p>\n</cite></footer></blockquote><p>Don\'t spend time debating that which doesn\'t warrant it. Once you have good people, trust that they\'ve looked into what they\'re talking about, that they\'ve looked at the details. Don\'t second guess the small stuff. When there\'s a disagreement over a decision, be honest about how much you care about the outcome. If it\'s 2/10 for you but 9/10 for them, let it go. This is related to having a personal attachment to details (&quot;perfectionism&quot;) but I\'ll leave that for another post.</p>\n<h3><a id="represent-and-protect" class="post-header-anchor" href="#represent-and-protect" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Represent and protect</h3>\n<p>Represent your team. Voice their concerns and share updates with them. Celebrate and recognise their hard work and achievements. Protect your team. Be an umbrella. Take negative criticism for them and only pass it down if they really need to hear it. Having anyone as a lead makes the team stronger, no matter who it is. Someone can stand up for the team and make things happen. Under promise, over deliver.</p>\n<p>You now represent &quot;the man&quot;. Understand top-down decisions; you need to in order to believe in them, and to then make others believe in them. Support your superiors. If they don\'t understand the challenges you\'re facing, that\'s your fault. Give them more situational awareness. Support them. Make them look good.</p>\n<p>Manage stakeholder expectations as well as internal perspectives of your team and their work. Criticise team members if they\'re less than nice with other teams, for example. They\'re representing the team. Larger organisations can be tough as not everyone will respect the work being done by your team. Avoid pointing fingers or blaming other teams. I could benefit from being more savvy when it comes to politics but that\'s not what I\'m about. You\'re all on the same side, act like it. When listing our values at <a href="http://teamwork.com/" rel="noopener">Teamwork</a>, the following is often cited as a good example:</p>\n<blockquote><p>Let the other person save face, even if they are clearly wrong</p>\n</blockquote><h3><a id="process" class="post-header-anchor" href="#process" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Process</h3>\n<p>Don\'t go overboard on process. Start small, experiment, keep what works. Team members\' past experiences and opinions will vary a lot. Make it clear that the process is evolving and can always be improved with a suggestion from a team member. Each team is different, you\'ll discover the best processes. Set as few rules as possible and strive for minimal viable bureaucracy or process.</p>\n<blockquote cite="https://twitter.com/tastapod/status/1059384774131965952 "><p>You shouldn’t start with the Spotify model. Spotify didn’t start with the Spotify model. You shouldn’t start with Scrum. Scrum didn’t start with Scrum. You should start by identifying what you want to improve, and introduce constraints that force the improvement.</p>\n<footer>&mdash;<cite><p>Dan North</p>\n</cite></footer></blockquote><p>I\'d recommend doing daily standups. They\'re really good when done properly. It should ideally be at the same time everyday, as early as possible. If everyone is in the same location, actually stand (otherwise people go on too long). If one person is remote, everyone should connect to the video call separately and ensure sound quality is good. If someone\'s late without notice / rescheduling it, start without them. Listen to each other, otherwise there isn\'t much point. People shouldn\'t go into too much detail or interject when others are talking. If a discussion needs to happen, finish the standup first, then anyone can stay for the discussion if they want. To sum up, keep it short and efficient.</p>\n<p>Schedule a regular chat with each person individually. Give them a chance to highlight successes or issues. This could be related to code, colleagues, your leadership, the company, home life, etc. Listen, empathise. Make sure you\'re up to speed on the work beforehand; it should be about them, not a status update for you. This is a good time to give feedback but keep it light. Try to give good with the bad. These conversations are really good; you\'ll be surprised by what comes up or how honest people will be. A lot of the time, the person will point out what they could improve on before you even get to it.</p>\n<h3><a id="probably-the-most-difficult-part-of-the-job" class="post-header-anchor" href="#probably-the-most-difficult-part-of-the-job" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Probably the most difficult part of the job</h3>\n<p>The role is people oriented, and people problems are not trivial. Even the toughest bugs are a lot more straight-forward to solve than &quot;How can I keep this person happy?&quot; Keeping morale high has to be a focus and part of that is mixing the right people. Each individual person can differ in what drives them, in their skills, weaknesses, experiences, standards, and more. Getting great people in your team is key. Worries about how best to educate and manage fade away and you\'re left to figure out how best to delegate.</p>\n<p>You will have opinionated team members and you\'ll have to drag words out of others. Developers tend to provide solutions and opinions rather than facts. This can lead to heated discussions. Monitor these. Get to a solution with healthy tension and without damaging relationships.</p>\n<p>You also need to give people space to grow though. It\'s tempting to solve problems for people but you should step back and let people fail. Failure is part of the learning process. Notice when people are happy to stay in their comfort zone. Encourage them to improve their weak areas and clear their path. Make developers around you better. It\'s a sign of a great senior developer.</p>\n<p>Prepare to have to explain rationales for things. Don\'t get frustrated that people won\'t just do what you say. Explain. They\'ll learn from that. On the other hand, keep an eye out for people who have a problem with authority or taking over others\' work / legacy code. There are times where all of us have to do something we don\'t like and people like this are less likely to improve their attitude in my experience.</p>\n<h3><a id="a-new-technical-mindset" class="post-header-anchor" href="#a-new-technical-mindset" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>A new technical mindset</h3>\n<p>Even though the role is certainly people oriented, people come and go, what we build remains. You might be used to coming up with elegant solutions to clear problems as a developer, but you will now have to resolve hazy problems with far reaching solutions. Focus on the long term when it comes to a design decision. Is this solution advancing us towards our overall goals? Is it compatible with foreseeable future changes? You don\'t want to make a decision that makes it more difficult to make changes or add features later. Strongly consider long-term maintainability, architecture, deployment, stability, availability, scalability, and so on. Think about the whole ecosystem of apps, alignment, etc.</p>\n<p>It\'s important to still be hands-on with code though. Some lessons can only be learned this way. Keep in touch, stay up to date, be respected. Identify patterns over time and keep an eye out for anyone implementing a pattern which\'ll come back to haunt us. Be careful when dropping the team lead role to play full-time developer on the other hand, other unnoticed issues might bubble up until they are too big to solve quickly.</p>\n<p>In general, I\'d promote test-driven development, as well as continuous integration, deployment, and delivery. Check out Steve Smith\'s <a href="https://www.youtube.com/watch?v=afEzqDExCTE" rel="noopener">Measuring Continuous Delivery</a> talk if you haven\'t seen it. You should also measure app performance, feature usage, and so on. Don\'t go overboard but carefully select a few key metrics to begin with.</p>\n<p>Let the team influence code style. I absolutely hate arguments over code style, e.g. tabs vs spaces. Discuss as a team and agree, but keep it short. Document the outcome. It shouldn\'t be acceptable to argue about it in pull requests; code either matches the code style or not. Plan a separate time to discuss a change to the code style if needed. Where possible, use linting tools which automatically formats code as it\'s written or pre-commit, e.g. <a href="https://prettier.io/" rel="noopener">Prettier</a>.</p>\n<p>Monitor gaps in the team and knowledge, fill them. If a new developer joins the team with valuable insights or coding style,  re-align the team / integrate that.</p>\n<p>It\'s easy to get sucked into the current work and dragged into the weeds but try to stay ahead of the team. Look at what\'s coming down the line, find problems, solutions, prototype. Steer the technical direction based on these discoveries. This, like everything else, is a lot of easier once you have great team members which you trust.</p>\n<h3><a id="transition-and-expectations" class="post-header-anchor" href="#transition-and-expectations" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Transition and expectations</h3>\n<p>The transition is not easy. It\'s a lonely role and your context will be unique. Even others in the same role in different teams in the organization will have different values and problems to solve. Relationships will change. There is a change of perspective from working alongside people to managing them while working alongside them.</p>\n<p>You\'ll find yourself reframing conversations not to offend anyone, more than you\'d like. You need to bring positive energy even when you don\'t feel like it. Expect to have to give a lot of yourself, to facilitate, especially when the problem is unclear or complex. It\'s a bit lonelier. On the other hand, you get to see the whole picture. You get to step back and have more influence on the success of the company.</p>\n<p>Time management is difficult. There are a lot of interruptions and context-switching. Some of these interruptions will be from other teams; everyone else has priorities and everything needs to be done ASAP, but you have to think of your priorities. The person shouting the loudest shouldn\'t necessarily always get your attention first.</p>\n<p>Writing code and dealing with other issues is always going to clash. Deciding to be a tech lead means less coding, unless you work longer hours (but this isn\'t sustainable). There\'s less time to focus on a problem as a result and it\'s hard to measure your own performance. It\'s just not as tangible. As much as you\'d like to shut your door to focus, you must be accessible to your team. You might find yourself coming in early, staying late, or working on the weekend. This again ties into delegating and the imposter syndrome.</p>\n<h3><a id="what-do-i-know" class="post-header-anchor" href="#what-do-i-know" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>What do I know?</h3>\n<p>I\'m no expert and I don\'t get everything right. I have been leading teams for just a few years, but I have also had a broad range of experiences; all sorts of management styles (good and bad), tiny startups, large corporate companies, and more. My current role is &quot;product lead&quot; at <a href="https://www.teamwork.com/" rel="noopener">Teamwork</a> which is like a product manager, project manger, technical lead, and lead developer rolled into one.</p>\n<p>There are far too many people to thank for their hand in my role and this advice. Managers I\'ve had, many authors of books, articles, and speakers. Thank you! If something I said doesn\'t feel right, that\'s OK. You can read as much as you like on the topic, but a lot of it comes with experience. Feel it out. Try things, make a few mistakes, learn from them.</p>\n<p>I\'m always open to improving so please feel free to give feedback on what I\'ve written.</p>\n',summary:"I've been thinking about team leading a lot lately. When revisiting advice a friend asked for when transitioning to a team lead position, I decided to flesh it out and put it online. Most of the following will hopefully be helpful to anyone leading a team or any manager, although some will be more relevant to leaders of developers and developers transitioning into leadership roles. If it helps anyone, great. It will be a good reference for me at least. Alright, let's get to it.\n",photo:"/images/blog-content/lessons-learned-leading-teams/graph.png",keywords:["leadership","management","teams","development","lead","leading","managing","manager","programming","delegating","efficiency","communication","people","technical","transition","job","career","growth","product management","project management","product lead","technical lead","lead developer"],published_at:"2018-11-14T00:00:00.000Z",updated_at:"2019-05-22T08:26:30.905Z",year:2018,month:11,day:15,relevanceScore:.75},{id:"serverless-crash-reporting-for-electron-apps",slug:"serverless-crash-reporting-for-electron-apps",highlightedLanguages:["javascript"],source:"---\ndate: 2016-11-22\noriginal:\n  blogLink: https://engineroom.teamwork.com\n  blogName: Teamwork's Engine Room\n  url: https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a\ntags:\n  - serverless\n  - electron\n  - javascript\n  - aws\n  - development\n---\n\n## Serverless crash reporting for Electron apps\n\n[![](https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png)](https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png)\n\n\n:::summary\n\nThe term “serverless” has been trendy for a while now. In this post, I’m going to share my experience dabbling with serverless architecture, specifically for handling crash reports from [Electron](http://electron.atom.io/) apps.\n\n:::\n\n### The conference\n\nI attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like [NodeConf EU](http://www.nodeconf.eu/). A few others were slightly disappointing, in that I expected to learn more. If you’re unlucky, some conferences can feel a little like a recap of the articles and books you’ve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever [ServerlessConf](http://serverlessconf.io/).\n\nI bought a [Udemy](https://www.udemy.com/) course on [AWS Lambda](https://aws.amazon.com/lambda/) during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does “serverless” even mean? I’m not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless “function”) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular [S3](https://aws.amazon.com/s3/) bucket.\n\n\n[![](https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png)](https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png)\n\nSo you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an [EC2](https://aws.amazon.com/ec2/) instance where you’ll pay even if it’s sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1–300 seconds). What’s great as well is that Lambda will completely handle scaling for you.\n\nThe conference was good, especially for one so cheap (even though I’d have paid for some air conditioning :/). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn’t agree on what “serverless” meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that “serverless” is really about “functions as a unit of deployment” and everything else is secondary. It’s up to you how you use it.\n\nMost of the talks involved AWS and there were a lot of jokes at [API Gateway](https://aws.amazon.com/api-gateway/)’s expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting [talk](http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development) on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like [Firebase](https://firebase.google.com/), [Auth0](https://auth0.com/), [Algolia](https://www.algolia.com/), [Netlify](https://www.netlify.com/), [Webtask.io](https://webtask.io/), and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don’t mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.\n\nOverall, I didn’t learn _that_ much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.\n\n### The crash reporter\n\nWe’re currently rewriting our desktop apps to be based on Electron rather than [NW.js](http://nwjs.io/). I’m sure this is going to be the first of many posts on that so I won’t go into too much detail here. I recently wrote a book on Electron called [Developing an Electron Edge](http://shop.oreilly.com/product/9781939902344.do) and while proofreading it, a nice serverless use case struck me; serverless crash reporting.\n\nSure, we report runtime errors to [Sentry](https://sentry.io/teamwork/) when they occur in [Teamwork Chat](https://teamwork.com/chat), but what if the app crashes entirely? Well, we’re in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron’s [`crash-reporter`](http://electron.atom.io/docs/api/crash-reporter/) module in your main and renderer process(es), it will send a POST request to the URL you've supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.\n\n```javascript\nconst { crashReporter } = require('electron');\n\ncrashReporter.start({\n productName: 'YourAppName;',\n companyName: 'YourCompany;',\n submitURL: 'https://your-domain.com/url-to-submit&amp',\n autoSubmit: true\n});\n```\n\nThat’s all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.\n\n```javascript\nconst { app, crashReporter } = require('electron’);\n\napp.on('ready’, () => {\n  crashReporter.start({\n    productName: 'YourAppName’,\n    companyName: 'YourCompany',\n    submitURL: 'https://your-domain.com/url-to-submit',autoSubmit: true\n  });\n  setTimeout(() => {\n  process.crash()\n  }, 3000);\n})\n```\n\n### The serverless crash reporter\n\nSo how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don’t want a whole server there running and waiting for crash reports. Ideally you wouldn’t have too many of these and therefore using Lambda should be very cheap.\n\nIt would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;\n\n*   Search.\n*   Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.\n*   New (Electron) desktop apps.\n*   New (native) mobile apps.\n\nExpect a few posts on those topics.\n\nAnyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.\n\nThe function\n\nI started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in [CoffeeScript at Teamwork](https://adamlynch.com/coffeescript-at-teamwork/) but this will only be a few lines long, what’s the harm in a little ES6?\n\nI quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with [express](http://expressjs.com/), and called my function whenever it received a POST.\n\n```javascript\nravenClient = new raven.Client(config.sentryDsn, {\n release: options._version\n});\n```\n\nWhen instantiating [Raven](https://github.com/getsentry/raven-node) (Sentry’s Node.js client module), it’s important to note that I’m passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.\n\nAnother thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don’t need to clean up that variable, that callback won’t be called again, etc.\n\nNow I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I’m not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.\n\nThe Lambda function\n\nEven though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn’t expect Lambda to be installing modules from npm. I assumed all I’d need to do is bundle them up into a ZIP or something like that for Lambda to use.\n\nIt wasn’t so easy in reality. Gordon stepped in to help out but long story short… it’s not possible to do what I had planned to do with Lambda; it doesn’t support file uploads.\n\nA few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I’d have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That’s back to the original problem though; if I went with that, there’s no point in using Lambda at all.\n\nAround the same time, I started investigating the [Serverless Framework](https://serverless.com/). It looked interesting. It’s a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there’s a company behind it but a lot of it is [open-sourced](https://github.com/serverless/serverless), I think.\n\nMaybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which _does_ support POSTing of files. I [posted](http://forum.serverless.com/t/no-support-for-posting-files/307) in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.\n\nThe webtask\n\nDisappointed, I almost gave up until I remembered Webtask.io. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0\\. A quick look at their site got my hopes up again. There was even a _free_ plan which limited us to one execution per second, which was fine by me as I wouldn’t expect there to be many crash reports.\n\nBased on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a “webtask” now. After spending some time with the site, I’d say it’s OK. Some things are hard to get to, but I’m told there is a dashboard in the works.\n\nI had a few little hiccups with their [wt-cli](https://www.npmjs.com/package/wt-cli) CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module’s function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.\n\nWebtask.io has some pre-installed npm modules but if you use anything outside of those, you’ll need to bundle them into your webtask. To do this, you’ll need their another module; [webtask-bundle](https://www.npmjs.com/package/webtask-bundle). So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle — output b.js a.js &amp;&amp; wt create b.js — name a.\n\nThe bundler uses [Webpack](https://webpack.github.io/) underneath so all it’s doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn’t really look into it. I just used [bluebird](http://bluebirdjs.com/docs/getting-started.html) for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know Webtask.io have. I don’t really mind since my script was still far below the 100KB webtask weight limit.\n\nRunning the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it’s a bit hard to find; there is pretty much no way to navigate to it from the site. It’s handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won’t even start like mine wouldn’t.\n\nSide note: there isn’t any real consensus on the best way to work with webtasks. Support for [local debugging](https://github.com/auth0/wt-cli/pull/89) was added recently though.\n\nOnce I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn’t like that the dump file Electron is sending is 560KB, which shouldn’t be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.\n\nOne thing I should point out is the Webtask.io has a [Slack channel](https://webtask-chat.slack.com/) where you can receive some much appreciated support. It was pointed out to me there that Webtask.io actually supports [multiple function signatures](https://webtask.io/docs/model) and I should try one of the other options; specifically the one that uses express.\n\nOnce I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.\n\n```javascript\nmodule.exports = function(context, req, res) {\n  res.writeHead(200, {\n  'Content-Type': 'text/html '\n  });\n  res.end('<h1>Hello, world!</h1>');\n}\n```\n\nNote: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.\n\nOK, so I got it working. Finally. Here is my webtask:\n\n```javascript\n'use strict';\nconst fs = require('fs');\nconst path = require('path');\nconst formidable = require('formidable');\nconst raven = require('raven');\nconst aws = require('aws-sdk');\nconst Promise = require('bluebird');\nconst config = {\n  sentryDsn: 'TODO',\n  s3: {\n  accessKey: 'TODO',\n  bucket: 'TODO',\n  secretAccessKey: 'TODO'\n  }\n};\n\nvar ravenClient, onError;\n\n// req - request {Object}\n// Returns a Promise which resolves to an {Object} containing {fields} and {files}\nconst parseFormData = (req) => {\n  return new Promise((resolve, reject) => {\n    formidable.IncomingForm().parse(req, (err, fields, files) => {\n      if (err) {\n        return reject(err);\n      }\n      resolve({\n        fields: fields,\n        files: files\n      });\n    });\n  });\n};\n\n// name - {String}\n// contents - {String}\n// Returns a Promise which resolves to a {String} URL\nconst uploadDumpToS3 = (name, contents) => {\n  aws.config.update({\n    accessKeyId: config.s3.accessKey,\n    secretAccessKey: config.s3.secretAccessKey\n  });\n  const s3 = new aws.S3({\n    params: {\n      Bucket: config.s3.bucket\n    }\n  });\n  return new Promise((resolve, reject) => {\n    s3.upload({\n      ACL: 'public-read',\n      Key: name,\n      Body: contents\n    }, (err, data) => {\n      if (err) {\n        return reject(err);\n      }\n      resolve(data.Location);\n    });\n  });\n};\n\n// context - {Object}\n// req - {Object}\n// res - {Object}\n// Returns a Promise\nmodule.exports = (context, req, res) => {\n  onError = (error, options) => {\n    if (!ravenClient) {\n      ravenClient = new raven.Client(config.sentryDsn, {\n        release: options._version\n      });\n    }\n\n    ravenClient.captureException(error, options);\n    res.end('Successfully received crash and sent event to Sentry!');\n  }\n\n  return parseFormData(req)\n    .then(formData => {\n      const payload = {\n        tags: formData.fields,\n        extra: {}\n      };\n      const dump = formData.files['upload_file_minidump'];\n\n      if (dump) {\n        const contents = fs.readFileSync(dump.path).toString('utf8');\n        return uploadDumpToS3(dump.name, contents)\n          .then(url => {\n            payload.extra[dump.name] = url;\n            return payload;\n          });\n      } else {\n        return payload;\n      }\n    })\n    .then((payload) => {\n      return onError(new Error(payload.tags.process_type + ' crash'), payload);\n    })\n    .catch((err) => onError(err, {\n      extra: {\n        context: context\n      }\n    }));\n};\n```\n\nOne thing that’s nice is that any error that occurs in the promise chain will also be logged to Sentry.\n\nNext up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that Webtask.io’s free plan only allows for “30 days webtask lifetime,” whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn’t support custom domains, so it’s not so cheap after all, eh?\n\n### The conclusion\n\nIn the end, I decided we’ll just add an endpoint to our existing API for this. It was an interesting experiment but I’ll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn’t want to spend a lot of time on it, but nevertheless it _should_ be that easy.\n\nFor this specific use case, there’s probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.\n\nI didn’t want to come away empty handed so along with writing this, I’ve published my serverless crash reporting function on GitHub at [Teamwork/serverless-crash-reporting](https://github.com/Teamwork/serverless-crash-reporting). Feedback is welcome, this stuff is completely new to me.\n\nI’m not disregarding “serverless” just yet. Last week, [two new Lambda features](https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/) were announced by AWS. I’m going to keep an eye on it and I’m sure I’ll revisit this topic in the future.\n",unfilteredRenderedBody:'<h2><a id="serverless-crash-reporting-for-electron-apps" class="post-header-anchor" href="#serverless-crash-reporting-for-electron-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Serverless crash reporting for Electron apps</h2>\n<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>\n<article-summary><p>The term “serverless” has been trendy for a while now. In this post, I’m going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n</article-summary><h3><a id="the-conference" class="post-header-anchor" href="#the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>\n<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you’re unlucky, some conferences can feel a little like a recap of the articles and books you’ve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>\n<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does “serverless” even mean? I’m not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless “function”) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>\n<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>\n<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you’ll pay even if it’s sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1–300 seconds). What’s great as well is that Lambda will completely handle scaling for you.</p>\n<p>The conference was good, especially for one so cheap (even though I’d have paid for some air conditioning 😕). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn’t agree on what “serverless” meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that “serverless” is really about “functions as a unit of deployment” and everything else is secondary. It’s up to you how you use it.</p>\n<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>’s expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don’t mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>\n<p>Overall, I didn’t learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>\n<h3><a id="the-crash-reporter" class="post-header-anchor" href="#the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>\n<p>We’re currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I’m sure this is going to be the first of many posts on that so I won’t go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>\n<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we’re in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron’s <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you\'ve supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ncrashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n productName<span class="token punctuation">:</span> <span class="token string">\'YourAppName;\'</span><span class="token punctuation">,</span>\n companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany;\'</span><span class="token punctuation">,</span>\n submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit&amp;amp\'</span><span class="token punctuation">,</span>\n autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>That’s all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>\'electron’<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>\'ready’<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    productName<span class="token punctuation">:</span> \'YourAppName’<span class="token punctuation">,</span>\n    companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany\'</span><span class="token punctuation">,</span>\n    submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit\'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<h3><a id="the-serverless-crash-reporter" class="post-header-anchor" href="#the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>\n<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don’t want a whole server there running and waiting for crash reports. Ideally you wouldn’t have too many of these and therefore using Lambda should be very cheap.</p>\n<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>\n<ul>\n<li>Search.</li>\n<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>\n<li>New (Electron) desktop apps.</li>\n<li>New (native) mobile apps.</li>\n</ul>\n<p>Expect a few posts on those topics.</p>\n<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>\n<p>The function</p>\n<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what’s the harm in a little ES6?</p>\n<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>\n<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry’s Node.js client module), it’s important to note that I’m passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>\n<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don’t need to clean up that variable, that callback won’t be called again, etc.</p>\n<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I’m not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>\n<p>The Lambda function</p>\n<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn’t expect Lambda to be installing modules from npm. I assumed all I’d need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>\n<p>It wasn’t so easy in reality. Gordon stepped in to help out but long story short… it’s not possible to do what I had planned to do with Lambda; it doesn’t support file uploads.</p>\n<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I’d have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That’s back to the original problem though; if I went with that, there’s no point in using Lambda at all.</p>\n<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It’s a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there’s a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>\n<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>\n<p>The webtask</p>\n<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn’t expect there to be many crash reports.</p>\n<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a “webtask” now. After spending some time with the site, I’d say it’s OK. Some things are hard to get to, but I’m told there is a dashboard in the works.</p>\n<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module’s function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>\n<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you’ll need to bundle them into your webtask. To do this, you’ll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle — output b.js a.js &amp;&amp; wt create b.js — name a.</p>\n<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it’s doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn’t really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don’t really mind since my script was still far below the 100KB webtask weight limit.</p>\n<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it’s a bit hard to find; there is pretty much no way to navigate to it from the site. It’s handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won’t even start like mine wouldn’t.</p>\n<p>Side note: there isn’t any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>\n<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn’t like that the dump file Electron is sending is 560KB, which shouldn’t be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>\n<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>\n<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>\n<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token string">\'Content-Type\'</span><span class="token punctuation">:</span> <span class="token string">\'text/html \'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'&lt;h1>Hello, world!&lt;/h1>\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>\n<p>OK, so I got it working. Finally. Here is my webtask:</p>\n<pre><code class="language-javascript"><span class="token string">\'use strict\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'formidable\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'raven\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'aws-sdk\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'bluebird\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>\n  sentryDsn<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  accessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  bucket<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  secretAccessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>\n\n<span class="token comment">// req - request {Object}</span>\n<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>\n        files<span class="token punctuation">:</span> files\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// name - {String}</span>\n<span class="token comment">// contents - {String}</span>\n<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>\n<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>\n    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      ACL<span class="token punctuation">:</span> <span class="token string">\'public-read\'</span><span class="token punctuation">,</span>\n      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>\n      Body<span class="token punctuation">:</span> contents\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// context - {Object}</span>\n<span class="token comment">// req - {Object}</span>\n<span class="token comment">// res - {Object}</span>\n<span class="token comment">// Returns a Promise</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Successfully received crash and sent event to Sentry!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>\n        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>\n        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">\'upload_file_minidump\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">\'utf8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>\n            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>\n            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">\' crash\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        context<span class="token punctuation">:</span> context\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>One thing that’s nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>\n<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>’s free plan only allows for “30 days webtask lifetime,” whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn’t support custom domains, so it’s not so cheap after all, eh?</p>\n<h3><a id="the-conclusion" class="post-header-anchor" href="#the-conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conclusion</h3>\n<p>In the end, I decided we’ll just add an endpoint to our existing API for this. It was an interesting experiment but I’ll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn’t want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>\n<p>For this specific use case, there’s probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>\n<p>I didn’t want to come away empty handed so along with writing this, I’ve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>\n<p>I’m not disregarding “serverless” just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I’m going to keep an eye on it and I’m sure I’ll revisit this topic in the future.</p>\n',attributes:{date:"2016-11-22T00:00:00.000Z",original:{blogLink:"https://engineroom.teamwork.com",blogName:"Teamwork's Engine Room",url:"https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a"},tags:[{id:"serverless",name:"serverless"},{id:"electron",name:"electron"},{id:"javascript",name:"javascript"},{id:"aws",name:"aws"},{id:"development",name:"development"}],title:"Serverless crash reporting for Electron apps",updated_at:"2019-05-22T08:26:26.903Z",photo:"https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png"},title:"Serverless crash reporting for Electron apps",renderedSummary:'<p>The term “serverless” has been trendy for a while now. In this post, I’m going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n',rendered:'<h2><a id="serverless-crash-reporting-for-electron-apps" class="post-header-anchor" href="#serverless-crash-reporting-for-electron-apps" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>Serverless crash reporting for Electron apps</h2>\n<p><a href="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png" alt=""></a></p>\n<p>The term “serverless” has been trendy for a while now. In this post, I’m going to share my experience dabbling with serverless architecture, specifically for handling crash reports from <a href="http://electron.atom.io/" rel="noopener">Electron</a> apps.</p>\n<h3><a id="the-conference" class="post-header-anchor" href="#the-conference" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conference</h3>\n<p>I attend about two or three conferences a year, typically related to JavaScript or the Web. Some have been amazing, like <a href="http://www.nodeconf.eu/" rel="noopener">NodeConf EU</a>. A few others were slightly disappointing, in that I expected to learn more. If you’re unlucky, some conferences can feel a little like a recap of the articles and books you’ve read over the previous year. Each developer at Teamwork gets one paid conference per year. This year, I decided to change things up and go for a topic I know little about, so I chose to head to New York for the first ever <a href="http://serverlessconf.io/" rel="noopener">ServerlessConf</a>.</p>\n<p>I bought a <a href="https://www.udemy.com/" rel="noopener">Udemy</a> course on <a href="https://aws.amazon.com/lambda/" rel="noopener">AWS Lambda</a> during a sale and the video or two I watched of that was the extent of my knowledge on serverless architecture. So what does “serverless” even mean? I’m not sure anyone knows really, but more on that later. The idea with Lambda is that once you supply some code (a stateless “function”) in one of the supported languages, you can trigger it via an API you configure, other events, or on a schedule (think Cron). The typical example is creating thumbnails whenever an image is added to a particular <a href="https://aws.amazon.com/s3/" rel="noopener">S3</a> bucket.</p>\n<p><a href="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" rel="noopener"><img src="https://cdn-images-1.medium.com/max/1600/0*PunR2epJ6yYV0f9_.png" alt=""></a></p>\n<p>So you push up little chunks of code which can all be written in different languages if you like and can be updated independently at any point. You only pay when your functions are executing. Compare that to setting up an API on an <a href="https://aws.amazon.com/ec2/" rel="noopener">EC2</a> instance where you’ll pay even if it’s sitting there idle. By default, your functions can only execute for 3 seconds at most before being killed but that can be configured (to anything between 1–300 seconds). What’s great as well is that Lambda will completely handle scaling for you.</p>\n<p>The conference was good, especially for one so cheap (even though I’d have paid for some air conditioning 😕). Of course some talks were basically people pushing their services but overall it was interesting. It was clear the speakers couldn’t agree on what “serverless” meant. Some implied it was about not managing your own servers or replacing a certain chunk of your server stack but keeping the rest, using third-party services and APIs at every possible chance, among others. My takeaway is that “serverless” is really about “functions as a unit of deployment” and everything else is secondary. It’s up to you how you use it.</p>\n<p>Most of the talks involved AWS and there were a lot of jokes at <a href="https://aws.amazon.com/api-gateway/" rel="noopener">API Gateway</a>’s expense (the AWS tool you must configure to expose an API for your functions, which apparently is very awkward). Joe Emison gave an interesting <a href="http://www.slideshare.net/ServerlessConf/joe-emison-10x-product-development" rel="noopener">talk</a> on using third-party services and serverless architectures to get his apps to market quickly. He essentially created thick clients leveraging services like <a href="https://firebase.google.com/" rel="noopener">Firebase</a>, <a href="https://auth0.com/" rel="noopener">Auth0</a>, <a href="https://www.algolia.com/" rel="noopener">Algolia</a>, <a href="https://www.netlify.com/" rel="noopener">Netlify</a>, <a href="https://webtask.io/" rel="noopener">Webtask.io</a>, and more. I admired his cojones in pointing out that nothing AWS offers is best-in-class individually, as long as you don’t mind not having everything in one place, given that the general manager of AWS Lambda was in the front row.</p>\n<p>Overall, I didn’t learn <em>that</em> much. A lot of the talks were high-level talks on stacks, etc. I came away optimistic and still curious about serverless architecture as well as Firebase and more.</p>\n<h3><a id="the-crash-reporter" class="post-header-anchor" href="#the-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The crash reporter</h3>\n<p>We’re currently rewriting our desktop apps to be based on Electron rather than <a href="http://nwjs.io/" rel="noopener">NW.js</a>. I’m sure this is going to be the first of many posts on that so I won’t go into too much detail here. I recently wrote a book on Electron called <a href="http://shop.oreilly.com/product/9781939902344.do" rel="noopener">Developing an Electron Edge</a> and while proofreading it, a nice serverless use case struck me; serverless crash reporting.</p>\n<p>Sure, we report runtime errors to <a href="https://sentry.io/teamwork/" rel="noopener">Sentry</a> when they occur in <a href="https://teamwork.com/chat" rel="noopener">Teamwork Chat</a>, but what if the app crashes entirely? Well, we’re in the dark there. One of the nice features Electron has over NW.js is crash reporting. Once you set up Electron’s <a href="http://electron.atom.io/docs/api/crash-reporter/" rel="noopener"><code>crash-reporter</code></a> module in your main and renderer process(es), it will send a POST request to the URL you\'ve supplied any time the app crashes with some helpful information including the type of process which died, the app version, the OS, a dump file for debugging, and more.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'electron\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\ncrashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n productName<span class="token punctuation">:</span> <span class="token string">\'YourAppName;\'</span><span class="token punctuation">,</span>\n companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany;\'</span><span class="token punctuation">,</span>\n submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit&amp;amp\'</span><span class="token punctuation">,</span>\n autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>That’s all you need. If you want to crash your app to test this out, call process.crash in your main process or any renderer process.</p>\n<pre><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> crashReporter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>\'electron’<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\napp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>\'ready’<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  crashReporter<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    productName<span class="token punctuation">:</span> \'YourAppName’<span class="token punctuation">,</span>\n    companyName<span class="token punctuation">:</span> <span class="token string">\'YourCompany\'</span><span class="token punctuation">,</span>\n    submitURL<span class="token punctuation">:</span> <span class="token string">\'https://your-domain.com/url-to-submit\'</span><span class="token punctuation">,</span>autoSubmit<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  process<span class="token punctuation">.</span><span class="token function">crash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n<h3><a id="the-serverless-crash-reporter" class="post-header-anchor" href="#the-serverless-crash-reporter" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The serverless crash reporter</h3>\n<p>So how can we make this serverless? We could have a Lambda function which accepts a POST, uploads the dump file to S3 and then sends an error event to Sentry with the URL to the file in the metadata. Nice right? I thought so anyway. We don’t want a whole server there running and waiting for crash reports. Ideally you wouldn’t have too many of these and therefore using Lambda should be very cheap.</p>\n<p>It would just be a fun little project too, right? Gordon (devOps) and I had been interested in testing out something serverless for awhile and it was an attractive idea given that we had a few big ongoing projects within Teamwork Chat;</p>\n<ul>\n<li>Search.</li>\n<li>Redoing a lot of our backend, breaking into smaller microservices using RabbitMQ, Kubernetes, and more.</li>\n<li>New (Electron) desktop apps.</li>\n<li>New (native) mobile apps.</li>\n</ul>\n<p>Expect a few posts on those topics.</p>\n<p>Anyway, I thought serverless crash reporting would be a nice little side-project I could throw a few hours into without needing too much knowledge on anything, so I started with the function itself.</p>\n<p>The function</p>\n<p>I started out by creating an S3 bucket, grabbed some API credentials, created a new Sentry project, and grabbed its DSN. We write everything in <a href="https://adamlynch.com/coffeescript-at-teamwork/" rel="noopener">CoffeeScript at Teamwork</a> but this will only be a few lines long, what’s the harm in a little ES6?</p>\n<p>I quickly threw together a module which did what I wanted. To test it, I created another script which required the first file, started an API with <a href="http://expressjs.com/" rel="noopener">express</a>, and called my function whenever it received a POST.</p>\n<pre><code class="language-javascript">ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n<p>When instantiating <a href="https://github.com/getsentry/raven-node" rel="noopener">Raven</a> (Sentry’s Node.js client module), it’s important to note that I’m passing the app version as the release. This will also me to browse the errors on Sentry by app version and do whatever I like with them. This very handy. Otherwise, you could have an old buggy version of your app still being used by customers filling up your error logs.</p>\n<p>Another thing worth mentioning is that writing single-use code is jarring. There are a few best practices you could not do and it would work fine; you don’t need to clean up that variable, that callback won’t be called again, etc.</p>\n<p>Now I could start our Electron app which calls process.crash in its main process, a POST request would be sent to the local API, the file would go to S3, and finally a Sentry event would be created. I’m not sure if this is how people typically work serverlessly. It worked for me. I could easily mock some of the calls when debugging too.</p>\n<p>The Lambda function</p>\n<p>Even though I had never used Lambda, I assumed that was the easy part. As far as I knew, all I needed for Lambda was a Node.js module that exported a function with which accepted certain arguments. I thought I might have had some issues with dependencies, I didn’t expect Lambda to be installing modules from npm. I assumed all I’d need to do is bundle them up into a ZIP or something like that for Lambda to use.</p>\n<p>It wasn’t so easy in reality. Gordon stepped in to help out but long story short… it’s not possible to do what I had planned to do with Lambda; it doesn’t support file uploads.</p>\n<p>A few suggested a workaround of putting the file on S3 and have that trigger the Lambda function but the POST is not under our control. I’d have to point the crash-reporter module at an intermediary URL which would accept the file, put it on S3, and the Lambda function would take over from there. That’s back to the original problem though; if I went with that, there’s no point in using Lambda at all.</p>\n<p>Around the same time, I started investigating the <a href="https://serverless.com/" rel="noopener">Serverless Framework</a>. It looked interesting. It’s a framework for Node.js functions with CLI tools which make publishing functions easier, stuff for testing functions, and more. The idea is that AWS Lambda is one of the platforms supported by Serverless Framework, along with Google CloudFunctions and more. I think there’s a company behind it but a lot of it is <a href="https://github.com/serverless/serverless" rel="noopener">open-sourced</a>, I think.</p>\n<p>Maybe this framework would allow me to workaround my problem or at least I could point it to another hosting provider which <em>does</em> support POSTing of files. I <a href="http://forum.serverless.com/t/no-support-for-posting-files/307" rel="noopener">posted</a> in their forum and played around with it in the meantime. On closer inspection, I found it to be a bit immature and the documentation to be a little lacking. I got a few answers on my forum post but once I properly got my problem across, the answers stopped.</p>\n<p>The webtask</p>\n<p>Disappointed, I almost gave up until I remembered <a href="http://Webtask.io" rel="noopener">Webtask.io</a>. This is what Joe Emison had used instead of Lambda and I had heard good things about its parent company, Auth0. A quick look at their site got my hopes up again. There was even a <em>free</em> plan which limited us to one execution per second, which was fine by me as I wouldn’t expect there to be many crash reports.</p>\n<p>Based on the documentation, it looked good, powerful. There was a lot there. Almost too much even; I originally just wanted to spend a few hours on this and host my function, which would be called a “webtask” now. After spending some time with the site, I’d say it’s OK. Some things are hard to get to, but I’m told there is a dashboard in the works.</p>\n<p>I had a few little hiccups with their <a href="https://www.npmjs.com/package/wt-cli" rel="noopener">wt-cli</a> CLI module (because I was on Windows) but I had a dummy webtask running online somewhat quickly. My module’s function signature had to refactored a bit to be compatible but once I did that, I uploaded my webtask and triggered it by crashing my Electron app. Then I ran into some problems.</p>\n<p><a href="http://Webtask.io" rel="noopener">Webtask.io</a> has some pre-installed npm modules but if you use anything outside of those, you’ll need to bundle them into your webtask. To do this, you’ll need their another module; <a href="https://www.npmjs.com/package/webtask-bundle" rel="noopener">webtask-bundle</a>. So now instead of just running wt create a.js to publish/update a webtask named a, I needed to run webtask-bundle — output b.js a.js &amp;&amp; wt create b.js — name a.</p>\n<p>The bundler uses <a href="https://webpack.github.io/" rel="noopener">Webpack</a> underneath so all it’s doing is traversing the requires and bundling it together into one script. One downside to this is that the native promises from Node.js can no longer be found when Promise is referenced without a Webpack bundle. Webpack must mess with globals or something, I didn’t really look into it. I just used <a href="http://bluebirdjs.com/docs/getting-started.html" rel="noopener">bluebird</a> for promises and quickly moved on. Another downside are that it bundles all dependencies, even the ones I know <a href="http://Webtask.io" rel="noopener">Webtask.io</a> have. I don’t really mind since my script was still far below the 100KB webtask weight limit.</p>\n<p>Running the commands every time I found an issue was becoming tedious. Instead, I started using the Web-based webtask editor (yes, editing the Webpack output). The editor is a good idea, even though it can be buggy and it’s a bit hard to find; there is pretty much no way to navigate to it from the site. It’s handy that you can run your webtask with the click of a button in the editor and watch the real-time logs, especially when your webtask won’t even start like mine wouldn’t.</p>\n<p>Side note: there isn’t any real consensus on the best way to work with webtasks. Support for <a href="https://github.com/auth0/wt-cli/pull/89" rel="noopener">local debugging</a> was added recently though.</p>\n<p>Once I got around those little problems, I started getting a 400; Script exceeds the size limit. The error is misleading. It doesn’t like that the dump file Electron is sending is 560KB, which shouldn’t be a problem. As I said earlier, webtasks are limited to 100KB and the file is being compared to this by mistake.</p>\n<p>One thing I should point out is the <a href="http://Webtask.io" rel="noopener">Webtask.io</a> has a <a href="https://webtask-chat.slack.com/" rel="noopener">Slack channel</a> where you can receive some much appreciated support. It was pointed out to me there that <a href="http://Webtask.io" rel="noopener">Webtask.io</a> actually supports <a href="https://webtask.io/docs/model" rel="noopener">multiple function signatures</a> and I should try one of the other options; specifically the one that uses express.</p>\n<p>Once I did this, limit error disappeared but I started getting a random error deep in express itself, so I tried another function signature and it worked.</p>\n<pre><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token string">\'Content-Type\'</span><span class="token punctuation">:</span> <span class="token string">\'text/html \'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'&lt;h1>Hello, world!&lt;/h1>\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>Note: one other thing I should point out is that I needed to disable the Parse body and Merge body options in the settings for my webtask too.</p>\n<p>OK, so I got it working. Finally. Here is my webtask:</p>\n<pre><code class="language-javascript"><span class="token string">\'use strict\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'formidable\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> raven <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'raven\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> aws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'aws-sdk\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> Promise <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'bluebird\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>\n  sentryDsn<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  s3<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  accessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  bucket<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span><span class="token punctuation">,</span>\n  secretAccessKey<span class="token punctuation">:</span> <span class="token string">\'TODO\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> ravenClient<span class="token punctuation">,</span> onError<span class="token punctuation">;</span>\n\n<span class="token comment">// req - request {Object}</span>\n<span class="token comment">// Returns a Promise which resolves to an {Object} containing {fields} and {files}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">parseFormData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    formidable<span class="token punctuation">.</span><span class="token function">IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        fields<span class="token punctuation">:</span> fields<span class="token punctuation">,</span>\n        files<span class="token punctuation">:</span> files\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// name - {String}</span>\n<span class="token comment">// contents - {String}</span>\n<span class="token comment">// Returns a Promise which resolves to a {String} URL</span>\n<span class="token keyword">const</span> <span class="token function-variable function">uploadDumpToS3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  aws<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    accessKeyId<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>accessKey<span class="token punctuation">,</span>\n    secretAccessKey<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>secretAccessKey\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">aws<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    params<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      Bucket<span class="token punctuation">:</span> config<span class="token punctuation">.</span>s3<span class="token punctuation">.</span>bucket\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    s3<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      ACL<span class="token punctuation">:</span> <span class="token string">\'public-read\'</span><span class="token punctuation">,</span>\n      Key<span class="token punctuation">:</span> name<span class="token punctuation">,</span>\n      Body<span class="token punctuation">:</span> contents\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// context - {Object}</span>\n<span class="token comment">// req - {Object}</span>\n<span class="token comment">// res - {Object}</span>\n<span class="token comment">// Returns a Promise</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">onError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ravenClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ravenClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">raven<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>sentryDsn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        release<span class="token punctuation">:</span> options<span class="token punctuation">.</span>_version\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    ravenClient<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">\'Successfully received crash and sent event to Sentry!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token function">parseFormData</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>formData <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>\n        tags<span class="token punctuation">:</span> formData<span class="token punctuation">.</span>fields<span class="token punctuation">,</span>\n        extra<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> dump <span class="token operator">=</span> formData<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">\'upload_file_minidump\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>dump<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">\'utf8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token function">uploadDumpToS3</span><span class="token punctuation">(</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>url <span class="token operator">=></span> <span class="token punctuation">{</span>\n            payload<span class="token punctuation">.</span>extra<span class="token punctuation">[</span>dump<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> url<span class="token punctuation">;</span>\n            <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> payload<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>process_type <span class="token operator">+</span> <span class="token string">\' crash\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      extra<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        context<span class="token punctuation">:</span> context\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n<p>One thing that’s nice is that any error that occurs in the promise chain will also be logged to Sentry.</p>\n<p>Next up, look into creating a proper account for Teamwork (instead of using my personal one) and hooking up a nice URL like functions.teamwork.chat. Looking over the site again, it hit me; I missed that <a href="http://Webtask.io" rel="noopener">Webtask.io</a>’s free plan only allows for “30 days webtask lifetime,” whereas the other plans are unlimited in this respect. The next plan up is $9 per month and it doesn’t support custom domains, so it’s not so cheap after all, eh?</p>\n<h3><a id="the-conclusion" class="post-header-anchor" href="#the-conclusion" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>The conclusion</h3>\n<p>In the end, I decided we’ll just add an endpoint to our existing API for this. It was an interesting experiment but I’ll leave it at that for now. Overall, I found the services and tools around serverless architecture to be a bit immature and flaky. Keep in mind that I knew very little about it and didn’t want to spend a lot of time on it, but nevertheless it <em>should</em> be that easy.</p>\n<p>For this specific use case, there’s probably scope for a Sentry feature where a project can expose a URL which we can POST crash dumps to and events are created in the project. That would be nice.</p>\n<p>I didn’t want to come away empty handed so along with writing this, I’ve published my serverless crash reporting function on GitHub at <a href="https://github.com/Teamwork/serverless-crash-reporting" rel="noopener">Teamwork/serverless-crash-reporting</a>. Feedback is welcome, this stuff is completely new to me.</p>\n<p>I’m not disregarding “serverless” just yet. Last week, <a href="https://aws.amazon.com/blogs/aws/new-for-aws-lambda-environment-variables-and-serverless-application-model/" rel="noopener">two new Lambda features</a> were announced by AWS. I’m going to keep an eye on it and I’m sure I’ll revisit this topic in the future.</p>\n',summary:"The term “serverless” has been trendy for a while now. In this post, I’m going to share my experience dabbling with serverless architecture, specifically for handling crash reports from Electron apps.\n",original:{blogLink:"https://engineroom.teamwork.com",blogName:"Teamwork's Engine Room",url:"https://engineroom.teamwork.com/serverless-crash-reporting-for-electron-apps-fe6e62e5982a"},photo:"https://cdn-images-1.medium.com/max/1600/1*7_8IQl1UmmFdv-Z3EwGNJg.png",keywords:["serverless","electron","javascript","aws","development"],published_at:"2016-11-22T00:00:00.000Z",updated_at:"2019-05-22T08:26:26.903Z",year:2016,month:11,day:23,relevanceScore:.75}]}}],error:null,state:{nameToShow:"Adam Lynch",githubAccountUrl:"https://github.com/adam-lynch",siteUrl:"https://adamlynch.com",siteTitle:"Adam Lynch",repositoryUrl:"https://github.com/adam-lynch/adam-lynch.github.io"},serverRendered:!0}</script><script src="/_nuxt/manifest.65913a97086adc66c060.js" defer></script><script src="/_nuxt/layouts/default.8ce3dde6452dcf1cfcac.js" defer></script><script src="/_nuxt/1.03bda2e583db241630d8.js" defer></script><script src="/_nuxt/vendor.ce05078a33ab89125ee8.js" defer></script><script src="/_nuxt/app.4156c854185051639b89.js" defer></script>

    <script src="https://use.typekit.net/tci5xbk.js"></script>
    <script>try{Typekit.load({async:!0})}catch(a){}</script>
    <script>!function(e,a,t,n,c,g,s){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,g=a.createElement("script"),s=a.getElementsByTagName("script")[0],g.async=1,g.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(g,s)}(window,document),ga("create","UA-31546953-1","auto"),ga("send","pageview")</script>
  

